/**
 * impac-angular - Impac! Front-End Library
 * @version v1.7.4
 * @git git://github.com/maestrano/impac-angular.git
 * @license Copyright 2017 Maestrano Pty Ltd
 */
(function(){"use strict";angular.module("maestrano.impac",["impac.services","impac.filters","impac.components","ngMessages","ui.sortable","ui.bootstrap","emguo.poller","toastr","pascalprecht.translate","xeditable"]),angular.module("impac.components",["impac.components.dashboard","impac.components.dashboard-create","impac.components.dashboard-selector","impac.components.dashboard-templates-selector","impac.components.dashboard-settings","impac.components.kpis-bar","impac.components.kpi","impac.components.chart","impac.components.alerts-config","impac.components.widget","impac.components.widgets","impac.components.widgets-settings","impac.components.widgets-common","impac.components.common","impac.components.templates"]),angular.module("impac.components.widgets",["impac.components.widgets.accounts-accounting-values","impac.components.widgets.accounts-assets-summary","impac.components.widgets.accounts-assets-liability-summary","impac.components.widgets.accounts-balance-sheet","impac.components.widgets.accounts-balance","impac.components.widgets.accounts-cash-projection","impac.components.widgets.accounts-cash-summary","impac.components.widgets.accounts-comparison","impac.components.widgets.accounts-custom-calculation","impac.components.widgets.accounts-expenses-revenue","impac.components.widgets.accounts-payable-receivable","impac.components.widgets.accounts-profit-and-loss","impac.components.widgets.accounts-class-comparison","impac.components.widgets.accounts-expense-weight","impac.components.widgets.accounts-assets-vs-liabilities","impac.components.widgets.accounts-detailed-classifications","impac.components.widgets.accounts-ratios","impac.components.widgets.accounts-cash-balance","impac.components.widgets.accounts-live-balance","impac.components.widgets.accounts-invoices-list","impac.components.widgets.hr-employee-details","impac.components.widgets.hr-employees-list","impac.components.widgets.hr-leaves-balance","impac.components.widgets.hr-leaves-schedule","impac.components.widgets.hr-payroll-summary","impac.components.widgets.hr-payroll-taxes","impac.components.widgets.hr-salaries-summary","impac.components.widgets.hr-superannuation-accruals","impac.components.widgets.hr-timesheets","impac.components.widgets.hr-workforce-summary","impac.components.widgets.invoices-aged-payables-receivables","impac.components.widgets.invoices-list","impac.components.widgets.invoices-summary","impac.components.widgets.sales-aged","impac.components.widgets.sales-break-even","impac.components.widgets.sales-comparison","impac.components.widgets.sales-customer-details","impac.components.widgets.sales-cycle","impac.components.widgets.sales-forecast","impac.components.widgets.sales-growth","impac.components.widgets.sales-leads-funnel","impac.components.widgets.sales-leads-list","impac.components.widgets.sales-list","impac.components.widgets.sales-margin","impac.components.widgets.sales-net-sales","impac.components.widgets.sales-number-of-leads","impac.components.widgets.sales-opportunities-funnel","impac.components.widgets.sales-performance","impac.components.widgets.sales-segmented-turnover","impac.components.widgets.sales-summary","impac.components.widgets.sales-top-opportunities","impac.components.widgets.sales-top-customers","impac.components.widgets.sales-new-vs-existing-customers"]),angular.module("impac.components.widgets-settings",["impac.components.widgets-settings.account","impac.components.widgets-settings.bolt-account","impac.components.widgets-settings.accounts-list","impac.components.widgets-settings.accounting-behaviour","impac.components.widgets-settings.chart-filters","impac.components.widgets-settings.dates-picker","impac.components.widgets-settings.formula","impac.components.widgets-settings.hist-mode","impac.components.widgets-settings.limit-entries","impac.components.widgets-settings.organizations","impac.components.widgets-settings.param-selector","impac.components.widgets-settings.params-picker","impac.components.widgets-settings.params-checkboxes","impac.components.widgets-settings.time-period","impac.components.widgets-settings.time-presets","impac.components.widgets-settings.time-slider","impac.components.widgets-settings.width","impac.components.widgets-settings.attach-kpis","impac.components.widgets-settings.tag-filter","impac.components.widgets-settings.offsets"]),angular.module("impac.components.dashboard-settings",["impac.components.dashboard-settings.currency","impac.components.dashboard-settings.pdf-mode","impac.components.dashboard-settings.sync-apps"]),angular.module("impac.components.widgets-common",["impac.components.widgets-common.editable-title","impac.components.widgets-common.info-panel","impac.components.widgets-common.time-period-info","impac.components.widgets-common.top-buttons","impac.components.widgets-common.autofocus","impac.components.widgets-common.currency-conversions","impac.components.widgets-common.chart-threshold"]),angular.module("impac.components.common",["impac.components.common.data-not-found","impac.components.common.delete-widget","impac.components.common.transactions-add","impac.components.common.transactions-list","impac.components.common.trends-add","impac.components.common.trends-list"]),angular.module("impac.services",["impac.services.routes","impac.services.linking","impac.services.theming","impac.services.assets","impac.services.chart-formatter","impac.services.highcharts-factory","impac.services.message-bus","impac.services.utilities","impac.services.main","impac.services.kpis","impac.services.dashboards","impac.services.dashboard-templates","impac.services.widgets","impac.services.developer","impac.services.pusher","impac.services.alerts","impac.services.notifications","impac.services.events","impac.services.currency-rates","impac.services.bolt-resources"]),angular.module("impac.filters",["impac.filters.titleize","impac.filters.truncate","impac.filters.mno-currency","impac.filters.moment-date"]),angular.module("impac.components.templates",[]).run(["$templateCache",function(e){e.put("alerts-config/alerts-config.modal.html",'<div class="kpi-alerts-settings">\n\n  <div class="modal-header" translate>\n    impac.kpi.alerts.title\n  </div>\n\n  <div class="modal-body">\n    <span translate="impac.kpi.alerts.explanation"\n          translate-values="{name: kpi.name,  element_watched: kpi.element_watched}"></span>\n    <u>{{translateTarget(kpi)}}</u> :\n\n    <ul class="list-group">\n\n      <li class="list-group-item" ng-repeat="alert in alerts" ng-class="{active: alert.active}">\n        <div class="alert-toggle" ng-click="toggleAlert(alert)">\n          <i class="fa" ng-class="alert.active ? \'fa-toggle-on\' : \'fa-toggle-off\'" />\n          {{alert.label}}\n        </div>\n\n        <ul class="list-group recipients-list" ng-show="showRecipientList(alert)">\n\n          <li class="list-group-item" ng-repeat="member in members track by member.id" ng-if="member.active" ng-click="toggleRecipient(member)">\n            {{member.email}}\n            <button type="button" class="close" aria-label="Close">\n              <span aria-hidden="true">&times;</span>\n            </button>\n          </li>\n\n        </ul>\n\n        <input class="recipient-search" placeholder="Add Recipients By Member Email" ng-show="showRecipientList(alert)" ng-model="recipientSearch.text" ng-keydown="onAddRecipientsKeyPress($event)" ng-focus="onRecipientSearchFocus()"/>\n\n        <ul class="list-group recipients-list available" ng-show="showAvailableRecipients(alert)">\n\n          <li class="list-group-item" ng-class="member == selectedMember ? \'active\' : \'\'" ng-repeat="member in members | filter:recipientSearch.text as filteredMembers" ng-if="!member.active" ng-click="toggleRecipient(member)">\n            {{member.email}}\n          </li>\n\n        </ul>\n      </li>\n\n    </ul>\n\n  </div>\n\n  <div class="modal-footer text-right">\n    <button class="btn btn-default" ng-click="modal.close()" translate>impac.kpi.alerts.cancel</button>\n    <button class="btn btn-primary" ng-click="save(alerts)" translate><strong>impac.kpi.alerts.save</strong></button>\n  </div>\n\n</div>\n'),e.put("alerts-config/alerts-config.tmpl.html",'<div class="alerts-config" ng-show="(kpi.targets && kpi.targets[kpi.element_watched].length > 0)" ng-click="showAlertsSettings()">\n  <!-- directive link function compiles html here -->\n</div>\n'),e.put("dashboard/dashboard.tmpl.html",'<!-- DASHBOARD -->\n<div class="analytics" ng-hide="(isLoading || forceLoad || failedDashboardLoad)" ng-class="{\'hide-dhb\': (isLoading || forceLoad), \'show-dhb\': !(isLoading || forceLoad), \'pdf-mode\': pdfMode }">\n  <div mno-star-wizard=true modal-open=\'starWizardModal.value\'></div>\n\n  <!-- Title and Dashboard selection -->\n  <div class="row" id="dashboard-heading" ng-if="showDhbHeading">\n    <div class="col-xs-12">\n      <img ng-src="{{impacTitleLogo}}" ng-click="!pdfMode || triggerUpload()" ng-class="{\'pdf-mode\': pdfMode}" />\n      <br />\n      <button class="btn btn-sm btn-default hidden-print" ng-click="triggerUpload()" ng-if="pdfMode" translate>impac.dashboard.change_logo</button>\n      <input type="file" style="display:none" id="fileInput" name="filedata"/>\n    </div>\n\n    <div class="col-xs-12">\n      <div class="caption">{{dhbHeadingText}}</div>\n    </div>\n  </div>\n\n  <!-- Impac KPI\'s -->\n  <kpis-bar ng-if="kpisBar.displayed()" kpis="currentDhb.kpis" user-accesses="userAccesses"></kpis-bar>\n\n  <!-- Dashboards selection/creation/deletion -->\n  <dashboard-selector id="module__dashboard-selector" is-widget-selector-shown="showWidgetSelector()" on-create-dashboard="createDashboard(dashboard)" on-display-widget-selector="displayWidgetSelector()" on-select-dashboard="activateTimer()" pdf-mode="pdfMode" dhb-label-name="dhbLabelName" user-accesses="userAccesses"></dashboard-selector>\n\n  <div id="sub-menu" uib-collapse="!showSubMenu">\n    <i class="fa fa-times" ng-click="hideSubMenu()" />\n\n    <!-- Displayed to MYOB Essentials Users -->\n    <div id="myob-message" ng-if="hasMyobEssentialsOnly && myobMessageConfig.show" class="alert alert-warning">\n      <h3 translate>impac.dashboard.it_looks_like</h3>\n      <p translate="impac.dashboard.unfortunately_information"></p>\n      <p>{{\'impac.dashboard.myob_message.part_1\' | translate}} <a href="http://myob.com.au/products/small-business/accounting-software/myob-accountright-1422735752948" target="_blank">{{\'impac.dashboard.myob_message.part_2\' | translate}}</a> {{\'impac.dashboard.myob_message.part_3\' | translate}}</p>\n      <p align="right" ng-if="myobMessageConfig.appLink.show"><a ng-href="{{myobMessageConfig.appLink.url}}" target="_blank" translate>{{myobMessageConfig.appLink.text}}</a></p>\n    </div>\n  </div>\n\n  <!-- Widgets selection container -->\n  <div id="widget-selector" uib-collapse="!showWidgetSelector()" ng-if="userAccesses.widgets.create && !customWidgetSelector.path">\n    <div class="title">\n      <p class="instruction" translate translate-values="{name: dhbLabelName}">impac.dashboard.select_the_widgets</p>\n      <span class="widget-added badge" translate>impac.dashboard.widget_added</span>\n      <i class="fa fa-times-circle close-selector" ng-if="showCloseWidgetSelectorButton()" ng-click="displayWidgetSelector(false)"/>\n    </div>\n\n    <div class="row top-container">\n      <div class="col-md-3 categories-section">\n        <div class="row section-header">\n          <span translate>impac.dashboard.all_categories</span>\n        </div>\n        <div class="row section-lines">\n          <div class="col-md-12">\n            <p class="line-item" ng-click="selectCategory(\'accounts\')" ng-class="isCategorySelected(\'accounts\') ? \'selected\' : none" translate>impac.dashboard.accounting</p>\n            <p class="line-item" ng-click="selectCategory(\'invoices\')" ng-class="isCategorySelected(\'invoices\') ? \'selected\' : none" translate>impac.dashboard.invoicing</p>\n            <p class="line-item" ng-click="selectCategory(\'hr\')" ng-class="isCategorySelected(\'hr\') ? \'selected\' : none" translate>impac.dashboard.hr_or_payroll</p>\n            <p class="line-item" ng-click="selectCategory(\'sales\')" ng-class="isCategorySelected(\'sales\') ? \'selected\' : none" translate>impac.dashboard.sales</p>\n          </div>\n        </div>\n        <div class="arrow-icon" ng-style="getSelectedCategoryTop()">\n          <div class="square"></div>\n          <i class="fa fa-caret-right"></i>\n        </div>\n      </div>\n\n      <div class="col-md-9 widgets-section">\n        <div class="section-header row">\n          <span>{{getSelectedCategoryName() | titleize}}</span>\n        </div>\n        <div class="section-lines">\n          <div class="line-items-grid">\n            <div class="grid-item" ng-repeat="widgetTemplate in getWidgetsForSelectedCategory()" ng-click="addWidget(widgetTemplate)" uib-tooltip="{{widgetTemplate.desc}}" tooltip-placement="{{$index < 9 ? \'bottom\' : \'top\'}}" tooltip-animation="false"  tooltip-append-to-body="true" tooltip-class="impac-widget-selector-tooltip">\n              <i class="fa fa-{{widgetTemplate.icon}} line-item" />\n              <p class="line-item" ng-bind="widgetTemplate.name"></p>\n              <i class="fa fa-plus-circle line-item" />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="bottom" ng-if="widgetSuggestionModal.config.apiPath">\n      <span class="suggestion">\n        {{\'impac.dashboard.can_not_find\' | translate}} <a ng-click="widgetSuggestionModal.open()">{{\'impac.dashboard.give_us\' | translate}}</a>\n      </span>\n    </div>\n  </div>\n\n  <!-- custom widget selector template configured from ImpacThemingProvider -->\n  <div id="custom-widget-selector" ng-if="customWidgetSelector.path" ng-include="customWidgetSelector.path" ng-hide="showChooseDhbMsg()"></div>\n\n  <!-- Dashboard Settings - DEFAULT POSITION -->\n  <div id="dashboard-settings-panel" ng-if="!dhbSettingsConfig.inWidgetsContainer && !showChooseDhbMsg()" class="row" ng-hide="pdfMode">\n    <div class="col-xs-12">\n      <div dashboard-setting-sync-apps ng-if="dhbSettingsConfig.syncApps.show()"/>\n      <div dashboard-setting-currency ng-if="userAccesses.dashboards.update" currency="currentDhb.currency" />\n    </div>\n  </div>\n\n  <!-- Errors -->\n  <div class="alert alert-error" ng-show="errors">\n    <button class="close" ng-click="errors=\'\'">×</button>\n    <ul>\n      <li ng-repeat="error in errors">{{error}}</li>\n    </ul>\n  </div>\n\n  <div id="no-widgets-container" class="row text-center ng-hide" ng-show=\'(showChooseDhbMsg() || showNoWidgetsMsg())\'>\n    <img ng-src="{{impacDashboardBackground}}" class="bg">\n\n    <div class="impac-info-message">\n      <!-- First Time Dashboard Creation -->\n      <div class="ng-hide" ng-show=\'showChooseDhbMsg()\'>\n        <div class=\'hidden-xs\'>\n          <div class="row top-buffer-4">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="info-text">\n                <p><b translate translate-values="{name: dhbLabelName}">{{dhbErrorsConfig.firstTimeCreated.first}}</b></p>\n                <p translate>{{dhbErrorsConfig.firstTimeCreated.second}}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="align-center top-buffer-2">\n          <impac-dashboard-create ng-if="userAccesses.dashboards.create" on-create-dashboard="createDashboard(dashboard)" label-locale="impac.dashboard.create_a_dashboard" btn-class="btn-warning btn-lg" />\n        </div>\n      </div>\n\n      <!-- Empty Dashboard -->\n      <div class="ng-hide" ng-show=\'showNoWidgetsMsg()\'>\n        <div class=\'hidden-xs\'>\n          <div class="row top-buffer-4">\n            <div class="col-md-8 col-md-offset-2">\n              <div class="info-text">\n                <p><b translate>{{dhbErrorsConfig.empty.first}}</b></p>\n                <p translate>{{dhbErrorsConfig.empty.second}}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="align-center top-buffer-2">\n          <button ng-if="userAccesses.widgets.create" ng-disabled="showWidgetSelector()" ng-click="displayWidgetSelector()" class=\'btn btn-lg btn-warning\'><span class=\'fa fa-plus\'></span> {{\'impac.dashboard.add_new_widget\' | translate}}</button>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- First Time Dashboard Creation -->\n  <div class="row text-center" ng-show=\'showChooseDhbMsg()\'>\n    <img class="bg" ng-src="{{impacDashboardBackground}}">\n    <div class="spacer2 hidden-xs"></div>\n    <div class=\'col-md-8 col-md-offset-2\'>\n      <p class="text-muted"><small><em translate>{{dhbErrorsConfig.firstTimeCreated.note}}</em></small></p>\n    </div>\n  </div>\n\n  <!-- Widgets -->\n  <div class=\'row\' id="widgets-section" ng-hide="showNoWidgetsMsg() || showChooseDhbMsg()">\n    <!-- Dashboard Settings - CONFIGURED INSIDE WIDGETS-CONTAINER -->\n    <div id="dashboard-settings-panel" ng-if="dhbSettingsConfig.inWidgetsContainer && !showChooseDhbMsg()" class="col-md-12 in-widgets-container">\n      <div>\n        <div dashboard-setting-sync-apps ng-if="dhbSettingsConfig.syncApps.show()"/>\n        <div dashboard-setting-currency ng-if="userAccesses.dashboards.update" currency="currentDhb.currency" />\n      </div>\n    </div>\n    <div class="col-md-12">\n      <div id="widgets-container" ui-sortable="sortableOptions" ng-model="currentDhb.widgets" class="row">\n        <!-- Widgets -->\n        <div impac-widget widget="widget" is-accessibility="accessibility" parent-dashboard="currentDhb" ng-repeat="widget in currentDhb.widgets" class="widget-item" ng-class="widget.getCssClasses()" on-display-alerts="displaySubMenu()" user-accesses="userAccesses" />\n        <!-- Add Widget Tile, enabled & customised in ImpacThemingProvider -->\n        <div ng-if="isAddChartEnabled" class="unsortable" ng-click="addChartTileOnClick()">\n          <div class="col-md-6 widget-item add-chart">\n            <div class="a-content" translate>impac.dashboard.plus_chart</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="analytics" ng-show="(isLoading || forceLoad)">\n  <div class="row">\n    <div class="col-md-12 loader-container text-center" style="margin-top: 200px;">\n      <i class="fa fa-refresh fa-spin" style="font-size: 250px; opacity: 0.7;"/>\n    </div>\n  </div>\n</div>\n\n<div class="analytics load-failed" ng-show="!isLoading && failedDashboardLoad">\n  <div class="row">\n    <div class="col-md-12 text-center" style="margin-top: 200px;">\n      <p translate>{{dhbErrorsConfig.failed.first}}</p>\n      <div class="second-msg" ng-if="displaySecondMsg">\n        <p translate>{{dhbErrorsConfig.failed.second}}</p>\n      </div>\n      <a href="" ng-click="reloadDashboard()">\n        <button type="button" class="btn btn-default" translate>impac.dashboard.refresh</button>\n      </a>\n    </div>\n  </div>\n</div>\n'),e.put("dashboard/widget-suggestion.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="instance.close()" >×</div>\n  <h3 translate>impac.dashboard.widget_suggestion.suggest_a_widget</h3>\n</div>\n\n<div class="modal-body">\n\n  <div class="row">\n    <div class="col-md-6">\n      <label translate>impac.dashboard.widget_suggestion.widget_name</label><br />\n      <input type="text" ng-model="widgetDetails.name" ng-disabled="isLoading" />\n    </div>\n    <div class="col-md-6">\n      <label>In which category?</label><br />\n      <input type="text" ng-model="widgetDetails.category" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" />\n\n  <div class="row">\n    <div class="col-md-12">\n      <label translate>impac.dashboard.widget_suggestion.kind_of_information</label><br/>\n      <textarea ng-model="widgetDetails.description" ng-disabled="isLoading" />\n    </div>\n  </div>\n\n  <div class="spacer1" ng-show="isLoading" />\n\n  <div class="row" uib-collapse="!onSuccess">\n    <div class="col-md-12 text-center">\n      <h3 class="thanks-message">{{userName | titleize}}, <span translate="impac.dashboard.widget_suggestion.helping"></span></h3>\n    </div>\n  </div>\n\n  <div class="row" ng-show="error">\n    <div class="col-md-12 text-center">\n      <h5 style="color: red;" translate>impac.dashboard.widget_suggestion.unable_to_send</h5>\n    </div>\n  </div>\n\n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="instance.dismiss()" ng-hide="isLoading" translate>impac.dashboard.widget_suggestion.cancel</button>\n      <button class="btn btn-info" ng-click="proceed()" ng-disabled="!(widgetDetails.name && widgetDetails.category && widgetDetails.description) || isLoading">\n        <i class="fa fa-spinner fa-pulse loader" ng-show="isLoading"></i>\n        {{\'impac.dashboard.widget_suggestion.send_your_suggestion\' | translate}}\n      </button>\n    </div>\n  </div>\n</div>\n'),e.put("dashboard-create/dashboard-create.modal.html",'<div class="modal-header">\n  <i class="fa fa-times" ng-click="$close()" />\n  <h1 translate translate-values="{ name: label }">\n    impac.dashboard.create.create_new_dashboard\n  </h1>\n</div>\n<div class="modal-body">\n  <div class="row">\n    <div class="col-xs-10 col-xs-offset-1 form-horizontal">\n      <div class="row form-group">\n        <label class="col-sm-2 control-label" translate>impac.dashboard.create.name</label>\n        <div class="col-sm-10">\n          <input type="text" class="form-control" ng-model="dashboard.name" placeholder="{{\'impac.dashboard.create.placeholder.cash_accounts\' | translate}}"></input>\n        </div>\n      </div>\n\n      <div class="row form-group" ng-if="multiMode.enabled">\n        <label class="col-sm-2 control-label" translate>impac.dashboard.create.source</label>\n        <div class="col-sm-10">\n          <div class="btn-group">\n            <label class="btn btn-info" ng-model="source.mode" uib-btn-radio="\'single\'" ng-change="init()" translate>impac.dashboard.create.current_company</label>\n            <label class="btn btn-info" ng-model="source.mode" uib-btn-radio="\'multi\'" translate>impac.dashboard.create.multi_company</label>\n          </div>\n        </div>\n      </div>\n\n      <div class="row" ng-if="source.mode == \'multi\'">\n        <div class="col-sm-10 col-sm-offset-2">\n          <ul class="list-unstyled">\n            <li ng-repeat="org in organizations" >\n              <input type="checkbox" ng-model="org.selected" ng-disabled="!org.acl.related.impac.show" />\n              {{ org.name }}\n              <i class="fa fa-exclamation-circle text-danger" ng-hide="org.acl.related.impac.show" uib-tooltip="{{\'impac.dashboard.create.tooltip.access\' | translate}}" />\n            </li>\n          </ul>\n        </div>\n      </div>\n\n      <dashboard-templates-selector on-select="templates.select($event)" ng-if="templates.enabled"></dashboard-templates-selector>\n    </div>\n  </div>\n</div>\n<div class="modal-footer text-right">\n  <button class="btn btn-default" ng-click="$close()" ng-disabled="loading" translate>impac.dashboard.create.cancel</button>\n  <button class="btn btn-success" ng-click="createDashboard(organizations)" ng-disabled="invalid() || loading">\n    <i class="fa fa-spinner fa-pulse loader" ng-if="loading" />\n    {{ \'impac.dashboard.create.create\' | translate }}\n  </button>\n</div>\n'),e.put("dashboard-create/dashboard-create.tmpl.html",'<div class="dashboard-create">\n  <button class="btn" ng-class="$ctrl.btnClass" ng-click="$ctrl.openModal()">\n    <i class="fa fa-plus" />\n    {{ ($ctrl.labelLocale || \'impac.dashboard_selector.dropdown.create_dashboard\') | translate: { name: $ctrl.label } }}\n  </button>\n</div>\n'),e.put("dashboard-selector/bootstrap-tabs.tmpl.html",'<div class="row buttons-bar-row" ng-class="{\'pdf-mode\': pdfMode}">\n  <div ng-show="pdfMode" class=\'col-md-6 col-md-offset-3 title-container text-center\'>\n    <h1 class="dashboard-title">\n      {{currentDhb.full_name}}\n    </h1>\n    <p class="data-source-label">\n      <small><b translate>impac.dashboard_selector.bootstrap_tabs.source</b> {{organizationsNames()}}</small>\n    </p>\n  </div>\n\n  <div class="buttons-bar col-sm-8" ng-show="isThereADashboard() && !pdfMode">\n    <uib-tabset type="{{selectorType}}">\n      <uib-tab ng-repeat="dhb in dashboardsList" ng-click="selectDashboard(dhb.id)" active="dhb.active">\n        <uib-tab-heading>\n          {{dhb.full_name}}\n          <a href="" class="close-link" ng-if="userAccesses.dashboards.destroy">\n            <i class="fa fa-times" ng-click="deleteDashboardModal.open()"></i>\n          </a>\n        </uib-tab-heading>\n      </uib-tab>\n      <uib-tab ng-if=\'isAccessibilityEnabled\' ng-click="toggleAccessibilityMode()">\n        <uib-tab-heading>\n          <a href=""><i class="fa fa-wheelchair"></i></a>\n        </uib-tab-heading>\n      </uib-tab>\n      <uib-tab ng-if="userAccesses.dashboards.create" ng-click="onCreateDashboard()">\n        <uib-tab-heading>\n          <a href="">+</a>\n        </uib-tab-heading>\n      </uib-tab>\n    </uib-tabset>\n  </div>\n\n  <div class=\'buttons-bar hidden-print\' ng-class="{\'col-md-3\': pdfMode, \'col-sm-4\': !pdfMode}">\n    <div class=\'actions-panel\'>\n      <button ng-if=\'isAccessibilityEnabled && !pdfMode\' ng-click="toggleAccessibilityMode()" class=\'btn btn-info\' ng-disabled="isWidgetSelectorShown()"><span class=\'fa fa-wheelchair\'></span></button>\n      <button ng-if="userAccesses.widgets.create && isThereADashboard() && !pdfMode" ng-click="onDisplayWidgetSelector()" class=\'btn btn-warning\' ng-disabled="isWidgetSelectorShown()"><span class=\'fa fa-plus\'></span> {{\'impac.dashboard_selector.bootstrap_tabs.add_widget\' | translate}}</button>\n\n      <div dashboard-settings-pdf-mode ng-if="isThereADashboard() && !isCurrentDashboardEmpty()" />\n\n    </div>\n  </div>\n</div>\n'),e.put("dashboard-selector/delete.modal.html",'<div class="modal-header">\n  <div class="close" type="button" ng-click="instance.close()" >×</div>\n  <h3 translate translate-values="{ name: dhbLabelName }">impac.dashboard_selector.delete.delete_dashboard</h3>\n</div>\n\n<div class="modal-body">\n  <div class="row">\n    <div class="col-sm-12">\n      <div class="alert alert-error" ng-show="errors">\n        <button class="close" ng-click="errors=\'\'">×</button>\n        <ul>\n          <li ng-repeat="error in errors">{{error}}</li>\n        </ul>\n      </div>\n    </div>\n  </div>\n\n  <p translate translate-values="{ name: dhbLabelName }">impac.dashboard_selector.delete_widget.description</p>\n</div>\n\n<div class="modal-footer">\n  <div class="row">\n    <div class="col-sm-12">\n      <button class="btn btn-shaded" ng-click="instance.dismiss()" ng-hide="isLoading" ng-disabled="isLoading" translate>impac.dashboard_selector.delete.cancel</button>\n      <button class="btn btn-danger" ng-click="proceed()" ng-disabled="isLoading">\n        <i class="fa fa-spinner fa-pulse loader" ng-if="isLoading"></i>\n        {{\'impac.dashboard_selector.delete.delete\' | translate}}\n      </button>\n    </div>\n  </div>\n</div>\n'),e.put("dashboard-selector/dropdown.tmpl.html",'<div class="row buttons-bar-row buttons-bar no-gutters" ng-class="{\'pdf-mode\': pdfMode}">\n\n  <div ng-show="pdfMode" class=\'col-md-6 col-md-offset-3 title-container text-center\'>\n    <h1 class="dashboard-title">\n      {{currentDhb.full_name}}\n    </h1>\n    <p class="data-source-label">\n      <small><b translate>impac.dashboard_selector.dropdown.source</b> {{organizationsNames()}}</small>\n    </p>\n  </div>\n\n  <div class="col-md-6 dropdown-container" ng-hide="isLoading || pdfMode">\n    <div ng-if="isThereADashboard()">\n      <h4 class=\'dashboard-title\'>\n        <div style="display: inline-block;" ng-click="toggleShowDashboardsDropdown()">\n          {{currentDhb.full_name}}\n          <i class="fa fa-chevron-down" ng-if="userAccesses.dashboards.create || dashboardsList.length > 1" style="font-size: 18px;"></i>\n        </div>\n        <i ng-show="userAccesses.dashboards.update && !showChangeDashboardNameBox" class="fa fa-pencil" uib-tooltip="{{\'impac.dashboard_selector.dropdown.tooltip.change_name\' | translate}}" tooltip-animation="false" tooltip-append-to-body="true" ng-click="toggleChangeDashboardNameBox(currentDhb)"></i>\n      </h4>\n\n      <div ng-show="showDashboardsDropdown" class=\'dashboard-select hidden-print\'>\n        <div ng-hide="dhb.id == currentDhb.id" class=\'option\' ng-repeat="dhb in dashboardsList">\n          <span class="name" ng-click="selectDashboard(dhb.id)">{{dhb.full_name}}</span>\n          <i ng-show="userAccesses.dashboards.update && !showChangeDashboardNameBox" class="fa fa-pencil" uib-tooltip="{{\'impac.dashboard_selector.dropdown.tooltip.change_name\' | translate}}" tooltip-animation="false" tooltip-append-to-body="true" ng-click="toggleChangeDashboardNameBox(dhb)"/>\n        </div>\n\n        <div ng-if="userAccesses.dashboards.create" class="option dashboard-create">\n          <impac-dashboard-create on-create-dashboard="createDashboard(dashboard)" btn-class="btn-warning" />\n        </div>\n      </div>\n\n      <div ng-if="showChangeDashboardNameBox" class="change-name">\n        <p translate translate-values="{name: dhbLabelName}">impac.dashboard_selector.dropdown.change_dashboard_name</p>\n        <input type="text" class="form-control" id="changeDhbNameInput" ng-model="dashboardToChange.name" ng-keyup="checkAndUpdateDashboardName($event)"/>\n        <button class="btn btn-sm btn-default" ng-click="hideChangeDashboardNameBox()" translate>impac.dashboard_selector.dropdown.cancel</button>\n        <button class="btn btn-sm btn-success" style="margin-left: 10px" ng-click="updateDashboardName()" translate>impac.dashboard_selector.dropdown.confirm</button>\n      </div>\n\n      <p class="data-source-label">\n        <small><b translate>impac.dashboard_selector.dropdown.source</b> {{organizationsNames()}}</small>\n      </p>\n    </div>\n  </div>\n\n  <div class="col-md-6 loader-container" ng-show="isLoading">\n    <i class="fa fa-spinner fa-pulse fa-4x loading-spinner"/>\n  </div>\n\n  <div class=\'actions-panel hidden-print\' ng-class="{\'col-md-3\': pdfMode, \'col-md-6\': !pdfMode}">\n    <button ng-if=\'isAccessibilityEnabled\' ng-click="toggleAccessibilityMode()" class=\'btn btn-info\' ng-disabled="showWidgetSelector" ng-hide="pdfMode"><span class=\'fa fa-wheelchair\'></span></button>\n\n    <button ng-if="userAccesses.widgets.create && isThereADashboard()" ng-click="onDisplayWidgetSelector()" class=\'btn btn-warning\' ng-disabled="isWidgetSelectorShown()" ng-hide="pdfMode"><span class=\'fa fa-plus\'></span> {{\'impac.dashboard_selector.dropdown.add_widget\' | translate}}</button>\n\n    <impac-dashboard-create ng-if="userAccesses.dashboards.create" on-create-dashboard="createDashboard(dashboard)" btn-class="btn-warning" />\n\n    <div dashboard-settings-pdf-mode ng-if="isThereADashboard() && !isCurrentDashboardEmpty()" />\n\n    <button ng-if="userAccesses.dashboards.destroy && isThereADashboard()" ng-click="deleteDashboardModal.open()" class=\'btn btn-danger hidden-xs\' ng-show="isThereADashboard()" uib-tooltip="{{\'impac.dashboard_selector.dropdown.tooltip.delete\' | translate:{name: dhbLabelName} }}" ng-hide="pdfMode"><span class=\'fa fa-trash-o\'></span> </button>\n  </div>\n\n</div>\n'),e.put("dashboard-templates-selector/dashboard-templates-selector.tmpl.html",'<div ng-hide="$ctrl.hasTemplates() || $ctrl.hideLoader" class="loader" align="center">\n  <div>\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n  </div>\n</div>\n\n<div ng-if="$ctrl.hasTemplates()">\n  <div class="templates-header">\n    <label class="control-label" translate>impac.dashboard.create.templates.create_from</label>\n    <div class="templates-toggle">\n      <i ng-class="{\'fa-toggle-off\': !$ctrl.isTemplatesMode, \'fa-toggle-on\': $ctrl.isTemplatesMode}" class="fa control-label" ng-click="$ctrl.toggleTemplatesMode()"></i>\n    </div>\n  </div>\n  <div class="templates" ng-if="$ctrl.isTemplatesMode">\n    <ul class="list-unstyled">\n      <li class="template" ng-repeat="template in $ctrl.templates track by $index" ng-click="$ctrl.templateOnClick(template)" ng-class="{ \'selected\': $ctrl.isSelected(template) }">\n        <span ng-bind="template.name"></span>\n      </li>\n    </ul>\n  </div>\n</div>\n'),e.put("kpi/kpi.tmpl.html",'<div class="kpi" ng-class="{ \'static\': kpi.static, \'triggered\': (kpi.layout.triggered && !isEditing() && !isLoading()), \'editing\': isEditing() }">\n  <div class="content-container" ng-hide="isLoading()">\n    <div class="top-line" ng-class="{ \'triggered\': kpi.layout.triggered }"></div>\n    <div class="kpi-content" ng-show="showKpiContent()" ng-class="{ \'editing\': isEditing() }">\n      <!-- SHOW -->\n      <div class="kpi-show row nomargin nopadding" ng-hide="isEditing()">\n        <div class="col-xs-3 col-sm-3 kpi-icon" ng-class="{ \'triggered\': kpi.layout.triggered }">\n          <i class="fa {{kpi.layout.icon.value}} fa-2x"></i>\n        </div>\n        <div class="col-xs-9 col-sm-9 kpi-text" ng-class="{ \'triggered\': kpi.layout.triggered }">\n          <span class="caption" uib-tooltip="{{kpi.layout.text.caption}}" tooltip-append-to-body="false">{{kpi.layout.text.caption}}</span>\n          <span class="emphasis" uib-tooltip="{{kpi.layout.text.emphasis}} - ({{ getRealValue() }})" tooltip-placement="bottom" tooltip-append-to-body="false">\n            <strong>{{kpi.layout.text.emphasis}}</strong> - <span class="real-value">({{ getRealValue() }})</span>\n          </span>\n        </div>\n      </div>\n      <!-- EDIT -->\n      <div class="kpi-edit" ng-show="isEditing()">\n        <div class="kpi-name">\n          <h6>{{kpi.name.toUpperCase()}}</h6>\n        </div>\n\n        <div class=\'alert-caption\'>\n          <span>{{kpi.layout.text.alert}}</span>\n        </div>\n\n        <form name="kpi{{kpi.id}}SettingsForm">\n          <!-- watchables -->\n          <div ng-repeat="watchable in kpi.watchables track by $index">\n            <div class="real-value" ng-show="kpi.data">{{\'impac.kpi.current\' | translate}} {{watchable}}: {{ getRealValue() }}</div>\n            <!-- targets -->\n            <div class="im-form-group" ng-class="getFormTargetValueInput(watchable, $index).$valid ? \'has-success\' : \'has-error\'" ng-repeat="target in targets[watchable] track by $index">\n              <!-- target -->\n              <input name="{{watchable}}TargetValue{{$index}}" type="text" pattern="^-?\\d+(\\.\\d+)?$" ng-model="target[getTargetPlaceholder(watchable).mode]" placeholder="{{bindTargetInputPlaceholder(watchable, $index)}}" ng-focus="setTargetInputPlaceholder(watchable, $index)" ng-blur="resetTargetInputPlaceholder(watchable, $index)" autofocus ng-keypress="onKeyPress($event)" required>\n              <label for="targetValue" class="im-control-label">{{watchable | titleize}}</label><i class="im-bar"></i>\n              <span class="kpi-target-unit" aria-hidden="true">{{getTargetUnit(watchable)}}</span>\n              <!-- target error messages -->\n              <div ng-messages="getFormTargetValueInput(watchable, $index).$error" class="im-messages">\n                <span ng-message="required" translate>impac.kpi.kpi_target_require</span>\n                <span ng-message="pattern" translate>impac.kpi.kpi_target_number</span>\n              </div>\n            </div>\n          </div>\n\n          <div class="im-form-group">\n            <div ng-repeat="(param, paramValues) in kpi.possibleExtraParams track by $index">\n              <!-- extra param selection -->\n              <select name="extraParam" ng-model="kpi.extra_params[param]" ng-change="updateExtraParam()" ng-options="value.id as value.label for value in paramValues">\n              </select>\n              <label for="extraParam" class="im-control-label">{{\'impac.kpi.extra_param_label.verb\' | translate}} {{param | titleize}}</label>\n              <i class="im-bar"></i>\n            </div>\n          </div>\n        </form>\n\n        <!-- Alerts Config -->\n        <alerts-config kpi="kpi" button-html="\n          <button class=\'kpi-alerts im-fab im-primary\'>\n            <i class=\'fa fa-bell\'></i>\n          </button>">\n        </alerts-config>\n\n        <!-- Remove KPI -->\n        <button type="button" ng-if="userAccesses.kpis.destroy" class="kpi-remove im-fab im-warn" ng-click="deleteKpi()">\n          <i class="fa fa-times" aria-hidden="true"></i>\n        </button>\n\n      </div>\n    </div>\n    <!-- Data not found display -->\n    <div class="kpi-no-data" ng-if="isDataNotFound()">\n      <!-- Remove KPI -->\n      <button type="button" ng-show="isEditing() && userAccesses.kpis.destroy" class="kpi-remove im-fab im-warn" ng-click="deleteKpi()">\n        <i class="fa fa-times" aria-hidden="true"></i>\n      </button>\n      <div common-data-not-found no-image="true" endpoint="::kpi.endpoint"/>\n    </div>\n  </div>\n  <div class="col-xs-2 kpi-data-loader loader" ng-if="isLoading()">\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n  </div>\n</div>\n'),e.put("kpis-bar/kpis-bar.tmpl.html",'<div class="kpis" ng-class="{\'empty\': (kpis.length == 0), \'hidden-print\': (kpis.length == 0)}">\n\n  <div class="actions">\n    <button type="button" class="toggle-show-content im-fab im-primary" ng-click="toggleShowContent()">\n      <a href="">\n        <i class="fa" ng-class="showContent ? \'fa-chevron-up\' : \'fa-chevron-down\'" />\n      </a>\n    </button>\n    <div class="content-buttons">\n      <button type="button" ng-if="userAccesses.kpis.create || !availableKpis.kpiSelectorHidden" class="add-kpis im-fab im-primary" ng-click="availableKpis.toggle()" ng-class="{ disabled: !hasKpiAvailability() }">\n        <a href="">\n          <i class="fa" ng-class="{\'fa-plus\': availableKpis.kpiSelectorHidden, \'fa-minus\': !availableKpis.kpiSelectorHidden}" />\n        </a>\n      </button>\n      <button type="button" ng-if="kpis.length > 0 && userAccesses.kpis.update" class="edit-kpis im-fab im-primary" ng-class="{ \'disabled\': toggleEditModeLock, \'editing\':isEditing() }" ng-click="toggleEditMode()">\n        <a href="">\n          <i class="fa" ng-class="{ \'fa-cog\': !isEditing(), \'fa-floppy-o\': isEditing() }" />\n        </a>\n      </button>\n    </div>\n  </div>\n\n  <div class="content">\n    <div class="row title" ng-if="kpis.length == 0 && availableKpis.kpiSelectorHidden">\n      <div class="col-xs-12 text-center">\n        <a href="" class="show-dashboard" ng-click="availableKpis.toggle()" ng-show="hasKpiAvailability() && userAccesses.kpis.create" translate translate-values="{name: dhbLabelName}">impac.kpi_bar.you_can_attach</a>\n        <span class="no-kpi-templates" ng-if="!hasKpiAvailability() || !userAccesses.kpis.create" translate translate-values="{name: dhbLabelName}">impac.kpi_bar.no_kpis</span>\n      </div>\n    </div>\n\n    <div class="row add-bar" uib-collapse="availableKpis.kpiSelectorHidden">\n      <div class="col-xs-12 col-sm-12">\n        <div class="row">\n          <div ng-repeat="kpi in availableKpis.list track by $index" class="impac-kpi col-xs-6 col-sm-4 col-md-3" ng-click="addKpi(kpi)">\n            <div class="kpi add" ng-hide="(availableKpis.list.length == 0)">\n              <div class="top-line ui-sortable-handle"></div>\n              <div class="kpi-content">\n                <div class="kpi-show row nomargin nopadding">\n                  <div class="col-xs-3 col-sm-3 kpi-icon">\n                    <i class="fa fa-2x fa-plus"></i>\n                  </div>\n                  <div class="col-xs-9 col-sm-9 kpi-text">\n                    <span class="caption"><strong>{{kpi.name}}</strong></span>\n                    <span class="emphasis" translate translate-values="{name: dhbLabelName}">impac.kpi_bar.add_to_dashboard</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="row">\n      <div class="col-xs-12 col-sm-12">\n        <div class="row">\n          <div ui-sortable="sortableOptions" ng-model="kpis">\n            <div ng-repeat="kpi in kpis" impac-kpi class="impac-kpi col-xs-6 col-sm-4 col-md-3" kpi="kpi" on-delete="removeKpi(kpi.id)" edit-mode="showEditMode" available-kpis="availableKpis.list" load-ready="kpiDatesDeferred" user-accesses="userAccesses">\n            </div>\n          </div>\n          <div ng-show="isAddingKpi" class="col-xs-6 col-sm-4 col-md-3 kpi-loader">\n            <i class="fa fa-2x fa-spin fa-refresh"></i>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="row" ng-show="showDatesPicker()">\n      <div class="dates-picker-container">\n        <div setting-dates-picker from="kpisDateRange.from" to="kpisDateRange.to" keep-today="kpisDateRange.keepToday" on-change="kpisBarUpdateDates" deferred="datesPickerDeferred"/>\n      </div>\n    </div>\n</div>\n\n</div>\n'),e.put("widget/widget.tmpl.html",'<div class="top-line">\n  <div common-editable-title parent-widget="widget" class="editable-title" on-toggle="toggleEditTitle()" disabled="!userAccesses.widgets.update" />\n  <div common-top-buttons parent-widget="widget" on-refresh="showWidget" ng-hide="isInfoPanelDisplayed() || isTitleEdited() || pdfMode" on-toggle-info-panel="toggleInfoPanel()" on-toggle-delete-widget="toggleDeleteWidget()" user-accesses="userAccesses"/>\n</div>\n\n<div ng-if="pdfMode && !widget.ticked" class="include-to-pdf title hidden-print">\n  <h6 translate>impac.widget.include_pdf</h6>\n</div>\n\n<div class="content" ng-class="::cssClass">\n  <div ng-show="widget.isLoading" class="loader" align="center">\n    <div>\n      <i class="fa fa-spinner fa-pulse fa-3x"></i>\n      <p translate="impac.widget.loader"></p>\n    </div>\n  </div>\n\n  <div ng-if="pdfMode" class="include-to-pdf tick hidden-print">\n    <a class="widget-hover" ng-click="tick()">\n      <i class="fa fa-check-circle fa-5x" aria-hidden="true" ng-show="widget.ticked"></i>\n    </a>\n  </div>\n\n  <div ng-hide="widget.isLoading" class="content-template-wrapper" ng-include="::templatePath" />\n  \n  <common-delete-widget ng-if="showDeleteWidget" on-dismiss="toggleDeleteWidget()" on-delete="deleteWidget()" />\n</div>\n\n<div common-info-panel parent-widget="widget" on-close="toggleInfoPanel()" ng-show="isInfoPanelDisplayed()" />\n'),e.put("common/data-not-found.tmpl.html",'<div class="data-not-found" ng-if="!designerMode">\n  <div class="overlay" ng-show="messageVisible" />\n  <div class="message" ng-show="messageVisible" >\n    <div class="title" translate>{{ needsCustomMessage ? content.liveBTitle : content.title }}</div>\n    <p translate>{{ needsCustomMessage ? content.liveBMessage : content.title }}</p>\n    <button class="btn btn-xs btn-default" ng-click="goToMarketplace()" translate>{{ content.linkMessage }}</button>\n    <button class="btn btn-xs btn-warning" ng-click="hide()" translate>{{ content.seeExample }}</button>\n  </div>\n  <div class="example" ng-hide="messageVisible">\n    {{ content.demoData | translate }} -\n    <a ng-click="goToMarketplace()" translate>{{ content.linkMessage }}</a>\n  </div>\n</div>\n'),e.put("common/delete-widget.tmpl.html",'<div class="delete-widget">\n  <div class="overlay" />\n  <div class="message">\n    <div class="title" translate>impac.widget.common.top_buttons.delete.title</div>\n    <p translate>impac.widget.common.top_buttons.delete.message</p>\n    <p translate>impac.widget.common.top_buttons.delete.explanation</p>\n    <div ng-hide="$ctrl.loading">\n      <button ng-click="$ctrl.onDismiss()" class="btn btn-xs btn-default" translate>impac.widget.common.top_buttons.delete.cancel</button>\n      <button ng-click="$ctrl.deleteWidget()" class="btn btn-xs btn-danger" translate>impac.widget.common.top_buttons.delete.delete</button>\n    </div>\n    <div ng-show="$ctrl.loading" class="loader" align="center">\n      <div>\n        <i class="fa fa-spinner fa-pulse fa-4x"></i>\n      </div>\n    </div>\n  </div>\n</div>\n'),e.put("common/transactions-add.tmpl.html",'<div id="transactions-add">\n  <div class="overlay" />\n  <div class="message" >\n    <div class="title">Create a manual transaction</div>\n    \n    <div class="form text-left">\n      <label>Description:</label>\n      <input type="text" class="form-control" ng-model="$ctrl.trx.name" placeholder="Transaction description" />\n\n      <label>Amount:</label>\n      <input type="text" class="form-control" ng-model="$ctrl.trx.amount" placeholder="1500.00" />\n\n      <label>Expected payment date:</label>\n      <input type="text" class="btn btn-default form-control" uib-datepicker-popup="dd MMM yyyy" ng-model="$ctrl.trx.datePicker.date" ng-click="$ctrl.trx.datePicker.toggle()" is-open="$ctrl.trx.datePicker.opened" close-text="Close" on-open-focus="false" />\n\n      <label>Customer</label>\n      <div class=\'btn-group\'>\n        <select ng-model="$ctrl.trx.contact" ng-options="contact.attributes.name for contact in $ctrl.contacts | orderBy: \'attributes.name\' track by contact.id" class=\'form-control\'>\n          <option value=\'\'> Choose Customer</option>\n        </select>\n      </div>\n\n      <label>Type:</label>\n      <div class="btn-group">\n        <label class="btn btn-sm btn-default" ng-model="$ctrl.resourcesType" uib-btn-radio="\'invoices\'">Money in</label>\n        <label class="btn btn-sm btn-default" ng-model="$ctrl.resourcesType" uib-btn-radio="\'bills\'">Money out</label>\n      </div>\n\n      <div class="coming-soon">\n        <div class="badge pull-right">Coming soon!</div>\n        \n        <label style="padding-top: 0px;">Repeat every:</label>\n        <div class="btn-group">\n          <select disabled="true">\n            <option>3</option>\n          </select>\n          <select disabled="true">\n            <option>Weeks</option>\n          </select>\n        </div>\n\n        <label>Ends:</label>\n        <div class="btn-group">\n          <input type="radio" disabled="true" checked="true" style="margin-top: 0px;"> Never<br />\n          <input type="radio" disabled="true"> After <select disabled="true"><option>10</option></select> occurences<br />\n          <input type="radio" disabled="true"> On <input type="text" class="btn btn-xs btn-default" uib-datepicker-popup="dd MMM yyyy" ng-model="$ctrl.tempDate" disabled="true" />\n        </div>\n      </div>\n    </div>\n\n    <div class="bottom text-center">\n      <button class="btn btn-sm btn-default" ng-click="$ctrl.onHide()">Cancel</button>\n      <button class="btn btn-sm btn-success" ng-click="$ctrl.createTransaction()" ng-disabled="!$ctrl.isValid()">Save</button>\n    </div>\n  </div>\n</div>\n'),e.put("common/transactions-list.tmpl.html",'<div id="transactions-list">\n  <div class="top">\n    <div class="back">\n      <label class="btn btn-sm btn-default" ng-click="$ctrl.onHide()" ng-hide="$ctrl.listOnly">\n        <i class="fa fa-chevron-left" />\n        Back to chart\n      </label>\n    </div>\n    <div class="resource-type">\n      <div class="btn-group">\n        <label class="btn btn-sm btn-default" ng-model="$ctrl.resourcesType" ng-click="$ctrl.changeResourcesType()" uib-btn-radio="\'invoices\'">See money in</label>\n        <label class="btn btn-sm btn-default" ng-model="$ctrl.resourcesType" ng-click="$ctrl.changeResourcesType()" uib-btn-radio="\'bills\'">See money out</label>\n      </div>\n    </div>\n  </div>\n  <div class="table-container">\n    <table class="table table-striped">\n      <tr>\n        <th>{{ $ctrl.currentAttributes.resourcesType == \'invoices\' ? \'Customer\' : \'Supplier\' }}</th>\n        <th>Code</th>\n        <th ng-hide="$ctrl.currentAttributes.resourcesType == \'bills\'">Title</th>\n        <th>Status</th>\n        <th>Transaction date</th>\n        <th>Due date</th>\n        <th ng-hide="$ctrl.listOnly">Expected payment date</th>\n        <th class="text-right">Amount</th>\n        <th class="text-right">Balance</th>\n        <th />\n      </tr>\n      <tr ng-repeat="trx in $ctrl.currentAttributes.transactions">\n        <td>{{ trx.contact_name }}</td>\n        <td>{{ trx.transaction_number }}</td>\n        <td ng-hide="$ctrl.currentAttributes.resourcesType == \'bills\'">{{ trx.title }}</td>\n        <td>{{ trx.status }}</td>\n        <td>{{ trx.trxDateUTC }}</td>\n        <td>{{ trx.dueDateUTC }}</td>\n        <td ng-hide="$ctrl.listOnly">\n          <div class="expected-payment-date">\n            <input type="text" class="btn btn-xs btn-default" uib-datepicker-popup="dd MMM yyyy" ng-model="trx.datePicker.date" ng-click="trx.datePicker.toggle()" is-open="trx.datePicker.opened" close-text="Close" on-open-focus="false" ng-change="$ctrl.changeExpectedDate(trx)"/>\n            <button class="btn btn-xs btn-danger reset-date" ng-if="trx.showReset" title="Reset expected payment date to due date" ng-click="$ctrl.resetExpectedDate(trx)">\n              <i class="fa fa-clock-o" />\n            </button>\n          </div>\n        </td>\n        <td class="text-right">{{ trx.amount | mnoCurrency : trx.currency }}</td>\n        <td class="text-right">{{ trx.balance | mnoCurrency : trx.currency }}</td>\n        <td>\n          <i class="fa fa-times" title="Delete forecast transaction" ng-if="trx.status == \'FORECAST\'" ng-click="$ctrl.onDeleteTransaction({ resourcesType: $ctrl.resourcesType, trxId: trx.id })" />\n        </td>\n      </tr>\n      <tr class="total" ng-class="$ctrl.currentAttributes.resourcesType">\n        <td colspan="5">TOTAL</td>\n        <!-- If Date Picker is open the colspan width will be 6.  If \'list-only\' the width will be 5 -->\n        <td ng-hide="$ctrl.listOnly" colspan="1"></td>\n        <!-- There are no titles for Bills. -->\n        <td ng-hide="$ctrl.currentAttributes.resourcesType == \'bills\'"></td>\n        <td class="text-right">{{ $ctrl.totalAmount | mnoCurrency : $ctrl.currentAttributes.currency }}</td>\n        <td class="text-right">{{ $ctrl.totalBalance | mnoCurrency : $ctrl.currentAttributes.currency }}</td>\n        <td />\n      </tr>\n    </table>\n  </div>\n  <div class="bottom">\n    <div>\n      <ul uib-pagination total-items="$ctrl.totalRecords" ng-model="$ctrl.currentPage" max-size="5" items-per-page="30" class="pagination-sm" force-ellipses="true" ng-change="$ctrl.changePage()"/>\n    </div>\n  </div>\n</div>\n'),e.put("common/trends-add.tmpl.html",'<div id="trends-add">\n  <div class="overlay" />\n  <div class="message" >\n    <div class="title">Add data from historical trend</div>\n\n    <div class="form text-left">\n      <label>Adjustment rate:</label><br>\n      <input style="width: 45px;" type="number" value="0" min="0" step="1" ng-model="$ctrl.trend.rate"/>%<br>\n\n      <label>Start date:</label><br>\n      <input type="text" class="btn btn-default form-control" uib-datepicker-popup="dd MMM yyyy" ng-model="$ctrl.startDatePicker.date" ng-click="$ctrl.startDatePicker.toggle()" is-open="$ctrl.startDatePicker.opened" close-text="Close" on-open-focus="false" style="width: 70%" ng-change="$ctrl.updateStartDate()"/>\n\n      <label>Trend applied:</label><br>\n      <select ng-model="$ctrl.trend.period">\n        <option>Once</option>\n        <option>Daily</option>\n        <option>Weekly</option>\n        <option>Monthly</option>\n        <option>Yearly</option>\n      </select>\n\n      <fieldset class="btn-group" ng-disbaled="$ctrl.isPeriodDisabled()">\n        <input type="radio" ng-model="$ctrl.trend.untilDate" name="until" checked="true" ng-value="-1"> Forever<br>\n        <input type="radio" ng-model="$ctrl.trend.untilDate" name="until" ng-value="$ctrl.selectedPeriod"> For <input style="width: 45px;" type="number" value="0" min="1" step="1" ng-model=$ctrl.selectedPeriod ng-change="$ctrl.trend.untilDate = $ctrl.selectedPeriod"> {{$ctrl.period()}}<br>\n        <input type="radio" ng-model="$ctrl.trend.untilDate" name="until" ng-value="$ctrl.untilDatePicker.date"> Until <input type="text" class="btn btn-default form-control" uib-datepicker-popup="dd MMM yyyy" ng-model="$ctrl.untilDatePicker.date" ng-click="$ctrl.untilDatePicker.toggle()" is-open="$ctrl.untilDatePicker.opened" close-text="Close" on-open-focus="false" style="width: 70%" ng-change="$ctrl.updateUntilDate()"/>\n      </fieldset>\n\n      <label>Name: </label><br>\n      <input type="text" class="form-control" ng-model="$ctrl.trend.name" placeholder="Trend name" />\n    </div>\n\n    <div class="bottom text-center">\n      <button class="btn btn-sm btn-default" ng-click="$ctrl.onHide()">Cancel</button>\n      <button class="btn btn-sm btn-success" ng-click="$ctrl.createTrend()" ng-disabled="!$ctrl.isValid()">Save</button>\n    </div>\n  </div>\n</div>\n'),e.put("common/trends-list.tmpl.html",'<div id="trends-list">\n  <div class="row top">\n    <div class="col-xs-6 pull-left">\n      <label class="btn btn-sm btn-default" ng-click="$ctrl.onHide()" ng-hide="$ctrl.listOnly">\n        <i class="fa fa-chevron-left" />\n        Back to chart\n      </label>\n    </div>\n    <div class="col-xs-6">\n      <ul uib-pagination class="pull-right" total-items="$ctrl.totalRecords" ng-model="$ctrl.currentPage" max-size="5" items-per-page="30" class="pagination-sm" force-ellipses="true" ng-change="$ctrl.onPageChanged({page: $ctrl.currentPage})" />\n    </div>\n  </div>\n  <div class="table-container">\n    <table class="table table-striped">\n      <tr>\n        <th>Name</th>\n        <th>Rate</th>\n        <th>Periodicity</th>\n        <th>Start Date</th>\n        <th>Last apply date</th>\n        <th/>\n        <th/>\n      </tr>\n      <tr ng-repeat="trend in $ctrl.trends">\n        <td ng-if="!$ctrl.editMode">{{trend.name}}</td>\n        <td ng-if="$ctrl.editMode">\n          <input type="text" class="form-control" ng-model="trend.name"/>\n        </td>\n        <td ng-if="!$ctrl.editMode">{{trend.rate}}%</td>\n        <td ng-if="$ctrl.editMode">\n          <input style="width: 45px;" type="number" value="0" min="0" step="1" ng-model="trend.rate"/>%\n        </td>\n        <td ng-if="!$ctrl.editMode">{{trend.period}}</td>\n        <td ng-if="$ctrl.editMode">\n          <select ng-model="trend.period">\n            <option>once</option>\n            <option>daily</option>\n            <option>weekly</option>\n            <option>monthly</option>\n            <option>yearly</option>\n          </select>\n        </td>\n        <td>\n          <input type="text" class="btn btn-xs btn-default" uib-datepicker-popup="dd MMM yyyy" ng-model="trend.startDatePicker.date" ng-click="trend.startDatePicker.toggle()" is-open="trend.startDatePicker.opened" close-text="Close" on-open-focus="false" />\n        </td>\n        <td>\n          <input type="text" class="btn btn-xs btn-default" uib-datepicker-popup="dd MMM yyyy" ng-model="trend.untilDatePicker.date" ng-click="trend.untilDatePicker.toggle()" is-open="trend.untilDatePicker.opened" close-text="Close" on-open-focus="false" />\n        </td>\n        <td>\n          <a ng-if="$ctrl.editMode">\n            <i class="fa fa-check" title="Validate" ng-click="$ctrl.updateTrend(trend)"/>\n          </a>\n          <a ng-if="!$ctrl.editMode">\n            <i class="fa fa-pencil" title="Edit trend" ng-click="$ctrl.editMode = true" />\n          </a>\n        </td>\n        <td>\n          <a ng-if="$ctrl.editMode">\n            <i class="fa fa-eraser" title="Cancel" ng-click="$ctrl.cancelEdit(trend.id)"/>\n          </a>\n          <a ng-if="!$ctrl.editMode">\n            <i class="fa fa-times" title="Delete trend" ng-click="$ctrl.onDeleteTrend({ trendId: trend.id })"/>\n          </a>\n        </td>\n      </tr>\n    </table>\n  </div>\n</div>\n'),e.put("dashboard-settings/currency.tmpl.html",'<div class="dashboard-settings currency">\n  <select ng-options="cur for cur in currencies" ng-model="data.currency" ng-change="massAssignCurrency()" ng-disabled="locked">\n    <option ng-if="!data.currency" value="" disabled translate>impac.components.currency.choose_currency</option>\n  </select>\n</div>\n'),e.put("dashboard-settings/pdf-mode.tmpl.html",'<div class="dashboard-settings pdf-mode" ng-if="enabled">\n  <div ng-hide="pdfMode">\n    <button ng-click="toggle()" class=\'btn btn-info\' uib-tooltip="Print Dashboard">\n      <span class=\'fa fa-print\' />\n    </button>\n  </div>\n\n  <div ng-show="pdfMode">\n    <button ng-click="print()" class=\'btn btn-info\' ng-disabled="allNotTicked">\n      <span class=\'fa fa-print\' /> {{\'impac.components.pdf_mode.print\' | translate}}\n    </button>\n    <button ng-click="toggle()" class=\'btn btn-default\' translate>impac.components.pdf_mode.cancel</button>\n  </div>\n</div>\n'),e.put("dashboard-settings/sync-apps.tmpl.html",'<!-- Will be displayed only if specified in configuration and if the organizations has apps -->\n<div class="dashboard-settings sync-apps" ng-show="hasApps">\n  <span class="show-status" uib-popover-template="\'connectors.tmpl.html\'" popover-trigger="\'mouseenter\'" popover-placement="bottom" ng-click="triggerSyncAlertsModal()">\n    <i class="fa fa-info" ng-click="triggerSyncAlertsModal()" />\n    <span class="ng-hide" ng-show="isSyncing" translate>impac.components.sync_apps.syncing</span>\n    <span ng-hide="isSyncing" translate>impac.components.sync_apps.show_sync_status</span>\n  </span>\n\n  <div class="status-btn" ng-click="triggerSyncAlertsModal()" ng-show="(hasError && !isSyncing)">\n    <i class="fa fa-exclamation-triangle"></i>\n  </div>\n\n  <div class="status-btn" ng-click="triggerSyncAlertsModal()" ng-show="!hasError && !isSyncing">\n    <i class="fa fa-check"></i>\n  </div>\n\n  <button id="sync" class="btn btn-primary" ng-click="synchronize()" uib-tooltip="{{\'impac.components.sync_apps.tooltip.sync_data\' | translate}}" ng-disabled="isSyncing" ng-show="hasConnectors">\n    <i class="fa fa-refresh" ng-class="{ \'fa-spin\': isSyncing }" />\n  </button>\n\n</div>\n\n<!-- ui.bootstrap popover template -->\n<script type="text/ng-template" id="connectors.tmpl.html">\n  <div ng-if="hasApps" class="connector" ng-repeat="connector in connectors track by $index" ng-class="{ \'{{connector.status.toLowerCase()}}\': true, \'add-seperator\': !$last }">\n    <div class="badge">{{connector.status}}</div>\n    <strong>{{connector.name}}</strong> -\n    <span ng-switch="connector.status">\n      <span ng-switch-when="SUCCESS">{{\'impac.components.sync_apps.status.synced_at\' | translate}} {{connector.formatted_date}}.</span>\n      <span ng-switch-when="PENDING" translate>impac.components.sync_apps.status.sync_will_run</span>\n      <span ng-switch-when="RUNNING" translate>impac.components.sync_apps.status.syncing_in_progres</span>\n      <span ng-switch-when="ERROR" translate>impac.components.sync_apps.status.sync_failed</span>\n      <span ng-switch-when="DISCONNECTED" translate>impac.components.sync_apps.status.please_link</span>\n      <span ng-switch-when="UNKNOWN" translate>impac.components.sync_apps.status.could_not_retrieve</span>\n    </span>\n    <!-- <span ng-if="connector.formatted_date"> - Synced at {{connector.formatted_date}}</span> -->\n  </div>\n  <div class="popover-footer" ng-class="{ \'remove-seperator\': !hasConnectors }" ng-show="hasRunningCube">\n    <p>{{\'impac.components.sync_apps.all\' | translate}} {{hasConnectors ? \'other\' : \'\'}} {{\'impac.components.sync_apps.applications_are_synced\' | translate}}</p>\n  </div>\n</script>\n\n<!-- ui.bootstrap modal template -->\n<script type="text/ng-template" id="alerts.tmpl.html">\n  <div id="sync-apps-modal">\n    <div class="modal-header">\n      <h4 class="modal-title" translate>impac.components.sync_apps.synchronization_status</h4>\n    </div>\n    <div class="modal-list">\n      <div class="modal-list-item" ng-class="{\'{{connector.status.toLowerCase()}}\': true, \'with-message\': connector.message}" ng-repeat="connector in connectors track by $index" ng-click="expandListItemOnClick(connector)">\n        <div class="badge">{{connector.status}}</div>\n        <div class="text-left">\n          <strong>{{connector.name}}</strong> -\n          <span ng-switch="connector.status">\n            <span ng-switch-when="SUCCESS">{{\'impac.components.sync_apps.status.synced_at\' | translate}} {{connector.formatted_date}}.</span>\n            <span ng-switch-when="PENDING" translate>impac.components.sync_apps.status.sync_will_run</span>\n            <span ng-switch-when="RUNNING" translate>impac.components.sync_apps.status.syncing_in_progres</span>\n            <span ng-switch-when="ERROR" translate>impac.components.sync_apps.status.sync_failed</span>\n            <span ng-switch-when="DISCONNECTED" translate>impac.components.sync_apps.status.please_link</span>\n            <span ng-switch-when="UNKNOWN" translate>impac.components.sync_apps.status.could_not_retrieve</span>\n          </span>\n        </div>\n        <div class="message ng-hide" ng-show="connector.showMessage">\n          <p>{{connector.message}}</p>\n        </div>\n      </div>\n    </div>\n    <div class="modal-footer">\n      <button class="btn btn-primary" type="button" ng-click="ok()" translate>impac.components.sync_apps.ok</button>\n    </div>\n  </div>\n</script>\n'),e.put("widgets-common/chart-threshold.tmpl.html",'<div class="attach-panel" ng-if="$ctrl.showPanel">\n  <div class="attach-panel-text">\n    <span class="panel-text-label">{{$ctrl.kpiCreateLabel}}: </span>\n    <input type="text" class="panel-text-input" ng-model="$ctrl.draftTarget.value">\n    <span class="panel-text-currency" ng-bind="$ctrl.widget.metadata.currency"></span>\n  </div>\n  <div class="action-buttons">\n    <button class="btn btn-default" ng-click="$ctrl.cancelCreateKpi()" ng-disabled="$ctrl.loading">Cancel</button>\n    <button class="btn btn-primary" ng-class="{\'loading\': $ctrl.loading}" ng-click="$ctrl.saveKpi()">\n      <i ng-show="$ctrl.loading" class="fa fa-spinner fa-spin" aria-hidden="true"></i>\n      <span ng-hide="$ctrl.loading">{{$ctrl.isEditingKpi ? \'Update\' : \'Save\'}}</span>\n    </button>\n    <button ng-if="$ctrl.isEditingKpi" class="btn btn-danger" ng-class="{\'loading\': $ctrl.loading}" ng-click="$ctrl.deleteKpi()">\n      <i ng-show="$ctrl.loading" class="fa fa-spinner fa-spin" aria-hidden="true"></i>\n      <span ng-hide="$ctrl.loading">Delete</span>\n    </button>\n  </div>\n</div>\n'),e.put("widgets-common/editable-title.tmpl.html",'<div ng-hide="disabled" class="hidden-xs hidden-sm title" editable-text="parentWidget.name" onaftersave="updateName()" onshow="onToggle()" onhide="onToggle()" uib-tooltip="{{ getTooltip() }}" tooltip-placement="top-left">\n  {{ parentWidget.name }}\n</div>\n\n<div ng-show="disabled" class="hidden-xs hidden-sm title" uib-tooltip="{{ getTooltip() }}" tooltip-placement="top-left">\n  {{ parentWidget.name }}\n</div>\n\n<!-- Can\'t edit widget title on mobile -->\n<div class="visible-xs visible-sm title">\n  {{ parentWidget.name }}\n</div>\n'),e.put("widgets-common/currency-conversions.tmpl.html",'<span class="currency-conversions" ng-if="fxAmounts">\n  <img ng-src="{{currencyConversionsIcon}}" uib-popover-template="\'details-popover.tmpl.html\'" popover-class="currency-conversions" popover-title="{{popoverTitle}}" popover-trigger="\'mouseenter\'" popover-append-to-body="true" />\n</span>\n\n<!-- ui.bootstrap popover template -->\n<script type="text/ng-template" id="details-popover.tmpl.html">\n  <p ng-if="fxAmounts.length > 1">This value includes amounts that have been converted to {{ baseCurrency }} from different currencies:</p>\n  <p ng-if="fxAmounts.length == 1">This value includes one amount that has been converted to {{ baseCurrency }} from a different currency:</p>\n  \n  <table class="table">\n    <tr>\n      <th>Original amount</th>\n      <th>Rate</th>\n    </tr>\n    <tr ng-repeat="fx in fxAmounts">\n      <td>{{ fx.amount | mnoCurrency : fx.currency }}</td>\n      <td>{{ fx.rate }}</td>\n    </tr>\n  </table>\n\n  <p ng-if="fxAmounts.length > 1">The rates used correspond to those for {{ formattedRatesDate }}.</p>\n  <p ng-if="fxAmounts.length == 1">The rate used corresponds to the rate for {{ formattedRatesDate }}.</p>\n</script>\n'),e.put("widgets-common/info-panel.tmpl.html",'<div class="info-panel">\n\n  <div class="i-header text-center">\n    <i class="fa fa-info-circle" />\n    <i class="fa fa-times-circle" ng-click="toggleInfoPanel()" />\n    {{\'impac.widget.info_panel.information\' | translate}} <b>{{ getWidgetTemplateName() | titleize }}</b>\n  </div>\n\n  <div class="i-content text-left">\n    <div class="row text-left" ng-repeat="i in parentWidget.content.info">\n\n      <div class="col-md-3 key">\n        {{i.key}}\n      </div>\n\n      <div class="col-md-9 value">\n        {{i.value}}\n      </div>\n\n    </div>\n  </div>\n\n</div>\n'),e.put("widgets-common/time-period-info.tmpl.html",'<div class="time-period-info text-center" ng-if="context">\n  {{date}}\n</div>\n'),e.put("widgets-common/top-buttons.tmpl.html",'  <div class="top-buttons">\n  <div class="top-buttons-wrapper">\n\n    <button class="btn top-button btn-info" ng-if="hasInfo()" ng-click="onToggleInfoPanel()">\n      <i class="fa fa-info-circle"></i>\n      <span class="text-hide" translate>impac.widget.common.top_buttons.info_popup.info</span>\n    </button>\n\n    <button class="btn top-button btn-export" ng-show="isCsvExportable()" ng-click="exportCSV()">\n      <i class="fa fa-file-text-o"></i>\n      <span class="text-hide" translate>impac.widget.common.top_buttons.info_popup.export_csv</span>\n    </button>\n\n    <button class="btn top-button btn-refresh" ng-click="onRefresh({refreshCache: true})">\n      <i class="fa fa-refresh"></i>\n      <span class="text-hide" translate>impac.widget.common.top_buttons.info_popup.refresh</span>\n    </button>\n\n    <button class="btn top-button btn-edit" ng-click="toggleEditMode()" ng-show="userAccesses.widgets.update" ng-class="{\'edit-mode\': parentWidget.isEditMode}">\n      <i class="fa fa-cog fa-lg"></i>\n      <span class="text-hide" translate>impac.widget.common.top_buttons.info_popup.edit</span>\n    </button>\n\n    <button class="btn top-button btn-close" ng-click="onToggleDeleteWidget()" ng-show="userAccesses.widgets.destroy">\n      <i class="fa fa-times-circle-o fa-lg"></i>\n      <span class="text-hide" translate>impac.widget.common.top_buttons.info_popup.delete</span>\n    </button>\n  </div>\n</div>\n'),e.put("widgets/accounts-accounting-values.tmpl.html",'<div widget-accounts-accounting-values>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.accounting_values.turnover.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.accounting_values.turnover.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.accounting_values.turnover.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" accounting-behaviour="pnl" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getCurrentPrice() | mnoCurrency : currency_unit : false }}\n        </div>\n        <div class="currency">{{currency}}</div>\n        <div class="legend">{{legend}}</div>\n      </div>\n\n      <div class="history chart-container" ng-show="widget.isHistoryMode">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">{{legend}}</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-assets-liability-summary.tmpl.html",'<div widget-accounts-assets-liability-summary>\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.acc_ass_liab_smry.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.acc_ass_liab_smry.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.acc_ass_liab_smry.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div class="chart-container">\n      <!-- account classification selectors -->\n      <div setting-param-selector parent-widget="widget" param="classification" options="accountsOptions" selected="selectedAccountsOption" class="row param-selector" deferred="::paramSelectorDeferred"/>\n      <!---->\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <div class="title" ng-show="widget.metadata.organization_ids.length==1">{{widget.content.summary[0].company}} {{classification}}</div>\n        <div class="title" ng-hide="widget.metadata.organization_ids.length==1">{{classification}} repartition</div>\n        <span ng-repeat="valuePair in dataSource | orderBy:\'label\'">\n          <span ng-style="{ \'font-weight\': \'bold\', \'color\': getAccountColor(valuePair) }">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n          <br />\n        </span>\n      </div>\n    </div>\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/accounts-assets-summary.tmpl.html",'<div widget-accounts-assets-summary>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.acc_ass_smry.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.acc_ass_smry.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.acc_ass_smry.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <div class="title" ng-show="widget.metadata.organization_ids.length==1">{{widget.content.summary[0].company}} {{classification}}</div>\n        <div class="title" ng-hide="widget.metadata.organization_ids.length==1">{{classification}} repartition</div>\n        <span ng-repeat="valuePair in dataSource | orderBy:\'label\'">\n          <span ng-style="{ \'font-weight\': \'bold\', \'color\': getAccountColor(valuePair) }">{{valuePair.label}}</span>: {{valuePair.total | mnoCurrency : getCurrency()}}\n          <br />\n        </span>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-assets-vs-liabilities.tmpl.html",'<div widget-accounts-assets-vs-liabilities>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.acc_ass_vs_liab.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.acc_ass_vs_liab.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.acc_ass_vs_liab.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend" style="max-height: 115px;">\n        <div class="title">\n          <i class="fa fa-circle" ng-style="{ \'color\': assetsColor }"><span translate="impac.widget.acc_ass_vs_liab.asset.many"></span></i> |\n          <i class="fa fa-circle" ng-style="{ \'color\': liabilitiesColor }"><span translate="impac.widget.acc_ass_vs_liab.liability.many"></span></i>\n        </div>\n        <div class="row">\n          <div ng-repeat="data in companiesList | orderBy:\'company\'" ng-class="{\'col-md-6\': (widget.content.companies.length > 1), \'col-md-12\': (widget.content.companies.length == 1)}">\n            <span>{{ data.company }}</span><br />\n            <span ng-style="{ \'color\': assetsColor }"> {{ data.assets | mnoCurrency : data.currency }}</span> <br/>\n            <span ng-style="{ \'color\': liabilitiesColor }"> {{ data.liabilities | mnoCurrency : data.currency }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-balance.tmpl.html",'<div widget-accounts-balance>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.account_balance.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-account parent-widget="widget" on-account-selected="updateKpiExtraParams(\'account\', widget.selectedAccount)" class="part" deferred="::accountBackDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_balance.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_balance.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <!-- Will be hidden once an account is selected -->\n    <div setting-account ng-hide="widget.selectedAccount" parent-widget="widget" label=\'Select an account to monitor\' on-account-selected="displayAccount()" deferred="::accountFrontDeferred" />\n\n    <!-- All the below divs will remain hidden until an account is selected -->\n    <div ng-show="widget.selectedAccount">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" accounting-behaviour="{{ getBehaviour() }}" end-date="widget.metadata.hist_parameters.to" />\n\n      <div ng-hide="widget.isHistoryMode">\n        <h3>{{getName()}}</h3>\n        <div class="price">\n           {{ getCurrentBalance() | mnoCurrency : getCurrency() : false }}\n        </div>\n        <div class="currency">{{getCurrency()}}</div>\n      </div>\n\n      <div class="chart-container" ng-show="widget.isHistoryMode">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">{{getName()}}</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-balance-sheet.tmpl.html",'<div widget-accounts-balance-sheet>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.account_balance_sheets.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-tag-filter ng-show="filterTagsEnabled == true" parent-widget="widget" class="part" deferred="::tagFilterDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_balance_sheets.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_balance_sheets.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div class="widget-lines-container no-scroll">\n      <div class="row widget-line header">\n        <div class="col-sm-6 col-sm-offset-6 col-xs-12">\n          <div setting-dates-picker parent-widget="widget" deferred="::datesPickerDeferred" from="fromDate" to="toDate" keep-today="keepToday" update-on-pick="true" template="::datesPickerTemplate" />\n        </div>\n      </div>\n      <div class="row widget-line header">\n        <div class="col-sm-5 col-sm-offset-1 col-xs-12 text-left sortable-title" ng-click="sort(\'account\')">\n          {{\'impac.widget.account_balance_sheets.accounts\' | translate}}\n          <i ng-show="sortedColumn == \'account\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n        </div>\n        <div class="col-sm-6 col-xs-12">\n          <div class="row">\n            <div class="col-xs-6 text-center sortable-title" ng-click="sort(\'total1\')">\n              {{\'impac.widget.account_balance_sheets.balance\' | translate}}\n              <i ng-show="sortedColumn == \'total1\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-6 text-center sortable-title" ng-click="sort(\'total2\')">\n              {{\'impac.widget.account_balance_sheets.balance\' | translate}}\n              <i ng-show="sortedColumn == \'total2\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="widget-lines-container">\n      <!-- Groups of statements with their accounts -->\n      <div class="row lines-group" ng-repeat="category in categories" >\n        <div class="col-xs-12">\n\n          <!-- Statements lines -->\n          <div class="row widget-line" >\n            <div class="col-xs-1" ng-click="toggleCollapsed(category.key)" style="cursor: pointer;">\n              <i class="fa" ng-class="isCollapsed(category.key) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n            </div>\n            <div class="col-sm-5 col-xs-11 text-left">\n              <strong>{{category.label}}</strong>\n            </div>\n            <div class="col-sm-3 col-xs-6 text-right">\n              <strong>{{widget.content.summary[category.key].totals[1] | mnoCurrency : widget.content.summary[category.key].currency}}</strong>\n            </div>\n            <div class="col-sm-3 col-xs-6 text-right">\n              <strong>{{widget.content.summary[category.key].totals[0] | mnoCurrency : widget.content.summary[category.key].currency}}</strong>\n            </div>\n          </div>\n\n          <!-- Accounts lines -->\n          <div class="row" uib-collapse="isCollapsed(category.key)">\n            <div class="col-xs-12">\n              <div class="row widget-line" ng-repeat="account in widget.content.summary[category.key].accounts" >\n                <div class="col-sm-5 col-xs-11 col-xs-offset-1 text-left">\n                  {{account.name | titleize}}\n                </div>\n                <div class="col-sm-3 col-xs-6 text-right">\n                  {{account.totals[1] | mnoCurrency : account.currency}}\n                </div>\n                <div class="col-sm-3 col-xs-6 text-right">\n                  {{account.totals[0] | mnoCurrency : account.currency}}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="row widget-line header" ng-show="isReportFiltered()">\n        <div class="col-xs-12 text-center">\n          <strong translate>impac.widget.settings.tag-filter.report_filtered</strong>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/accounts-cash-balance.tmpl.html",'<!--\n  Component generated by Impac! Widget Generator!\n-->\n<div widget-accounts-cash-balance>\n  <!-- Settings Panel -->\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <!-- Buttons displayed on the lower  -->\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <!-- Content Panel -->\n  <div ng-hide="widget.isEditMode">\n    <!-- Data found -->\n    <div class="data-container">\n      <div class="left-panel">\n        <div id="cash-balance-legend">\n          <div class="header" ng-repeat="header in groupedTable.headers">\n            <h4 ng-bind="header | titleize"></h4>\n            <div class="group-item" ng-repeat="item in groupedTable.groups[$index]" ng-click="legendItemOnClick(item)">\n              <i ng-style="{\'color\': getLegendItemColor(item)}" class="fa" ng-class="getLegendItemCheckBox(item)" aria-hidden="true"></i>\n              <div>\n                <svg ng-include="getLegendItemIcon(item)" class="legend-item-icon" ng-style="{\'fill\': getLegendItemColor(item)}"></svg>\n              </div>&nbsp;\n              <span ng-bind="item.name"></span>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="right-panel">\n        <div id="{{chartId()}}" class="cash-balance-chart"></div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/accounts-cash-projection.tmpl.html",'<div widget-accounts-cash-projection>\n  <!-- Settings Panel -->\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <!-- Widget content -->\n  <div ng-hide="widget.isEditMode">\n    <transactions-list ng-if="trxList.display" transactions="trxList.transactions" currency="widget.metadata.currency" total-records="trxList.totalRecords" resources-type="trxList.resources" on-hide="trxList.hide()" on-page-changed="trxList.fetch(page)" on-currency-change="trxList.fetch()" on-update-expected-date="trxList.updateExpectedDate(trxId, date)" on-change-resources="trxList.changeResourcesType(resourcesType)" on-delete-transaction="trxList.deleteTransaction(resourcesType, trxId)"></transactions-list>\n\n    <trends-list ng-if="trendList.display" trends="trendList.trends" total-records="trendList.totalRecords" on-hide="trendList.hide()" on-page-changed="trendList.fetch(page)" on-update-trend="trendList.updateTrend(trend)" on-delete-trend="trendList.deleteTrend(trendId)"></trends-list>\n\n    <div ng-hide="trxList.display || trendList.display">\n      <chart-threshold widget="widget" chart-promise="chartPromise" kpi-create-label="chartThresholdOptions.label" on-complete="widget.format()"></chart-threshold>\n\n      <!-- Chart -->\n      <div id="{{chartId()}}" class="cash-projection-chart"></div>\n\n      <!-- Bottom buttons -->\n      <div class="text-left">\n        <button class="btn btn-sm btn-default" ng-click="trxList.showAll()" title="See all due invoices and bills, and forecast">\n          <i class="fa fa-list" />\n          See all transactions\n        </button>\n        <button class="btn btn-sm btn-default" ng-click="addForecastPopup.show()" title="Create a new forecast transaction">\n          <i class="fa fa-pencil" />\n          Add manual transaction\n        </button>\n        <button class="btn btn-sm btn-default" ng-click="trendList.showAll()" title="See all trends">\n          <i class="fa fa-list" />\n          See all trends\n        </button>\n        <button class="btn btn-sm btn-default" ng-click="addTrendPopup.show()" title="Create a new trend">\n          <i class="fa fa-pencil" />\n          Add trend\n        </button>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n  <transactions-add ng-if="addForecastPopup.display" contacts="contacts" resources-type="addForecastPopup.resourcesType" on-hide="addForecastPopup.hide()" on-create-transaction="addForecastPopup.createTransaction(trx)"/>\n  <trends-add ng-if="addTrendPopup.display" on-hide="addTrendPopup.hide()" on-create-trend="addTrendPopup.createTrend(trend)"/>\n\n</div>\n'),e.put("widgets/accounts-cash-summary.tmpl.html",'<div widget-accounts-cash-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.account_cash_smry.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_cash_smry.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_cash_smry.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n        <!-- Tab header -->\n          <div class="row widget-line header">\n            <div class="col-xs-5 col-xs-offset-1 sortable-title" ng-click="sort(\'account\')">\n              {{ impac.widget.account_cash_smry.cash_flow | translate }}\n              <i ng-show="sortedColumn == \'account\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-3 text-right sortable-title" ng-click="sort(\'total\')">\n              {{getLastDate() | momentDate : widget.metadata.hist_parameters.period}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-3 text-right sortable-title" ng-click="sort(\'variance\')">\n              {{\'impac.widget.account_cash_smry.vs\' | translate}}{{getPrevDate() | momentDate : widget.metadata.hist_parameters.period}}\n              <i ng-show="sortedColumn == \'variance\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <!-- Groups of statements with their accounts -->\n          <div class="row lines-group" ng-repeat="statement in widget.content.summary" ng-class="{cash: statement.name.indexOf(\'cash\')>0}" >\n            <div class="col-xs-12">\n\n              <!-- Statements lines -->\n              <div class="row widget-line" >\n                <div class="col-xs-1" ng-click="toggleCollapsed(statement)">\n                  <i ng-show="(statement.accounts && statement.accounts.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'"/>\n                </div>\n                <div class="col-xs-5" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{statement.label | titleize}}</strong>\n                </div>\n                <div class="col-xs-3 text-right" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getLastValue(statement) | mnoCurrency : statement.currency : false}}</strong>\n                </div>\n                <div class="col-xs-3 text-right" ng-click="toggleSelectedElement(statement)" ng-class="getVarianceClassColor(getLastVariance(statement))">\n                  <strong>{{getLastVariance(statement)}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(statement)" ng-style="{ \'background-color\': getSelectLineColor(statement) }"/>\n              </div>\n\n              <!-- Accounts lines -->\n              <div class="row" uib-collapse="isCollapsed(statement)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(account, statement.name)" ng-repeat="account in statement.accounts" >\n                    <div class="col-xs-5 col-xs-offset-1">\n                      {{account.name}}\n                    </div>\n                    <div class="col-xs-3 text-right">\n                      {{getLastValue(account) | mnoCurrency : account.currency : false }}\n                    </div>\n                    <div class="col-xs-3 text-right" ng-class="getVarianceClassColor(getLastVariance(account))">\n                      {{getLastVariance(account)}}\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(account, statement.name)" ng-style="{ \'background-color\': getSelectLineColor(account) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n        </div>\n\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-show="selectedElement">\n          <h4>{{(selectedElement.label | titleize) || selectedElement.name}}</h4>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div class="legend">{{::widget.metadata.hist_parameters.period_translation}}</div>\n          </div>\n\n          <div class="widget-lines-container">\n\n            <!-- Not mobile -->\n            <div class="row">\n              <span ng-repeat="date in dates track by $index" class="hidden-xs">\n                <!-- Separator every 4 items -->\n                <div ng-if="$index % 4 == 0 && $index > 0" class="clearfix dashed"></div>\n\n                <div class="col-sm-3 text-center">\n                  <!-- Date -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12">\n                      {{date | momentDate : widget.metadata.hist_parameters.period}}\n                    </div>\n                  </div>\n                  <!-- Amount + currency -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12">\n                      {{selectedElement.cash_flows[$index] | mnoCurrency : selectedElement.currency }}\n                    </div>\n                  </div>\n                  <!-- Variance -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12" ng-class="getVarianceClassColor(selectedElement.variances[$index])">\n                      {{formatVariance(selectedElement.variances[$index])}}\n                    </div>\n                  </div>\n                </div>\n              </span>\n            </div>\n\n            <!-- Mobile -->\n            <div ng-repeat="date in dates track by $index" class="row widget-line visible-xs">\n              <!-- Date -->\n              <div class="col-xs-4">\n                {{date | momentDate : widget.metadata.hist_parameters.period}}\n              </div>\n              <!-- Amount + currency -->\n              <div class="col-xs-4 text-right">\n                {{selectedElement.cash_flows[$index] | mnoCurrency : selectedElement.currency }}\n              </div>\n              <!-- Variance -->\n              <div class="col-xs-4 text-right" ng-class="getVarianceClassColor(selectedElement.variances[$index])">\n                {{formatVariance(selectedElement.variances[$index])}}\n              </div>\n            </div>\n\n          </div>\n        </div>\n\n        <div ng-hide="selectedElement" class="no-element" translate>\n          impac.widget.account_cash_smry.select.description\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-class-comparison.tmpl.html",'<div widget-accounts-class-comparison>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.account_class_comp.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" hide-chart-interval="true" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_class_comp.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_class_comp.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <!-- account classification selectors -->\n      <div setting-param-selector parent-widget="widget" param="classification" options="classifications" selected="selectedClassification" class="row param-selector" deferred="::paramSelectorDeferred" on-select="widget.format()" no-reload/>\n      <!---->\n      <div class="row">\n        <div class="col-md-12 chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n      </div>\n      <div class="row">\n        <div class="col-md-12 widget-lines-container">\n          <div class="row" style="margin-bottom: 5px;">\n            <div class="col-xs-12">\n              <div common-time-period-info context="timePeriodInfoParams" />\n            </div>\n          </div>\n\n          <div class="row" ng-repeat="entity in widget.content.companies | orderBy:\'toString()\' track by $index">\n            <div class="col-xs-6 text-left">\n              <i class="fa fa-circle" ng-style="{ \'margin\': \'0px 8px\', \'color\': getAccountColor(entity) }" />\n              {{entity}}\n            </div>\n            <div class="col-xs-6 text-right">\n              <i>{{getAmount($index)}}</i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-comparison.tmpl.html",'<div widget-accounts-comparison>\n  <div setting-accounts-list parent-widget="widget" deferred="::accountsListDeferred" accounts-list="savedAccountsList"/>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.account_comp.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" hide-chart-interval="true" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_comp.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_comp.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n      <!-- multi-companies mode -->\n      <div ng-show="widget.metadata.organization_ids.length > 1 && canSelectComparisonMode || isComparisonMode()">\n        <div setting-params-checkboxes options="comparisonModeOptions" param="comparison_mode" parent-widget="widget" deferred="::paramsCheckboxesDeferred"/>\n      </div>\n      <!-- end -->\n      <div ng-hide="hasAccountsSelected() || noComparableAccounts" class="row">\n        <div class="col-xs-12">\n          <h5 translate>impac.widget.account_comp.account.select</h5>\n        </div>\n        <div class="col-md-6">\n          <div class="input-group">\n            <select ng-model="movedAccount[0]" ng-options="account.name + \' (\' + formatAmount(account) + \')\' group by account.classification for account in widget.remainingAccounts" class="form-control" ng-change="addAccount(movedAccount[0])"></select>\n          </div>\n        </div>\n      </div>\n      <!-- error: when there are no comparable accounts matched -->\n      <div ng-show="isComparisonMode() && noComparableAccounts" class="row comparable-error">\n        <div class="col-xs-12"><h5 translate>impac.widget.account_comp.account.not_found</h5></div>\n      </div>\n\n      <div class="row" ng-show="hasAccountsSelected()">\n        <div class="col-xs-12 text-center">\n          <div class="chart-container" impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n      </div>\n\n      <div class="row" ng-show="hasAccountsSelected()">\n        <div class="col-xs-12 widget-lines-container">\n\n          <div class="row" ng-class="{\'lines-group\': isComparisonMode(), \'widget-line\': !isComparisonMode()}" ng-repeat="account in widget.selectedAccounts track by $index">\n\n            <!-- Comparison between several conpanies -->\n            <div class="col-xs-12" ng-if="isComparisonMode()">\n              <div class="row widget-line" ng-repeat="groupedAccount in account.accounts track by $index">\n                <div class="col-xs-1">\n                  <i class="fa fa-circle" ng-style="{ \'color\': getAccountColor(groupedAccount) }" />\n                </div>\n                <div class="col-xs-6">\n                  {{groupedAccount.name}}\n                </div>\n                <div class="col-xs-4 text-right">\n                  <i>{{formatAmount(groupedAccount)}}</i>\n                </div>\n                <div class="col-xs-1 text-right">\n                  <button class="close" ng-click="removeAccount(account)">x</button>\n                </div>\n              </div>\n            </div>\n\n            <!-- Simple comparison between accounts -->\n            <div ng-if="!isComparisonMode()" class="col-xs-1">\n              <i class="fa fa-circle" ng-style="{ \'color\': getAccountColor(account) }" />\n            </div>\n            <div ng-if="!isComparisonMode()" class="col-xs-6">\n              {{account.name}}\n            </div>\n            <div ng-if="!isComparisonMode()" class="col-xs-4 text-right">\n              <i>{{formatAmount(account)}}</i>\n            </div>\n            <div ng-if="!isComparisonMode()" class="col-xs-1 text-right">\n              <button class="close" ng-click="removeAccount(account)">x</button>\n            </div>\n\n          </div>\n        </div>\n      </div>\n\n      <div class="row" ng-show="hasAccountsSelected() && !pdfMode">\n        <div class="col-xs-12 input-group add-account">\n          <select ng-model="movedAccount[0]" ng-options="account.name + \' (\' + formatAmount(account) + \')\' group by account.classification for account in widget.remainingAccounts track by account.uid" class="form-control" ng-change="addAccount(movedAccount[0])" ng-disabled="widget.selectedAccounts.length >= 15 || widget.remainingAccounts.length == 0 || isComparisonMode()">\n            <option value="" disabled selected translate>impac.widget.account_comp.account.add</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-custom-calculation.tmpl.html",'<div widget-accounts-custom-calculation>\n\n  <div setting-organizations parent-widget="widget" ng-hide="true" deferred="::orgDeferred" />\n  <div setting-accounts-list parent-widget="widget" deferred="::accountsListDeferred" />\n  <div setting-formula parent-widget="widget" deferred="::formulaDeferred" />\n\n  <h3 ng-hide="widget.isFormulaCorrect">\n    <a href="" ng-click="formulaModal.open()" translate>impac.widget.account_cust_calc.title</a>\n  </h3>\n\n  <!-- Calculation result -->\n  <div>\n    <div setting-hist-mode ng-show="widget.isFormulaCorrect" parent-widget="widget" deferred="::histModeDeferred" accounting-behaviour="pnl" />\n\n    <div ng-hide="widget.isHistoryMode">\n      <div class="price" ng-show="widget.isFormulaCorrect">\n        {{widget.evaluatedFormulaTranslate}}\n      </div>\n      <div class="legend" ng-show="widget.isFormulaCorrect">\n        {{widget.legend}}\n      </div>\n    </div>\n\n    <!-- Chart -->\n    <div class="history" ng-show="widget.isHistoryMode">\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n    </div>\n  </div>\n\n  <div ng-show="widget.demoData" common-data-not-found />\n</div>\n'),e.put("widgets/accounts-custom-calculation/formula.modal.html",'<div class="analytics modal-custom-calculation">\n  <div class="modal-header">\n    <div class="close" type="button" ng-click="cancel()" >×</div>\n    <h3 translate>impac.widget.account_cust_calc.formula.title</h3>\n  </div>\n\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-sm-12">\n        <div class="alert alert-error" ng-show="errors">\n          <button class="close" ng-click="errors=\'\'">×</button>\n          <ul>\n            <li ng-repeat="error in errors">{{error}}</li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <div class="edit row">\n      <div setting-organizations parent-widget="widget" class="part col-md-6" deferred="::modalOrgDeferred" on-select="reloadAccountsLists(orgs)" />\n      <div setting-time-period parent-widget="widget" class="part col-md-6" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" hide-chart-interval="true" apply-changes-callback="updateWidgetSettings()" />\n    </div>\n\n    <p translate="impac.widget.account_cust_calc.formula.explanations" translate-values="{example: \'({1} + {2}) / {3})\' }"></p>\n\n    <div class=\'row\'>\n      <div ng-show="widget.isLoading" class=\'col-md-6 loader\' align="center">\n        <div>\n          <i class="fa fa-spinner fa-pulse fa-3x"></i>\n          <p translate>impac.widget.account_cust_calc.formula.data_retrieved</p>\n        </div>\n      </div>\n\n      <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n        <div class=\'widget-line\' ng-repeat=\'account in widget.selectedAccounts track by $index\'>\n          <div class=\'row\'>\n            <div class=\'col-md-6\'>\n              {{$index+1}} - {{account.name}}\n            </div>\n            <div class=\'col-md-6\'>\n              {{account.current_balance | mnoCurrency : account.currency}}\n              <button class="close" ng-click="removeAccountFromFormula(account)"><span class=\'fa fa-times-circle\'></span></button>\n            </div>\n          </div>\n        </div>\n\n        <div class=\'input-group\'>\n          <select ng-model="movedAccount" ng-options="account.name + \' (\' + widget.formatAmount(account) + \')\' group by account.classification for account in widget.remainingAccounts" class=\'form-control\' ng-change=\'addAccountToFormula(movedAccount)\'><select>\n        </div>\n      </div>\n\n      <div ng-hide="widget.isLoading" class=\'col-md-6\'>\n        <p translate>impac.widget.account_cust_calc.formula.type_here</p>\n        <input class=\'form-control\' ng-model="widget.formula">\n\n        <p translate="impac.widget.account_cust_calc.formula.result" translate-values="{result: widget.evaluatedFormula}"></p>\n        <p translate="impac.widget.account_cust_calc.formula.legend" translate-values="{legend: widget.legend}"></p>\n      </div>\n    </div>\n  </div>\n\n  <div class="modal-footer">\n    <div class="row">\n      <div class="col-sm-12">\n        <button class="btn btn-gray" ng-click="cancel()" ng-hide="widget.isLoading" ng-disabled="isLoading" translate>impac.widget.account_cust_calc.formula.cancel</button>\n        <button class="btn btn-warning" ng-click="proceed()" ng-hide="widget.isLoading" ng-disabled=\'!widget.isFormulaCorrect || widget.isLoading\'>\n          <i class="fa fa-spinner fa-pulse loader" ng-show="isLoading"></i>\n          {{\'impac.widget.account_cust_calc.formula.save\' | translate}}\n        </button>\n      </div>\n\n    </div>\n  </div>\n</div>\n'),e.put("widgets/accounts-detailed-classifications.tmpl.html",'<div widget-accounts-detailed-classifications>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.account_det_class.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_det_class.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_det_class.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div class="widget-lines-container">\n\n      <!-- Tab header -->\n      <div ng-hide="multiEntity" class="row widget-line header">\n        <div class="col-md-6 text-left"  translate="impac.widget.account_det_class.acc_classifications" translate-values="{name: widget.content.companies[0].name}">\n\n        </div>\n\n        <div class="col-md-6 text-right">\n          <div common-time-period-info context="timePeriodInfoParams" />\n        </div>\n      </div>\n\n      <!-- Sorting sub-header (contains sorting) -->\n      <div ng-hide="multiEntity" class="row widget-line header sorting">\n        <div class="col-md-6 text-left sortable-title" ng-click="sort(\'account\')">\n          {{\'impac.widget.account_det_class.account_classifications\' | translate}}\n          <i ng-show="sortedColumn == \'account\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n        </div>\n\n        <div class="col-md-6 text-right sortable-title" ng-click="sort(\'total\')">\n          {{\'impac.widget.account_det_class.amounts\' | translate}}\n          <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n        </div>\n      </div>\n\n      <!-- Groups of statements with their accounts -->\n      <div class="row lines-group" ng-repeat="source in dataSource | orderBy:\'label\' track by source.label">\n        <div class="col-xs-12">\n\n          <!-- Statements lines -->\n          <div class="row widget-line">\n            <div class="col-xs-1" ng-click="toggleCollapsed(source.label)" style="cursor: pointer;">\n              <i class="fa" ng-class="isCollapsed(source.label) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n            </div>\n            <div class="col-xs-5 text-left">\n              <strong>{{source.label | titleize}}</strong>\n            </div>\n            <div class="col-xs-6 text-right">\n              <strong>{{source.value | mnoCurrency : source.currency}}</strong>\n            </div>\n          </div>\n\n          <!-- Accounts lines -->\n          <div class="row" uib-collapse="isCollapsed(source.label)">\n            <div class="col-xs-12">\n              <div class="row widget-line" ng-repeat="entry in source.entries" >\n                <div class="col-xs-5 col-xs-offset-1 text-left">\n                  {{entry.label | titleize}}\n                </div>\n                <div class="col-xs-6 text-right">\n                  {{entry.value | mnoCurrency : entry.currency}}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/accounts-expense-weight.tmpl.html",'<div widget-accounts-expense-weight>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.account_expense_weight.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-account parent-widget="widget" class="part" deferred="::accountBackDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.account_expense_weight.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.account_expense_weight.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <!-- Will be hidden once an account is selected -->\n    <div setting-account ng-hide="widget.selectedAccount" parent-widget="widget" label=\'Select an expense account\' on-account-selected="displayAccount()" deferred="::accountFrontDeferred" />\n\n    <div ng-show="widget.selectedAccount">\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" on-toggle="widget.format()" accounting-behaviour="pnl" />\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div class="legend">\n        <div class="title">\n          {{getName()}} to {{getComparator() | titleize}}\n          <span ng-if="widget.metadata.organization_ids.length==1"><br /><strong>{{widget.content.summary[0].ratio | mnoCurrency : \'%\'}}</strong></span>\n        </div>\n        <span ng-repeat="sum in widget.content.summary | orderBy:\'company\'" ng-if="widget.metadata.organization_ids.length>1">\n          <span style="font-weight: bold;">{{sum.company}}: {{sum.ratio | mnoCurrency : \'%\'}}</span>\n          <br />\n        </span>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-expenses-revenue.tmpl.html",'<div widget-accounts-expenses-revenue>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.accounts_expenses_revenue.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.accounts_expenses_revenue.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.accounts_expenses_revenue.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" on-toggle="widget.format()" accounting-behaviour="pnl" />\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div class="legend" ng-if="widget.isHistoryMode">\n        <span ng-hide="isNetProfitDisplayed">\n          <span class="negative2" translate>impac.widget.accounts_expenses_revenue.expenses</span> -\n          <span class="positive2" translate>impac.widget.accounts_expenses_revenue.revenue</span>\n        </span>\n        <span ng-show="isNetProfitDisplayed">\n          <strong translate>impac.widget.accounts_expenses_revenue.net_profit</strong>\n        </span>\n      </div>\n\n      <div ng-show="widget.isHistoryMode" setting-params-checkboxes options="displayOptions" param="display" parent-widget="widget" deferred="::paramsCheckboxesDeferred"/>\n\n      <div class="legend" ng-if="!widget.isHistoryMode">\n        <span class="negative2">{{\'impac.widget.accounts_expenses_revenue.expenses\' | translate}}: {{getCurrentExpenses() | mnoCurrency : getCurrency()}}</span>\n        </br>\n        <span class="positive2">{{\'impac.widget.accounts_expenses_revenue.revenue\' | translate}}: {{getCurrentRevenue() | mnoCurrency : getCurrency()}}</span>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-invoices-list.tmpl.html",'<div widget-accounts-invoices-list>\n  <!-- Settings Panel -->\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <!-- Content Panel -->\n  <div ng-hide="widget.isEditMode">\n    <!-- Data found -->\n    <div class="trx-container">\n    <!-- Display Transactions list.  Hide date picker and \'back to chart\' button\'. -->\n      <transactions-list ng-if="trxList.display" transactions="trxList.transactions" currency="widget.metadata.currency" total-records="trxList.totalRecords" resources-type="trxList.resources" on-hide="trxList.hide()" on-page-changed="trxList.fetch(page)" on-change-resources="trxList.changeResourcesType(resourcesType)" on-currency-change="trxList.fetch()" list-only="true"></transactions-list>\n    </div>\n\n    <!-- No data found -->\n    <div ng-if="(isDataFound==false)" common-data-not-found on-display-alerts="onDisplayAlerts()" endpoint="::widget.category" width="::widget.width" />\n  </div>\n</div>\n<div ng-show="!trxList.display" class="loader" align="center">\n  <div>\n    <i class="fa fa-spinner fa-pulse fa-3x"></i>\n    <p translate="impac.widget.loader"></p>\n  </div>\n</div>\n'),e.put("widgets/accounts-live-balance.tmpl.html",'<div widget-accounts-live-balance class="tall-widget">\n  <!-- Settings Panel -->\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-bolt-account parent-widget="widget" on-account-selected="updateKpiExtraParams()" class="part" deferred="::accountBackDeferred" />\n\n    <!-- Buttons displayed on the lower  -->\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <!-- Content Panel -->\n  <div ng-hide="widget.isEditMode">\n    <div show="widget.selectedAccount">\n      <h3>{{widget.selectedAccount.name}}</h3>\n      <div class="currency currency-centered">{{getCurrency()}}</div>\n      <hr>\n      <div class="headers legend">\n        <div class="price positive2">\n          {{getStatementBalance().column_7 ? (getStatementBalance().column_7 | mnoCurrency : getCurrency() : false) : \'Statement Not Available\' }}\n        </div>\n        <div class="statement-title"> Statement Balance </div>\n        <div class="spacer"></div>\n        <div class="price negative2">\n          {{getTotal().column_5 ? (getTotal().column_5 | mnoCurrency : getCurrency() : false) : \'N/A\' }}\n        </div>\n        <div class="balance-title"> Balance in Xero </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" needs-custom-message="isLiveBalance" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/accounts-payable-receivable.tmpl.html",'<div widget-accounts-payable-receivable>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.accounts_payable_receivable.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.accounts_payable_receivable.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.accounts_payable_receivable.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" accounting-behaviour="bls" end-date="widget.metadata.hist_parameters.to" />\n\n      <div ng-hide="widget.isHistoryMode">\n        <div class="receivable">\n          <h3 translate>impac.widget.accounts_payable_receivable.receivables.title</h3>\n          <div class="price positive2">\n            {{getCurrentReceivable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n\n        <div class="payable">\n          <h3 translate>impac.widget.accounts_payable_receivable.payables.title</h3>\n          <div class="price negative2">\n            {{getCurrentPayable() | mnoCurrency : getCurrency() : false}}\n          </div>\n          <div class="currency">{{getCurrency()}}</div>\n        </div>\n      </div>\n\n      <div class="chart-container" ng-show="widget.isHistoryMode">\n        <div impac-chart draw-trigger="drawTrigger.promise" deferred="chartDeferred"></div>\n        <div class="legend">\n          <span class="negative2" translate>impac.widget.accounts_payable_receivable.payable</span> -\n          <span class="positive2" translate>impac.widget.accounts_payable_receivable.receivable</span>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-profit-and-loss.tmpl.html",'<div widget-accounts-profit-and-loss>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.accounts_profit_and_loss.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n    <div setting-tag-filter ng-show="filterTagsEnabled == true" parent-widget="widget" class="part" deferred="::tagFilterDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.accounts_profit_and_loss.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.accounts_profit_and_loss.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n          <!-- Total mode -->\n          <div class="row widget-line header">\n            <div class="col-xs-12 text-right">\n              <span setting-param-selector parent-widget="widget" param="amount_displayed" options="amountDisplayedOptions" selected="amountDisplayed" deferred="::paramSelectorDeferred" no-reload />\n            </div>\n          </div>\n\n          <!-- Tab header -->\n          <div class="row widget-line header">\n            <div class="col-xs-7 col-xs-offset-1 text-left sortable-title" ng-click="sort(\'account\')">\n              {{\'impac.widget.accounts_profit_and_loss.accounts\' | translate}}\n              <i ng-show="sortedColumn == \'account\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-4 text-right sortable-title" ng-click="sort(\'total\')">\n              {{\'impac.widget.accounts_profit_and_loss.prof_loss\' | translate}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <!-- Groups of statements with their accounts -->\n          <div class="row lines-group" ng-repeat="statement in widget.content.summary" ng-class="{profit: statement.name.indexOf(\'profit\')>0}">\n            <div class="col-xs-12">\n\n              <!-- Statements lines -->\n              <div class="row widget-line" >\n                <div class="col-xs-1" ng-click="toggleCollapsed(statement)">\n                  <i ng-show="(statement.accounts && statement.accounts.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-7" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getName(statement) | titleize}}</strong>\n                </div>\n                <div class="col-xs-4 text-right" ng-class="getClassColor(getAmount(statement))" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getAmount(statement) | mnoCurrency : statement.currency}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(statement)" ng-style="{ \'background-color\': getSelectLineColor(statement) }"/>\n              </div>\n\n              <!-- Accounts lines -->\n              <div class="row" uib-collapse="isCollapsed(statement)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(account, statement.name)" ng-repeat="account in statement.accounts" >\n                    <div class="col-xs-7 col-xs-offset-1">\n                      {{account.name}}\n                    </div>\n                    <div class="col-xs-4 text-right" ng-class="getClassColor(getAmount(account))">\n                      {{getAmount(account) | mnoCurrency : account.currency}}\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(account, statement.name)" ng-style="{ \'background-color\': getSelectLineColor(account, statement.name) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n          <div class="row widget-line header" ng-show="isReportFiltered()">\n            <div class="col-xs-12 text-center">\n              <strong translate>impac.widget.settings.tag-filter.report_filtered</strong>\n            </div>\n          </div>\n\n        </div>\n\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-show="hasElements()">\n          <h4>{{::period_translation}} {{\'impac.widget.accounts_profit_and_loss.prof_and_loss\' | translate}}</h4>\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n\n            <!-- Not mobile -->\n            <div class="row">\n              <span ng-repeat="date in dates track by $index" class="hidden-xs">\n                <!-- Separator every 4 items -->\n                <div ng-if="$index % 4 == 0 && $index > 0" class="clearfix dashed"></div>\n\n                <div class="col-sm-3 text-center">\n                  <!-- Date -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12">\n                      {{date | momentDate : widget.metadata.hist_parameters.period}}\n                    </div>\n                  </div>\n                  <!-- Amount + currency -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                      {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n                    </div>\n                  </div>\n                </div>\n              </span>\n            </div>\n\n            <!-- Mobile -->\n            <div ng-repeat="date in dates track by $index" class="row widget-line visible-xs">\n              <!-- Date -->\n              <div class="col-xs-6">\n                {{date | momentDate : widget.metadata.hist_parameters.period}}\n              </div>\n              <!-- Amount + currency -->\n              <div class="col-xs-6 text-right" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n            <div class="row widget-line" ng-repeat="element in selectedElements track by $index">\n              <div class="col-xs-7 text-left">\n                <i class="fa fa-circle" ng-style="{ \'margin\': \'0px 8px\', \'color\': getElementChartColor($index) }" />\n                {{getName(element) | titleize}}\n              </div>\n              <div class="col-xs-5 text-right">\n                <i ng-class="getClassColor(getAmount(element))">\n                  {{getAmount(element) | mnoCurrency : element.currency}}\n                </i>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element" translate>\n          impac.widget.accounts_profit_and_loss.no_elements_selected\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/accounts-ratios.tmpl.html",'<!--\n  Component generated by Impac! Widget Generator!\n-->\n<div widget-accounts-ratios>\n  <!-- Settings Panel -->\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4>Widget settings</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <!-- Buttons displayed on the lower  -->\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()">Cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()">Save</button>\n    </div>\n  </div>\n\n  <!-- Content Panel -->\n  <div ng-hide="widget.isEditMode">\n    <!-- Data found -->\n    <div>\n\n      <!-- Ratio details -->\n      <div class="col-md-6 left-panel" ng-class="{simulation: simulationMode}">\n        <div common-time-period-info ng-if="simulationMode" context="periodInfoContext" />\n\n        <div class="member">\n          <div class="price" ng-if="!simulationMode">\n            {{ totalNumerator | mnoCurrency : widget.content.layout.currency }}\n          </div>\n\n          <div class="price" ng-if="simulationMode">\n            {{ calculatedNumerator | mnoCurrency : widget.content.layout.currency }}\n          </div>\n\n          <div class="legend">\n            {{ widget.content.layout.numerator }}\n          </div>\n\n          <div setting-offsets ng-show=\'simulationMode\' parent-widget="widget" deferred="::numeratorOffsetsDeferred" offsets-key=\'numerator\' initial-offsets=\'widget.metadata.offset.numerator\' currency=\'widget.content.layout.currency\' intervals-count=\'intervalsCount\' show-intervals-mult="isPnl" period=\'widget.metadata.hist_parameters.period\' />\n        </div>\n\n        <div class="center-block separator" />\n\n        <div class="member">\n          <div class="price" ng-if="!simulationMode">\n            {{ totalDenominator | mnoCurrency : widget.content.layout.currency }}\n          </div>\n\n          <div class="price" ng-if="simulationMode">\n            {{ calculatedDenominator | mnoCurrency : widget.content.layout.currency }}\n          </div>\n\n          <div class="legend">\n            {{ widget.content.layout.denominator }}\n          </div>\n\n          <div setting-offsets ng-show=\'simulationMode\' parent-widget="widget" deferred="::denominatorOffsetsDeferred" offsets-key=\'denominator\' initial-offsets=\'widget.metadata.offset.denominator\' currency=\'widget.content.layout.currency\' intervals-count=\'intervalsCount\' show-intervals-mult="isPnl" period=\'widget.metadata.hist_parameters.period\' />\n        </div>\n\n        <div class="text-center">\n          <button class="btn btn-sm btn-default" ng-if="simulationMode" ng-click="toggleSimulationMode(true)" title = "Clear changes to simulation">\n            Cancel\n          </button>\n          <button class="btn btn-sm btn-default" ng-if="!simulationMode" ng-click="toggleSimulationMode()" title="Add custom offsets to the ratio calculation">\n            <i class="fa fa-pencil-square-o" />\n            Simulation\n          </button>\n          <button class="btn btn-sm btn-warning" ng-if="simulationMode" ng-click="saveSimulation()" title="Apply simulation">\n            Save\n          </button>\n        </div>\n      </div>\n\n      <!-- Current value / Chart -->\n      <div class="col-md-6 right-panel">\n        <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" accounting-behaviour="{{widget.content.layout.accounting_behaviour}}" end-date="endDate" />\n\n        <div ng-hide="widget.isHistoryMode" class="current">\n          <div class="price">\n             {{ totalRatio | mnoCurrency : \'(ratio)\' : false }}\n          </div>\n          <div class="legend">{{ widget.content.layout.ratio }}</div>\n        </div>\n\n        <div class="history chart-container" ng-show="widget.isHistoryMode">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          <div class="legend">{{ widget.content.layout.ratio }}</div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/hr-employee-details.tmpl.html",'<div widget-hr-employee-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_employee_details.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_employee_details.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_employee_details.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n        <div setting-param-selector parent-widget="widget" param="employee_uid" options="employeesOptions" selected="selectedEmployee" class="row title" deferred="::paramSelectorDeferred1" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.job_title</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().job_title || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.company</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().company || getSingleCompanyName()}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.phone</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().phone || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.email</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().email || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.date_of_birth</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().dob | momentDate: "hr/employee_details"  || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.gender</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().gender || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <!-- <div class="legend">{{\'impac.widget.hr_employee_details.legend\' | translate}} <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred2" /></div> -->\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4">\n              <label translate>impac.widget.hr_employee_details.label.salary</label>\n            </div>\n            <div class="col-md-8">\n              <pre ng-if="salaries.length > 0" ng-repeat="salary in salaries" title="{{salary.tooltip}}">{{ salary.amount | mnoCurrency : salary.currency }} ({{ salary.period }})</pre>\n              <pre ng-if="salaries.length == 0">-</pre>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-12">\n              <label>\n                Estimated earnings\n                - <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred2" />\n              </label>\n            </div>\n            <div class="col-md-8 col-md-offset-4">\n              <pre>{{ getEmployee().earnings || \'-\' }}</pre>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.address</label></div>\n            <div class="col-md-8"><pre>{{formatAddress(getEmployee().address) || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.job_location</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().location || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.supervisor</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().supervisor || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.status</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().employment_status || "-" }}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.hr_employee_details.label.note</label></div>\n            <div class="col-md-8"><pre>{{getEmployee().note || "-" }}</pre></div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-employees-list.tmpl.html",'<div widget-hr-employees-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_employees_list.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_employees_list.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_employees_list.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div class="legend">\n        <strong>{{widget.content.total.employees}}</strong> <span translate="impac.widget.hr_employees_list.legend.employee" translate-values="{num_employee: widget.content.total.employees}"></span> {{\'impac.widget.hr_employees_list.legend.average\' | translate}} (<span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred"/>): <strong>{{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}</strong>\n      </div>\n\n      <div class="widget-lines-container">\n        <div class="row widget-line header">\n          <div class="col-sm-2" translate>impac.widget.hr_employees_list.label.company</div>\n          <div class="col-sm-3" translate>impac.widget.hr_employees_list.label.employee</div>\n          <div class="col-sm-2" translate>impac.widget.hr_employees_list.label.title</div>\n          <div class="col-sm-3" translate>impac.widget.hr_employees_list.label.phone</div>\n          <div class="col-sm-2" translate>impac.widget.hr_employees_list.label.salary</div>\n        </div>\n        <div class="row widget-line" ng-repeat="employee in widget.content.employees" >\n          <div class="col-sm-2">{{employee.company || getSingleCompanyName()}}</div>\n          <div class="col-sm-3">{{employee.lastname}} {{employee.firstname}}</div>\n          <div class="col-sm-2"><i>{{employee.job_title}}</i></div>\n          <div class="col-sm-3">{{employee.phone}}</div>\n          <div class="col-sm-2"><i>{{getEmployeeEarnings(employee)}}</i></div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-leaves-balance.tmpl.html",'<div widget-hr-leaves-balance>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate="">impac.widget.hr_leaves_balance.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred"/>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_leaves_balance.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_leaves_balance.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="employee-name" deferred="::paramSelectorDeferred" />\n\n      <h3>{{vacationLeaves_translation}} {{\'impac.widget.hr_leaves_balance.balance\' | translate}}</h3>\n      <div class="balance">{{(getEmployee().leaves[0].units || 0) | mnoCurrency : (getEmployee().leaves[0].type_of_units || \'h\')}}</div>\n\n      <h3>{{sickLeaves_translation}} {{\'impac.widget.hr_leaves_balance.balance\' | translate}}</h3>\n      <div class="balance">{{(getEmployee().leaves[1].units || 0) | mnoCurrency : (getEmployee().leaves[1].type_of_units || \'h\')}}</div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-leaves-schedule.tmpl.html",'<div widget-hr-leaves-schedule>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 tranlate>impac.widget.hr_leaves_schedule.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" tranlate>impac.widget.hr_leaves_schedule.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" tranlate>impac.widget.hr_leaves_schedule.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div widget-component-calendar ng-model="eventSources"></div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-payroll-summary.tmpl.html",'<div widget-hr-payroll-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_payroll_summary.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_payroll_summary.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_payroll_summary.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n\n          <!-- Tab header -->\n          <div class="row widget-line header">\n            <div class="col-xs-9 sortable-title" ng-click="sort(\'employee\')">\n              {{widget.metadata.hist_parameters.period}} {{\'impac.widget.hr_payroll_summary.payroll_summary\' | translate}}\n              <i ng-show="sortedColumn == \'employee\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-3 text-right sortable-title" ng-click="sort(\'total\')">\n              {{\'impac.widget.hr_payroll_summary.total\' | translate}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <!-- Groups of statements with their accounts -->\n          <div class="row lines-group" ng-repeat="statement in widget.content.summary" >\n            <div class="col-xs-12">\n\n              <!-- Statements lines -->\n              <div class="row widget-line">\n                <div class="col-xs-1" ng-click="toggleCollapsed(statement)">\n                  <i ng-show="(statement.employees && statement.employees.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-7" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getName(statement) | titleize}}</strong>\n                </div>\n                <div class="col-xs-4 text-right" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getLastValue(statement) | mnoCurrency : statement.currency}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(statement)" ng-style="{ \'background-color\': getSelectLineColor(statement) }"/>\n              </div>\n\n              <!-- Accounts lines -->\n              <div class="row" uib-collapse="isCollapsed(statement)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(employee, statement.name)" ng-repeat="employee in statement.employees" >\n                    <div class="col-xs-7 col-xs-offset-1">\n                      {{employee.name}}\n                    </div>\n                    <div class="col-xs-4 text-right">\n                      {{getLastValue(employee) | mnoCurrency : employee.currency}}\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(employee, statement.name)" ng-style="{ \'background-color\': getSelectLineColor(employee, statement.name) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-show="hasElements()">\n\n          <h4>{{::periodTranslation | titleize}} {{\'impac.widget.hr_payroll_summary.payroll_summary\' | translate}}</h4>\n          <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" on-toggle="widget.format()"/>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n\n            <div ng-show="getTrackedField()" class="row widget-line header">\n              <div class="col-xs-12">{{getTrackedField()}}</div>\n            </div>\n\n            <!-- Not mobile -->\n            <div class="row">\n              <span ng-repeat="date in widget.content.dates track by $index" class="hidden-xs">\n                <!-- Separator every 4 items -->\n                <div ng-if="$index % 4 == 0 && $index > 0" class="clearfix dashed"></div>\n\n                <div class="col-sm-3 text-center">\n                  <!-- Date -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12">\n                      {{formatDate(date)}}\n                    </div>\n                  </div>\n                  <!-- Amount + currency -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                      {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency }}\n                    </div>\n                  </div>\n                </div>\n              </span>\n            </div>\n\n            <!-- Mobile -->\n            <div ng-repeat="date in widget.content.dates track by $index" class="row widget-line visible-xs">\n              <!-- Date -->\n              <div class="col-xs-6">\n                {{formatDate(date)}}\n              </div>\n              <!-- Amount + currency -->\n              <div class="col-xs-6 text-right" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div class="row widget-line header">\n              <div class="col-md-12">\n                <span ng-if="getTrackedField()">\n                  {{getTrackedField()}} -\n                </span>\n                <span ng-if="widget.isHistoryMode">\n                  {{\'impac.widget.hr_payroll_summary.from\' | translate}} {{widget.content.dates[0] | momentDate : "hr/payroll_summary"}} {{\'impac.widget.hr_payroll_summary.to\' | translate}} {{widget.content.dates[widget.content.dates.length - 1] | momentDate : "hr/payroll_summary"}}\n                </span>\n                <span ng-if="!widget.isHistoryMode">\n                  {{getPeriod()}}\n                </span>\n              </div>\n            </div>\n\n            <div class="row widget-line" ng-repeat="element in selectedElements track by $index">\n              <div class="col-xs-7">\n                <i class="fa fa-circle" ng-style="{ \'margin\': \'0px 8px\', \'color\': getElementChartColor($index) }" />\n                {{getName(element) | titleize}}\n              </div>\n              <div class="col-xs-5 text-right">\n                <span ng-if="widget.isHistoryMode">{{getTotalSum(element) | mnoCurrency : element.currency}}</span>\n                <span ng-if="!widget.isHistoryMode">{{getLastValue(element) | mnoCurrency : element.currency}}</span>\n              </div>\n            </div>\n\n          </div>\n\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element" translate>impac.widget.hr_payroll_summary.no_elements</div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-payroll-taxes.tmpl.html",'<div widget-hr-payroll-taxes>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.hr_payroll_taxes.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_payroll_taxes.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_payroll_taxes.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <div setting-hist-mode parent-widget="widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">{{getCurrentPrice() | mnoCurrency : getCurrency() : false}}</div>\n        <div class="currency">{{getCurrency()}}</div>\n        <div class="legend">{{\'impac.widget.hr_payroll_taxes.legend\' | translate}}<br />{{getPeriod()}}</div>\n      </div>\n\n      <div class="history chart-container" ng-show="widget.isHistoryMode">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend">{{\'impac.widget.hr_payroll_taxes.legend\' | translate}}</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-salaries-summary.tmpl.html",'<div widget-hr-salaries-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_salaries_summary.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_salaries_summary.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_salaries_summary.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n\n        <h3 class="left" ng-class="widget.isExpanded() ? \'left\' : \'reduced-left\'" translate>impac.widget.hr_salaries_summary.average_rate</h3>\n        <div class="price">\n           {{widget.content.total.average_rate | mnoCurrency : widget.content.total.currency}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred1"/>\n        <div class="legend">\n          <span>({{widget.content.total.employees}} <span translate="impac.widget.hr_salaries_summary.legend.employee" translate-values="{num_employee: widget.content.total.employees}"></span> {{\'impac.widget.hr_salaries_summary.legend.with\' | translate}})</span>\n        </div>\n      </div>\n\n      <div class="right-panel" ng-class="{\'col-md-12\': !widget.isExpanded(), \'col-md-6\': widget.isExpanded()}">\n        <h3 class="right">{{\'impac.widget.hr_salaries_summary.filter\' | translate}} <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/></h3>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="row widget-line" ng-repeat="data in widget.content.summary.data">\n            <div class="col-xs-2">\n              <i ng-hide="widget.content.summary.filter==\'age_range\'" class="fa fa-circle" ng-style="{ \'color\': getColorByIndex($index) }" />\n            </div>\n            <div class="col-xs-5">\n              {{data.label}}\n            </div>\n            <div class="col-xs-5 text-right">\n              <i>{{data.value | mnoCurrency : widget.content.total.currency}} (av.)</i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-superannuation-accruals.tmpl.html",'<div widget-hr-superannuation-accruals>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_superannuation_accruals.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_superannuation_accruals.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_superannuation_accruals.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" deferred="::paramSelectorDeferred" />\n\n      <h3 translate>impac.widget.hr_superannuation_accruals.superannuation_balance</h3>\n      <div class="price">{{(getEmployee().total_super || 0) | mnoCurrency : getEmployee().currency}}</div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-timesheets.tmpl.html",'<div widget-hr-timesheets>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_timesheets.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_timesheets.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_timesheets.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div setting-param-selector parent-widget="widget" param="employee_id" options="employeesOptions" selected="selectedEmployee" class="currency" deferred="::paramSelectorDeferred" />\n\n      <div class="widget-lines-container">\n\n        <!-- Tab header -->\n        <div class="row widget-line header">\n          <div class="col-sm-12">\n            {{\'impac.widget.hr_timesheets.from\' | translate}} {{widget.content.dates[0] | momentDate : widget.metadata.hist_parameters.period}} {{\'impac.widget.hr_timesheets.to\' | translate}} {{widget.content.dates[widget.content.dates.length - 1] | momentDate : widget.metadata.hist_parameters.period}}\n          </div>\n        </div>\n\n        <!-- Time worked activities -->\n        <div class="row lines-group" >\n          <div class="col-xs-12">\n\n            <!-- Time worked -->\n            <div class="row widget-line" >\n              <div class="col-xs-1" ng-click="toggleCollapsed(\'total_time_worked\')" style="cursor: pointer;">\n                <i class="fa" ng-class="isCollapsed(\'total_time_worked\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-xs-7">\n                <strong translate>impac.widget.hr_timesheets.total_worked</strong>\n              </div>\n              <div class="col-xs-4 text-right">\n                <strong>{{getEmployeeTimeWorked()}} h</strong>\n              </div>\n            </div>\n\n            <!-- Activities lines / TODO -->\n            <div class="row" uib-collapse="isCollapsed(\'total_time_worked\')">\n              <div class="col-xs-12">\n                <div class="row widget-line">\n                  <div class="col-xs-11 col-xs-offset-1">\n                    <i translate>impac.widget.hr_timesheets.activities_not_found</i>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n\n        <!-- Time off activities -->\n        <div class="row lines-group" >\n          <div class="col-xs-12">\n\n            <!-- Time off -->\n            <div class="row widget-line" >\n              <div class="col-xs-1" ng-click="toggleCollapsed(\'total_time_of\')" style="cursor: pointer;">\n                <i class="fa" ng-class="isCollapsed(\'total_time_of\') ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n              </div>\n              <div class="col-xs-7">\n                <strong translate>impac.widget.hr_timesheets.total_off</strong>\n              </div>\n              <div class="col-xs-4 text-right">\n                <strong>{{getEmployeeTimeOff()}} h</strong>\n              </div>\n            </div>\n\n\n            <!-- PTO and Vacation lines / TODO -->\n            <div class="row" uib-collapse="isCollapsed(\'total_time_of\')">\n              <div class="col-xs-12">\n                <div class="row widget-line">\n                  <div class="col-xs-7 col-xs-offset-1">PTO</div>\n                  <div class="col-xs-4 text-right">0 h</div>\n                </div>\n                <div class="row widget-line">\n                  <div class="col-xs-7 col-xs-offset-1">Vacation</div>\n                  <div class="col-xs-4 text-right">0 h</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/hr-workforce-summary.tmpl.html",'<div widget-hr-workforce-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.hr_workforce_summary.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.hr_workforce_summary.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.hr_workforce_summary.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n\n        <h3 class="left" ng-class="widget.isExpanded() ? \'left\' : \'reduced-left\'" translate>impac.widget.hr_workforce_summary.total_workforce</h3>\n        <div class="price">\n           {{getTotalWorkforce() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="currency" setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred1"/>\n        <div class="legend">\n          <span>({{getNumberOfEmployees()}} <span translate="impac.widget.hr_workforce_summary.legend.employee" translate-values="{num_employee: widget.content.total.employees}"></span> {{\'impac.widget.hr_workforce_summary.legend.with\' | translate}})</span>\n        </div>\n      </div>\n\n      <div class="right-panel" ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <h3 class="right">{{\'impac.widget.hr_workforce_summary.filter\' | translate}} <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/></h3>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n        <div class="widget-lines-container">\n          <div class="row widget-line" ng-repeat="data in widget.content.summary.data">\n            <div class="col-xs-2">\n              <i class="fa fa-circle" ng-style="{ \'color\': getColorByIndex($index) }" />\n            </div>\n            <div class="col-xs-7">\n              {{widget.content.summary.filter == "salary_range" ? formatSalaryRange(data) : data.label}}\n            </div>\n            <div class="col-xs-3 text-right">\n              <i>{{((data.value / widget.content.total.amount)*100).toFixed()}}%</i>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/invoices-aged-payables-receivables.tmpl.html",'<div widget-invoices-aged-payables-receivables>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.invoices_receivables.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.invoices_receivables.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.invoices_receivables.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="widget-lines-container">\n\n          <div class="row widget-line header">\n            <div class="col-xs-6 sortable-title" ng-click="sort(\'customer\')">\n              {{\'impac.widget.invoices_receivables.payables_and_receivables\' | translate}}\n              <i ng-show="sortedColumn == \'customer\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-3 text-right sortable-title" ng-click="sort(\'total\')">\n              {{\'impac.widget.invoices_receivables.total\' | translate}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-3 text-right sortable-title" ng-click="sort(\'invoice\')">\n              {{\'impac.widget.invoices_receivables.oldest\' | translate}}\n              <i ng-show="sortedColumn == \'invoice\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <!-- Payables -->\n          <div class="row lines-group">\n            <div class="col-xs-12">\n\n              <div class="row widget-line">\n                <div class="col-xs-1" ng-click="toggleCollapsed(payables)">\n                  <i ng-show="(payables.suppliers && payables.suppliers.length)" class="fa" ng-class="isCollapsed(payables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-5" ng-click="toggleSelectedElement(payables)">\n                  <strong translate>impac.widget.invoices_receivables.aged_payables</strong>\n                </div>\n                <div class="col-xs-3 text-right" ng-click="toggleSelectedElement(payables)">\n                  <strong>{{getTotalSum(payables) | mnoCurrency : payables.currency}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(payables)" ng-style="{ \'background-color\': getSelectLineColor(payables) }"/>\n              </div>\n\n              <div class="row" uib-collapse="isCollapsed(payables)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(supplier, payables.name)" ng-repeat="supplier in payables.suppliers">\n                    <div class="col-xs-5 col-xs-offset-1">\n                      {{supplier.name}}\n                    </div>\n                    <div class="col-xs-3 text-right">\n                      {{getTotalSum(supplier) | mnoCurrency : supplier.currency}} <span common-currency-conversions fx-amounts="supplier.formattedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n                    </div>\n                    <div class="col-xs-3 text-right">\n                      <span uib-tooltip="{{\'impac.widget.invoices_receivables.tooltip.oldest_invoice\' | translate}} {{getOldestInvoice(supplier)}}" tooltip-placement="left">\n                        {{getOldestInvoice(supplier) | momentDate : widget.metadata.hist_parameters.period}}\n                      </span>\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(supplier, payables.name)" ng-style="{ \'background-color\': getSelectLineColor(supplier, payables.name) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n\n          <!-- Receivables -->\n          <div class="row lines-group">\n            <div class="col-xs-12">\n\n              <div class="row widget-line" >\n                <div class="col-xs-1" ng-click="toggleCollapsed(receivables)">\n                  <i ng-show="(receivables.customers && receivables.customers.length)" class="fa" ng-class="isCollapsed(receivables) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-5" ng-click="toggleSelectedElement(receivables)">\n                  <strong translate>impac.widget.invoices_receivables.aged_receivables</strong>\n                </div>\n                <div class="col-xs-3 text-right" ng-click="toggleSelectedElement(receivables)">\n                  <strong>{{getTotalSum(receivables) | mnoCurrency : receivables.currency}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(receivables)" ng-style="{ \'background-color\': getSelectLineColor(receivables) }"/>\n              </div>\n\n              <div class="row" uib-collapse="isCollapsed(receivables)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(customer, receivables.name)" ng-repeat="customer in receivables.customers" ng-class="isSelected(customer, receivables.name) ? \'selected\' : null" >\n                    <div class="col-xs-5 col-xs-offset-1">\n                      {{customer.name}}\n                    </div>\n                    <div class="col-xs-3 text-right">\n                      <span>{{getTotalSum(customer) | mnoCurrency : customer.currency}} <span common-currency-conversions fx-amounts="customer.formattedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" /></span>\n                    </div>\n                    <div class="col-xs-3 text-right">\n                      <span uib-tooltip="{{\'impac.widget.invoices_receivables.tooltip.oldest_invoice\' | translate}} {{getOldestInvoice(customer)}}" tooltip-placement="left">\n                        {{getOldestInvoice(customer) | momentDate : widget.metadata.hist_parameters.period}}\n                      </span>\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(customer, receivables.name)" ng-style="{ \'background-color\': getSelectLineColor(customer, receivables.name) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-show="hasElements()">\n\n          <h4>{{::period_translation | titleize}} {{\'impac.widget.invoices_receivables.aged_payables_and_receivables\' | translate}}</h4>\n\n          <div ng-show="selectedElements.length < 2" class="legend">{{getName(selectedElements[0]) | titleize}}</div>\n\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div ng-show="selectedElements.length < 2" class="widget-lines-container">\n\n            <!-- Not mobile -->\n            <div class="row">\n              <span ng-repeat="date in widget.content.dates track by $index" class="hidden-xs">\n                <!-- Separator every 4 items -->\n                <div ng-if="$index % 4 == 0 && $index > 0" class="clearfix dashed"></div>\n\n                <div class="col-sm-3 text-center">\n                  <!-- Date -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12">\n                      {{date | momentDate : widget.metadata.hist_parameters.period}}\n                    </div>\n                  </div>\n                  <!-- Amount + currency -->\n                  <div class="row widget-line">\n                    <div class="col-sm-12" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                      {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n                    </div>\n                  </div>\n                </div>\n              </span>\n            </div>\n\n            <!-- Mobile -->\n            <div ng-repeat="date in widget.content.dates track by $index" class="row widget-line visible-xs">\n              <!-- Date -->\n              <div class="col-xs-6">\n                {{date | momentDate : widget.metadata.hist_parameters.period}}\n              </div>\n              <!-- Amount + currency -->\n              <div class="col-xs-6 text-right" ng-class="getClassColor(selectedElements[0].totals[$index])">\n                {{selectedElements[0].totals[$index] | mnoCurrency : selectedElements[0].currency}}\n              </div>\n            </div>\n\n            <div class="row astericks-info">\n              <div class="col-xs-12">\n                <p><i translate>impac.widget.invoices_receivables.your_opening_balance</i></p>\n              </div>\n            </div>\n          </div>\n\n          <div ng-hide="selectedElements.length < 2" class="widget-lines-container">\n\n            <div class="row widget-line header">\n              <div class="col-xs-4 col-xs-offset-8 text-right">Totals</div>\n            </div>\n\n            <div class="row widget-line" ng-repeat="element in selectedElements track by $index">\n              <div class="col-xs-2">\n                <i class="fa fa-circle" ng-style="{ \'margin\': \'0px 8px\', \'color\': getElementChartColor($index) }" />\n              </div>\n              <div class="col-xs-6">\n                {{getName(element) | titleize}}\n              </div>\n              <div class="col-xs-4 text-right">\n                <i>{{getTotalSum(element) | mnoCurrency : element.currency}}</i>\n              </div>\n            </div>\n\n            <div class="row astericks-info">\n              <div class="col-xs-12">\n                <p><i translate>impac.widget.invoices_receivables.your_opening_balance</i></p>\n              </div>\n            </div>\n          </div>\n\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element" translate>impac.widget.invoices_receivables.select_accounts</div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/invoices-list.accessible.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.invoices_list.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.invoices_list.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.invoices_list.save</button>\n    </div>\n  </div>\n\n  <table class="table widget-lines-container" ng-hide="widget.isEditMode">\n\n    <!-- Header line -->\n    <tr class="widget-line header">\n      <td>{{entityTypeCap}}</td>\n      <td translate>impac.widget.invoices_list.paid</td>\n      <td translate>impac.widget.invoices_list.due</td>\n      <td translate>impac.widget.invoices_list.invoiced</td>\n    </tr>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n\n    <!-- Content lines -->\n    <tr class="widget-line" ng-repeat="entity in widget.content.entities | orderBy:\'name\'">\n      <td>{{entity.name}}</td>\n      <td><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></td>\n      <td><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></td>\n    </tr>\n\n  </table>\n\n</div>\n'),e.put("widgets/invoices-list.tmpl.html",'<div widget-invoices-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.invoices_list.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="(widget.metadata.hist_parameters.to || defaultTo)" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.invoices_list.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.invoices_list.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode" class="widget-lines-container">\n\n    <div setting-limit-entries parent-widget="widget" deferred="::limitEntriesDeferred" selected="limitEntriesSelected" max="widget.content.entities.length" entries-label="limitEntriesLabel" />\n\n\n    <!-- LARGE WIDGET -->\n\n    <!-- Header line -->\n    <div ng-if="widget.width > 3" class="row widget-line header">\n      <div class="col-sm-4">{{entityTypeCap}}</div>\n      <div class="col-sm-7">\n        <div class="row">\n          <div class="col-xs-4" translate>impac.widget.invoices_list.paid</div>\n          <div class="col-xs-4" translate>impac.widget.invoices_list.due</div>\n          <div class="col-xs-4" translate>impac.widget.invoices_list.invoiced</div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Content lines -->\n    <div ng-if="widget.width > 3" class="row widget-line" ng-repeat="entity in widget.content.entities | limitTo:limitEntriesSelected | orderBy:\'name\'" tooltip-placement="bottom" uib-tooltip-html="invoiceTooltips[entity.id]" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-sm-4"><b>{{entity.name}}</b></div>\n      <div class="col-sm-7">\n        <div class="row">\n          <div class="col-xs-4"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n          <div class="col-xs-4"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n          <div class="col-xs-4"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n        </div>\n      </div>\n      <div class="col-sm-1 right-column text-right">\n        <i class="fa fa-info-circle" />\n        <span common-currency-conversions fx-amounts="entity.formattedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n      </div>\n    </div>\n\n\n    <!-- SMALL WIDGET -->\n\n    <!-- Header line -->\n    <div ng-if="widget.width <= 3" class="row widget-line header">\n      <div class="col-xs-12" ng-show="orderBy == \'paid \'">{{entityTypeCap}} {{\'impac.widget.invoices_list.total_paid\' | translate}}</div>\n      <div class="col-xs-12" ng-show="orderBy == \'due \'">{{entityTypeCap}} {{\'impac.widget.invoices_list.total_due\' | translate}}</div>\n      <div class="col-xs-12" ng-hide="orderBy == \'paid \' || orderBy == \'due \'">{{entityTypeCap}} {{\'impac.widget.invoices_list.total_invoiced\' | translate}}</div>\n    </div>\n\n    <!-- Content lines -->\n    <div ng-if="widget.width <= 3" class="row widget-line" ng-repeat="entity in widget.content.entities | limitTo:limitEntriesSelected | orderBy:\'name\'" tooltip-placement="bottom" uib-tooltip-html="invoiceTooltips[entity.id]" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n      <div class="col-xs-12"><b>{{entity.name}}</b></div>\n      <div class="col-xs-8" ng-show="orderBy == \'paid \'"><i>{{entity.total_paid | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-8" ng-show="orderBy == \'due \'"><i>{{entity.total_due | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-8" ng-hide="orderBy == \'paid \' || orderBy == \'due \'"><i>{{entity.total_invoiced | mnoCurrency : entity.currency}}</i></div>\n      <div class="col-xs-4 text-right">\n        <i class="fa fa-info-circle" />\n        <span common-currency-conversions fx-amounts="entity.formattedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/invoices-summary.tmpl.html",'<div widget-invoices-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.invoices_summary.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n    <div setting-chart-filters parent-widget="widget" class="part" deferred="::chartFiltersDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.invoices_summary.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.invoices_summary.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <span>{{widget.content.legend}}</span>\n      </div>\n    </div>\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-aged.tmpl.html",'<div widget-sales-aged>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_aged.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_aged.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_aged.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="center">\n\n      <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload truncate-no="60" on-select="widget.format()" style="text-align: center;" deferred="::paramSelectorDeferred"/>\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n      <div class="legend">{{\'impac.widget.sales_aged.from\' | translate}} {{widget.content.dates[0] | momentDate : widget.metadata.hist_parameters.period}} {{\'impac.widget.sales_aged.to\' | translate}} {{getLastDate() | momentDate : widget.metadata.hist_parameters.period}}</div>\n\n      <div class="widget-lines-container">\n\n        <!-- Not mobile -->\n        <div class="row">\n          <span ng-repeat="date in formattedDates track by $index" class="hidden-xs">\n            <!-- Separator every 4 items -->\n            <div ng-if="$index % 4 == 0 && $index > 0" class="clearfix dashed"></div>\n\n            <div class="col-sm-3 text-center">\n              <!-- Date -->\n              <div class="row widget-line">\n                <div class="col-xs-12">\n                  {{date}}\n                </div>\n              </div>\n              <!-- Amount (+ currency) -->\n              <div class="row widget-line">\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-xs-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" >\n                  {{getTotal($index) | mnoCurrency : widget.content.currency}}\n                </div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-xs-12" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" >\n                  {{getTotal($index)}}\n                </div>\n              </div>\n            </div>\n          </span>\n        </div>\n\n        <!-- Mobile -->\n        <div ng-repeat="date in formattedDates track by $index" class="row widget-line visible-xs">\n          <!-- Date -->\n          <div class="col-xs-6">\n            {{date}}\n          </div>\n          <!-- Amount (+ currency) -->\n          <div ng-hide="filter.value == \'quantity_sold\'" class="col-xs-6 text-right" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" >\n            {{getTotal($index) | mnoCurrency : widget.content.currency}}\n          </div>\n          <div ng-show="filter.value == \'quantity_sold\'" class="col-xs-6 text-right" ng-class="getClassColor(getTotal($index - 1),getTotal($index))" >\n            {{getTotal($index)}}\n          </div>\n        </div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-break-even.tmpl.html",'<div widget-sales-break-even>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_break_even.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_break_even.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_break_even.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="align-center">\n\n      <div class="legend">{{\'impac.widget.sales_break_even.from\' | translate}} {{widget.content.period.from | momentDate : "sales/break_even"}} {{\'impac.widget.sales_break_even.to\' | translate}} {{widget.content.period.to | momentDate : "sales/break_even"}}</div>\n\n      <div class="block to-date">\n        <div class="title" translate>impac.widget.sales_break_even.title.sales</div>\n        <div class="price">{{widget.content.sales.to_date | mnoCurrency : widget.content.currency : false}}</div>\n        {{\'impac.widget.sales_break_even.target\' | translate}}: <span class="edit-target" style="float: right;" editable-text="threshold" buttons="no" onaftersave="updateSettings()">\n          {{threshold | mnoCurrency : widget.content.currency : false}}\n        </span>\n      </div>\n\n      <div ng-show="widget.content.break_even" class="block to-breakeven">\n        <div class="title">impac.widget.sales_break_even.title.projection</div>\n        <span ng-show="isTargetMet()" translate>impac.widget.sales_break_even.your_sales</span>\n        <div class="price">{{getVariance() | mnoCurrency : widget.content.currency : false}}</div>\n        <span ng-hide="isTargetMet()">\n          {{\'impac.widget.sales_break_even.projected_date\' | translate}} <span style="float: right;">{{getProjectedDate() | date : \'d-MM-yy\'}}</span>\n          <br />\n          {{\'impac.widget.sales_break_even.opportunities_to_close\' | translate}} <span style="float: right;">{{getOpportunitiesToClose()}}</span>\n        </span>\n      </div>\n      <div ng-show="widget.content.break_even" class="legend">{{widget.content.break_even.eligible_opportunities}} {{\'impac.widget.sales_break_even.eligible_opportunities\' | translate}}</div>\n\n      <div ng-hide="widget.content.break_even" class="block to-breakeven">\n        <span class="edit-target" editable-text="threshold" buttons="no" onaftersave="updateSettings()">\n          <div class="define-text">{{\'impac.widget.sales_break_even.click_to_define\' | translate}}</div>\n        </span>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-comparison.tmpl.html",'<div widget-sales-comparison>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_comparison.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_comparison.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_comparison.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row" >\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="row legend center">\n          {{\'impac.widget.sales_comparison.legend.compare_by\' | translate}} <div setting-param-selector parent-widget="widget" style="display: inline;" param="criteria" options="criteriaOptions" selected="criteria" truncate-no="30" deferred="::paramSelectorDeferred1" />\n           |\n          {{\'impac.widget.sales_comparison.legend.see\' | translate}} <div setting-param-selector parent-widget="widget" style="display: inline;" param="filter" options="filterOptions" selected="filter" truncate-no="30" on-select="widget.format()" no-reload deferred="::paramSelectorDeferred2" />\n        </div>\n\n        <div class="widget-lines-container">\n\n          <div class="row widget-line header">\n            <div class="col-xs-8 sortable-title" ng-click="sort(\'sales\')">\n              {{\'impac.widget.sales_comparison.total_sales_from\' | translate}} {{widget.content.dates[0] | momentDate : widget.metadata.hist_parameters.period}} {{\'impac.widget.sales_comparison.to\' | translate}} {{getLastDate() | momentDate : widget.metadata.hist_parameters.period}}\n              <i ng-show="sortedColumn == \'sales\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-4 text-right sortable-title" ng-click="sort(\'total\')">\n              {{\'impac.widget.sales_comparison.total\' | translate}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <div class="row lines-group" ng-repeat="statement in widget.content.sales_comparison" >\n            <div class="col-xs-12">\n\n              <div class="row widget-line" >\n                <div class="col-xs-1" ng-click="toggleCollapsed(statement)">\n                  <i ng-show="(statement.sales && statement.sales.length)" class="fa" ng-class="isCollapsed(statement) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-7" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{statement.name | titleize}}</strong>\n                </div>\n                <div ng-show="filter.value == \'quantity_sold\'" class="col-xs-4 text-right" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getTotalForPeriod(statement)}}</strong>\n                </div>\n                <div ng-hide="filter.value == \'quantity_sold\'" class="col-xs-4 text-right" ng-click="toggleSelectedElement(statement)">\n                  <strong>{{getTotalForPeriod(statement) | mnoCurrency : statement.currency}}</strong>\n                </div>\n\n                <div class="selection-tag" ng-if="isSelected(statement)" ng-style="{ \'background-color\': getSelectLineColor(statement) }"/>\n              </div>\n\n              <div class="row" uib-collapse="isCollapsed(statement)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-click="toggleSelectedElement(sale, statement.name)" ng-repeat="sale in statement.sales" >\n                    <div class="col-xs-7 col-xs-offset-1">\n                      {{sale.name}}\n                    </div>\n                    <div ng-show="filter.value == \'quantity_sold\'" class="col-xs-4 text-right">\n                      {{getTotalForPeriod(sale)}}\n                    </div>\n                    <div ng-hide="filter.value == \'quantity_sold\'" class="col-xs-4 text-right">\n                      <span common-currency-conversions fx-amounts="sale.formattedFxTotals[filter.value]" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n                      {{getTotalForPeriod(sale) | mnoCurrency : sale.currency}}\n                    </div>\n\n                    <div class="selection-tag" ng-if="isSelected(sale, statement.name)" ng-style="{ \'background-color\': getSelectLineColor(sale, statement.name) }"/>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-show="hasElements()">\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n          </div>\n\n          <div class="widget-lines-container">\n\n            <div class="row widget-line header">\n              <div class="col-xs-12">\n                {{\'impac.widget.sales_comparison.total_sales_from\' | translate}} {{widget.content.dates[0] | momentDate : widget.metadata.hist_parameters.period}} {{\'impac.widget.sales_comparison.to\' | translate}} {{getLastDate() | momentDate : widget.metadata.hist_parameters.period}}\n              </div>\n            </div>\n\n            <div class="row widget-line" ng-repeat="element in selectedElements track by $index">\n              <div class="col-xs-1">\n                <i class="fa fa-circle" ng-style="{ \'color\': getElementChartColor($index) }" />\n              </div>\n              <div class="col-xs-7">\n                {{element.name | titleize}}\n              </div>\n              <div class="col-xs-4 text-right">\n                <i ng-show="filter.value == \'quantity_sold\'">{{getTotalForPeriod(element)}}</i>\n                <i ng-hide="filter.value == \'quantity_sold\'">{{getTotalForPeriod(element) | mnoCurrency : element.currency}}</i>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div ng-hide="hasElements()" class="no-element" translate>impac.widget.sales_comparison.select_sales_category</div>\n\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-customer-details.tmpl.html",'<div widget-sales-customer-details>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_customer_details.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_customer_details.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_customer_details.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred" />\n        <div setting-param-selector parent-widget="widget" param="customer_uid" options="customersOptions" selected="selectedCustomerId" class="row title" deferred="::paramSelectorDeferred" />\n\n        <div class="details-container">\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.email</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.email || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.phone</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.phone || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.website</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.website || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.contact</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.contact || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.city</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.city || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-4"><label translate>impac.widget.sales_customer_details.label.country</label></div>\n            <div class="col-md-8"><pre>{{selectedCustomer.country || \'-\'}}</pre></div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <div class="details-container">\n          <div class="row" style="border-bottom: solid 1px #e6e6e6; margin-bottom: 10px; padding-bottom: 5px;">\n            <div class="col-md-3"><label translate>impac.widget.sales_customer_details.label.address</label></div>\n            <div class="col-md-9"><pre>{{formatAddress(selectedCustomer.full_address) || \'-\'}}</pre></div>\n          </div>\n          <div class="row">\n            <div class="col-md-12 center legend">{{\'impac.widget.sales_customer_details.from\' | translate}} {{getFromDate() | date : \'d MMM yyyy\'}} {{\'impac.widget.sales_customer_details.to\' | translate}} {{getToDate() | date : \'d MMM yyyy\'}}:</div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label translate>impac.widget.sales_customer_details.label.total_invoiced</label></div>\n            <div class="col-md-7">\n              <span common-currency-conversions fx-amounts="selectedCustomer.invoicedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n              <pre>{{selectedCustomer.total_invoiced | mnoCurrency : selectedCustomer.currency}}</pre>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label translate>impac.widget.sales_customer_details.label.total_paid</label></div>\n            <div class="col-md-7">\n              <span common-currency-conversions fx-amounts="selectedCustomer.paidFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n              <pre>{{selectedCustomer.total_paid | mnoCurrency : selectedCustomer.currency}}</pre>\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-5"><label translate>impac.widget.sales_customer_details.label.total_due</label></div>\n            <div class="col-md-7">\n              <span common-currency-conversions fx-amounts="selectedCustomer.dueFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n              <pre>{{selectedCustomer.total_due | mnoCurrency : selectedCustomer.currency}}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-cycle.tmpl.html",'<div widget-sales-cycle>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_cycle.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" param="status_selection" has-reach="hasReach" parent-widget="widget" class="part" deferred="::paramsPickerDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_cycle.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_cycle.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      <div class="legend">\n        <span translate>impac.widget.sales_cycle.your_sales_cycle</span>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-forecast.tmpl.html",'<div widget-sales-forecast>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_forecast.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_forecast.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_forecast.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div class="chart-container">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div class="widget-lines-container">\n\n        <div class="row widget-line header">\n          <div class="col-xs-12" translate>impac.widget.sales_forecast.projection_on</div>\n        </div>\n\n        <div class="row lines-group" ng-repeat="date in widget.content.dates.slice(6) track by $index" ng-init="collapsed = true" >\n          <div class="col-xs-12">\n\n            <div class="row widget-line" ng-class="{main: widget.content.opportunities.slice(6)[$index].length > 0}" ng-click="collapsed = !collapsed" >\n              <div class="col-xs-6">\n                {{date | momentDate : widget.metadata.hist_parameters.period}}\n              </div>\n              <div class="col-xs-6 text-right">\n                <strong>{{widget.content.totals.slice(6)[$index] | mnoCurrency : widget.content.currency}}</strong>\n              </div>\n            </div>\n\n            <div class="row" uib-collapse="collapsed">\n              <div class="col-xs-12">\n                <div class="row widget-line" ng-repeat="opp in widget.content.opportunities.slice(6)[$index]" >\n                  <div class="col-xs-6">\n                    {{opp.name}}\n                  </div>\n                  <div class="col-xs-6 text-right">\n                    {{getOpportunityAmount(opp) | mnoCurrency : getOpportunityCurrency(opp)}}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-growth.tmpl.html",'<div widget-sales-growth>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_growth.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_growth.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_growth.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div class="selector">\n        <div setting-param-selector classic="true" parent-widget="widget" param="product" options="productOptions" selected="product" no-reload on-select="widget.format()" deferred="::paramSelectorDeferred1"/>\n        <div ng-show="product.value != -1" setting-param-selector classic="true" parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred2"/>\n      </div>\n\n      <div class="chart-container" ng-hide="(product.value == -1)">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n      </div>\n\n      <div ng-show="product.value != -1" class="legend text-center">{{getSelectedProduct().displayName}}</div>\n      <div class="price text-center" ng-hide="isDataQuantity || product.value == -1" uib-tooltip="{{\'impac.widget.sales_growth.tooltip.total_for_period\' | translate}}">{{getCurrentValue() | mnoCurrency : getSelectedProduct().currency}}</div>\n      <div class="price text-center" ng-show="isDataQuantity && product.value != -1" uib-tooltip="{{\'impac.widget.sales_growth.tooltip.total_for_period\' | translate}}">{{getCurrentValue()}}</div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-leads-funnel.tmpl.html",'<div widget-sales-leads-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_leads_funnel.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" param="status_selection" has-reach="hasReach" parent-widget="widget" class="part" deferred="::paramsPickerDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_leads_funnel.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_leads_funnel.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="legend">{{\'impac.widget.sales_leads_funnel.legend.your_leads\' | translate}} {{widget.content.from | momentDate : "sales/leads_funnel"}} {{\'impac.widget.sales_leads_funnel.legend.to\' | translate}} {{widget.content.to | momentDate : "sales/leads_funnel"}}</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toggleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency" translate>impac.widget.sales_leads_funnel.select_a_status</div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n\n          <div class="row lines-group widget-line" ng-repeat="lead in getSelectedLeads()" uib-tooltip-html="leadDescriptionTooltips[$index]" tooltip-placement="top" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n            <div class="col-sm-7">\n              {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n              <span ng-show="lead.organization">({{lead.organization}})</span>\n            </div>\n            <div class="col-sm-5 text-right">\n              <strong>{{lead.lead_status | titleize}}</strong>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-leads-list.tmpl.html",'<div widget-sales-leads-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_leads_list.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_leads_list.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_leads_list.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div class="widget-lines-container">\n\n        <div class="row lines-group widget-line" ng-repeat="lead in widget.content.leads | orderBy:ordering" uib-tooltip-html="leadDescriptionTooltips[$index]" tooltip-placement="top" tooltip-animation="false" tooltip-append-to-body="true" tooltip-class="impac-widgets-tooltip">\n          <div class="col-sm-7">\n            {{lead.first_name | titleize}} {{lead.last_name | titleize}}\n            <span ng-show="lead.organization">({{lead.organization}})</span>\n          </div>\n          <div class="col-sm-5 text-right">\n            <strong>{{lead.lead_status | titleize}}</strong>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-list.tmpl.html",'<div widget-sales-list>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_list.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_list.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_list.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="widget-lines-container no-scroll">\n      <div class="row widget-line header">\n        <div class="col-xs-12 text-center">\n          <span setting-dates-picker parent-widget="widget" from="widget.metadata.hist_parameters.from" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred" template="::datesPickerTemplate"/>\n        </div>\n      </div>\n      <div class="row widget-line header">\n        <div class="col-xs-4 text-left sortable-title" ng-click="sort(\'account\')">\n          {{\'impac.widget.sales_list.products\' | translate}}\n          <i ng-show="sortedColumn == \'account\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n        </div>\n        <div class="col-xs-4 text-center">\n          <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred" />\n        </div>\n        <div class="col-xs-4 text-right sortable-title" ng-click="sort(\'total\')">\n          {{\'impac.widget.sales_list.total\' | translate}}\n          <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n        </div>\n      </div>\n    </div>\n\n    <div class="widget-lines-container">\n\n      <div class="row lines-group" ng-repeat="company in widget.content.summary" >\n        <div class="col-xs-12">\n\n          <div class="row widget-line" >\n            <div class="col-xs-1" ng-click="toggleCollapsed(company.name)" style="cursor: pointer;">\n              <i class="fa" ng-class="isCollapsed(company.name) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n            </div>\n            <div class="col-xs-7">\n              <strong>{{company.name | titleize}}</strong>\n            </div>\n            <div class="col-xs-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}">\n              <strong>{{company.total}}</strong>\n            </div>\n            <div class="col-xs-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}">\n              <strong>{{company.total | mnoCurrency : company.currency}}</strong>\n            </div>\n          </div>\n\n        <div class="row" uib-collapse="isCollapsed(company.name)">\n          <div class="col-xs-12">\n            <div class="row widget-line" ng-repeat="product in company.products" >\n              <div class="col-xs-7 col-xs-offset-1">\n                {{product.name | titleize}}\n              </div>\n              <div class="col-xs-4 text-right" ng-show="{{filter.value.match(\'quantity\')}}">\n                <strong>{{product.total}}</strong>\n              </div>\n              <div class="col-xs-4 text-right" ng-hide="{{filter.value.match(\'quantity\')}}">\n                <span common-currency-conversions fx-amounts="product.formattedFxTotals" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n                <strong>{{product.total | mnoCurrency : product.currency}}</strong>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div ng-show="widget.demoData" common-data-not-found />\n</div>\n'),e.put("widgets/sales-margin.tmpl.html",'<div widget-sales-margin>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.sales_margin.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_margin.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_margin.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n    <div>\n      <div setting-hist-mode parent-widget= "widget" deferred="::histModeDeferred" />\n\n      <div ng-hide="widget.isHistoryMode" class="current">\n        <div class="price">\n           {{ getTotalMargin() | mnoCurrency : getCurrency()}}\n        </div>\n        <div class="legend">\n          {{\'impac.widget.sales_margin.total_sold_and_purchased\' | translate}}\n          </br>\n          <div setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" no-reload on-select="widget.format()" deferred="::paramSelectorDeferred" />\n        </div>\n      </div>\n\n      <div class="history chart-container" ng-show="widget.isHistoryMode">\n        <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        <div class="legend" translate>impac.widget.sales_margin.total_sold_and_purchased</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-net-sales.tmpl.html",'<div widget-sales-net-sales>\n\n  <div ng-show="widget.isEditMode" class="edit">\n    <h4 translate>impac.widget.sales_net_sales.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_net_sales.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_net_sales.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row selector">\n      <div class="col-xs-12 text-right">\n        <span setting-param-selector parent-widget="widget" param="display_type" options="displayOptions" selected="displayType" no-reload="true" deferred="::paramSelector1Deferred" /> |\n        <span setting-param-selector parent-widget="widget" param="time_range" options="timeRangeOptions" selected="timeRange" deferred="::paramSelector2Deferred" />\n      </div>\n    </div>\n\n    <div>\n\n      <div class="row text-center values">\n        <div class="value-container col-md-3 col-md-offset-0 col-xs-10 col-xs-offset-2">\n          <div class="title" translate>impac.widget.sales_net_sales.title.sales</div>\n          <div class="value-box">\n            {{ getValue(\'sales\') }}\n          </div>\n        </div>\n        <div class="operator col-md-1 col-xs-2">\n          <span>{{ sign(\'minus\') }}</span>\n        </div>\n        <div class="value-container col-md-3 col-xs-10">\n          <div class="title" translate>impac.widget.sales_net_sales.title.returns</div>\n          <div class="value-box">\n            {{ getValue(\'returns\') }}\n          </div>\n        </div>\n        <div class="operator col-md-1 col-xs-2">\n          <span>{{ sign(\'equal\') }}</span>\n        </div>\n        <div class="value-container col-md-4 col-xs-10">\n          <div class="title" translate>impac.widget.sales_net_sales.title.net_result</div>\n          <div class="value-box">\n            {{ getValue(\'net_result\') }}\n          </div>\n        </div>\n      </div>\n\n  </div>\n\n  <div ng-show="widget.demoData" common-data-not-found />\n</div>\n'),e.put("widgets/sales-new-vs-existing-customers.tmpl.html",'<div widget-sales-new-vs-existing-customers>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_new_vs_existing.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_new_vs_existing.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_new_vs_existing.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="selector">\n      <div class="selector-wrap">\n        <span setting-param-selector parent-widget="widget" param="display_type" options="displayOptions" selected="displayType" on-select="displayTypeOnClick()" no-reload="true" deferred="::displayTypeParamSelectorDeferred" />\n      </div>\n      <div class="selector-wrap">\n        <span setting-param-selector parent-widget="widget" param="time_range" options="timeRangeOptions" selected="timeRange" deferred="::timeRangeParamSelectorDeferred" />\n      </div>\n    </div>\n\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n    </div>\n\n    <div class="legend">\n      <div class="row positive2">\n        <div class="col-xs-7 text-left" translate>impac.widget.sales_new_vs_existing.new_customers</div>\n        <div class="col-xs-5 text-right">{{getValue(\'new\')}}</div>\n      </div>\n      <div class="row negative2">\n        <div class="col-xs-7 text-left" translate>impac.widget.sales_new_vs_existing.existing_customers</div>\n        <div class="col-xs-5 text-right">{{getValue(\'existing\')}}</div>\n      </div>\n      <div class="row total">\n        <div class="col-xs-7 text-left" translate>impac.widget.sales_new_vs_existing.total</div>\n        <div class="col-xs-5 text-right">{{getValue(\'total\')}}</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-number-of-leads.tmpl.html",'<div widget-sales-number-of-leads>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_number_of_leads.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_number_of_leads.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_number_of_leads.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="align-center">\n      <div class="selector">\n        {{\'impac.widget.sales_number_of_leads.leads_for_this\' | translate}} <span setting-param-selector parent-widget="widget" param="period" options="periodOptions" selected="period" deferred="::paramSelectorDeferred" />\n      </div>\n\n      <div class="stats">\n        <div class="stat row align-left" ng-repeat="carac in [\'new\', \'converted\', \'lost\']">\n          <div class="col-md-6 title" style="padding: 0px;">{{carac | titleize}}</div>\n          <div class="col-md-6" style="padding: 0px;">\n            <span class="variation" ng-class="formatNumberOfLeads(carac).color">{{formatNumberOfLeads(carac).variation}}</span>\n            <span class="nominal">{{formatNumberOfLeads(carac).nominal}}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class="legend">\n      {{widget.content.number_of_leads.total[1]}} {{\'impac.widget.sales_number_of_leads.leads_in_total\' | translate}}\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-opportunities-funnel.tmpl.html",'<div widget-sales-opportunities-funnel>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_funnel.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-params-picker options="statusOptions" has-reach="hasReach" param="sales_stage_selection" parent-widget="widget" class="part" deferred="::paramsPickerDeferred1" />\n    <div setting-params-picker options="assigneesOptions" has-reach="hasReach" param="assignees_selection" parent-widget="widget" class="part" deferred="::paramsPickerDeferred2" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_funnel.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_funnel.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\': \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred" />\n\n        <div class="legend" translate>impac.widget.sales_funnel.legend</div>\n\n        <div class="funnel-container">\n          <div class="tile" ng-repeat="elem in funnel" ng-click="toggleSelectStatus(elem.status)">\n            <div class="colored-area" ng-style="elem.coloredWidth" ng-class="isSelected(elem.status) ? \'selected\' : \'\'">{{elem.number}}</div>\n            <div class="main-text" ng-style="elem.statusWidth">{{elem.status | titleize}}</div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedStatus" class="currency" translate>impac.widget.sales_funnel.select_a_sales</div>\n\n        <div ng-show="selectedStatus" class="widget-lines-container">\n\n          <!-- Header -->\n          <div class="row widget-line header">\n            <div class="col-xs-6 sortable-title" ng-click="sort(\'group\')">\n              {{\'impac.widget.sales_funnel.assignees_opportunities\' | translate}}\n              <i ng-show="sortedColumn == \'group\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n            <div class="col-xs-6 text-right sortable-title" ng-click="sort(\'total\')">\n              {{\'impac.widget.sales_funnel.potential_per_assignee\' | translate}}\n              <i ng-show="sortedColumn == \'total\'" class="fa" ng-class="ascending ? \'fa-sort-alpha-asc\' : \'fa-sort-alpha-desc\'" />\n            </div>\n          </div>\n\n          <div class="row lines-group widget-line" ng-repeat="group in selectedOpportunities">\n            <div class="col-xs-12">\n\n              <!-- Assignee lines -->\n              <div class="row widget-line" ng-click="toggleCollapsed(group)">\n                <div class="col-xs-1">\n                  <i class="fa" ng-class="isCollapsed(group) ? \'fa-plus-square-o\' : \'fa-minus-square-o\'" />\n                </div>\n                <div class="col-xs-6">\n                  <strong>{{group.assigneeName | titleize}}</strong>\n                </div>\n                <div class="col-xs-5 text-right">\n                  <strong>{{getTotal(group.opps)}}</strong>\n                </div>\n              </div>\n\n              <!-- Opportunity lines -->\n              <div class="row" uib-collapse="isCollapsed(group)">\n                <div class="col-xs-12">\n                  <div class="row widget-line" ng-repeat="opp in group.opps">\n                    <div class="col-xs-6 col-xs-offset-1">\n                      {{opp.name | titleize}}\n                    </div>\n                    <div class="col-xs-5 text-right">\n                      <strong>{{getOppDetails(opp)}}</strong>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-performance.tmpl.html",'<div widget-sales-performance>\n\n  <!-- Edit panel -->\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_performance.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred"></div>\n\n    <div setting-params-picker options="closedWonOptions" param="closed_won_selection" parent-widget="widget" class="part" deferred="::paramsWinsPickerDeferred" description="{{\'impac.widget.sales_performance.description.pick_the_status\' | translate}}"></div>\n\n    <div setting-params-picker options="closedLostOptions" param="closed_lost_selection" parent-widget="widget" class="part" deferred="::paramsLostsPickerDeferred" description="{{\'impac.widget.sales_performance.description.pick_the_status_lost\' | translate}}"></div>\n\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" ></div>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_performance.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_performance.save</button>\n    </div>\n  </div>\n\n\n  <!-- Widget front -->\n  <div ng-hide="widget.isEditMode">\n\n    <div class="row">\n\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="6" max="12" class="settings width" deferred="::widthDeferred"></div>\n\n        <div class="widget-lines-container">\n          <div class="row widget-line header">\n            <div class="col-xs-5">\n              {{\'impac.widget.sales_performance.from\' | translate}} {{widget.content.dates[0] | momentDate : widget.metadata.hist_parameters.period}} {{\'impac.widget.sales_performance.to\' | translate}} {{widget.content.dates[widget.content.dates.length - 1] | momentDate : widget.metadata.hist_parameters.period}}\n            </div>\n            <div class="col-xs-3 text-right" translate>impac.widget.sales_performance.win_ratio</div>\n            <div class="col-xs-4 text-right" translate>impac.widget.sales_performance.total_won</div>\n          </div>\n\n          <div class="row lines-group" ng-repeat="assignee in widget.content.assignees" ng-click="toggleSelectedElement(assignee)" >\n            <div class="col-xs-12">\n              <div class="row widget-line">\n                <div class="col-xs-5">{{assignee.name | titleize}}</div>\n                <div class="col-xs-3 text-right">{{assignee.win_ratio}} %</div>\n                <div class="col-xs-4 text-right">{{assignee.total_won | mnoCurrency: widget.metadata.currency}}</div>\n                <div class="selection-tag" ng-if="isSelected(assignee)" ng-style="{ \'background-color\': getSelectLineColor(assignee) }"/>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-6 right-panel text-center" ng-show="widget.isExpanded()">\n\n        <div ng-hide="selectedElements.length > 0" class="no-element" translate>impac.widget.sales_performance.select_an_employee</div>\n\n        <div ng-show="no_sales_stages_selected()" class="no-element" translate>impac.widget.sales_performance.pick_the_status</div>\n\n        <div ng-show="selectedElements.length > 0 && !no_sales_stages_selected()">\n          <div class="chart-container">\n            <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n            <div class="legend">{{\'impac.widget.sales_performance.total_won_with_colon\' | translate}} {{getTotalWon() | mnoCurrency : widget.metadata.currency}}</div>\n          </div>\n\n          <div class="widget-lines-container" ng-init="collapsedAll=false">\n            <div ng-repeat="selectedElement in selectedElements track by $index">\n              <div class="row widget-line header" ng-click="collapsedAll=!collapsedAll">\n                <div class="col-xs-8">\n                  <i class="fa fa-circle" ng-style="{ \'color\': getElementChartColor($index) }"></i>\n                  {{selectedElement.name | titleize}}\n                </div>\n                <div class="col-xs-4 text-right">{{selectedElement.total_won | mnoCurrency: widget.metadata.currency}}</div>\n              </div>\n\n              <div uib-collapse="collapsedAll">\n                <div class="row lines-group" ng-init="collapsedForecast=false" ng-hide="selectedElement.opps.forecast.length == 0" >\n                  <div class="col-xs-12">\n                    <div class="row widget-line" ng-click="collapsedForecast=!collapsedForecast">\n                      <div class="col-xs-10">\n                        <strong translate>impac.widget.sales_performance.forecast</strong>\n                      </div>\n                      <div class="col-xs-2 text-right">\n                        <strong>{{selectedElement.opps.forecast.length}}</strong>\n                      </div>\n                    </div>\n\n                    <div class="row" uib-collapse="collapsedForecast">\n                      <div class="col-xs-12">\n                        <div class="row widget-line no-select" ng-repeat="opp in selectedElement.opps.forecast" >\n                          <div class="col-xs-4">{{opp.name}}</div>\n                          <div class="col-xs-2 text-right">{{opp.probability | number :0 }} %</div>\n                          <div class="col-xs-3 text-right">{{getForecastCloseDate(opp)}}</div>\n                          <div class="col-xs-3 text-right">{{(opp.amount.amount) | mnoCurrency : opp.amount.currency}}</div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div class="row lines-group" ng-init="collapsedWon=false">\n                  <div class="col-xs-12">\n                    <div class="row widget-line" ng-click="collapsedWon=!collapsedWon">\n                      <div class="col-xs-10">\n                        <strong translate>{{\'impac.widget.sales_performance.closed_won\' | translate}}</strong>\n                      </div>\n                      <div class="col-xs-2 text-right">\n                        <strong>{{selectedElement.opps.won.length}}</strong>\n                      </div>\n                    </div>\n\n                    <div class="row" uib-collapse="collapsedWon">\n                      <div class="col-xs-12">\n                        <div class="row widget-line no-select" ng-repeat="opp in selectedElement.opps.won">\n                          <div class="col-xs-6">{{opp.name}}</div>\n                          <div class="col-xs-3 text-right">{{getCloseDate(opp)}}</div>\n                          <div class="col-xs-3 text-right">{{opp.amount.amount | mnoCurrency : opp.amount.currency}}</div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div class="row lines-group" ng-init="collapsedLost=false">\n                  <div class="col-xs-12">\n                    <div class="row widget-line" ng-click="collapsedLost=!collapsedLost">\n                      <div class="col-xs-10">\n                        <strong translate>impac.widget.sales_performance.closed_lost</strong>\n                      </div>\n                      <div class="col-xs-2 text-right">\n                        <strong>{{selectedElement.opps.lost.length}}</strong>\n                      </div>\n                    </div>\n\n                    <div class="row" uib-collapse="collapsedLost">\n                      <div class="col-xs-12">\n                        <div class="row widget-line no-select" ng-repeat="opp in selectedElement.opps.lost" >\n                          <div class="col-xs-6">{{opp.name}}</div>\n                          <div class="col-xs-3 text-right">{{getCloseDate(opp)}}</div>\n                          <div class="col-xs-3 text-right">{{opp.amount.amount | mnoCurrency : opp.amount.currency}}</div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n</div>\n'),e.put("widgets/sales-segmented-turnover.tmpl.html",'<div widget-sales-segmented-turnover>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_turnover.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-time-period parent-widget="widget" class="part" deferred="::timePeriodDeferred" hist-params="widget.metadata.hist_parameters" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_turnover.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_turnover.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="row">\n      <div ng-class="widget.isExpanded() ? \'col-md-6\' : \'col-md-12\'">\n        <div setting-width parent-widget="widget" min="3" max="6" class="settings width" deferred="::widthDeferred"></div>\n\n        <div class="selector">{{\'impac.widget.sales_turnover.filter\' | translate}} <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred"/></div>\n        <div class="chart-container">\n          <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n        </div>\n\n        <div class="widget-lines-container">\n\n          <div class="row widget-line header">\n            <div class="col-xs-12" translate>impac.widget.sales_turnover.average_price</div>\n          </div>\n\n          <div class="row widget-line" ng-repeat="range in widget.content.ranges">\n            <div class="col-xs-2">\n              <i class="fa fa-circle" ng-style="{ \'color\': getColorByIndex($index) }" />\n            </div>\n            <div class="col-xs-7">\n              {{getRangeLabel(range.label)}}\n            </div>\n            <div class="col-xs-3 text-right">\n              <i>{{range.percentage}}%</i>\n            </div>\n          </div>\n        </div>\n\n      </div>\n\n      <div class="col-md-6 right-panel" ng-show="widget.isExpanded()">\n        <i class="fa fa-info-circle" uib-tooltip="{{\'impac.widget.sales_turnover.tooltip.widget_segment\' | translate}}" />\n        <h3>{{getMaxRange().percentage.toFixed()}}% {{\'impac.widget.sales_turnover.of_your_revenue\' | translate}} {{getMaxRange().label.split(\'-\')[0] | mnoCurrency : widget.content.currency}} {{\'impac.widget.sales_turnover.and\' | translate}} {{getMaxRange().label.split(\'-\')[1] | mnoCurrency : widget.content.currency}}.</h3>\n        <div class=\'analysis hidden-md\'>{{::analysisTranslate}}</div>\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-summary.tmpl.html",'<div widget-sales-summary>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_summary.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-chart-filters parent-widget="widget" class="part" deferred="::chartFiltersDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_summary.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_summary.save</button>\n    </div>\n  </div>\n\n  <div align="center" ng-hide="widget.isEditMode">\n\n    <div class="selector">\n      <span setting-param-selector parent-widget="widget" param="filter" options="filterOptions" selected="filter" deferred="::paramSelectorDeferred" />\n      <span setting-dates-picker parent-widget="widget" from="widget.metadata.hist_parameters.from" to="widget.metadata.hist_parameters.to" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred" template="::datesPickerTemplate"/>\n    </div>\n\n    <div class="chart-container">\n      <div impac-chart draw-trigger="::drawTrigger.promise" deferred="::chartDeferred"></div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-top-customers.tmpl.html",'<div widget-sales-top-customers>\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_top_customers.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n    <div setting-dates-picker parent-widget="widget" class="part" from="(widget.metadata.hist_parameters.from || defaultFrom)" to="(widget.metadata.hist_parameters.to || defaultTo)" keep-today="widget.metadata.hist_parameters.keep_today" deferred="::datesPickerDeferred"/>\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_top_customers.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_top_customers.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode" class="widget-lines-container">\n\n    <div class="row selector">\n      <div class="col-xs-12 text-right">\n        <a ng-click="toggleTransactions()">{{transactionsCollapsed ? \'impac.widget.sales_top_customers.show\' : \'impac.widget.sales_top_customers.hide\' | translate}} {{\'impac.widget.sales_top_customers.details\' | translate}}</a> |\n        <div setting-param-selector parent-widget="widget" param="limit_entries" options="limitEntriesOptions" selected="limitEntriesSelected" class="param-selector" deferred="::paramSelectorDeferred" no-reload/>\n      </div>\n    </div>\n\n    <!-- Header line -->\n    <div class="row widget-line header">\n      <div class="col-xs-1">\n        #\n      </div>\n      <div class="col-xs-7" translate>impac.widget.sales_top_customers.customer_name</div>\n      <div class="col-xs-4 text-right">\n        <div setting-param-selector parent-widget="widget" param="header" options="headerOptions" selected="headerSelected" class="param-selector" deferred="::paramSelectorDeferred" no-reload />\n      </div>\n    </div>\n\n    <!-- Content lines -->\n    <div class="row lines-group" ng-repeat="entity in getEntities() | limitTo: limitEntriesSelected.value">\n      <div class="col-xs-12">\n\n        <div class="row widget-line">\n          <div class="col-xs-2">\n            {{$index + 1}}\n          </div>\n          <div class="col-xs-6">\n            <b>{{entity.name}}</b>\n          </div>\n          <div class="col-xs-4 text-right">\n            <b ng-if="getHeaderField().showCurrency">\n              <span common-currency-conversions fx-amounts="getHeaderField().getFormattedFxTotals(entity)" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n              {{ getHeaderField().getValue(entity) | mnoCurrency : entity.currency }}\n            </b>\n            <b ng-if="!getHeaderField().showCurrency">\n              {{ getHeaderField().getValue(entity) }}\n            </b>\n          </div>\n        </div>\n\n        <div class="row widget-line sub-line" uib-collapse="transactionsCollapsed">\n          <div class="col-xs-4" ng-repeat="field in getRemainingFields() track by $index" ng-class="{\'text-center\': ($index==1), \'text-right\': ($index==2)}" >\n            <i ng-if="field.showCurrency">\n              {{field.label}}: {{field.getValue(entity) | mnoCurrency : entity.currency}}\n              <span common-currency-conversions fx-amounts="field.getFormattedFxTotals(entity)" base-currency="widget.metadata.currency" rates-date="ratesDate" />\n            </i>\n            <i ng-if="!field.showCurrency">{{field.label}}: {{field.getValue(entity)}}</i>\n          </div>\n        </div>\n\n      </div>\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets/sales-top-opportunities.tmpl.html",'<div widget-sales-top-opportunities>\n\n  <div class="edit" ng-show="widget.isEditMode">\n    <h4 translate>impac.widget.sales_opportunities.settings.title</h4>\n\n    <div setting-organizations parent-widget="widget" class="part" deferred="::orgDeferred" />\n\n    <div class="bottom-buttons" align="right">\n      <button class="btn btn-default" ng-click="initSettings()" translate>impac.widget.sales_opportunities.cancel</button>\n      <button class="btn btn-warning" ng-click="updateSettings()" translate>impac.widget.sales_opportunities.save</button>\n    </div>\n  </div>\n\n  <div ng-hide="widget.isEditMode">\n\n    <div>\n\n      <div class="legend">\n        {{\'impac.widget.sales_opportunities.total_potential\' | translate}} <b>{{widget.content.total_potential | mnoCurrency : widget.content.currency || "AUD"}}</b> - <b>{{widget.content.eligible_opportunities}}</b> {{\'impac.widget.sales_opportunities.eligible_opportunities\' | translate}}\n      </div>\n\n      <div class="opps-container">\n        <div class="tile" ng-repeat="opp in widget.content.opportunities track by $index" ng-class="getOppClass($index)">\n          <div class="colored-area">{{$index +1 }}</div>\n          <div class="main-text">\n            {{opp.name | titleize}}\n            <br />\n            <i style="font-size: 13px;">{{getOppDetails(opp)}}</i>\n          </div>\n        </div>\n      </div>\n\n    </div>\n\n    <div ng-show="widget.demoData" common-data-not-found />\n  </div>\n\n</div>\n'),e.put("widgets-settings/account.tmpl.html",'<h5 ng-if="showLabel">{{label}}</h5>\n<div class="input-group settings select-account">\n	<select ng-model="parentWidget.selectedAccount" ng-change="onAccountSelected()" ng-options="formatLabel(account) group by account.classification for account in parentWidget.content.account_list track by account.uid" class="form-control" />\n</div>\n'),e.put("widgets-settings/accounting-behaviour.tmpl.html",'<h5 translate>impac.widget.settings.account.label.accounting_behaviour</h5>\n<div class="settings accounting-behaviour">\n\n<div class="row">\n  <div class="col-md-12 text-center">\n    <div class="btn-group">\n      <label class="btn btn-primary" ng-model="selectedBehaviour" uib-btn-radio="\'bls\'" translate>impac.widget.settings.accounting_behaviour.balance_sheet</label>\n      <label class="btn btn_primary" ng-model="selectedBehaviour" uib-btn-radio="\'pnl\'" translate>impac.widget.settings.accounting_behaviour.p_and_l</label>\n    </div>\n  </div>\n</div>\n\n</div>\n'),e.put("widgets-settings/attach-kpis.tmpl.html",'<div class="settings attach-kpis">\n\n  <div class="attach-kpi">\n    <h5 translate>impac.widget.settings.attach_kpis.attach_an_alert</h5>\n    <form name="attachKpiForm" class=\'attach-kpi-form\'>\n      <!-- <div class="row nomargin">\n        <select class="form-control input-sm" ng-model="kpi.endpoint" ng-options="kpi.endpoint as formatKpiName(kpi.endpoint) for kpi in availableKpis" ng-change="selectKpi()"></select>\n      </div>\n      <div class="row nomargin">\n        <div class="extra-params" ng-repeat="(param, paramValues) in kpi.possibleExtraParams track by $index">\n          <select class="form-control input-sm" name="{{param}}" ng-model="kpi.extra_params[param]" ng-options="value.id as value.label for value in paramValues" ng-init="kpi.extra_params[param] = paramValues[0].id"></select>\n        </div>\n      </div> -->\n      <div class="row nomargin kpi-description">\n        <!-- TODO: support for multiple extra params, and watchables. -->\n        {{\'impac.widget.settings.attach_kpis.keep_the\' | translate}} {{elementWatched}} <span ng-if="showExtraParam">{{\'impac.widget.settings.attach_kpis.of\' | translate}} {{extraParams[selectedParam].name}}</span>:\n      </div>\n      <div class="row nomargin">\n        <div class="col-xs-5 nopadding">\n          <select class="pull-left form-control input-sm" ng-model="kpi.limit.mode" ng-options="option.mode as option.label for option in possibleTargets" ></select>\n        </div>\n        <div class="form-group col-xs-5 nopadding nomargin" ng-class="attachKpiForm.limitValue.$valid ? \'has-success\' : \'has-error\'">\n          <input name="limitValue" type="text" pattern="-?[0-9]+" class="form-control input-sm attach-target" ng-model="kpi.limit.value" required>\n          <!-- TODO: return possible units from API? -->\n          <!-- <span class="form-control-feedback" aria-hidden="true">{{kpi.data.unit}}</span> -->\n          <div class="error-messages limit" ng-messages="attachKpiForm.limitValue.$error">\n            <span ng-message="required" translate>impac.widget.settings.attach_kpis.kpi_target_require</span>\n            <span ng-message="pattern" translate>impac.widget.settings.attach_kpis.kpi_target_number</span>\n          </div>\n        </div>\n        <div class="col-xs-2 nopadding">\n          <button class="btn btn-primary input-sm" ng-click="attachKpi()" ng-disabled="!hasValidTarget()"><i class="fa fa-plus"></i></button>\n        </div>\n      </div>\n    </form>\n  </div>\n\n  <div class="list-group attached-kpis" ng-show="attachedKpis.length">\n    <h5 translate>impac.widget.settings.attach_kpis.attached_alerts</h5>\n    <div class="list-group-item clearfix attached-kpi" ng-repeat="kpi in attachedKpis track by $index">\n      <div class="attached-kpi-name">{{\'impac.widget.settings.attach_kpis.keep\' | translate}} {{formatAttachedKpiTitle(kpi) | titleize}}</div>\n      <div class="pull-right actions">\n        <alerts-config kpi="kpi"></alerts-config>\n        <div class="remove-attached-kpi" ng-click="deleteKpi(kpi)">\n          <i class="fa fa-times"></i>\n        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n'),e.put("widgets-settings/bolt-account.tmpl.html",'<h5 ng-if="showLabel">{{label}}</h5>\n<div class="input-group settings select-account">\n	<select ng-model="parentWidget.selectedAccount" ng-change="onAccountSelected()" ng-options="formatLabel(account) for account in parentWidget.accountList track by account.name" class="form-control">\n	</select>\n</div>\n'),e.put("widgets-settings/chart-filters.tmpl.html",'<div class="settings chart-filters">\n  <h5 translate>impac.widget.settings.chart_filters.title</h5>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="number">\n      <label for="number" ng-click="filterCriteria = \'number\'" translate="impac.widget.settings.chart_filters.filter_number" translate-values="{number: filterValueNumber, entityType: entityType}"></label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValueNumber" ng-change="filterCriteria = \'number\'" min="3" max="{{maxEntities}}" step="1">\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <input type="radio" ng-model="filterCriteria" value="percentage">\n      <label for="percentage" ng-click="filterCriteria = \'percentage\'" translate="impac.widget.settings.chart_filters.filter_percentage" translate-values="{percentage: filterValuePercentage, entityType: filterLabel}"></label>\n    </div>\n    <div class="col-md-6">\n      <input type="range" ng-model="filterValuePercentage" ng-change="filterCriteria = \'percentage\'" min="20" max="100" step="5">\n    </div>\n  </div>\n</div>\n'),e.put("widgets-settings/dates-picker.tmpl.html",'<span class="settings dates-picker">\n  <h5 ng-if="showTitle()" translate>impac.widget.settings.dates_picker.title</h5>\n  <span id="template-container" />\n</span>\n'),e.put("widgets-settings/hist-mode.tmpl.html",'<div class="settings hist-mode-choser">\n  <div common-time-period-info context="forwardParams" />\n\n  <div align="center" class="options" ng-show="!parentWidget.isLiveBalance">\n    <a ng-click="toggleHistMode(\'current\')" ng-class="!parentWidget.isHistoryMode ? \'active\' : \'inactive\'">{{currentLabel}} </a> |\n    <a ng-click="toggleHistMode(\'history\')" ng-class="parentWidget.isHistoryMode ? \'active\' : \'inactive\'" translate>impac.widget.settings.hist.history</a>\n  </div>\n\n  <div class="{{parentWidget.isHistoryMode ? \'arrow-container right\' : \'arrow-container left\'}}" ng-show="!parentWidget.isLiveBalance">\n    <div class="arrow" />\n    <div class="arrow-border" />\n  </div>\n</div>\n'),e.put("widgets-settings/limit-entries.tmpl.html",'<div class="settings limit-entries">\n  {{ (entriesLabel ? \'impac.widget.settings.limit_entries.top\' : \'impac.widget.settings.limit_entries.display\') | translate }}\n\n  <span ng-repeat="option in options | filter:isOptionValid:option track by $index">\n    {{ $index!=0 ? \' |\' : \'\' }} \n    <a target=\'#\' ng-click="selectOption(option)" class="option" ng-class="{badge: option==selected}">{{ option }}</a>\n  </span>\n\n  <span ng-if="max">\n    | \n    <a target=\'#\' ng-click="selectOption(max)" class="option" ng-class="{badge: (!selected || selected==max)}">{{ max }}</a>\n  </span>\n\n   {{entriesLabel || (\'impac.widget.settings.limit_entries.entries\' | translate)}}\n</div>'),e.put("widgets-settings/offsets.tmpl.html",'<div class="settings offsets">\n  <div ng-repeat="offsetValue in offsets track by $index" class="offset-value text-right">\n    <i class="fa fa-trash-o pull-left" ng-click="removeOffset($index)" title="Remove offset"/>\n    + <span ng-if="showIntervalsMult">{{ intervalsCount }} {{ periodWord }}{{ intervalsCount > 1 ? \'s\' : \'\' }} x </span>{{ offsetValue | mnoCurrency : currency}}\n  </div>\n\n  <div class="form-group">\n    <button class="btn btn-sm btn-success" ng-click="addOffset()" title="Add offset">\n      <i class="fa fa-plus" />\n    </button>\n    <input type="text" class="form-control input-sm pull-right text-right" placeholder="{{ placeholder }}" ng-model="offsetFormula" ng-keyup="addOffsetOnEnter($event)">\n  </div>\n</div>\n'),e.put("widgets-settings/organizations.tmpl.html",'<div class="settings organizations">\n  <h5 translate>impac.widget.settings.organizations.select_companies</h5>\n\n  <div class="widget-lines-container">\n    <div class="widget-line" ng-repeat="org in dashboardOrganizations">\n      {{org.label}}\n      <i ng-show="multiOrgMode()" ng-class="isOrganizationSelected(org.uid) ? \'fa fa-toggle-on\' : \'fa fa-toggle-off\'" ng-click="toggleSelectOrganization(org.uid)" uib-tooltip="{{isOrganizationSelected(org.uid) ? \'disable\' : \'enable\'}}" tooltip-append-to-body="true" />\n\n      <i ng-show="singleOrgMode()" ng-class="isOrganizationSelected(org.uid) ? \'fa fa-check-circle\' : \'fa fa-circle-thin\'" ng-click="toggleSelectOrganization(org.uid)" />\n    </div>\n  </div>\n</div>\n'),e.put("widgets-settings/param-selector-classic.tmpl.html",'<span class="settings param-selector classic" ng-if="selected != undefined">\n  <select ng-options="option as option.label for option in options track by option.value" ng-model="$parent.selectedOption" ng-change="selectOption(selectedOption)" ng-init="onInit()">\n  </select>\n</span>\n'),e.put("widgets-settings/param-selector.tmpl.html",'<span class="settings param-selector">\n	<a ng-click="toggleShowOptions()">{{((selected.labelTranslate | translate | titleize) || (selected.label | titleize)) | truncate : getTruncateValue() : "..." : false}} <i class="fa fa-chevron-down" /></a>\n	<div class="options-container" uib-collapse="!showOptions">\n		<div ng-repeat="option in options" ng-click="selectOption(option)" class="param-selector-label">\n			{{(option.labelTranslate | translate | titleize) || (option.label | titleize)}}\n		</div>\n	</div>\n</span>\n'),e.put("widgets-settings/params-checkboxes.tmpl.html",'<div ng-repeat="parameter in options track by $index" class="settings params-checkboxes">\n  <label>\n    <input type="checkbox" ng-model="parameter.value" ng-change="parameter.onChangeCallback()">\n    <span>{{parameter.label}}</span>\n  </label>\n</div>\n'),e.put("widgets-settings/params-picker.tmpl.html",'<h5>{{formattedParam | titleize}}</h5>\n<div class="settings params-picker">\n  <div style="margin-bottom: 8px;">{{description}}</div>\n  <div ui:sortable="sortableOptions" ng-model="options" class="input-group">\n    <span ng-repeat="parameter in options track by $index" class="parameter" ng-class="!parameter.selected ? \'unchecked\' : \'\'">\n      <span class="badge">{{$index + 1}}</span>\n      {{parameter.label | titleize}}\n      <input type="checkbox" ng-model="parameter.selected" />\n    </span>\n  </div>\n  <div ng-show="hasReach">\n    <label><strong translate>impac.widget.settings.params-picker.apply_to_all</strong> <input type="checkbox" ng-change="toggleReach()" ng-model="applyToDashboard"></label>\n  </div>\n</div>\n'),e.put("widgets-settings/tag-filter.tmpl.html",'<h5 translate>impac.widget.settings.tag-filter.filter_title</h5>\n<div class="settings tag-filter" >\n\n  <div class="tag-lines-container">\n    <div class="row tag-line" ng-repeat="rule in settingsTags" >\n      <div class="col-xs-2">\n        <span style="font-weight: bold;" ng-hide="$index>0" translate>impac.widget.settings.tag-filter.add_filter</span>\n        <span ng-hide="$index==0">AND</span>\n      </div>\n      <div class="col-xs-8 tags-col">\n        <tags-input ng-model="rule.tags" replace-spaces-with-dashes="false" add-from-autocomplete-only="true">\n          <auto-complete source="loadTagList($query)" min-length="1" max-results-to-show="5" debounce-delay="0" load-on-down-arrow="true"></auto-complete>\n        </tags-input>\n      </div>\n      <div class="col-xs-2 text-center">\n        <button class="btn btn-sm btn-default" ng-click="delRule($index)" title="Remove filter">-</button>\n      </div>\n    </div>\n\n    <div class="row">\n      <div class="col-xs-2 text-center">\n        <button class="btn btn-sm btn-default" ng-click="addRule()" title="Add filter">+</button>\n      </div>\n    </div>\n  </div>\n</div>\n'),e.put("widgets-settings/time-period.tmpl.html",'<h5 translate>impac.widget.settings.time_period.title</h5>\n<div class="settings time-period" ng-if="timePeriodSetting">\n\n  <!-- Time range -->\n  <div class="row">\n    <div class="col-xs-12">\n      <strong translate>impac.widget.settings.time_period.time_range</strong>\n      <div setting-time-presets parent-widget="timePeriodSetting" deferred="::timePresetsDeferred" on-select="applyPreset(histParams)" presets="presets" on-choose-dates="useDatesPicker()" on-choose-period="useTimeSlider()" hist-params="histParams" reset-promise="resetPreset.promise" />\n    </div>\n  </div>\n\n  <!-- Dates pickers -->\n  <div class="row" ng-show="isDatesPickerUsed()">\n    <div class="col-xs-12">\n      <div setting-dates-picker class="sub-setting" parent-widget="timePeriodSetting" deferred="::datesPickerDeferred" min-date="formattedMinDate()" from="fromDate" to="toDate" keep-today="keepToday" on-use="useDatesPicker()" />\n    </div>\n  </div>\n\n  <!-- Slider -->\n  <div class="row" ng-show="isTimeSliderUsed()">\n    <div class="col-xs-12">\n      <div setting-time-slider class="sub-setting" parent-widget="timePeriodSetting" deferred="::timeSliderDeferred" time-range="timePeriodSetting.timeRange" on-use="useTimeSlider()" />\n    </div>\n  </div>\n\n  <!-- Chart interval -->\n  <div class="row" ng-hide="hideChartInterval">\n    <div class="col-xs-12">\n      <strong translate>impac.widget.settings.time_period.chart_interval</strong>\n      <select ng-model="timePeriodSetting.period" ng-options="period.value as period.label for period in periods" ng-change="updateSettings()" />\n    </div>\n  </div>\n\n  <!-- Info -->\n  <div class="row text-center" ng-hide="hideChartInterval">\n    <div class="col-xs-12">\n      <i translate="impac.widget.settings.time_period.chart_note" translate-values="{nbOfPeriods: maxNumberOfPeriods}"></i>\n    </div>\n  </div>\n\n  <!-- Save Changes -->\n  <div class="row text-center" ng-show="showApplyButton">\n    <div class="col-xs-12">\n      <button class="btn btn-sm btn-default" ng-click="applyChangesCallback()">Apply changes</button>\n    </div>\n  </div>\n</div>\n'),e.put("widgets-settings/time-presets.tmpl.html",'<div class="settings time-presets">\n  <select ng-model="selectedPreset" ng-options="p.label for p in presets" ng-change="presetSelected()" />\n</div>\n'),e.put("widgets-settings/time-slider.tmpl.html",'<div class="settings time-slider">\n  <div class="row">\n    <div class="col-xs-11 col-xs-offset-1" ng-click="onUse()" translate="impac.widget.settings.time_slider.show_last" translate-values="{formatPeriod: formatPeriod()}"></div>\n    <div class="col-xs-11 col-xs-offset-1" ng-click="onUse()">\n      <i>{{fromDate() | momentDate : \'time-slider\'}} - {{toDate() | momentDate : \'time-slider\'}}</i>\n    </div>\n    <div class="col-xs-12">\n      <input type="range" ng-model="numberOfPeriods" min="1" max="12" step="1" ng-focus="onUse()" ng-change="formatPeriod()">\n    </div>\n  </div>\n</div>\n'),e.put("widgets-settings/width.tmpl.html",'<i class="fa fa-angle-double-left reduce" ng-show="expanded && !pdfMode" ng-click="parentWidget.toggleExpanded()" uib-tooltip="{{\'impac.widget.settings.width.reduce\' | translate}}"/>\n<i class="fa fa-angle-double-right expand" ng-hide="expanded || pdfMode" ng-click="parentWidget.toggleExpanded()" uib-tooltip="{{\'impac.widget.settings.width.expand\' | translate}}"/>\n')
}]),function(){var e;e=angular.module("maestrano.impac"),e.config(["$httpProvider",function(e){return e.defaults.headers.common.Accept="application/json",e.defaults.headers.common["Content-Type"]="application/json"}]),e.config(["$translateProvider","ImpacThemingProvider",function(e){return e.useSanitizeValueStrategy("escapeParameters"),e.useMessageFormatInterpolation()}])}.call(this),function(){var e;e=angular.module("maestrano.impac"),e.constant("IMPAC_EVENTS",{kpiTargetAlert:"kpi-target-alert",impacNotificationsLoad:"impac-notifications-load",addOrRemoveAlerts:"add-or-remove-alerts",kpisBarUpdateSettings:"on-kpis-bar-update-settings",kpisBarToggleSettings:"on-kpis-bar-toggle-settings",kpisBarUpdateDates:"on-kpis-bar-update-dates",kpiPressEnterButton:"on-kpi-press-enter-button"}),e.constant("LOCALES",{list:[{id:"en-gb",name:"English (GB)"},{id:"zh-HK",name:"Chinese (HK)"}]})}.call(this),function(){var e;e=angular.module("maestrano.impac"),e.run(["ImpacAlerts",function(){}]),e.run(["editableOptions",function(e){return e.theme="bs3"}])}.call(this),function(){console.info("Impac! Front-End Library - v1.7.4"),window.impac={version:"1.7.4"}}.call(),function(){angular.module("impac.filters.moment-date",[]).filter("momentDate",["$translate","ImpacTheming",function(e,t){return function(n,a){var i,r,s;return moment.locale(e.use().toLowerCase()),s=["daily","weekly","monthly","quarterly","yearly","default"],!_.isEmpty(a)&&_.includes(s,a.toLowerCase())&&(a="period-"+a.toLowerCase()),r=t.get(),i=r.dateFormatterSettings["default"],r.dateFormatterSettings.formats&&r.dateFormatterSettings.formats[a]&&(i=r.dateFormatterSettings.formats[a]),moment(n).format(i)}}])}.call(this),function(){angular.module("impac.filters.titleize",[]).filter("titleize",function(){return function(e){return e=void 0===e||null===e?"":e,e.toString().toLowerCase().replace(/\b([a-z])/g,function(e){return e.toUpperCase()})}})}.call(this),function(){angular.module("impac.filters.truncate",[]).filter("truncate",function(){return function(e,t,n,a){var i;return e?(t=parseInt(t,10))?e.length<=t?e:(e=e.substr(0,t),a&&(i=e.lastIndexOf(" "),-1!==i&&(e=e.substr(0,i))),e+(n||"…")):e:""}})}.call(this),function(){var e;e=angular.module("impac.components.alerts-config",[]),e.directive("alertsConfig",["$uibModal","$templateCache","$compile","$translate","ImpacKpisSvc","ImpacMainSvc",function(e,t,n,a,i,r){return{restrict:"EA",scope:{kpi:"=",buttonHtml:"@",afterSaveCallback:"=?"},template:t.get("alerts-config/alerts-config.tmpl.html"),link:function(e,t){var a,i;return i=e.buttonHtml?e.buttonHtml:"<i class='fa fa-bell-o' />",a=t.find(".alerts-config"),a.html(i).show(),n(a.contents())(e)},controller:["$scope",function(n){var s;return n.members=[],n.alerts={inapp:{service:"inapp",label:a.instant("impac.kpi.alerts.service.inapp")},email:{service:"email",label:"By sending me an email to:"}},n.recipientSearch={text:"",focus:!1},r.load().then(function(e){var t,i,r;return n.members=e.currentOrgMembers,!n.members&&e.userData.email&&a("impac.kpi.alerts.service.email",{EMAIL:"hasEmail",email:e.userData.email}).then(function(e){return n.alerts.email.label=e}),i=_.find(n.kpi.alerts,function(e){return"email"===e.service}),i&&n.members?(r=i.recipients.map(function(e){return e.id}),_.forEach(n.members,function(e){return _.includes(r,e.id)?e.active=!0:void 0})):n.members&&(t=_.find(n.members,function(t){return t.email===e.userData.email})||n.members[0])?t.active=!0:void 0}),n.save=function(e){return n.members&&(n.alerts.email.recipients=n.members.filter(function(e){return e.active})),n.alerts.email.active||_.forEach(n.alerts.email.recipients,function(e){return n.toggleRecipient(e)}),i.saveAlerts(n.kpi,e),n.modal.close(),n.afterSaveCallback?n.afterSaveCallback():void 0},n.toggleAlert=function(e){return e.active=!e.active},n.toggleRecipient=function(e){return!e.active||_.filter(n.members,function(e){return e.active}).length>1?e.active=!e.active:void 0},n.translateTarget=function(e){var t,n;return e.targets&&(n=e.targets[e.element_watched]),n&&n.length>0?(t=[],null!=n[0].max?t.push(a.instant("impac.widget.alerts_config.over"),n[0].max):n[0].min&&t.push(a.instant("impac.widget.alerts_config.below"),n[0].min),null!=e.data&&t.push(e.data[e.element_watched].unit),t.join(" ")):void 0},s={options:{backdrop:"static",template:t.get("alerts-config/alerts-config.modal.html"),scope:n}},n.showAlertsSettings=function(){var t,a,i,r;if(angular.isDefined(n.kpi.alerts))for(r=n.kpi.alerts,a=0,i=r.length;i>a;a++)t=r[a],n.alerts[t.service].active=!0;return n.modal=e.open(s.options)},n.showRecipientList=function(e){return e.active&&"email"===e.service&&n.members},n.onAddRecipientsKeyPress=function(e){var t,a,i;return t=_.filter(this.filteredMembers,function(e){return!e.active}),i=_.find(t,function(e){return e.email===n.recipientSearch.text}),a=0,13!==e.which?40===e.which&&t.length>0?(n.selectedMember&&(a=_.indexOf(t,n.selectedMember)+1),a<t.length||(a=0),n.selectedMember=t[a]):38===e.which&&t.length>0?(n.selectedMember&&(a=_.indexOf(t,n.selectedMember)-1),0>a&&(a=t.length-1),n.selectedMember=t[a]):n.selectedMember=null:(n.selectedMember&&(n.selectedMember.active=!0,n.selectedMember=null),i?(i.active=!0,n.recipientSearch.text=""):void 0)},n.onRecipientSearchFocus=function(){return n.recipientSearch.focus=!0},n.showAvailableRecipients=function(e){return this.filteredMembers?n.showRecipientList(e)&&n.recipientSearch.focus&&_.filter(this.filteredMembers,function(e){return!e.active}).length>0:!1}}]}}])}.call(this),function(){angular.module("impac.components.chart",[]).directive("impacChart",["$log","$window",function(e,t){return{restrict:"A",scope:{drawTrigger:"=",deferred:"="},link:function(n,a){return n.draw=function(e){var t,n;return null==e.options.showXLabels||e.options.showXLabels||angular.merge(e.options,{scales:{xAxes:[{display:!1}]}}),a.children().length>0&&a.children().remove(0),a.append("<canvas></canvas>"),t=a.children()[0],n=t.getContext("2d"),new Chart(n,e)},n.drawTrigger.then(function(){return e.warn("chart promise has been resolved: use notify instead")},function(t){return e.error(t)},function(e){var i,r,s;return r=t.navigator.userAgent,s=!0,s?(i=function(){var t;return t=$(a).is(":visible"),t?n.draw(e):setTimeout(function(){return i()},100)},i()):n.draw(e)}),n.deferred.resolve("chart ready")}}}])}.call(this),function(){var e;e=angular.module("impac.components.dashboard",[]),e.controller("ImpacDashboardCtrl",["$scope","$http","$q","$filter","$uibModal","$log","$timeout","$templateCache","MsgBus","ImpacUtilities","ImpacAssets","ImpacTheming","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc","ImpacWidgetsSvc","$translate","ImpacDhbTemplatesSvc",function(e,t,n,a,i,r,s,o,l,d,c,u,g,p,m,h,f){var v,b,w,y,x;return e.currentDhb=m.getCurrentDashboard(),e.widgetsTemplates=m.getWidgetsTemplates(),e.userAccesses=m.userAccesses(),e.impacTitleLogo=c.get("impacTitleLogo"),e.impacDashboardBackground=c.get("impacDashboardBackground"),e.showDhbHeading=u.get().dhbConfig.showDhbHeading,e.dhbHeadingText=u.get().dhbConfig.dhbHeadingText,e.dhbErrorsConfig=u.get().dhbErrorsConfig,e.dhbLabelName=u.getDhbLabelName(),e.dhbSettingsConfig=u.get().dhbSettings,e.createFromTemplateEnabled=e.dhbSettingsConfig.createFromTemplateEnabled,e.marketplaceMyobLink=u.get().dhbSubMenuConfig.marketplaceMyobLink,e.myobMessageConfig=u.get().dhbSubMenuConfig.myobMessage,e.isLoading=!0,e.failedDashboardLoad=!1,w=function(){return e.activateTimer(),e.hasMyobEssentialsOnly=p.config.currentOrganization.has_myob_essentials_only},b=function(t){return r.error(t),e.failedDashboardLoad=!0,e.isLoading=!1},m.load(!0).then(w,b),e.showChooseDhbMsg=function(){return!m.isThereADashboard()},e.showNoWidgetsMsg=function(){return m.isCurrentDashboardEmpty()&&u.get().showNoWidgetMsg},e.starWizardModal={value:!1},l.publish("starWizardModal",e.starWizardModal),e.openStarWizard=function(){return e.starWizardModal.value=!0},e.showSubMenu=!1,e.displaySubMenu=function(){return e.showSubMenu=!0},e.hideSubMenu=function(){return e.showSubMenu=!1},v=0,e.displaySecondMsg=!1,e.reloadDashboard=function(){return v++,v>=3&&(e.displaySecondMsg=!0),m.reload(!0).then(w,b)},m.dhbLoader().then(null,null,function(t){return t?e.isLoading=!0:e.activateTimer()}),e.activateTimer=function(){var t,n;return e.isLoading||(e.isLoading=!0),n=e.currentDhb.widgets,t=null!=n?Math.max(100*n.length,500):500,s(function(){return e.isLoading=!1},t)},e.sortableOptions={stop:y=function(){var t;return t={widgets_order:_.pluck(e.currentDhb.widgets,"id")},m.update(e.currentDhb.id,t)},start:x=function(e,t){return t.placeholder.css("width",t.item.width()-1),t.placeholder.css("height",t.item.height())},cursorAt:{left:100,top:20},opacity:.5,delay:150,tolerance:"pointer",placeholder:"placeHolderBox",cursor:"move",revert:250,cancel:".unsortable,.editable-input",handle:".top-line",helper:"clone"},m.dashboardChanged().then(null,null,function(){return e.sortableOptions.disabled=!e.userAccesses.dashboards.update}),e.createDashboard=function(e){return e.metadata=_.omit(e.metadata,"organization_ids"),e.id?m.copy(e):m.create(e)},e.kpisBar={displayed:function(){return!_.isEmpty(e.userAccesses)&&e.userAccesses.kpis.show&&m.isThereADashboard()}},e.customWidgetSelector=u.get().widgetSelectorConfig,e.forceShowWidgetSelector=!1,e.showCloseWidgetSelectorButton=function(){return!m.isCurrentDashboardEmpty()},e.displayWidgetSelector=function(t){return null==t&&(t=!0),e.forceShowWidgetSelector=t},e.showWidgetSelector=function(){return m.isThereADashboard()&&(e.forceShowWidgetSelector||m.isCurrentDashboardEmpty())},e.isAddChartEnabled=u.get().addChartTile.show,e.addChartTileOnClick=function(){var t;return t=u.get().addChartTile.onClickOptions.triggers,_.forEach(t,function(t){switch(t.type){case"objectProperty":return e[t.target][t.property]=t.value}})},e.selectedCategory="accounts",e.isCategorySelected=function(t){return null!=e.selectedCategory&&null!=t?e.selectedCategory===t:!1},e.selectCategory=function(t){return e.selectedCategory=t},e.getSelectedCategoryName=function(){if(null==e.selectedCategory)return!1;switch(e.selectedCategory){case"accounts":return f.instant("impac.dashboard.category_name.accounting");case"invoices":return f.instant("impac.dashboard.category_name.invoicing");case"hr":return f.instant("impac.dashboard.category_name.hr_or_payroll");case"sales":return f.instant("impac.dashboard.category_name.sales");default:return!1}},e.getSelectedCategoryTop=function(){if(null==e.selectedCategory)return!1;switch(e.selectedCategory){case"accounts":return{top:"33px"};case"invoices":return{top:"63px"};case"hr":return{top:"93px"};case"sales":return{top:"123px"};default:return{top:"9999999px"}}},e.getWidgetsForSelectedCategory=function(){return null!=e.selectedCategory&&null!=e.widgetsTemplates?_.select(e.widgetsTemplates,function(t){var n,a;return t.metadata&&t.metadata.template?a=t.metadata.template.split("/")[0]:t.metadata&&t.metadata.bolt_path?(n=_.find(g.bolts(),function(e){return e.path===t.metadata.bolt_path}),a=n.category):a=t.endpoint.split("/")[0],a===e.selectedCategory}):[]},e.addWidget=function(t){var n;return n=_.pick(t,["endpoint","name","width","metadata"]),angular.element("#widget-selector").css("cursor","progress"),angular.element("#widget-selector .section-lines .line-item").css("cursor","progress"),h.create(n).then(function(){e.errors="",angular.element("#widget-selector .badge.widget-added").fadeTo(250,1),s(function(){return angular.element("#widget-selector .badge.widget-added").fadeTo(700,0)},4e3)},function(t){return e.errors=d.processRailsError(t)})["finally"](function(){return angular.element("#widget-selector").css("cursor","auto"),angular.element("#widget-selector .section-lines .line-item").css("cursor","pointer")})},e.triggerUpload=function(){var t;return t=angular.element("#fileInput"),t.on("change",function(t){var n,a;return n=t.target.files,n&&n[0]?(a=new FileReader,a.onload=function(t){return e.impacTitleLogo=t.target.result},a.readAsDataURL(n[0])):void 0}),t.trigger("click"),!0},e.widgetSuggestionModal=e.$new(),e.widgetSuggestionModal.widgetDetails={},e.widgetSuggestionModal.error=!1,e.widgetSuggestionModal.onSuccess=!1,e.widgetSuggestionModal.config={backdrop:"static",template:o.get("dashboard/widget-suggestion.modal.html"),size:"md",windowClass:"inverse impac-widget-suggestion",scope:e.widgetSuggestionModal,apiPath:g.widgets.suggest()},e.widgetSuggestionModal.open=function(){var t;return t=e.widgetSuggestionModal,t.locked?void 0:(p.loadUserData().then(function(e){return t.userName=e.name}),t.instance=i.open(t.config),t.instance.rendered.then(function(){return t.locked=!0}),t.instance.result.then(function(){return t.locked=!1},function(){return t.locked=!1}),t.isLoading=!1)},e.widgetSuggestionModal.proceed=function(){var n,a;return a=e.widgetSuggestionModal,a.isLoading=!0,n={widget_name:a.widgetDetails.name,widget_category:a.widgetDetails.category,widget_description:a.widgetDetails.description},null!=a.config.apiPath?t.post(a.config.apiPath,{template:"widget_suggestion",opts:n}).then(function(){return a.onSuccess=!0,s(function(){return a.instance.close(),a.widgetDetails={},a.isLoading=!1,a.onSuccess=!1},3e3)},function(e){return a.isLoading=!1,a.error=!0,r.error("impac-angular ERROR: Unable to POST widget_suggestion mailer: ",e)}):void 0}}]),e.directive("impacDashboard",["$templateCache","ImpacDashboardsSvc",function(e,t){return{restrict:"EA",scope:{forceLoad:"=load"},template:e.get("dashboard/dashboard.tmpl.html"),controller:"ImpacDashboardCtrl",link:function(e){return e.pdfMode=!1,t.pdfModeEnabled().then(null,null,function(){return e.pdfMode=!0}),t.pdfModeCanceled().then(null,null,function(){return e.pdfMode=!1})}}}])}.call(this),function(){var e;e=angular.module("impac.components.dashboard-create",[]),e.component("impacDashboardCreate",{templateUrl:"dashboard-create/dashboard-create.tmpl.html",bindings:{onCreateDashboard:"&",labelLocale:"@?",btnClass:"@?"},controller:["$scope","$uibModal","ImpacTheming","ImpacMainSvc",function(e,t,n,a){var i,r,s,o;return i=this,i.$onInit=function(){return i.label=n.getDhbLabelName(),a.loadOrganizations().then(function(e){return i.currentOrganizationId=e.currentOrganization.id,r(e)})},s=function(e){return e.id===i.currentOrganizationId},o=function(){var e,t,n,a,r;for(a=i.modalScope.organizations,r=[],e=0,t=a.length;t>e;e++)n=a[e],r.push(n.selected=s(n));return r},r=function(t){return i.modalScope=angular.merge(e.$new(),{label:i.label,multiMode:{enabled:n.get().dhbConfig.multiCompany},dashboard:{},organizations:t.organizations}),o(),i.modalScope.source={mode:"single",init:o()},i.modalScope.templates={enabled:n.get().dhbSettings.createFromTemplateEnabled,select:function(e){var t;return t=e.template,angular.merge(i.modalScope.dashboard,t)}},i.modalScope.createDashboard=function(e){var t,n;return t=i.modalScope,t.loading=!0,n=_.filter(e,function(e){return e.selected}),angular.merge(t.dashboard,{organization_ids:_.pluck(n,"id")}),i.onCreateDashboard({dashboard:t.dashboard})["finally"](function(){return t.loading=!1,i.instance.close()})},i.modalScope.invalid=function(){return _.isEmpty(i.modalScope.dashboard.name)||!_.some(_.pluck(i.modalScope.organizations,"selected"))}},i.openModal=function(){var e;return i.modalScope.dashboard.name=null,i.modalScope.source.mode="single",e={backdrop:"static",templateUrl:"dashboard-create/dashboard-create.modal.html",scope:i.modalScope,windowClass:"impac-dashboard-create"},i.instance=t.open(e)},i}]})}.call(this),function(){angular.module("impac.components.dashboard-selector",[]).directive("dashboardSelector",["$log","$compile","$templateCache","$http","$timeout","$uibModal","ImpacTheming","ImpacDashboardsSvc","ImpacMainSvc","ImpacUtilities",function(e,t,n,a,i,r,s,o,l,d){return{restrict:"E",scope:{onCreateDashboard:"&",isWidgetSelectorShown:"&",onDisplayWidgetSelector:"&",onSelectDashboard:"&",pdfMode:"=",userAccesses:"="},controller:["$scope",function(e){return e.organizationsNames=function(){var t;return t=_.sortBy(e.currentDhb.data_sources,function(e){return e.label.toLowerCase()}),_.pluck(t,"label").join(", ")},e.toggleShowDashboardsDropdown=function(){return e.showChangeDashboardNameBox?void 0:e.showDashboardsDropdown=!e.showDashboardsDropdown},e.selectDashboard=function(t){return e.currentDhb.id!==t?(e.isLoading=!0,e.showDashboardsDropdown=!1,i(function(){return e.$apply(function(){return o.setCurrentDashboard(t),e.onSelectDashboard(),e.isLoading=!1})},50)):void 0},e.createDashboard=function(t){return e.onCreateDashboard({dashboard:t})},e.toggleChangeDashboardNameBox=function(t){var n;return n=angular.copy(t),e.dashboardToChange={},e.dashboardToChange.id=n.id,e.dashboardToChange.name=n.full_name,e.showChangeDashboardNameBox=!e.showChangeDashboardNameBox,i(function(){var e;return e=$("#changeDhbNameInput"),e.select(),e.focus()},100)},e.hideChangeDashboardNameBox=function(){return e.showChangeDashboardNameBox=!1},e.checkAndUpdateDashboardName=function(t){return 13===t.keyCode&&e.updateDashboardName(),27===t.keyCode?e.showChangeDashboardNameBox=!1:void 0},e.updateDashboardName=function(){return null==e.dashboardToChange||_.isEmpty(e.dashboardToChange.name)?void 0:o.update(e.dashboardToChange.id,{name:e.dashboardToChange.name}).then(function(){return e.showChangeDashboardNameBox=!1})},e.toggleAccessibilityMode=function(){return e.accessibilityMode=!e.accessibilityMode,angular.forEach(e.currentDhb.widgets,function(e){return e.loadContent()})},e.deleteDashboardModal=e.$new(),e.deleteDashboardModal.config={backdrop:"static",template:n.get("dashboard-selector/delete.modal.html"),size:"md",windowClass:"inverse",scope:e.deleteDashboardModal},e.deleteDashboardModal.open=function(){var t;return t=e.deleteDashboardModal,t.locked?void 0:(t.errors="",t.isLoading=!1,t.dhbLabelName=s.getDhbLabelName(),t.instance=r.open(t.config),t.instance.rendered.then(function(){return t.locked=!0}),t.instance.result.then(function(){return t.locked=!1},function(){return t.locked=!1}))},e.deleteDashboardModal.proceed=function(){var t;return t=e.deleteDashboardModal,t.isLoading=!0,o["delete"](e.currentDhb.id).then(function(){return t.errors="",t.instance.close()},function(e){return t.errors=d.processRailsError(e),t.isLoading=!1})},e}],link:function(i,r){var l,d,c,u,g,p,m;switch(i.currentDhb=o.getCurrentDashboard(),i.dashboardsList=o.getDashboards(),i.isThereADashboard=o.isThereADashboard,i.isCurrentDashboardEmpty=o.isCurrentDashboardEmpty,g=s.get().dhbSelectorConfig,i.isAccessibilityEnabled=g.accessibilityEnabled,i.dhbLabelName=s.getDhbLabelName(),i.showDashboardsDropdown=!1,i.showChangeDashboardNameBox=!1,i.accessibilityMode=!1,g.customTmplPath?d=g.customTmplPath:i.selectorType=g.selectorType,p=null,m=function(e){return p=e},i.selectorType){case"dropdown":m("dashboard-selector/dropdown.tmpl.html");break;case"tabs":m("dashboard-selector/bootstrap-tabs.tmpl.html");break;case"pills":m("dashboard-selector/bootstrap-tabs.tmpl.html");break;default:m(d)}return c=function(){return a.get(p,{cache:n}).then(function(t){return t&&t.data&&t.data.length||e.warn("dashboardSelector custom template: no content found"),l(t.data)},function(t){return e.error("Error retrieving custom template: ",t)})},u=function(){return l(n.get(p))},l=function(e){return r.html(e).show(),t(r.contents())(i)},d?c():u()}}}])}.call(this),function(){var e;e=angular.module("impac.components.dashboard-templates-selector",[]),e.component("dashboardTemplatesSelector",{templateUrl:"dashboard-templates-selector/dashboard-templates-selector.tmpl.html",bindings:{onSelect:"&"},controller:["toastr","ImpacDhbTemplatesSvc",function(e,t){var n;return n=this,n.$onInit=function(){return n.templates=[],n.selectedTemplate={},n.isTemplatesMode=!1,n.hideLoader=!1,t.index().then(function(e){return n.templates=e},function(){return e.error("Failed to retrieve dashboard templates. You can still create your dashboard from scratch.","Error")})["finally"](function(){return n.hideLoader=!0})},n.hasTemplates=function(){return n.templates.length},n.templateOnClick=function(e){return n.selectedTemplate=n.isSelected(e)?{}:e,n.onSelect({$event:{template:angular.copy(n.selectedTemplate)}})},n.isSelected=function(e){return _.isEqual(e,n.selectedTemplate)},n.toggleTemplatesMode=function(){return n.isTemplatesMode=!n.isTemplatesMode,n.isTemplatesMode?void 0:n.templateOnClick({})},n}]})}.call(this),function(){angular.module("impac.components.kpi",[]).directive("impacKpi",["$log","$timeout","$templateCache","ImpacKpisSvc","ImpacEvents","IMPAC_EVENTS","$translate",function(e,t,n,a,i,r,s){return{restrict:"EA",scope:{onDelete:"&",kpi:"=",editMode:"=",loadReady:"=",userAccesses:"="},template:n.get("kpi/kpi.tmpl.html"),controller:["$scope","$element",function(e,n){var o,l,d,c,u,g;return d=function(){return a.show(e.kpi).then(function(t){var n,i;return angular.extend(e.kpi,t),n=a.getKpiTemplate(e.kpi.endpoint,e.kpi.element_watched),e.kpi.name=null!=n&&n.name,null!=n&&null!=n.extra_params&&(e.kpi.possibleExtraParams=n.extra_params,_.forIn(e.kpi.possibleExtraParams,function(t,n){var a;return t[0]?((a=e.kpi).extra_params||(a.extra_params={}))[n]=t[0].id:void 0})),i=!1,_.forEach(e.kpi.watchables,function(t){var n;return _.isEmpty(n=e.getTargets(t))?(e.addTargetToWatchable(t),i=!0):e.targets[t]=angular.copy(n)}),i?e.displayEditSettings():void 0})},g=function(t){return e.kpi.isEditing||t?e.updateSettings():void 0},c=function(){return o()},u=function(){return e.kpi["static"]?void 0:d()},l=function(){return _.forEach(e.kpi.watchables,function(t){var n,a;return n=e.getTargetPlaceholder(t),(a={})[n.mode]=n.value,e.targets[t]=[a]}),e.updateSettings(!0)},o=function(){var e;return(e=angular.element(n).find(".kpi-content"))?(e.animate({opacity:0},0),t(function(){return e.animate({opacity:1},150)},200)):void 0},e.kpiTemplates=a.getKpisTemplates(),e.possibleExtraParams=[],e.targets={},e.possibleTargets=[{label:s.instant("impac.kpi.below"),mode:"min"},{label:s.instant("impac.kpi.over"),mode:"max"}],e.kpi.isLoading=!0,e.loadReady.promise.then(function(){return e.kpi["static"]?e.kpi.isLoading=!1:d()["finally"](function(){return e.kpi.isLoading=!1})}),i.registerCb(r.kpisBarUpdateSettings,g),i.registerCb(r.kpisBarToggleSettings,c),i.registerCb(r.kpisBarUpdateDates,u),e.$on("$destroy",function(){return i.deregisterCb(r.kpisBarUpdateSettings,g),i.deregisterCb(r.kpisBarToggleSettings,c),i.deregisterCb(r.kpisBarUpdateDates,u)}),e.addTargetToWatchable=function(t){var n,a;if(!_.has(e.targets,t))return(a={})[e.getTargetPlaceholder(t).mode]="",((n=e.targets)[t]||(n[t]=[])).push(a)},e.displayEditSettings=function(){return e.kpi.isEditing=!0},e.hideEditSettings=function(){return e.kpi.isEditing=!1},e.hasValidTargets=function(){return a.validateKpiTargets(e.targets)},e.hasContent=function(){return!!(e.kpi&&e.kpi.layout&&e.kpi.data)},e.showKpiContent=function(){return!e.isLoading()&&e.hasContent()},e.isDataNotFound=function(){return!e.hasContent()},e.isLoading=function(){return e.kpi.isLoading},e.updateExtraParam=function(){return e.updateSettings(!0)},e.updateSettings=function(n){var i,r,s,o;return s={},o=(i=e["kpi"+e.kpi.id+"SettingsForm"])&&i.$dirty,r=e.hasValidTargets(),o&&r||n?(s.targets=e.targets,_.isEmpty(e.kpi.extra_params)||(s.extra_params=e.kpi.extra_params),_.isEmpty(s)||a.update(e.kpi,s),i.$setPristine(),t(function(){return e.hideEditSettings()},200)):e.cancelUpdateSettings(r)},e.cancelUpdateSettings=function(){return _.isEmpty(e.kpi.targets)?l():e.targets=angular.copy(e.kpi.targets),t(function(){return e.hideEditSettings()},200)},e.deleteKpi=function(){return e.kpi["static"]?void 0:(e.kpi.isLoading=!0,a["delete"](e.kpi).then(function(){return e.onDelete()})["finally"](function(){return e.kpi.isLoading=!1}))},e.isTriggered=function(){return null!=e.kpi.layout&&e.kpi.layout.triggered},e.isEditing=function(){return e.userAccesses.kpis.update?e.kpi.isEditing||e.editMode:!1},e.getFormTargetValueInput=function(t,n){return e["kpi"+e.kpi.id+"SettingsForm"][t+"TargetValue"+n]},e.getTargets=function(t){return null!=e.kpi.targets&&e.kpi.targets[t]||[]},e.getTargetUnit=function(t){var n;return n=null!=e.kpi.data&&e.kpi.data[t].unit||e.getTargetPlaceholder(t).unit||"","currency"===n?a.getCurrentDashboard().currency:n},e.getTargetPlaceholder=function(t){return a.getKpiTargetPlaceholder(e.kpi.endpoint,t)},e.getRealValue=function(){var t,n,a;return t=e.kpi,_.isEmpty(t.data)?"":(a=t.data[t.watchables[0]].value,n=t.data[t.watchables[0]].unit,[a,n].join(" ").trim())},e.bindTargetInputPlaceholder=function(t,n){var a;return e[a=t+"TargetPlaceholder"+n]||(e[a]="")},e.setTargetInputPlaceholder=function(t,n){return e[t+"TargetPlaceholder"+n]=e.getTargetPlaceholder(t).value||""},e.resetTargetInputPlaceholder=function(t,n){return e[t+"TargetPlaceholder"+n]=""},e.onKeyPress=function(e){return 13===e.which?i.notifyCallbacks(r.kpiPressEnterButton):void 0}}]}}])}.call(this),function(){angular.module("impac.components.kpis-bar",[]).directive("kpisBar",["$templateCache","$q","$timeout","ImpacKpisSvc","ImpacMainSvc","ImpacDashboardsSvc","ImpacTheming","ImpacEvents","IMPAC_EVENTS",function(e,t,n,a,i,r,s,o,l){return{restrict:"E",scope:{kpis:"=",userAccesses:"="},template:e.get("kpis-bar/kpis-bar.tmpl.html"),controller:["$scope","$log","$element",function(e,i,d){var c,u,g,p,m;return e.availableKpis={kpiSelectorHidden:!0,toggle:function(){return e.hasKpiAvailability()?e.availableKpis.kpiSelectorHidden=!e.availableKpis.kpiSelectorHidden:!1},list:[]},e.showKpisExpanded=!1,e.showEditMode=!1,e.isAddingKpi=!1,e.showContent=!0,e.dhbLabelName=s.getDhbLabelName(),a.load().then(function(){return g(),u()}),r.dashboardChanged().then(null,null,function(){return n(function(){return g(),u()})}),e.sortableOptions={stop:function(){var t;return t=_.pluck(e.kpis,"id"),a.updateKpisOrder(t)},cursorAt:{left:100,top:20},opacity:.5,delay:150,tolerance:"pointer",cursor:"move",revert:250,handle:".top-line",cancel:".unsortable",helper:"clone"},e.kpisDateRange={},e.kpiDatesDeferred=t.defer(),e.datesPickerDeferred=t.defer(),p=function(){return e.datesPickerDeferred.promise.then(function(t){return a.getKpisDateRange().then(function(t){return e.kpisDateRange.from=t.from,e.kpisDateRange.to=t.to,e.kpisDateRange.keepToday=t.keepToday},function(){return e.hideDatesPicker=!0})["finally"](function(){return e.kpiDatesDeferred.resolve(),t.initialize()})})},p(),r.dashboardChanged().then(null,null,function(e){return e?p():void 0}),o.registerCb(l.kpiPressEnterButton,function(){return e.toggleEditMode()}),e.addKpi=function(t){var n;if(!e.isAddingKpi)return e.isAddingKpi=!0,t.element_watched=t.watchables[0],n={},n.extra_watchables=_.filter(t.watchables,function(e){return e!==t.element_watched}),a.create(t.source||"impac",t.endpoint,t.element_watched,n).then(function(t){return e.kpis.push(t)},function(e){return i.error("Impac Kpis bar can't add a kpi",e)})["finally"](function(){return g(),e.isAddingKpi=!1})},e.removeKpi=function(t){return _.remove(e.kpis,function(e){return e.id===t}),g()},e.toggleEditModeLock=!1,e.toggleEditMode=function(){var t;if(!e.toggleEditModeLock)return e.toggleEditModeLock=!0,o.notifyCallbacks(l.kpisBarToggleSettings),m()&&!e.showEditMode?o.notifyCallbacks(l.kpisBarUpdateSettings):((t=e.showEditMode)&&o.notifyCallbacks(l.kpisBarUpdateSettings,t),e.showEditMode=!e.showEditMode),e.availableKpis.kpiSelectorHidden||e.showEditMode||e.availableKpis.toggle(),n(function(){return e.toggleEditModeLock=!1},450)},e.isEditing=function(){return e.userAccesses.kpis.update?e.showEditMode||m():!1},e.kpisBarUpdateDates=function(e){var t;if(_.isObject(e)&&!_.isEmpty(e))return t=r.getCurrentDashboard(),angular.merge(t.metadata,{kpis_hist_parameters:e}),r.update(t.id,{metadata:t.metadata}).then(function(){return o.notifyCallbacks(l.kpisBarUpdateDates)})},e.toggleShowContent=function(){return e.showContent=!e.showContent,c(),!0},e.hasKpiAvailability=function(){return e.availableKpis.list.length},e.showDatesPicker=function(){return e.userAccesses.kpis.update&&e.isEditing()&&e.kpis.length&&!e.hideDatesPicker},m=function(){return _.includes(_.map(e.kpis,function(e){return e.isEditing}),!0)},g=function(){return e.availableKpis.list=_.select(a.getKpisTemplates(),function(t){return _.isEmpty(t.attachables)&&_.isEmpty(_.select(e.kpis,function(e){return e.endpoint===t.endpoint&&e.element_watched===t.watchables[0]}))}),_.isEmpty(e.availableKpis.list)?e.availableKpis.kpiSelectorHidden=!0:void 0},u=function(){return _.forEach(e.kpis,function(e){return a.buildKpiWatchables(e)})},c=function(){var e;return(e=angular.element(d).find(".kpis .content, .kpis .content-buttons"))?e.slideToggle(500):void 0}}]}}])}.call(this),function(){var e;e=angular.module("impac.components.widget",[]),e.controller("ImpacWidgetCtrl",["$scope","$log","$q","$timeout","ImpacWidgetsSvc","ImpacDashboardsSvc",function(e,t,n,a,i,r){var s;return s=e.widget||{},e.widgetDeferred=n.defer(),e.widgetDeferred.promise.then(function(a){return n.all(a).then(function(){return e.showWidget()},function(e){return s.isLoading=!1,t.error("widget "+s.id+" failed to render"),t.error(e)})}),e.showWidget=function(t){return null==t&&(t=!1),i.show(s,{refreshCache:t})["finally"](function(){return e.isAccessibility?(e.initialWidth=s.width,s.width=12):e.initialWidth?s.width=e.initialWidth:void 0})},e.initSettings=function(){return i.initWidgetSettings(s)},e.updateSettings=function(e){return null==e&&(e=!0),i.updateWidgetSettings(s,e)},e.getColClass=function(){return"col-md-"+s.width},s.getCssClasses=function(){var t;return t=[e.getColClass()],e.pdfMode&&t.push("pdf-mode"),s.ticked||t.push("hidden-print"),t.join(" ")},r.pdfModeEnabled().then(null,null,function(){return e.pdfMode=!0,angular.isDefined(s.ticked)||(s.ticked=!0),e.widget.hasEditAbility=!1,e.initSettings()}),r.pdfModeCanceled().then(null,null,function(){return e.pdfMode=!1,e.widget.hasEditAbility=!0}),e.tick=function(){return s.ticked=!s.ticked,r.tick()}}]),e.directive("impacWidget",["$templateCache","ImpacUtilities","ImpacWidgetsSvc",function(e,t,n){return{restrict:"A",scope:{parentDashboard:"=",widget:"=",isAccessibility:"=",onDisplayAlerts:"&",userAccesses:"="},controller:"ImpacWidgetCtrl",link:function(e){return e.widget.isLoading=!0,e.widget.settings=[],e.pdfMode=!1,e.cssClass=t.fetchWidgetCssClass(e.widget),e.templatePath=t.fetchWidgetTemplatePath(e.widget),e.showInfoPanel=!1,e.isInfoPanelDisplayed=function(){return e.showInfoPanel},e.toggleInfoPanel=function(){return e.showInfoPanel=!e.showInfoPanel},e.editTitle=!1,e.isTitleEdited=function(){return e.editTitle},e.toggleEditTitle=function(){return e.editTitle=!e.editTitle},e.showDeleteWidget=!1,e.toggleDeleteWidget=function(){return e.showDeleteWidget=!e.showDeleteWidget},e.deleteWidget=function(){return n["delete"](e.widget).then(null,function(n){return e.widget.errors=t.processRailsError(n)})}},template:e.get("widget/widget.tmpl.html")}}])}.call(this),function(){angular.module("impac.filters.mno-currency",[]).filter("mnoCurrency",["$filter",function(e){return function(t,n,a,i){var r,s,o;return null==n&&(n=""),null==a&&(a=!0),r={USD:"$",AUD:"$",CAD:"$",CNY:"¥",EUR:"€",GBP:"£",HKD:"$",INR:"",JPY:"¥",NZD:"$",SGD:"$",PHP:"₱",AED:"",IDR:"Rp",MMK:""},null==t?"":(o=!a&&_.has(r,n)?r[n]:"",s=e("currency")(t,o,i),s=s.replace("(","-"),s=s.replace(")",""),(n&&!n.match(/[A-Z]{3}/)||"%"===n||"(ratio)"===n)&&(s=s.replace(/,/g,""),"%"!==n&&"(ratio)"!==n)?parseInt(s):(a&&(s=s+" "+n),s))}}])}.call(this),function(){angular.module("impac.filters.url-helper",[]).filter("urlHelper",function(){return function(e,t){var n,a;if(e&&e.length)return n=function(){return e=[e,t.shift()].join("?"),e=[].concat.apply([],[e,t]).join("&")},a=function(){var e,a,i;for(a=0,e=[],i=Object.keys(t);a<i.length;)e.push(i[a]+"="+t[i[a]]),a++;return t=e,n()},Array.isArray(t)&&n(),"object"!=typeof t||Array.isArray(t)||a(),e}})}.call(this),function(){angular.module("impac.services.alerts",[]).service("ImpacAlerts",["$log","$q","$http","$httpParamSerializerJQLike","ImpacRoutes","ImpacMainSvc","ImpacEvents","IMPAC_EVENTS",function(e,t,n,a,i,r,s,o){var l;
return l=this,this.config={},s.registerCb(o.impacNotificationsLoad,function(e){return l.getAlerts().then(function(t){return e(t)})}),this.getAlerts=function(){return n.get(i.kpis.alerts.index()).then(function(e){return e.data},function(t){return e.error("ImpacAlerts Service: cannot get alerts.",t),t})},this.create=function(e,t){return n.post(i.kpis.alerts.create(e),t)},this.update=function(e,t){return n.put(i.kpis.alerts.update(e),t)},this["delete"]=function(e){return n["delete"](i.kpis.alerts["delete"](e))},l}])}.call(this),function(){angular.module("impac.services.assets",[]).provider("ImpacAssets",function(){var e,t,n;return n=this,t={defaultImagesPath:"/images",impacTitleLogo:":default/impac-title-logo.png",impacDashboardBackground:":default/impac-dashboard-background.png",currencyConversionsIcon:":default/currency-conversions.png",cashFlowLegendIcon:":default/cash-flow.png",payablesLegendIcon:":default/payables.png",projectedCashLegendIcon:":default/projected-cash.png",receivablesLegendIcon:":default/receivables.png",plotLineLegendIcon:":default/plot-line-icon.svg",areaLegendIcon:":default/area-icon.svg",greenArrowUp:":default/green-arrow-up.svg",redArrowDown:":default/red-arrow-down.svg"},n.configure=function(e){return angular.extend(t,e),_.forIn(t,function(e,n){return t[n]=e.replace(":default",t.defaultImagesPath)})},e=function(){var e;return e=this,e.get=function(e){return t[e]},e},e.$inject=["$log"],n.$get=e,n})}.call(this),function(){angular.module("impac.services.bolt-resources",[]).service("BoltResources",["$http","ImpacMainSvc",function(e,t){var n,a;n=function(){var e;return e="Basic "+btoa(t.getSsoSessionId()),{Authorization:e}},a=function(e,t){var n,a;return a=e.join("/"),n=decodeURIComponent($.param(t)),[a,n].join("?")},this.index=function(t,i,r){var s;return s=a([t,i],r),e.get(s,{headers:n()})},this.update=function(t,a,i,r){var s,o;return o=[t,a,i].join("/"),s={data:{id:i,type:a,attributes:r}},e.put(o,s,{headers:n()})},this.create=function(t,a,i,r){var s,o;return o=[t,a].join("/"),s={data:{type:a,attributes:i,relationships:r}},e.post(o,s,{headers:n()})},this.destroy=function(t,a,i){var r;return r=[t,a,i].join("/"),e["delete"](r,{headers:n()})}}])}.call(this),function(){angular.module("impac.services.chart-formatter",[]).service("ChartFormatterSvc",["ImpacTheming","$filter","$window","$document","ImpacDashboardsSvc",function(e,t,n,a,i){var r,s,o,l,d,c,u,g;s=this,r=e.get().chartColors,n.onblur=function(){return angular.element(a[0].getElementById("chartjs-tooltip")).remove()},this.getPositiveColor=function(){return r.positive},this.getNegativeColor=function(){return r.negative},this.getOthersColor=function(){return r.others},this.getColor=function(e){return r.array[e%r.array.length]},this.getLightenColor=function(e,t){var n;return n=r.array[e%r.array.length],n?g(n,t||.4):void 0},o=function(e){return e.replace(/#/,"")},c=function(e){return parseInt(o(e).substring(0,2),16)},d=function(e){return parseInt(o(e).substring(2,4),16)},l=function(e){return parseInt(o(e).substring(4,6),16)},u=function(e){return[c(e),d(e),l(e)].join(",")},g=function(e,t){return"rgba("+u(e)+","+t+")"},this.customTooltip=function(e){var t,n,a,i,r,s;return s=angular.element("#chartjs-tooltip"),s[0]||(angular.element("body").append('<div id="chartjs-tooltip"></div>'),s=angular.element("#chartjs-tooltip")),e.opacity?(s.removeClass("above below no-transform"),e.yAlign?s.addClass(e.yAlign):s.addClass("no-transform"),e.body&&(n=_.compact([(e.beforeTitle||[]).join("<br/>"),(e.title||[]).join("<br/>"),(e.afterTitle||[]).join("<br/>"),(e.beforeBody||[]).join("<br/>"),(e.body||[]).join("<br/>"),(e.afterBody||[]).join("<br/>"),(e.beforeFooter||[]).join("<br/>"),(e.footer||[]).join("<br/>"),(e.afterFooter||[]).join("<br/>")]),s.html(n.join("<br/>"))),t=angular.element(this._chart.canvas),i=t.offset(),t.bind("mouseleave",function(e){return"chartjs-tooltip"!==e.relatedTarget.id?s.remove():void 0}),s.bind("mouseleave",function(e){return"CANVAS"!==e.relatedTarget.tagName?s.remove():void 0}),s.css({"background-color":"#17262d",color:"white",opacity:1,transition:"opacity 0.5s, top 0.5s, left 0.5s",position:"absolute",width:null!=(r=e.width)?r:(a={},a[e.width+"px"]="auto",a),left:i.left+e.x+10+"px",top:i.top+e.y+10+"px",fontFamily:e._fontFamily,fontSize:e.fontSize,fontStyle:e._fontStyle,padding:e.yPadding+"px "+e.xPadding+"px","border-radius":"2px"})):(s.css({opacity:.5}),void 0)},angular.merge(Chart.defaults.global,{defaultColor:s.getColor(0),tooltips:{titleFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",bodyFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",footerFontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif",enabled:!1,custom:s.customTooltip},elements:{point:{hitRadius:8,hoverRadius:8},line:{tension:0,borderWidth:2}},legend:{display:!1}}),angular.merge(Chart.defaults.scale,{ticks:{beginAtZero:!0,minRotation:0,fontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif"},scaleLabel:{fontFamily:"Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif"}}),this.setTooltipsTextLayout=function(e,n){return null==n&&(n=!1),angular.merge(e,{tooltips:{callbacks:{title:function(e,t){var a;return n?(a=[t.labels[e[0].index]],t.datasets[e[0].datasetIndex].label&&a.push(t.datasets[e[0].datasetIndex].label),a.join(" | ")):t.labels[e[0].index]},label:function(n,a){var r;return r=e.currency||i.getCurrentDashboard().currency,"hide"!==r?t("mnoCurrency")(a.datasets[n.datasetIndex].data[n.index],r):a.datasets[n.datasetIndex].data[n.index]}}}})},this.lineChart=function(e,t,n){var a,i,r;return null==t&&(t={}),null==n&&(n=!1),s.setTooltipsTextLayout(t,!0),a=0,i=1===e.length,r=!1,e[0].labels.length<2&&(r=!0,e[0].labels.push(e[0].labels[0])),(e.length>1||null!=t.pointDot&&!t.pointDot||r)&&angular.merge(t,{elements:{point:{radius:1e-4},line:{tension:.3}}}),{type:"line",options:t,data:{labels:e[0].labels,datasets:_.map(e,function(e){var t;return r&&e.values.push(e.values[0]),t=n?0===a?s.getNegativeColor():s.getPositiveColor():s.getColor(a),a++,{label:e.title,data:e.values,fill:i,backgroundColor:g(t,.3),borderColor:t,pointBorderColor:t,pointBackgroundColor:t,pointHoverBackgroundColor:"rgb(255,255,255)"}})}}},this.barChart=function(e,t,n){var a,i,r,o,l,d;for(null==t&&(t={}),null==n&&(n=!0),s.setTooltipsTextLayout(t),r=0,a=[],l=e.values,i=0,o=l.length;o>i;i++)d=l[i],n&&(e.values[r]=Math.abs(d)),a.push(s.getColor(r)),r++;return{type:"bar",options:t,data:{labels:e.labels,datasets:[{backgroundColor:a,data:e.values}]}}},this.combinedBarChart=function(e,t,n,a){var i,r;return null==t&&(t={}),null==n&&(n=!0),null==a&&(a=!1),s.setTooltipsTextLayout(t,!0),i=0,r={type:"bar",options:t,data:{labels:e.labels,datasets:_.map(e.datasets,function(e){var t,r,o,l,d;if(t=s.getColor(i),a&&(t=0===i?s.getNegativeColor():s.getPositiveColor()),i++,n)for(l=e.values,r=0,o=l.length;o>r;r++)d=l[r],d=Math.abs(d);return{label:e.title,data:e.values,backgroundColor:t}})}}},this.pieChart=function(e,t,n){var a,i,r,o,l,d,c;if(null==t&&(t={}),null==n&&(n=!1),s.setTooltipsTextLayout(t),o=0,a=[],n)for(a.push(s.getNegativeColor()),r=0,d=e.length;d>r;r++)i=e[r],0!==o&&a.push(s.getPositiveColor()),o++;else for(l=0,c=e.length;c>l;l++)i=e[l],a.push(s.getColor(o)),o++;return{type:"doughnut",options:t,data:{datasets:[{data:_.map(e,function(e){return Math.abs(e.value)}),backgroundColor:a}],labels:_.map(e,function(e){return e.label})}}}}])}.call(this),function(){angular.module("impac.services.currency-rates",[]).service("ImpacCurrencyRatesSvc",["$log","$http","$filter","$q","$timeout","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc",function(e,t,n,a,i,r,s,o){var l,d;return l=this,this.getSsoSessionId=s.getSsoSessionId,this.getCurrentDashboard=o.getCurrentDashboard,this.getOrgUids=_.pluck(l.getCurrentDashboard().data_sources,"uid"),this.locked=!1,this.ratesForPeriod=function(n){var s,o;return this.locked?(e.warn("Impac! - CurrencyRatesSvc: ratesForPeriod locked. Trying again in 1s"),i(function(){return l.ratesForPeriod(n)},1e3)):(this.locked=!0,s={sso_session:this.getSsoSessionId,engine:"currencies/currency_rates",metadata:{organization_ids:this.getOrgUids,hist_parameters:n}},o=d(r.widgets.show(),s),t.get(o).then(function(t){var n,a,i,r,o;if(r=[],null!=t&&null!=t.data&&!_.isEmpty(t.data.content))for(o=t.data.content.currency_rates,n=0,a=o.length;a>n;n++)i=o[n],r.push(i);return e.info("Impac! - CurrencyRatesSvc: ratesForPeriod params "+s),r},function(t){return e.error("Impac! - CurrencyRatesSvc: Cannot retrieve current rates :",t),a.reject(t)})["finally"](function(){return l.locked=!1}))},d=function(e,t){var n;return n=[e,decodeURIComponent($.param(t))].join("?")},this}])}.call(this),function(){angular.module("impac.services.dashboard-templates",[]).service("ImpacDhbTemplatesSvc",["$q","$http","$log","ImpacRoutes","ImpacDashboardsSvc",function(e,t,n,a){var i;return i=this,this.index=function(){return t.get(a.dashboardTemplates.index()).then(function(e){return e.data||[]},function(t){return n.err("Impac! DashboardTemplatesSvc: failed to retrieve dashboard templates",t),e.reject()})},this}])}.call(this),function(){angular.module("impac.services.dashboards",[]).service("ImpacDashboardsSvc",["$q","$http","$log","$timeout","ImpacMainSvc","ImpacRoutes","ImpacTheming","ImpacDeveloper","ImpacUtilities",function(e,t,n,a,i,r,s,o,l){var d,c,u,g,p,m,h;return d=this,this.config={},this.config.dashboards=[],this.getDashboards=function(){return d.config.dashboards},this.config.currentDashboard={},this.getCurrentDashboard=function(){return d.config.currentDashboard},this.config.widgetsTemplates=[],this.getWidgetsTemplates=function(){return d.config.widgetsTemplates},this.config.userAccesses={},this.userAccesses=function(){return d.config.userAccesses},this.callbacks={},this.callbacks.dashboardChanged=e.defer(),this.dashboardChanged=function(){return d.callbacks.dashboardChanged.promise},this.callbacks.widgetAdded=e.defer(),this.widgetAdded=function(){return d.callbacks.widgetAdded.promise},this.callbacks.pdfModeEnabled=e.defer(),this.pdfModeEnabled=function(){return d.callbacks.pdfModeEnabled.promise},this.callbacks.pdfModeCanceled=e.defer(),this.pdfModeCanceled=function(){return d.callbacks.pdfModeCanceled.promise},this.togglePdfMode=function(e){return e?d.callbacks.pdfModeEnabled.notify():d.callbacks.pdfModeCanceled.notify()},this.callbacks.ticked=e.defer(),this.ticked=function(){return d.callbacks.ticked.promise},this.tick=function(){return d.callbacks.ticked.notify()},this.callbacks.dhbLoader=e.defer(),this.dhbLoader=function(){return d.callbacks.dhbLoader.promise},this.triggerDhbLoader=function(e){return null==e&&(e=!1),d.callbacks.dhbLoader.notify(e)},p=function(){return _.isEmpty(d.config.dashboards)||_.isEmpty(d.config.currentDashboard)},this.isThereADashboard=function(){return!_.isEmpty(d.config.currentDashboard)},this.areThereSeveralDashboards=function(){return d.config.dashboards.length>1},this.isCurrentDashboardEmpty=function(){return d.isThereADashboard()&&_.isEmpty(d.config.currentDashboard.widgets)},this.areKpisEnabled=function(){return s.get().dhbKpisConfig.enableKpis&&i.userIsKpiEnabled()},this.reload=function(t){var n;return null==t&&(t=!1),n=e.defer(),d.triggerDhbLoader(!0),d.load(t).then(function(){return n.resolve()},function(){return n.reject()})["finally"](function(){return d.triggerDhbLoader(!1)}),n.promise},this.loadLocked=!1,this.load=function(s){var o;return null==s&&(s=!1),o=e.defer(),d.loadLocked?(n.warn("Impac! - DashboardsSvc: Load locked. Trying again in 1s"),a(function(){return d.load(s).then(function(e){return o.resolve(e)},function(e){return o.reject(e)})},1e3)):(d.loadLocked=!0,p()||s?i.load(s).then(function(a){var i,l,c;return l=a.currentOrganization.id,angular.merge(d.config.userAccesses,a.currentOrganization.acl.related),i=t.get(r.dashboards.index(l)).then(function(e){return d.setDashboards(e.data).then(function(){return d.setCurrentDashboard()})},function(){return n.error("Impac! - DashboardsSvc: cannot retrieve dashboards list for org: "+l)}),c=u(),e.all([i,c]).then(function(){return n.info("Impac! - DashboardsSvc: loaded (force="+s+")"),o.resolve(d.config)},function(e){return o.reject(e)})["finally"](function(){return d.loadLocked=!1})},function(e){return n.error("Impac! - DashboardsSvc: cannot retrieve current organization"),d.loadLocked=!1,o.reject(e)}):(d.loadLocked=!1,o.resolve(d.config))),o.promise},u=function(){var a,i,s;return s={},i=r.bolts(),s.legacy=t.get(h()).then(function(e){return _.sortBy(e.data.widgets,"name")},function(){return n.error("Impac! - DashboardsSvc: cannot retrieve widgets templates",h())}),a=_.map(i,function(e){var a;return a=e.provider+"_"+e.name,s[a]=t.get(e.path+"/widgets").then(function(t){return _.map(t.data.widgets,function(t){return _.extend(t,{metadata:{bolt_path:e.path,isBolt:!0}})})},function(){return n.error("Impac! - DashboardsSvc: cannot retrieve widgets templates from bolt",e.path+"/widgets")}),a}),e.all(s).then(function(e){var t;return t=_.map(a,function(t){return e[t]}),d.setWidgetsTemplates(_.flattenDeep([e.legacy,t]))})},h=function(){var e;return s.get().dhbWidgetsConfig.templates.defaultToFinancialYear?(e=i.getFinancialYearEndMonth(),r.widgets.templates()+"?financial_year_end_month="+e):r.widgets.templates()},m=function(){return null!=d.config.dashboards&&d.config.dashboards.length>0?(n.info("Impac! - DashboardsSvc: first dashboard set as current by default"),i.override(d.config.currentDashboard,d.config.dashboards[0]),d.initializeActiveTabs(),d.callbacks.dashboardChanged.notify(d.config.currentDashboard),!0):(n.warn("Impac! - DashboardsSvc: cannot set default current dashboard"),i.override(d.config.currentDashboard,{}),d.callbacks.dashboardChanged.notify(!1),!1)},this.setCurrentDashboard=function(e){var t;return null==e&&(e=null),null!=e?(t=_.find(d.config.dashboards,function(t){return e===t.id}),_.isEmpty(t)?(n.error("Impac! - DashboardsSvc: Dashboard "+e+" not found in dashboards list"),m()):(i.override(d.config.currentDashboard,t),d.initializeActiveTabs(),d.callbacks.dashboardChanged.notify(d.config.currentDashboard),!0)):m()},c=function(e,t){return _.includes(_.pluck(e.data_sources,"id"),t.id)},this.setDashboards=function(e){return null==e&&(e=[]),i.loadOrganizations().then(function(t){var n,a,i,r,s;for(n=t.currentOrganization,_.remove(d.config.dashboards,function(){return!0}),s=[],i=0,r=e.length;r>i;i++)a=e[i],c(a,n)?s.push(d.config.dashboards.push(a)):s.push(void 0);return s},function(){return n.error("Impac! - DashboardsSvc: Cannot load user's organizations")})},g=function(e){var t,n,a,i;return l.fetchWidgetTemplatePath(e)?(a=s.get().widgetSelectorConfig,i=l.fetchWidgetCssClass(e),(t=e.metadata&&e.metadata.bolt_path)&&(n=_.find(r.bolts(),function(e){return e.path===t}),i=n.provider+"/"+n.name+"/"+e.endpoint),_.isEmpty(a.whitelist)?_.isEmpty(a.blacklist)?!0:!_.includes(a.blacklist,i):_.includes(a.whitelist,i)):!1},this.setWidgetsTemplates=function(e){var t,n,a,i;if(_.isEmpty(e))return!1;for(o.isEnabled()&&(e=o.stubWidgetsTemplates(e)),t=d.config.widgetsTemplates,t.length=0,n=0,a=e.length;a>n;n++)i=e[n],g(i)&&t.push(i);return t},this.initializeActiveTabs=function(){var e,t,n,a,i;for(a=d.config.dashboards,i=[],t=0,n=a.length;n>t;t++)e=a[t],i.push(_.merge(e,{active:d.config.currentDashboard.id===e.id}));return i},this.create=function(a){return d.load().then(function(){var s,o,l;return o=e.defer(),l=i.config.currentOrganization,null==a.currency&&(a.currency=l.currency||"USD"),s={dashboard:a},t.post(r.dashboards.create(l.id),s).then(function(e){return d.config.dashboards.push(e.data),d.setCurrentDashboard(e.data.id),o.resolve(e.data)},function(e){return n.error("Impac! - DashboardsSvc: Cannot create dashboard with parameters: "+angular.toJson(a),e),o.reject(e)}),o.promise})},this.copy=function(a){var i;return a.id||e.reject("The dashboard you are trying to copy does not have an id"),i={dashboard:a},d.load().then(function(){return t.post(r.dashboards.copy(a.id),i).then(function(t){var n;return n=t.data,d.config.dashboards.push(n),d.setCurrentDashboard(n.id),e.resolve(n)},function(t){return n.error("Impac! - DashboardsSvc: Cannot copy dashboard with parameters: "+angular.toJson(a),t),e.reject(t)})})},this["delete"]=function(a){var i;return i=e.defer(),t["delete"](r.dashboards["delete"](a)).then(function(e){return _.remove(d.config.dashboards,function(e){return a===e.id}),d.setCurrentDashboard(),i.resolve(e)},function(e){return n.error("Impac! - DashboardsSvc: Cannot delete dashboard: "+a),i.reject(e)}),i.promise},this.update=function(a,i){var s,o;return o=e.defer(),s={dashboard:i},t.put(r.dashboards.update(a),s).then(function(e){return angular.merge(_.find(d.config.dashboards,function(e){return a===e.id}),e.data),a===d.config.currentDashboard.id&&angular.merge(d.config.currentDashboard,e.data),o.resolve(e.data)},function(e){return n.error("Impac! - DashboardsSvc: Cannot update dashboard: "+a+" with parameters: "+angular.toJson(i)),o.reject(e)}),o.promise},d}])}.call(this),function(){angular.module("impac.services.developer",[]).provider("ImpacDeveloper",function(){var e,t,n;return n=this,t={status:!1,widgetsTemplates:[]},n.configure=function(e){return angular.extend(t,e)},e=function(e){var n,a;return n={endpoint:"endpoint"},a=this,a.isEnabled=function(){return t.status},a.stubWidgetsTemplates=function(e){return e.concat(t.widgetsTemplates)},a.findTemplate=function(e,a,i){var r;return null==a&&(a=["endpoint","metadata"]),null==i&&(i=["template"]),r=_.mapKeys(e,function(e,t){return null!=n[t]?n[t]:t}),r.metadata&&(r.metadata=_.pick(r.metadata,i)),_.find(t.widgetsTemplates,function(e){return _.isEqual(_.pick(r,a),_.pick(e,a))})},a.isWidgetStubbed=function(e){return!_.isEmpty(a.findTemplate(e))},a.createWidgetStub=function(t,n){var i;return i=angular.copy(a.findTemplate(t)),e.resolve({data:{id:Math.random().toString(36).substr(2,9)+"-stubbed",name:i.name,endpoint:i.endpoint,width:i.width,metadata:angular.merge(i.metadata,{organization_ids:_.map(n.data_sources,function(e){return e.uid}),currency:n.currency})}})},a.updateWidgetStub=function(t,n){var i;return i=angular.copy(a.findTemplate(t)),angular.merge(n.metadata,i.metadata),e.resolve({data:n})},a.deleteWidgetStub=function(){return e.resolve({success:!0})},a},e.$inject=["$q"],n.$get=e,n})}.call(this),function(){angular.module("impac.services.events",[]).service("ImpacEvents",["$log",function(e){var t,n;return t=this,n={},this.registerCb=function(t,a){return _.isFunction(a)?_.isString(t)?(n[t]||(n[t]=[]),n[t].push(a)):e.warn("Event must be a string"):e.warn("Callback must be a Function")},this.notifyCallbacks=function(t,a){return null==a&&(a=null),n[t]?_.forEach(n[t],function(e){return e(a)}):e.warn("No observableCallbacks event named '"+t+"' found.")},this.deregisterCb=function(e,t){return _.remove(n[e],function(e){return t===e}),_.isEmpty(n[e])?delete n[e]:void 0},this.unsubscribe=function(e){return delete n[e]},t}])}.call(this),function(){angular.module("impac.services.highcharts-factory",[]).factory("HighchartsFactory",["$filter",function(e){var t,n,a;return n={line:Object.freeze({chart:{type:"line",zoomType:"x",spacingTop:20},legend:{enabled:!0,layout:"vertical",align:"left",verticalAlign:"middle"},title:null,credits:{enabled:!1},yAxis:{title:null,startOnTick:!0,minPadding:0,buttons:[{type:"month",count:4,text:"def."},{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}]}})},a=moment().startOf("day").add(moment().utcOffset(),"minutes"),t=function(){function t(e,t,a){var i,r,s,o,l;this.id=e,this.series=null!=t?t:{},this.settings=null!=a?a:{},o=n[this.settings.chartType],i=this.formatters(this.settings.currency),l=this.todayMarker(this.settings.showToday,this.settings.markerColor),r=this.onClickCallbacks(this.settings.chartOnClickCallbacks),s={series:this.series},this.highChartOptions=angular.merge({},s,o,i,l,r)}return t.prototype.render=function(){return this.hc=Highcharts.stockChart(this.id,this.highChartOptions),this},t.prototype.formatters=function(t){return{xAxis:{labels:{formatter:function(){return moment.utc(this.value).format("Do MMM YYYY")}}},yAxis:{labels:{formatter:function(){return e("mnoCurrency")(this.value,t,!1,0)}}},tooltip:{shared:!1,formatter:function(){var n,i,r;return i=moment.utc(this.x).format("Do MMM YYYY"),n=e("mnoCurrency")(this.y,t,!1),r=this.series.name,moment(this.x)<a&&(r=_.startCase(_.trim(r.toLowerCase().replace(/\s*projected\s*/," ")))),"<strong>"+i+"</strong><br>"+r+": "+n}}}},t.prototype.todayMarker=function(e,t){return null==t&&(t="rgba(0, 85, 255, 0.2)"),e?{xAxis:{plotLines:[{color:t,value:1e3*a.unix(),width:1,label:{text:null,verticalAlign:"top",textAlign:"center",rotation:0,y:-5}}]}}:{}},t.prototype.addThreshold=function(e){var t,n,i,r,s;if(!_.isEmpty(this.hc)){for(t=angular.copy(this.series[0].data),n=0,i=t.length;i>n;n++)s=t[n],s[1]=!e.fullLengthThresholds&&moment(s[0])<a?null:parseFloat(e.value);return r=angular.extend({data:t,showInLegend:!1,marker:{enabled:!1}},e),this.hc.addSeries(r)}},t.prototype.removeThreshold=function(e){var t;return t=this.findThreshold(e),null!=t?t.remove():void 0},t.prototype.findThreshold=function(e){return _.find(this.hc.series,function(t){return t.options.kpiId===e})},t.prototype.addThresholdEvent=function(e,t,n){return null!=e&&null!=t&&_.isFunction(n)?Highcharts.addEvent(e,t,function(){return n(e)}):void 0},t.prototype.addCustomLegend=function(e,t,n){var a;return null==t&&(t=!0),null==n&&(n=!0),a={legend:{labelFormatter:e,useHTML:t,enabled:n}},angular.merge(this.highChartOptions,a)},t.prototype.removeLegend=function(){var e;return e={legend:{enabled:!1}},angular.merge(this.highChartOptions,e)},t.prototype.addSeriesEvent=function(e,t){var n,a;return n={},n[e]=t,a={plotOptions:{series:{events:n}}},angular.merge(this.highChartOptions,a)},t.prototype.onClickCallbacks=function(e){var t;return null==e&&(e=[]),this.settings.chartOnClickCallbacks=e,t=function(e){return _.each(this.settings.chartOnClickCallbacks,function(t){return t(e)})},{chart:{events:{click:t.bind(this)}}}},t.prototype.addOnClickCallback=function(e){return this.settings.chartOnClickCallbacks.push(e)},t.prototype.addXAxisOptions=function(e){var t,n;return n=null!=e?{events:{setExtremes:e.callback},max:_.get(e.defaults,"max"),min:_.get(e.defaults,"min")}:void 0,t={xAxis:n,rangeSelector:{selected:_.get(n,"min")?null:0}},angular.merge(this.highChartOptions,t)},t}()}])}.call(this),function(){angular.module("impac.services.kpis",[]).service("ImpacKpisSvc",["$log","$http","$filter","$q","$timeout","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc","ImpacDeveloper","ImpacAlerts","ImpacEvents","IMPAC_EVENTS","ImpacUtilities","ImpacTheming","toastr",function(e,t,n,a,i,r,s,o,l,d,c,u,g,p,m){var h,f,v;return h=this,this.getSsoSessionId=s.getSsoSessionId,this.getCurrentDashboard=o.getCurrentDashboard,this.config={kpisTemplates:[]},this.getKpisTemplates=function(){return h.config.kpisTemplates},this.getKpiTemplate=function(e,t){return _.find(h.getKpisTemplates(),function(n){return n.endpoint===e&&n.watchables[0]===t})},this.getAttachableKpis=function(e){var t;return t=a.defer(),h.load().then(function(){var n;return n=_.select(h.getKpisTemplates(),function(t){return _.isArray(t.attachables)?_.includes(t.attachables,e):!1}),t.resolve(n)},function(){return t.reject()}),t.promise},this.getKpisDateRange=function(){return p.get().dhbKpisConfig.enableDatesPicker?h.load().then(function(){var e;return e=h.getCurrentDashboard().metadata.kpis_hist_parameters,!_.isEmpty(e)&&_.isObject(e)?e:s.load().then(function(e){var t,n;return n=parseInt(e.currentOrganization.financial_year_end_month)||6,t=g.financialYearDates(n),{from:t.start,to:moment().format("YYYY-MM-DD"),keepToday:!0}})}):a.reject("Kpis dates picker disabled")},c.registerCb(u.kpiTargetAlert,function(){return h.refreshAll(!0)}),v=function(e,t,n,a){var i,r;return i=[e,t,n].join("/"),r=[i,decodeURIComponent($.param(a))].join("?")},this.locked=!1,this.load=function(t){return null==t&&(t=!1),h.locked?(e.warn("Impac! - KpisSvc: Load locked. Trying again in 1s"),i(function(){return h.load(t)},1e3)):(h.locked=!0,a.all([s.loadUserData(),o.load()]).then(function(n){var a,i,r;return a=_.pluck(h.getCurrentDashboard().data_sources,"uid"),r=n[0].sso_session,i={metadata:{organization_ids:a},opts:{refresh_cache:t}},r&&(i.sso_session=r),f(i)["finally"](function(){return h.locked=!1,e.info("Impac! - KpisSvc: loaded")})},function(t){return e.error("Impac! - KpisSvc: failed to load.",t)})["finally"](function(){return h.locked=!1}))},this.massAssignAll=function(e){return h.load().then(function(){var t,n,a,i,r,s,o,l,d,c,u;for(l=h.getCurrentDashboard().kpis,t=0,r=l.length;r>t;t++)a=l[t],h.update(a,{metadata:e});for(d=h.getCurrentDashboard().widgets,n=0,s=d.length;s>n;n++)for(u=d[n],c=u.kpis,i=0,o=c.length;o>i;i++)a=c[i],h.update(a,{metadata:e},!1)})},this.isRefreshing=!1,this.refreshAll=function(t){return null==t&&(t=!1),h.isRefreshing?void 0:(h.isRefreshing=!0,h.load(t).then(function(){var n,a,i,r,s;for(r=h.getCurrentDashboard().kpis,s=[],n=0,i=r.length;i>n;n++)a=r[n],s.push(h.show(a,t).then(function(){},function(t){return e.error("Unable to refresh all Kpis: "+t)}));return s})["finally"](function(){return i(function(){return h.isRefreshing=!1},3e3)}))},this.validateKpiTargets=function(e){return _.isEmpty(e)?!1:_.every(e,function(e){return!_.isEmpty(e)&&_.every(e,function(e){return e.min||e.max})})},this.formatKpiName=function(e){var t;return t=_.find(h.getKpisTemplates(),function(t){return t.endpoint===e}),angular.copy(t.name)},this.formatKpiTarget=function(e,t,a){var i,r;return null==a&&(a=[]),e&&t?(r=_.keys(e)[0],i=_.find(a,function(e){return e.mode===r})||{},(i.label||r)+" "+n("mnoCurrency")(e[r],t,!1)):""},this.updateKpisOrder=function(e){var t,n;return t=h.getCurrentDashboard().id,n={metadata:{kpis_order:e}},o.update(t,n)},this.getKpiTargetPlaceholder=function(e,t){var n;return n=h.getKpiTemplate(e,t),null!=n&&null!=n.target_placeholders&&n.target_placeholders[t]||{}},this.buildKpiWatchables=function(e){return e.element_watched?e.watchables=[e.element_watched].concat(e.extra_watchables||[]):void 0},f=function(n){var i,s,o,l,d,c,u;for(l=[],d=[],o=[r.kpis.index(),decodeURIComponent($.param(n))].join("?"),d.push(t.get(o).then(function(e){var t,n,a,i,r;for(a=e.data.kpis,i=[],t=0,n=a.length;n>t;t++)r=a[t],r.source||(r.source="impac"),i.push(l.push(r));return i},function(){return e.error("Impac! - KpisSvc: cannot retrieve kpis templates from Impac!")})),r.kpis.local()&&t.get(r.kpis.local()).then(function(e){var t,n,a,i,r;for(a=e.data.kpis,i=[],t=0,n=a.length;n>t;t++)r=a[t],r.source="local",i.push(h.config.kpisTemplates.push(r));return i},function(){return e.error("Impac! - KpisSvc: cannot retrieve kpis templates from local",""+r.kpis.local())}),u=r.bolts(),s=0,c=u.length;c>s;s++)i=u[s],d.push(t.get(i.path+"/kpis").then(function(e){var t,n,a,r,s;for(a=e.data.kpis,r=[],t=0,n=a.length;n>t;t++)s=a[t],s.metadata||(s.metadata={}),s.metadata.bolt_path=i.path,r.push(l.push(s));return r},function(){return e.error("Impac! - KpisSvc: cannot retrieve kpis templates from bolt",i.path+"/kpis")}));return a.all(d).then(function(){var e,t,n,a;for(_.remove(h.config.kpisTemplates,function(){return!0}),n=[],e=0,t=l.length;t>e;e++)a=l[e],n.push(h.config.kpisTemplates.push(a));return n})},this.show=function(n,i){return null==i&&(i=!1),n.isLoading=!0,h.load().then(function(){var s,o,l,d;switch(l=angular.copy(n.settings)||{},l.utc_offset||(l.utc_offset=moment().utcOffset()),o={opts:{refresh_cache:i}},h.getSsoSessionId()&&(o.sso_session=h.getSsoSessionId()),null!=n.targets&&(o.targets=n.targets),o.metadata=l,null!=n.extra_params&&(o.extra_params=n.extra_params),null!=n.extra_watchables&&(o.extra_watchables=n.extra_watchables),n.source){case"impac":s=r.kpis.show(h.getCurrentDashboard().id,n.id);break;case"local":s=r.kpis.local()}return d=v(s,n.endpoint,n.element_watched,o),t.get(d).then(function(e){var t,a,i;return t=e.data.kpi,n.data=t.calculation,i=t.configuration||{},a=_.select(["targets","extra_params"],function(e){return null==n[e]&&null!=i[e]}),angular.extend(n,_.pick(i,a)),n.layout=t.layout,n},function(t){return e.error("Impac! - KpisSvc: Could not retrieve KPI (show) at: "+n.endpoint,t),a.reject(t)})},function(){return e.error("Impac! - KpisSvc: Service not initialized"),a.reject({error:{message:"Impac! - KpisSvc: Service is not initialized"}})})["finally"](function(){return n.isLoading=!1})},this.create=function(n,i,s,o){var l;return null==o&&(o={}),l=a.defer(),h.load().then(function(){var a;return a={source:n,endpoint:i,element_watched:s,metadata:{currency:h.getCurrentDashboard().currency}},h.getKpisDateRange().then(function(e){return null==a.metadata&&(a.metadata={}),a.metadata.hist_parameters=e})["finally"](function(){var n;return angular.merge(a,o),n=r.kpis.create(h.getCurrentDashboard().id),t.post(n,{kpi:a}).then(function(e){var t;return c.notifyCallbacks(u.addOrRemoveAlerts),t=e.data,h.buildKpiWatchables(t),l.resolve(t)},function(t){return e.error("Impac! - KpisSvc: Unable to create kpi endpoint="+i,t),m.error("Unable to create KPI","Error"),l.reject(t)})})},function(){return l.reject({error:{message:"Impac! - KpisSvc: Service is not initialized"}})}),l.promise},this.update=function(n,i,s){return null==i&&(i={}),null==s&&(s=!0),n.isLoading=!0,h.load().then(function(){var o,l;return o={},null!=i.name&&(o.name=i.name),null!=i.metadata&&(o.settings=i.metadata),null!=i.targets&&(o.targets=i.targets),null!=i.extra_params&&(o.extra_params=i.extra_params),l=r.kpis.update(h.getCurrentDashboard().id,n.id),_.isEmpty(o)?void 0:t.put(l,{kpi:i}).then(function(e){return c.notifyCallbacks(u.addOrRemoveAlerts),angular.extend(n,e.data),h.buildKpiWatchables(n),s?h.show(n):n},function(t){return e.error("Impac! - KpisSvc: Unable to update KPI "+n.id,t),a.reject(t)})})["finally"](function(){return n.isLoading=!1})},this["delete"]=function(n){return h.load().then(function(){var i;return i=r.kpis["delete"](h.getCurrentDashboard().id,n.id),t["delete"](i).then(function(e){return c.notifyCallbacks(u.addOrRemoveAlerts),e},function(t){return e.error("Impac! KpisSvc: Unable to delete KPI "+n.id,t),a.reject(t)})})},this.saveAlerts=function(e,t){var n,i,r,s,o,l,g,p,m,h,f,v;for(r=_.filter(t,function(t){return t.active&&!_.includes(_.map(e.alerts,function(e){return e.service}),t.service)}),s=_.filter(e.alerts,function(e){return!t[e.service].active}),o=_.filter(t,function(t){var n,a,i,r;return n=_.find(e.alerts,function(e){return e.service===t.service}),"inapp"!==t.service&&n&&t.recipients?(a=n.recipients.map(function(e){return e.id}).sort(),r=t.recipients.map(function(e){return e.id}).sort(),i=!1,(r.length!==a.length||""+a!=""+r)&&(i=!0),t.id=n.id,t.active&&i):!1}),v=[],l=0,m=r.length;m>l;l++)n=r[l],i={alert:_.pick(n,["service"])},"email"===n.service&&(i.alert.recipients=n.recipients),v.push(d.create(e.id,i));for(g=0,h=s.length;h>g;g++)n=s[g],v.push(d["delete"](n.id));for(p=0,f=o.length;f>p;p++)n=o[p],v.push(d.update(n.id,{alert:_.pick(n,["service","recipients"])}));return a.all(v).then(function(t){var n,a,i;for(e.alerts||(e.alerts=[]),a=0,n=t.length;n>a;a++)i=t[a],i.data.deleted?_.remove(e.alerts,function(e){return e.service===i.data.deleted.service}):e.alerts.push(i.data);return c.notifyCallbacks(u.addOrRemoveAlerts)})},this}])}.call(this),function(){angular.module("impac.services.linking",[]).provider("ImpacLinking",function(){var e,t,n,a;return n=this,a={user:null,organizations:null},t={pusher_key:""},n.linkData=function(e){var t,i,r;for(t in a){if(r=a[t],i=e[t],null==i)throw new Error("impac-angular linking.svc: Missing core data ("+t+") to run impac-angular.");if("function"!=typeof i)throw new TypeError("impac-angular linking.svc: "+t+" should be a Function.");a[t]=i}return n.linkOptionalData(e,!1),!0},n.linkOptionalData=function(e,n){var a,i,r,s;null==n&&(n=!0),s={pusher_key:", Alerts are disabled!"};for(a in t)r=t[a],i=e[a],null==i?console.warn("impac-angular linking.svc: No "+a+" is configured"+s[a]||""):(t[a]=i,n&&console.log("impac-angular linking.svc: "+a+" successfully configured"));
return!0},e=function(e){var n;return n=this,n.getUserData=function(){return a.user().then(function(e){return e},function(t){return e.reject(t)})},n.getOrganizations=function(){return a.organizations().then(function(e){return e},function(t){return e.reject(t)})},n.getPusherKey=function(){return t.pusher_key},n},e.$inject=["$q"],n.$get=e,n})}.call(this),function(){angular.module("impac.services.main",[]).service("ImpacMainSvc",["$q","$log","$timeout","ImpacLinking","ImpacNotifications",function(e,t,n,a,i){var r,s,o,l;return r=this,this.config={organizations:[],currentOrganization:{},userData:{},currencies:["USD","AUD","CAD","CNY","EUR","GBP","HKD","INR","JPY","NZD","SGD","PHP","AED","IDR","MMK"]},this.getSsoSessionId=function(){return r.config.userData.sso_session},this.getFinancialYearEndMonth=function(){return parseInt(r.config.currentOrganization.financial_year_end_month)},this.userIsKpiEnabled=function(){return r.config.userData.kpi_enabled},this.callbacks={},this.callbacks.organizationChanged=e.defer(),this.organizationChanged=function(){return r.callbacks.organizationChanged.promise},s=function(){return!(_.isEmpty(r.config.organizations)||_.isEmpty(r.config.currentOrganization||_.isEmpty(r.config.userData)))},this.load=function(n){var a;return null==n&&(n=!1),a=e.defer(),!s()||n?e.all([r.loadOrganizations(n),r.loadUserData(n)]).then(function(){return i.load(),a.resolve(r.config),t.info("Impac! - MainSvc: loaded (force="+n+")")},function(e){return t.error("Impac! - MainSvc: failed to load configuration"),a.reject(e)}):a.resolve(r.config),a.promise},this.loadOrganizations=function(n){var i;return null==n&&(n=!1),i=e.defer(),_.isEmpty(r.config.organizations)||_.isEmpty(r.config.currentOrganization)||n?(r.config.organizations=[],r.config.currentOrganization={},r.config.currentOrgMembers=[],a.getOrganizations().then(function(e){return null!=e.organizations&&e.organizations.length>0?(r.config.organizations=e.organizations,r.config.currentOrgMembers=e.currentOrgMembers,r.setCurrentOrganization(e.currentOrgId),t.info("Impac! - MainSvc: Organizations loaded (force="+n+")")):t.info("Impac! - MainSvc: retrieved empty organizations list"),i.resolve(r.config)},function(e){return t.error("Impac! - MainSvc: cannot load organizations"),i.reject(e)})):i.resolve(r.config),i.promise},o=function(){return null!=r.config.organizations&&r.config.organizations.length>0?(r.config.currentOrganization=r.config.organizations[0],t.info("Impac! - MainSvc: first organization set as current by default"),r.callbacks.organizationChanged.notify(r.config.currentOrganization),!0):(t.error("Impac! - MainSvc: cannot set default current organization"),r.config.currentOrganization={},r.callbacks.organizationChanged.notify(!1),{error:{code:400,message:"cannot set default current organization"}})},this.setCurrentOrganization=function(e){var n;return null==e&&(e=null),null!=e?(n=_.find(r.config.organizations,function(t){return e===t.id}),_.isEmpty(n)?(t.error("Impac! - MainSvc: organization: "+e+" not found in organizations list"),o()):(r.config.currentOrganization=n,r.callbacks.organizationChanged.notify(r.config.currentOrganization),!0)):o()},l=!1,this.loadUserData=function(i){var s;return null==i&&(i=!1),s=e.defer(),l?(t.warn("Impac! - MainSvc: User data load locked. Trying again in 1s"),n(function(){return r.loadUserData(i).then(function(e){return s.resolve(e)},function(e){return s.reject(e)})},1e3)):(l=!0,_.isEmpty(r.config.userData)||i?(r.config.userData={},a.getUserData().then(function(e){return angular.extend(r.config.userData,e),t.info("Impac! - MainSvc: User data loaded (force="+i+") with sso_session "+r.config.userData.sso_session),s.resolve(r.config.userData)},function(e){return t.error("Impac! - MainSvc: cannot retrieve user data"),s.reject(e)})["finally"](function(){return l=!1})):(l=!1,s.resolve(r.config.userData))),s.promise},this.override=function(e,t){var n,a;for(n in e)a=e[n],delete e[n];for(n in t)a=t[n],e[n]=a;return e},r}])}.call(this),function(){angular.module("impac.services.message-bus",[]).service("MsgBus",function(){var e;e={dashboardGrid:{},controlBarFilter:{},controlBarQuickFilter:{},orgaSharingModal:{},appConnectModal:{},page:{},pane:{},errors:[],autostopQueue:[],notificationQueue:[],params:{}},this.publish=function(t,n){return e[t]=n},this.subscribe=function(t){return function(){return e[t]}}})}.call(this),function(){angular.module("impac.services.notifications",[]).service("ImpacNotifications",["$log","Pusher","ImpacTheming","ImpacEvents","IMPAC_EVENTS","toastr",function(e,t,n,a,i,r){var s,o;return o=this,a.registerCb(i.addOrRemoveAlerts,function(){return o.load()}),s={kpi_target_alert:function(e){var t;return t=e.data,r.warning(t.subject),a.notifyCallbacks(i.kpiTargetAlert,t)}},this.load=function(){return n.get().alertsConfig.enableAlerts?a.notifyCallbacks(i.impacNotificationsLoad,function(e){var n,a,i,r,o,l,d,c,u,g,p;for(c=t.init(),u=_.map(e,function(e){return"inapp"===e.service&&_.has(e.metadata,"pusher")?_.pick(e.metadata,["pusher"]):null}),u=_.uniq(_.compact(u)),i=_.uniq(_.map(u,function(e){return e.pusher.channel})),g=c.socket.allChannels(),r=0,l=g.length;l>r;r++)n=g[r],i.indexOf(n)<0?c.disconnectChannel(n.name):c.unbindAll(n.name);for(p=[],o=0,d=u.length;d>o;o++)a=u[o],p.push(c.bind(a.pusher.channel,a.pusher.event,s[a.pusher.event]));return p}):void 0},o}])}.call(this),function(){angular.module("impac.services.routes",[]).provider("ImpacRoutes",function(){var e,t,n,a,i;return i=this,n={mnoHub:"http://localhost:7000/mnoe/jpi/v1",impacApi:"http://localhost:4000/api",dashboards:{index:null,show:null,create:null,update:null,del:null,copy:null},dashboardTemplates:{index:null,create:null,update:null,del:null},widgets:{index:null,show:null,create:null,update:null,del:null,suggest:null},kpis:{index:null,show:null,create:null,update:null,del:null,local:null},alerts:{index:null,create:null,update:null,del:null},organizations:{appInstancesSync:null}},t={version:"v2",engines:[]},a=function(e){return e.provider||console.warn("Bolt has no provider",e),e.name||console.warn("Bolt has no name",e),e.category||console.warn("Bolt is not mapped to a category",e),Boolean(e.provider&&e.name&&e.category)},i.configureRoutes=function(e){return angular.extend(n,e)},i.configureBolts=function(e,n){var i,r,s;for(r=0,s=n.length;s>r;r++)if(i=n[r],!a(i))return console.warn("Default bolts will be used:",t),!1;return angular.extend(t,{version:e,engines:n})},e=function(){var e;return e=this,e.dashboards={index:function(e){return null==e&&(e=null),n.dashboards.index?n.dashboards.index.replace(":organization_id",e):n.mnoHub+"/impac/dashboards"},create:function(t){return null==t&&(t=null),n.dashboards.create?n.dashboards.create.replace(":organization_id",t):e.dashboards.index(t)},show:function(e){return n.dashboards.show?n.dashboards.show.replace(":id",e):n.mnoHub+"/impac/dashboards/"+e},update:function(t){return n.dashboards.update?n.dashboards.update.replace(":id",t):e.dashboards.show(t)},"delete":function(t){return n.dashboards.del?n.dashboards.del.replace(":id",t):e.dashboards.show(t)},copy:function(t){return n.dashboards.copy?n.dashboards.copy.replace(":id",t):e.dashboards.show(t)+"/copy"}},e.dashboardTemplates={index:function(){return n.dashboardTemplates.index?n.dashboardTemplates.index:n.mnoHub+"/impac/dashboard_templates"}},e.widgets={index:function(e){return n.widgets.index?n.widgets.index.replace(":dashboard_id",e):n.mnoHub+"/impac/widgets"},show:function(e,t,a){return n.widgets.show?n.widgets.show.replace(":endpoint",e).replace(":dashboard_id",t).replace(":id",a):n.impacApi+"/v1/widgets/"+e},create:function(t){return n.widgets.create?n.widgets.create.replace(":dashboard_id",t):e.dashboards.show(t)+"/widgets"},update:function(t,a){return n.widgets.update?n.widgets.update.replace(":dashboard_id",t).replace(":id",a):e.widgets.index(t)+"/"+a},"delete":function(t,a){return n.widgets.del?n.widgets.del.replace(":dashboard_id",t).replace(":id",a):e.widgets.index(t)+"/"+a},suggest:function(){return n.widgets.suggest},templates:function(){return n.impacApi+"/v1/widgets"}},e.kpis={index:function(e){return n.kpis.index?n.kpis.index.replace(":dashboard_id",e):n.impacApi+"/v1/kpis"},show:function(e,t){return n.kpis.show?n.kpis.show.replace(":dashboard_id",e).replace(":id",t):n.impacApi+"/v1/kpis"},create:function(t){return n.kpis.create?n.kpis.create.replace(":dashboard_id",t):e.dashboards.show(t)+"/kpis"},update:function(e,t){return n.kpis.update?n.kpis.update.replace(":dashboard_id",e).replace(":id",t):n.mnoHub+"/impac/kpis/"+t},"delete":function(e,t){return n.kpis.del?n.kpis.del.replace(":dashboard_id",e).replace(":id",t):n.mnoHub+"/impac/kpis/"+t},local:function(){return n.kpis.local},alerts:{index:function(){return n.alerts.index?n.alerts.index:n.mnoHub+"/impac/alerts"},create:function(e){return n.alerts.create?n.alerts.create.replace(":kpi_id",e):n.mnoHub+"/impac/kpis/"+e+"/alerts"},update:function(e){return n.alerts.update?n.alerts.update.replace(":id",e):n.mnoHub+"/impac/alerts/"+e},"delete":function(e){return n.alerts.del?n.alerts.del.replace(":id",e):n.mnoHub+"/impac/alerts/"+e}}},e.organizations={appInstancesSync:function(e){return n.organizations.appInstancesSync?n.organizations.appInstancesSync.replace(":uid",e):n.mnoHub+"/organizations/"+e+"/app_instances_sync"}},e.bolts=function(){return _.map(t.engines,function(e){return angular.extend(e,{path:n.impacApi+"/"+t.version+"/"+e.provider+"/"+e.name})})},e},e.$inject=[],i.$get=e,i})}.call(this),function(){angular.module("impac.services.pusher",[]).service("Pusher",["$window","ImpacLinking",function(e,t){var n;return n=this,this.config={pusherOpts:{encrypted:!0}},this.init=function(a){return null==a&&(a=[]),n.socket||(n.socket=new e.Pusher(t.getPusherKey(),n.config.pusherOpts)),_.forEach(a,function(e){return n.socket.subscribe(e)}),n},this.bind=function(e,t,a){return n.socket||n.init(),n.socket.channel(e)||n.socket.subscribe(e),n.socket.channel(e).bind(t,a)},this.bindAll=function(e,t){return n.socket||n.init(),_.forEach(n.socket.allChannels(),function(n){return n.bind(e,t)})},this.unbind=function(e,t){return n.socket&&n.socket.channel(e)?n.socket.channel(e).unbind(t):void 0},this.unbindAll=function(e){return n.socket&&n.socket.channel(e)?n.socket.channel(e).unbind():void 0},this.disconnectChannel=function(e){return n.socket?n.socket.unsubscribe(e):void 0},n}])}.call(this),function(){angular.module("impac.services.theming",[]).provider("ImpacTheming",function(){var e,t,n;return n=this,t={chartColors:{positive:"#3FC4FF",negative:"#1DE9B6",array:["#1de9b6","#7c4dff","#ffc928","#3fc4ff","#ff8e01","#c6ff00","#d500fa","#ff6e41","#ffeb3c","#ff1844"]},dhbConfig:{showDhbHeading:!1,dhbHeadingText:"Impac!",multiCompany:!1,designerMode:{enabled:!1,dhbLabelName:"Template"}},dhbSelectorConfig:{selectorType:"dropdown",customTmplPath:null,accessibilityEnabled:!1,pdfModeEnabled:!1},dhbWidgetsConfig:{templates:{defaultToFinancialYear:!0}},dhbKpisConfig:{enableKpis:!0,parentElementId:"",enableDatesPicker:!0},alertsConfig:{enableAlerts:!0},dataNotFoundConfig:{content:{mainMessage:"impac.data_not_found_config.main_message",liveBMessage:"impac.data_not_found_config.live_b_message",linkMessage:"impac.data_not_found_config.link_message",liveBTitle:"impac.data_not_found_config.live_b_title",title:"impac.data_not_found_config.title",seeExample:"impac.data_not_found_config.see_example",demoData:"impac.data_not_found_config.demo_data"},linkUrl:"/apps",linkTarget:"_blank",linkUrlCallback:null},dhbErrorsConfig:{firstTimeCreated:{first:"impac.widget.common.error_config.first_time_created.first",second:"impac.widget.common.error_config.first_time_created.second",note:"impac.widget.common.error_config.first_time_created.note"},empty:{first:"impac.widget.common.error_config.empty.first",second:"impac.widget.common.error_config.empty.second"},failed:{first:"impac.widget.common.error_config.failed.first",second:"impac.widget.common.error_config.failed.second"}},dhbSubMenuConfig:{myobMessage:{show:!0,appLink:{show:!0,url:"#/marketplace",text:"impac.widget.common.sub_menu_config.check_this_app"}}},widgetSelectorConfig:{path:null,whitelist:[],blacklist:[]},addChartTile:{show:!1,onClickOptions:{triggers:[]}},showNoWidgetMsg:{show:!0},dhbSettings:{inWidgetsContainer:!1,syncApps:{show:function(){return!0},productDescriptor:"Impac!"},currency:{locked:!1},createFromTemplateEnabled:!1},widgetSettings:{histModeChoser:{currentLabels:{bls:"impac.widget.theming.hist.bls",pnl:"impac.widget.theming.hist.pnl","default":"impac.widget.theming.hist.default"},todayPrefixes:{bls:"impac.widget.theming.hist.bls.prefix",pnl:"impac.widget.theming.hist.pnl.prefix","default":"impac.widget.theming.hist.default.prefix"}},timePeriod:{showSlider:!0},tagging:{enabled:!1}},dateFormatterSettings:{"default":"L"}},n.configure=function(e){return angular.merge(t,e)},e=function(e,n){var a;return a=this,a.get=function(){return t},a.getDhbLabelName=function(){var e;return e=t.dhbConfig.designerMode,e.enabled?e.dhbLabelName:"Dashboard"},a.color={generateRandomShade:function(t){var a,i;return a=e.Color(t).hsl(),i=e.Color().hsl(a.h,n.getRandomInteger(40,100),n.getRandomInteger(50,85)).rgb(),"rgb("+i.r+", "+i.g+", "+i.b+")"},generateShadesPalette:function(t,n,a){var i,r,s,o,l;for(null==a&&(a={}),a.lightnessRange||(a.lightnessRange=[50,90]),i=e.Color(t).hsl(),s=a.lightnessRange.slice(0,2).reduce(function(e,t){return t-e})/n,o=[],r=0;n>r;)l=e.Color().hsl(i.h,i.s,a.lightnessRange[0]).rgb(),o.push("rgb("+l.r+", "+l.g+", "+l.b+")"),a.lightnessRange[0]+=s,r++;return o}},a},e.$inject=["$window","ImpacUtilities"],n.$get=e,n})}.call(this),function(){angular.module("impac.services.utilities",[]).service("ImpacUtilities",["$window","$templateCache","ImpacRoutes",function(e,t,n){var a,i,r;a=e._,r=e.moment,i=this,this.getDatesRange=function(e,t){var n,i;return null==t&&(t=!1),e&&e.length?(t||(e=e.concat([],r().toDate())),i=a.min(a.map(e,function(e){return r(e)})),n=a.max(a.map(e,function(e){return r(e)})),[i.startOf("day").toDate(),n.startOf("day").toDate()]):[]},this.getPeriodWord=function(e){if(!angular.isDefined(e))return"";switch(e.toLowerCase().slice(0,1)){case"d":return"day";case"w":return"week";case"m":return"month";case"q":return"quarter";case"y":return"year";case"f":return"financial year"}},this.formatPeriod=function(e,t){var n,a;return null==e&&(e=""),null==t&&(t=""),n="",a=""+i.getPeriodWord(t),e>1&&(n=""+e,a+="s"),[n,a].join(" ")},this.selectedTimeRange=function(e){var t,n,a,s,o,l;return o=r().format("YYYY-MM-DD"),t=r().startOf("year").format("YYYY-MM-DD"),e&&(e.to&&(o=e.to),e.from?t=e.from:e.time_range&&(n=e.time_range.match(/\d/g)&&parseInt(e.time_range.match(/\d/g).join("")),a=e.time_range.match(/[a-z]/)&&e.time_range.match(/[a-z]/)[0],l=i.getPeriodWord(a),t="w"===a?r().subtract(n,l).startOf("isoweek").format("YYYY-MM-DD"):r().subtract(n,l).startOf(l).format("YYYY-MM-DD"))),s={from:t,to:o}},this.financialYearDates=function(e){var t,n,a,i;return i=r().year()-1,r().month()>=e&&(i=r().year()),a=r(i+"-"+(e+1)+"-01","YYYY-MM-DD"),t=angular.copy(a).add(1,"year").subtract(1,"day"),n={start:a.format("YYYY-MM-DD"),end:t.format("YYYY-MM-DD")}},this.yearDates=function(){return{from:r().startOf("year").format("YYYY-MM-DD"),to:r().format("YYYY-MM-DD")}},this.processRailsError=function(e){var t;return t=[],e.status&&401===e.status?t.push("Sorry! You are not authorized to perform this action"):e.data&&" "!==e.data?angular.isArray(e.data)?a.each(e.data,function(e){var n;return n=e.charAt(0).toUpperCase()+e.slice(1),t.push(""+n)}):angular.isObject(e.data)?a.each(e.data,function(e,n){var i;return i=(n.charAt(0).toUpperCase()+n.slice(1)).replace("_"," "),angular.isArray(e)?a.each(e,function(e){return i.match(/base/i)?t.push(e):t.push(i+" "+e)}):i.match(/base/i)?t.push(e):t.push(i+" "+e)}):angular.isString(e.data)?t.push(e.data):t.push("Potentially a system or communication error. Please retry later."):t.push("Potentially a system or communication error. Please retry later."),t},this.fetchWidgetCssClass=function(e){var t,i;return i=e.metadata&&e.metadata.template?e.metadata.template.split("/").slice(0,2):e.endpoint&&e.metadata&&e.metadata.bolt_path?(t=a.find(n.bolts(),function(t){return t.path===e.metadata.bolt_path}),t&&[t.category,e.endpoint]):e.endpoint?e.endpoint.split("/").slice(0,2):void 0,null==i?!1:i.join("-").replace(/_/g,"-")},this.fetchWidgetTemplatePath=function(e){var n,a;return(n=i.fetchWidgetCssClass(e))?(a="widgets/"+n+".tmpl.html",t.get(a)&&a):!1},this.getRandomInteger=function(e,t){return Math.random()*(t-e)+e}}])}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};angular.module("impac.services.widgets",[]).service("ImpacWidgetsSvc",["$q","$http","$log","$timeout","ImpacRoutes","ImpacMainSvc","ImpacDashboardsSvc","ImpacDeveloper","ImpacEvents","ImpacTheming","IMPAC_EVENTS",function(t,n,a,i,r,s,o,l,d,c,u){var g,p,m,h,f;return g=this,this.getSsoSessionId=s.getSsoSessionId,d.registerCb(u.kpiTargetAlert,function(){return g.refreshAll(!0)}),this.load=function(){return null==g.getSsoSessionId()?t.all([s.loadUserData(),o.load()]):t.resolve()},h=function(e){var t;return t=o.getCurrentDashboard(),_.isEmpty(t)||_.isEmpty(t.widgets)?!1:_.contains(_.pluck(t.widgets,"id"),e)},this.initWidgetSettings=function(e){var t,n,a,i;if(e.isEditMode=!1,!_.isEmpty(e.settings)){for(a=e.settings,t=0,n=a.length;n>t;t++)i=a[t],i.initialize();return!0}},this.updateWidgetSettings=function(e,t,n){var i,r;return null==t&&(t=!0),null==n&&(n=!1),e.isEditMode=!1,_.isEmpty(e.settings)?(a.warn("Impac! - WidgetsSvc: Tried to update widget: "+e.id+" with no settings",e),!1):(i=_.find(e.settings,function(e){return"dashboard"===e.reach}),i&&!n?g.updateAllSimilarWidgets(o.getCurrentDashboard(),i):(r=_.reduce(_.map(e.settings,function(e){return e.toMetadata()}),function(e,t){return null==e&&(e={}),angular.merge(e,t)}),g.update(e,{metadata:r},t)))},this.updateAllSimilarWidgets=function(n,a){var i;return i=_.keys(a.toMetadata())[0],angular.extend(n.metadata,a.toMetadata()),o.update(n.id,{metadata:n.metadata}).then(function(){var r,s,o,l,d,c;for(o=[],l=n.widgets,r=0,s=l.length;s>r;r++)d=l[r],c=_.uniq(_.map(d.settings,function(e){return _.keys(e.toMetadata())[0]})),e.call(c,i)>=0?(angular.extend(d.metadata,a.toMetadata()),o.push(g.update(d,{metadata:d.metadata}))):o.push(t.resolve(d));return t.all(o)})},this.massAssignAll=function(e,n){return null==n&&(n=!1),_.isEmpty(e)?t.reject("undefined metadata"):g.load().then(function(){var i,r,s,l,d,c,u;if(i=o.getCurrentDashboard(),d=[],null==i||null==i.widgets)return a.error("Impac! - WidgetsSvc: CurrentDhb.widgets is null",i),t.reject("undefined currentDhb or currentDhb.widgets");if(_.isEmpty(i.widgets))return t.resolve([]);for(c=i.widgets,r=0,s=c.length;s>r;r++)u=c[r],l=angular.merge({},u.metadata,e),_.isEqual(u.metadata,l)||d.push(g.update(u,{metadata:l},!1));return t.all(d).then(function(){return g.refreshAll(n)})})},this.isRefreshing=!1,this.refreshAll=function(e){return null==e&&(e=!1),g.isRefreshing?t.resolve():(g.isRefreshing=!0,g.load().then(function(){var n,i,r,s,l,d;for(n=o.getCurrentDashboard(),s=[],l=n.widgets,i=0,r=l.length;r>i;i++)d=l[i],s.push(g.show(d,{refreshCache:e}).then(function(e){return t.resolve(e)},function(e){return null!=e.data&&e.data.error&&a.error(e.data.error),t.reject(e)}));return t.all(s)})["finally"](function(){return i(function(){return g.isRefreshing=!1},3e3)}))},m=function(e){var t,n,a,i;if(angular.isDefined(e.initContext)&&e.initContext(),!_.isEmpty(e.settings))for(a=e.settings,t=0,n=a.length;n>t;t++)i=a[t],angular.isDefined(i.initialize)&&i.initialize();return angular.isDefined(e.format)?e.format():void 0},f=function(e,t){var n,a,i,r,s;return null==t&&(t={}),s=!!t.refreshCache,n=!!t.demo,i=angular.copy(e.metadata),i.utc_offset||(i.utc_offset=moment().utcOffset()),a=c.get().dhbConfig.designerMode.enabled||n,r={metadata:i,demo_data:a},s&&(r.refresh_cache=!0),r},p=function(){var e;return e="Basic "+btoa(g.getSsoSessionId()),{headers:{Authorization:e}}},this.showAsCSV=function(e){var a,i,r;return i=e.metadata.bolt_path+"/widgets/"+e.endpoint+".csv",a=f(e),r=[i,decodeURIComponent($.param(a))].join("?"),n.get(r,p()).then(function(e){return t.resolve(e.data)},function(e){return t.reject(e)})},this.show=function(e,i){return null==i&&(i={}),e.isLoading=!0,g.load().then(function(){var s,l,d,c;return d=e.metadata.bolt_path?e.metadata.bolt_path+"/widgets/"+e.endpoint:(s=o.getCurrentDashboard(),r.widgets.show(e.endpoint,s.id,e.id)),l=f(e,i),c=[d,decodeURIComponent($.param(l))].join("?"),n.get(c,p()).then(function(n){var i,r;return i=n.data.content||n.data[e.endpoint]||{},_.isEmpty(i)?l.demo_data?(a.error("Impac! - WidgetsSvc: Cannot retrieve demo data for widget:",e),t.resolve(e)):g.show(e,{refreshCache:l.refreshCache,demo:!0}):(r=n.data.name,angular.extend(e,{content:i,originalName:r,demoData:l.demoData}),m(e),t.resolve(e))},function(n){return m(e),angular.isDefined(e.processError)&&null!=n.data&&n.data.error&&e.processError(n.data.error),t.reject(n)})},function(e){return a.error("Impac! - WidgetsSvc: Error while trying to load the service"),t.reject(e)})["finally"](function(){return e.isLoading=!1})},this.create=function(e){return g.load().then(function(){var i,s;return i=o.getCurrentDashboard(),s=l.isWidgetStubbed(e)?l.createWidgetStub(e,i):n.post(r.widgets.create(i.id),e),s.then(function(e){var n;return n=e.data,i.widgets.push(n),o.callbacks.widgetAdded.notify(n),t.resolve(n)},function(e){return a.error("Impac! - WidgetsSvc: Cannot create widget on dashboard "+i.id),t.reject(e)})},function(e){return a.error("Impac! - WidgetsSvc: Error while trying to load the service"),t.reject(e)})},this.update=function(e,i,s){return null==s&&(s=!0),e.isLoading=s,g.load().then(function(){var d,c,u;return h(e.id)?(c={widget:i},d=o.getCurrentDashboard(),u=l.isWidgetStubbed(e)?l.updateWidgetStub(e,c.widget):n.put(r.widgets.update(d.id,e.id),c),u.then(function(n){return angular.extend(e,n.data),s?g.show(e):t.resolve(e)},function(n){return a.error("Impac! - WidgetsSvc: Cannot update widget: "+e.id),t.reject(n)})):(a.info("Impac! - WidgetsSvc: Trying to update a widget (id: "+e.id+") that is not in currentDashboard"),t.reject("trying to update a widget (id: "+e.id+") that is not in currentDashboard"))},function(e){return a.error("Impac! - WidgetsSvc: Error while trying to load the service"),t.reject(e)})["finally"](function(){return e.isLoading=!1})},this["delete"]=function(e){return g.load().then(function(){var i,s;return i=o.getCurrentDashboard(),s=l.isWidgetStubbed(e)?l.deleteWidgetStub(e):n["delete"](r.widgets["delete"](i.id,e.id)),s.then(function(n){return _.remove(i.widgets,function(t){return t.id===e.id}),t.resolve(n)},function(n){return a.error("Impac! - WidgetsSvc: Error while trying to delete widget: "+e.id),t.reject(n)})},function(e){return a.error("Impac! - WidgetsSvc: Error while trying to load the service"),t.reject(e)})},g}])}.call(this),function(){var e;e=angular.module("impac.components.common.data-not-found",[]),e.directive("commonDataNotFound",["$templateCache","$location","ImpacTheming",function(e,t,n){return{restrict:"A",scope:{needsCustomMessage:"<"},link:function(e){var a;return a=n.get().dataNotFoundConfig,e.content=a.content,e.designerMode=n.get().dhbConfig.designerMode.enabled,e.messageVisible=!0,e.hide=function(){return e.messageVisible=!1},e.goToMarketplace=function(){return null!=a.linkUrlCallback?a.linkUrlCallback():t.url(a.linkUrl)}},template:e.get("common/data-not-found.tmpl.html")}}])}.call(this),function(){var e;e=angular.module("impac.components.common.delete-widget",[]),e.component("commonDeleteWidget",{templateUrl:"common/delete-widget.tmpl.html",bindings:{onDelete:"&",onDismiss:"&"},controller:function(){var e;return e=this,e.$onInit=function(){return e.loading=!1},e.deleteWidget=function(){return e.loading=!0,e.onDelete()["finally"](function(){return e.loading=!1})},e}})}.call(this),function(){var e;e=angular.module("impac.components.common.duplicate-transactions-list",[]),e.component("duplicateTransactionsList",{templateUrl:"common/duplicate-transactions-list.tmpl.html",bindings:{onHide:"&",onPageChanged:"&",onConfirmDuplication:"&",onChangeResources:"&",transactions:"<",currency:"<",resourcesType:"<"},controller:function(){var e;return e=this,e.$onInit=function(){return e.currentPage=1,e.itemsPerPage=30,e.formatTransactions()},e.formatTransactions=function(){var t,n,a,i,r;for(i=e.transactions,r=[],n=0,a=i.length;a>n;n++)t=i[n],t.origin=t.origin.data.attributes,t.forecast=t.forecast.data.attributes,t.origin=e.formatDates(t.origin),r.push(t.forecast=e.formatDates(t.forecast));return r},e.formatDates=function(e){return e.trxDateUTC=moment.utc(e.transaction_date).format("DD MMM YYYY"),e.dueDateUTC=moment.utc(e.due_date).format("DD MMM YYYY"),e.expectedPaymentDateUTC=moment.utc(e.expected_payment_date).format("DD MMM YYYY"),e.showReset=e.due_date!==e.expected_payment_date,e},e.changePage=function(){return e.onPageChanged({page:e.currentPage}).then(function(){return e.formatTransactions()})},e.showPaginationControl=function(){return e.totalRecords>=e.itemsPerPage},e}})}.call(this),function(){var e;e=angular.module("impac.components.common.transactions-add",[]),e.component("transactionsAdd",{templateUrl:"common/transactions-add.tmpl.html",bindings:{onHide:"&",onCreateTransaction:"&",resourcesType:"=",contacts:"="},controller:function(){var e;return e=this,e.$onInit=function(){return e.trx={datePicker:{opened:!1,date:new Date,toggle:function(){return this.opened=!this.opened}}},e.tempDate=moment().add(10,"weeks").toDate()},e.isValid=function(){return!_.isEmpty(e.trx.name)&&!isNaN(Number(e.trx.amount))&&0!==Number(e.trx.amount)&&e.trx.contact},e.createTransaction=function(){return e.onHide(),e.onCreateTransaction({trx:e.trx})},e}})}.call(this),function(){var e;e=angular.module("impac.components.common.transactions-list",[]),e.component("transactionsList",{templateUrl:"common/transactions-list.tmpl.html",bindings:{onHide:"&",onPageChanged:"&",onUpdateExpectedDate:"&",onChangeResources:"&",onDeleteTransaction:"&",onCurrencyChange:"&",transactions:"<",currency:"<",totalRecords:"<",resourcesType:"<",listOnly:"<"},controller:function(){var e;return e=this,e.currentAttributes={currency:"",resourcesType:"",transactions:[]},e.$onInit=function(){return e.currentPage=1,e.calculateTotals()},e.$onChanges=function(t){return t.currency&&t.currency.currentValue!==e.currentAttributes.currency?e.onCurrencyChange().then(function(){return e.$onInit()}):void 0},e.changeResourcesType=function(){return e.onChangeResources({resourcesType:e.resourcesType}).then(function(){return e.$onInit()})},e.updateCurrentAttributes=function(t){return t.transactions&&_.remove(e.currentAttributes.transactions,function(){return!0}),_.merge(e.currentAttributes,t)},e.changePage=function(){return e.onPageChanged({page:e.currentPage}).then(function(){return e.calculateTotals()})},e.changeExpectedDate=function(t){return t.showReset=!0,e.onUpdateExpectedDate({trxId:t.id,date:t.datePicker.date})},e.resetExpectedDate=function(t){var n,a;return t.showReset=!1,a=moment.utc(t.due_date),n=new Date(a.year(),a.month(),a.date()),t.datePicker.date=n,e.onUpdateExpectedDate({trxId:t.id,date:t.datePicker.date})},e.calculateTotals=function(){var t,n,a,i;for(e.totalAmount=0,e.totalBalance=0,a=e.transactions,t=0,n=a.length;n>t;t++)i=a[t],e.totalAmount+=i.amount,e.totalBalance+=i.balance,e.formatDate(i);return e.updateCurrentAttributes({currency:e.currency,resourcesType:e.resourcesType,transactions:e.transactions})},e.formatDate=function(t){var n;return t.trxDateUTC=moment.utc(t.transaction_date).format("DD MMM YYYY"),t.dueDateUTC=moment.utc(t.due_date).format("DD MMM YYYY"),e.listOnly?void 0:(t.showReset=t.due_date!==t.expected_payment_date,n=moment.utc(t.expected_payment_date),t.datePicker={opened:!1,date:new Date(n.year(),n.month(),n.date()),toggle:function(){return this.opened=!this.opened}})},e}})}.call(this),function(){var e;e=angular.module("impac.components.common.trends-add",[]),e.component("trendsAdd",{templateUrl:"common/trends-add.tmpl.html",bindings:{onHide:"&",onCreateTrend:"&"},controller:["$scope",function(){var e;return e=this,e.$onInit=function(){return e.untilDatePicker={opened:!1,date:new Date,toggle:function(){return this.opened=!0}},e.startDatePicker={opened:!1,date:new Date,toggle:function(){return this.opened=!0}},e.trend={rate:0,period:"Daily",untilDate:-1},e.selectedPeriod=1},e.period=function(){switch(e.trend.period){case"Once":return e.trend.untilDate=null,"";case"Daily":return"Day"+(e.selectedPeriod<=1?"":"s");case"Weekly":return"Week"+(e.selectedPeriod<=1?"":"s");case"Monthly":return"Month"+(e.selectedPeriod<=1?"":"s");case"Yearly":return"Year"+(e.selectedPeriod<=1?"":"s")}},e.isPeriodDisabled=function(){return"Once"===e.trend.period},e.isValid=function(){return!_.isEmpty(e.trend.name)&&e.trend.rate>0&&(null!=e.trend.untilDate||"Once"===e.trend.period)},e.createTrend=function(){return e.onHide(),e.trend.period=e.trend.period.toLowerCase(),e.onCreateTrend({trend:e.trend})},e.updateStartDate=function(){return e.trend.startDate=e.startDatePicker.date},e.updateUntilDate=function(){return e.trend.untilDate=e.untilDatePicker.date},e}]})}.call(this),function(){var e;e=angular.module("impac.components.common.trends-list",[]),e.component("trendsList",{templateUrl:"common/trends-list.tmpl.html",bindings:{onHide:"&",onPageChanged:"&",onDeleteTrend:"&",onUpdateTrend:"&",trends:"<",totalRecords:"<"},controller:function(){var e;return e=this,e.$onInit=function(){var t,n,a,i;for(e.currentPage=1,a=e.trends,t=0,n=a.length;n>t;t++)i=a[t],e.setDatePickers(i);return e.originalTrends=_.map(e.trends,_.clone)},e.setDatePickers=function(t){var n;return n=moment.utc(t.last_apply_date),t.untilDatePicker={opened:!1,date:new Date(n.year(),n.month(),n.date()),toggle:function(){return e.editMode?this.opened=!this.opened:void 0}},n=moment.utc(t.start_date),t.startDatePicker={opened:!1,date:new Date(n.year(),n.month(),n.date()),toggle:function(){return e.editMode?this.opened=!this.opened:void 0}}},e.onEditTrend=function(){return e.editMode=!0},e.updateTrend=function(t){return t.last_apply_date=t.untilDatePicker.date,t.start_date=t.startDatePicker.date,e.onUpdateTrend({trend:_.omit(t,"startDatePicker","untilDatePicker")}),e.originalTrends=_.map(e.trends,_.clone),e.editMode=!1},e.cancelEdit=function(t){var n;return n=_.find(e.originalTrends,"id",t),e.setDatePickers(n),e.trends.splice(_.findIndex(e.trends,{id:t}),1,n),e.originalTrends=_.map(e.trends,_.clone),e.editMode=!1},e}})}.call(this),function(){var e;e=angular.module("impac.components.dashboard-settings.currency",[]),e.directive("dashboardSettingCurrency",["$templateCache","$log","ImpacMainSvc","ImpacDashboardsSvc","ImpacWidgetsSvc","ImpacKpisSvc","ImpacTheming","toastr",function(e,t,n,a,i,r,s,o){return{restrict:"A",scope:{currency:"="},link:function(e){var t;return e.locked=s.get().dhbSettings.currency.locked,t=function(t){return e.currentDhb=t,e.data={currency:t.currency,savedCurrency:t.currency}},a.dashboardChanged().then(null,null,function(e){return t(e)}),n.load().then(function(n){return e.currencies=n.currencies,a.load().then(function(e){return t(e.currentDashboard)})}),e.massAssignCurrency=function(){var t;return t={currency:e.data.currency},a.update(e.currentDhb.id,t).then(function(){return e.data.savedCurrency=e.data.currency,i.massAssignAll(t),r.massAssignAll(t)},function(){return o.error("Unable to select currency '"+e.data.currency+"'","Error"),e.data.currency=e.data.savedCurrency})}},template:e.get("dashboard-settings/currency.tmpl.html")}}])}.call(this),function(){var e;e=angular.module("impac.components.dashboard-settings.pdf-mode",[]),e.directive("dashboardSettingsPdfMode",["$templateCache","$window","ImpacDashboardsSvc","ImpacTheming",function(e,t,n,a){return{restrict:"A",scope:{},template:e.get("dashboard-settings/pdf-mode.tmpl.html"),link:function(e){return e.enabled=a.get().dhbSelectorConfig.pdfModeEnabled,e.currentDhb=n.getCurrentDashboard(),e.pdfMode=!1,e.allNotTicked=!1,e.toggle=function(){return e.pdfMode=!e.pdfMode,n.togglePdfMode(e.pdfMode)
},e.print=function(){return t.print()},n.ticked().then(null,null,function(){return e.allNotTicked=_.all(e.currentDhb.widgets,{ticked:!1})})}}}])}.call(this),function(){var e;e=angular.module("impac.components.dashboard-settings.sync-apps",[]),e.directive("dashboardSettingSyncApps",["$templateCache","$log","$http","$filter","$uibModal","$document","$timeout","ImpacMainSvc","ImpacRoutes","ImpacWidgetsSvc","ImpacKpisSvc","ImpacTheming","poller","$sce",function(e,t,n,a,i,r,s,o,l,d,c,u,g){return{restrict:"A",scope:{},template:e.get("dashboard-settings/sync-apps.tmpl.html"),link:function(e){var t,r,s,u,p,m,h;return e.isSyncing=!1,e.hasConnector=!1,e.hasError=!1,e.modalOpened=!1,s=function(){var e,t,n,a;return a=(new Date).getTimezoneOffset(),n=["+","00","00"],0>a||(n[0]="-"),e=""+Math.abs(Math.floor(a/60)),n[1]=e.length<2?"0"+e:e,t=""+Math.abs(a%60),n[2]=t.length<2?"0"+t:t,n.join("")},r=function(e){return e.last_sync_date?e.formatted_date=a("date")(e.last_sync_date,"h:mma, yyyy-MM-dd",s()):void 0},h=function(){return d.refreshAll(!0),c.refreshAll(!0),_.any(e.connectors,function(e){return p(e)})?e.triggerSyncAlertsModal():void 0},m=function(t){var n,a,i,s,o;for(e.connectors=angular.copy(t.connectors)||[],e.hasRunningCube=t.has_running_cube||!1,o=e.isSyncing,e.isSyncing=e.connectors&&e.connectors.length>0&&_.any(e.connectors,function(e){return"PENDING"===e.status||"RUNNING"===e.status}),e.hasError=e.connectors&&e.connectors.length>0&&_.any(e.connectors,function(e){return p(e)}),e.hasConnectors=e.connectors.length>0,e.hasApps=e.hasConnectors||e.hasRunningCube,s=e.connectors,a=0,i=s.length;i>a;a++)n=s[a],r(n);return o&&!e.isSyncing?h():void 0},p=function(e){switch(e.status){case"ERROR":return!0;case"FAILED":return!0;case"DISCONNECTED":return!0;case"UNKNOWN":return!0;default:return!1}},e.synchronize=function(){return e.isSyncing?void 0:(e.isSyncing=!0,n.post(l.organizations.appInstancesSync(e.orgUID)).then(function(e){return m(e.data)}))},e.triggerSyncAlertsModal=function(){var t;return e.modalOpened||_.isEmpty(e.connectors)?void 0:(t=i.open({animation:!0,size:"md",templateUrl:"alerts.tmpl.html",appendTo:angular.element("impac-dashboard"),openedClass:"sync-modal-opened",controller:["$scope","connectors",function(e,n){return e.connectors=n,e.expandListItemOnClick=function(e){return e.message?e.showMessage=!e.showMessage:void 0},e.ok=function(){return t.close()}}],resolve:{connectors:function(){return e.connectors}}}),t.opened.then(function(){return e.modalOpened=!0}),t.result["finally"](function(){return e.modalOpened=!1}))},u=function(){return t(),o.load().then(function(t){return e.orgUID=t.currentOrganization.uid,e.syncingPoller=g.get(l.organizations.appInstancesSync(e.orgUID),{delay:1e4,smart:!0}),e.syncingPoller.promise.then(null,null,function(e){return m(e.data)})})},t=function(){return e.syncingPoller?e.syncingPoller.stop()&&e.syncingPoller.remove():void 0},u(),o.organizationChanged().then(null,null,function(e){return e?u():void 0}),e.$on("$destroy",t)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.autofocus",[]),e.directive("autofocus",["$timeout",function(e){return{restrict:"A",link:function(t,n){return e(function(){return n[0].focus()})}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.chart-threshold",[]),e.component("chartThreshold",{templateUrl:"widgets-common/chart-threshold.tmpl.html",bindings:{widget:"<",chartPromise:"<?",chartShrinkSize:"<?",disabled:"<?",kpiTargetMode:"<?",kpiCreateLabel:"<?",thresholdColor:"@",onComplete:"&?"},controller:["$timeout","$log","ImpacKpisSvc","ImpacUtilities","toastr",function(e,t,n,a,i){var r,s,o,l,d,c,u,g,p,m,h,f;return s=this,s.$onInit=function(){return s.kpi={},s.showPanel=!1,s.isEditingKpi=!1,s.loading=!1,s.draftTarget={value:""},s.chartShrinkSize||(s.chartShrinkSize=38),s.disabled||(s.disabled=!1),s.kpiTargetMode||(s.kpiTargetMode="min"),s.kpiCreateLabel||(s.kpiCreateLabel="Get alerted when the target threshold goes below"),s.thresholdColor||(s.thresholdColor="rgba(0, 0, 0, 0.7)"),n.getAttachableKpis(s.widget.endpoint).then(function(e){return _.isEmpty(e)||_.isEmpty(e[0].watchables)?o("No valid KPI Templates found"):angular.extend(s.kpi,angular.copy(e[0]))},function(){return o()}),null!=s.chartPromise&&_.isFunction(s.chartPromise.then)?s.chartPromise.then(null,null,g):void 0},s.createKpi=function(e){s.disabled||e&&_.isEmpty(s.widget.kpis)&&_.isEmpty(s.draftTarget.value)&&(s.draftTarget.value=e,h())},s.editKpi=function(e){s.showPanel||s.disabled||_.isEmpty(s.widget.kpis)||(s.isEditingKpi=!0,angular.extend(s.draftTarget,e),h())},s.cancelCreateKpi=function(){h(),e(function(){return s.draftTarget.value="",s.isEditingKpi=!1,s.loading=!1},100)},c=function(){return i.error("Please choose a number one or greater.","Error"),s.loading=!1},s.saveKpi=function(){var e,t,a;if(!s.loading)return s.loading=!0,t={targets:{},metadata:{}},t.targets[s.kpi.watchables[0]]=[(e={},e[""+s.kpiTargetMode]=parseFloat(s.draftTarget.value),e)],n.validateKpiTargets(t.targets)?(a=s.isEditingKpi?n.update(l(),t,!1).then(function(e){return s.chart.removeThreshold(e.id),angular.extend(l(),e)}):(t.metadata.hist_parameters=s.widget.metadata.hist_parameters,t.widget_id=s.widget.id,n.create("impac",s.kpi.endpoint,s.kpi.watchables[0],t).then(function(e){return s.widget.kpis.push(e),e})),a.then(function(e){return _.isFunction(s.onComplete)?s.onComplete({$event:{kpi:e}}):void 0})["finally"](function(){return s.cancelCreateKpi()})):c()},s.deleteKpi=function(){var e,t;if(!s.loading)return s.loading=!0,t=s.widget.name+" "+(e=l()).element_watched,n["delete"](e).then(function(){return i.success("Deleted "+t+" KPI"),_.remove(s.widget.kpis,function(t){return t.id===e.id}),s.chart.removeThreshold(e.id),_.isFunction(s.onComplete)?s.onComplete({$event:{}}):void 0},function(){return i.error("Failed to delete "+t+" KPI","Error")})["finally"](function(){return s.cancelCreateKpi()})},l=function(){return _.find(s.widget.kpis,function(e){return e.id===s.draftTarget.kpiId})},g=function(e){s.chart=e,f()&&(s.chart.addOnClickCallback(u),_.each(r(),function(e){var t;return t=s.chart.findThreshold(e.kpiId),null==t&&(t=s.chart.addThreshold(e)),s.chart.addThresholdEvent(t,"click",p)}))},u=function(e){var t;return t=e.yAxis&&e.yAxis[0]&&e.yAxis[0].value,t&&!_.isNaN(t)?(t=t.toFixed(2),s.createKpi(t)):void 0},p=function(e){var t,n;return n=(t=e.options).data[t.data.length-1][1].toFixed(2),s.editKpi({kpiId:t.kpiId,value:n})},o=function(e){return s.disabled=!0,i.warning("Chart threshold KPI disabled!",s.widget.name+" Widget"),e?t.warn("Impac! - "+s.widget.name+" Widget: "+e):void 0},h=function(){return e(function(){return s.showPanel?d():m(),s.showPanel=!s.showPanel})},m=function(){return s.chart?(s.chart.hc.setSize(null,s.chart.hc.chartHeight-s.chartShrinkSize,!1),s.chart.hc.container.parentElement.style.height=s.chart.hc.chartHeight+"px"):void 0},d=function(){return s.chart?(s.chart.hc.setSize(null,s.chart.hc.chartHeight+s.chartShrinkSize,!1),s.chart.hc.container.parentElement.style.height=s.chart.hc.chartHeight+"px"):void 0},f=function(){var e;return e=s.widget.metadata&&s.widget.metadata.hist_parameters,s.disabled=null!=e&&moment(e.to)<=moment.utc().startOf("day"),!s.disabled},r=function(){var e;return e=null!=s.widget.kpis&&s.widget.kpis[0]&&s.widget.kpis[0].targets,n.validateKpiTargets(e)?[{kpiId:s.widget.kpis[0].id,value:e.threshold[0].min,name:"Alert Threshold",color:s.thresholdColor}]:[]},s}]})}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.currency-conversions",[]),e.directive("commonCurrencyConversions",["$templateCache","ImpacAssets","$filter",function(e,t,n){return{restrict:"A",scope:{fxAmounts:"=",baseCurrency:"=",ratesDate:"="},template:e.get("widgets-common/currency-conversions.tmpl.html"),link:function(a){return a.currencyConversionsIcon=t.get("currencyConversionsIcon"),a.popoverTemplateUrl=e.get("widgets-common/details-popover.html"),a.popoverTitle="Currency Conversions Info",a.formattedRatesDate=n("momentDate")(a.ratesDate,"currency-conversions")}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.editable-title",[]),e.controller("CommonEditableTitleCtrl",["$scope","ImpacWidgetsSvc","ImpacDashboardsSvc","$translate",function(e,t,n,a){var i;return i=e.parentWidget,e.updateName=function(){return 0===i.name.length?(i.name=i.originalName,a.instant("impac.widget.editable_title.incorrect_name")):t.update(i,{name:i.name},!1)},e.getTooltip=function(){var t;return e.pdfMode?"":(t=a.instant("impac.widget.editable_title.tooltip_text"),i.name+" "+t)},n.pdfModeEnabled().then(null,null,function(){return e.pdfMode=!0}),n.pdfModeCanceled().then(null,null,function(){return e.pdfMode=!1})}]),e.directive("commonEditableTitle",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",onToggle:"&",disabled:"="},template:e.get("widgets-common/editable-title.tmpl.html"),controller:"CommonEditableTitleCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.info-panel",[]),e.directive("commonInfoPanel",["$templateCache","ImpacUtilities",function(e,t){return{restrict:"A",scope:{parentWidget:"=",onClose:"&"},template:e.get("widgets-common/info-panel.tmpl.html"),link:function(e){var n;return n=e.parentWidget,e.hideInfoPanel=!0,e.toggleInfoPanel=function(){return e.hideInfoPanel=!e.hideInfoPanel,e.onClose()},e.getWidgetTemplateName=function(){var e,a,i,r;return(e=t.fetchWidgetCssClass(n))?(a=e.split("-"),i=a.slice(0,1),r=a.slice(1,a.length).join(" "),i+" - "+r):""}}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.time-period-info",[]),e.directive("commonTimePeriodInfo",["$templateCache","ImpacUtilities","$translate","$filter",function(e,t,n,a){return{restrict:"A",scope:{context:"="},template:e.get("widgets-common/time-period-info.tmpl.html"),link:function(e){var i,r,s,o,l;i=function(){return angular.isFunction(e.context.accountingBehaviour)?e.context.accountingBehaviour():e.context.accountingBehaviour},o=function(){return angular.isDefined(e.context.injectBefore)?angular.isFunction(e.context.injectBefore)?e.context.injectBefore():e.context.injectBefore:""},s=function(){return angular.isDefined(e.context.injectAfter)?angular.isFunction(e.context.injectAfter)?e.context.injectAfter():e.context.injectAfter:""},l=function(e){return o().length>0&&(e=e.toLowerCase()),[o(),e,s()].join(" ")},r=function(){var r;return r=t.selectedTimeRange(e.context.histParams),r.from=a("momentDate")(r.from,"time-period"),r.to=a("momentDate")(r.to,"time-period"),"bls"===i()?n("impac.widget.common.time_period_info.to",{dateTo:""+r.to}).then(function(t){return e.date=l(t)}):n("impac.widget.common.time_period_info.from_to",{dateFrom:""+r.from,dateTo:""+r.to}).then(function(t){return e.date=l(t)})},r(),e.$watch("context.histParams",function(e,t){return _.isEqual(e,t)?void 0:r()})}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-common.top-buttons",[]),e.controller("CommonTopButtonsCtrl",["$scope","$rootScope","$log","ImpacWidgetsSvc","ImpacAssets","ImpacUtilities","ImpacDashboardsSvc",function(e,t,n,a,i,r,s){var o;return o=e.parentWidget,o.isEditMode=!1,e.toggleEditMode=function(){return o.isLoading?void 0:o.isEditMode?(o.isEditMode=!1,a.initWidgetSettings(o)):o.isEditMode=!0},e.hasInfo=function(){return o&&null!=o.content&&null!=o.content.info&&o.content.info.length>0},e.isCsvExportable=function(){var e;return e=_.find(s.getWidgetsTemplates(),{endpoint:o.endpoint}),_.get(e,"metadata.bolt_path")},e.exportCSV=function(){return a.showAsCSV(o).then(function(e){var t;return t=document.createElement("a"),t.href="data:attachment/csv;charset=utf-8,"+encodeURI(e),t.download=o.endpoint+".csv",t.style.display="none",t.click()})}}]),e.directive("commonTopButtons",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",onRefresh:"=",onToggleInfoPanel:"&",onToggleDeleteWidget:"&",userAccesses:"="},template:e.get("widgets-common/top-buttons.tmpl.html"),controller:"CommonTopButtonsCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-accounting-values",[]),e.controller("WidgetAccountsAccountingValuesCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.accounting,e.getLegend(),e.getCurrency()},e.getCurrentPrice=function(){return e.isDataFound?s.content.accounting.total_period:void 0},e.getCurrency=function(){return e.isDataFound?null!=s.content.accounting.currency_key?i(s.content.accounting.currency_key).then(function(t){return e.currency=t,e.currency_unit=s.content.accounting.currency}):(e.currency=s.content.accounting.currency,e.currency_unit=s.content.accounting.currency):void 0},e.getLegend=function(){return e.isDataFound?null!=s.content.accounting.legend_key?i(s.content.accounting.legend_key).then(function(t){return e.legend=t}):e.legend=s.content.accounting.legend:void 0},e.drawTrigger=t.defer(),s.format=function(){var t,i,r,o,l,d,c;return e.isDataFound?(r=angular.copy(s.content.accounting),c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(r.dates,function(e){return a("momentDate")(e,c)}),l={labels:o,datasets:[{title:r.type,values:r.values}]},t=!0,angular.forEach(r.values,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!1,currency:r.currency},i=n.combinedBarChart(l,d,!1),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetAccountsAccountingValues",function(){return{restrict:"A",controller:"WidgetAccountsAccountingValuesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-assets-liability-summary",[]),e.controller("WidgetAccountsAssetsLiabilitySummaryCtrl",["$scope","$q","ChartFormatterSvc","$translate",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),i=[e.orgDeferred.promise,e.chartDeferred.promise,e.paramSelectorDeferred.promise],r.initContext=function(){return e.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.summary),r.metadata.classification||(r.metadata.classification="ASSET"),a("impac.widget.acc_ass_liab_smry."+r.metadata.classification.toLowerCase()+".many").then(function(t){return e.classification=t}),a(["impac.widget.acc_ass_liab_smry.accounts.asset","impac.widget.acc_ass_liab_smry.accounts.liability"]).then(function(t){return e.accountsOptions=[{label:t["impac.widget.acc_ass_liab_smry.accounts.asset"],value:"ASSET"},{label:t["impac.widget.acc_ass_liab_smry.accounts.liability"],value:"LIABILITY"}],e.selectedAccountsOption?void 0:e.selectedAccountsOption=angular.copy(_.find(e.accountsOptions,{value:r.metadata.classification}))}),e.isDataFound?e.dataSource=r.metadata.organization_ids.length>1?r.content.repartition:r.content.summary:void 0},e.getCurrency=function(){return e.isDataFound?r.content.currency:void 0},e.getAccountColor=function(t){return e.isDataFound?n.getColor(_.indexOf(e.dataSource,t)):void 0},e.drawTrigger=t.defer(),r.format=function(){var t,a,i;return e.isDataFound?(a=_.map(e.dataSource,function(e){return{label:e.label,value:e.total}}),i={percentageInnerCutout:50,tooltipFontSize:12},t=n.pieChart(a,i),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(i)}]),e.directive("widgetAccountsAssetsLiabilitySummary",function(){return{restrict:"A",controller:"WidgetAccountsAssetsLiabilitySummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-assets-summary",[]),e.controller("WidgetAccountsAssetsSummaryCtrl",["$scope","$q","ChartFormatterSvc","$translate",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),i=[e.orgDeferred.promise,e.chartDeferred.promise],r.initContext=function(){return e.isDataFound=angular.isDefined(r.content)&&!_.isEmpty(r.content.summary),e.isDataFound&&(e.dataSource=r.metadata.organization_ids.length>1?r.content.repartition:r.content.summary),r.metadata.classification||(r.metadata.classification="ASSET"),a("impac.widget.acc_ass_smry."+r.metadata.classification.toLowerCase()+".many").then(function(t){return e.classification=t})},e.getCurrency=function(){return e.isDataFound?r.content.currency:void 0},e.getAccountColor=function(t){return e.isDataFound?n.getColor(_.indexOf(e.dataSource,t)):void 0},e.drawTrigger=t.defer(),r.format=function(){var t,a,i;return e.isDataFound?(a=_.map(e.dataSource,function(e){return{label:e.label,value:e.total}}),i={percentageInnerCutout:50,tooltipFontSize:12},t=n.pieChart(a,i),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(i)}]),e.directive("widgetAccountsAssetsSummary",function(){return{restrict:"A",controller:"WidgetAccountsAssetsSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-assets-vs-liabilities",[]),e.controller("WidgetAccountsAssetsVsLiabilitiesCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.chartDeferred.promise],i(["impac.widget.acc_ass_vs_liab.asset.one","impac.widget.acc_ass_vs_liab.liability.one"]).then(function(t){return e.classificationTranslation={ASSET:t["impac.widget.acc_ass_vs_liab.asset.one"].toUpperCase(),LIABILITY:t["impac.widget.acc_ass_vs_liab.liability.one"].toUpperCase()}}),s.initContext=function(){var t;return e.isDataFound=null!=s.content&&!_.isEmpty(s.content.summary)&&!_.isEmpty(s.content.companies),e.isDataFound?(t=0,e.companiesList=_.map(s.content.companies,function(e){var n,a,i;return n=_.find(s.content.summary,function(e){return"ASSET"===e.classification}),a=_.find(s.content.summary,function(e){return"LIABILITY"===e.classification}),i={company:e,assets:null!=n?n.totals[t]:0,liabilities:null!=a?a.totals[t]:0,currency:s.content.currency},t++,i}),e.titleTranslation):void 0},e.assetsColor=n.getColor(0),e.liabilitiesColor=n.getColor(1),e.drawTrigger=t.defer(),s.format=function(){var t,a,i,r;return e.isDataFound?(a=_.map(s.content.summary,function(t){return _.includes(["ASSET","LIABILITY"],t.classification)?{title:e.classificationTranslation[t.classification],values:t.totals}:void 0}),a=_.sortByOrder(a,["title"]),i={labels:s.content.companies,datasets:_.compact(a)},r={showTooltips:!1,showXLabels:!1,barValueSpacing:Math.max(8-s.content.companies.length,1)},t=n.combinedBarChart(i,r),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetAccountsAssetsVsLiabilities",function(){return{restrict:"A",controller:"WidgetAccountsAssetsVsLiabilitiesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-balance",[]),e.controller("WidgetAccountsBalanceCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.accountBackDeferred=t.defer(),e.accountFrontDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),i=[e.orgDeferred.promise,e.accountBackDeferred,e.accountFrontDeferred,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],e.kpiExtraParams={},e.isDataFound=!0,r.initContext=function(){return e.isDataFound=null!=r.content&&!_.isEmpty(r.content.account_list)},e.getName=function(){return null!=r.selectedAccount?r.selectedAccount.name:void 0},e.getBehaviour=function(){return null!=r.selectedAccount&&r.selectedAccount.accounting_behaviour},e.getCurrentBalance=function(){return null!=r.selectedAccount?"pnl"===e.getBehaviour()?_.sum(r.selectedAccount.balances):_.last(r.selectedAccount.balances):0},e.getCurrency=function(){return null!=r.selectedAccount?r.selectedAccount.currency:void 0},e.displayAccount=function(){return e.updateSettings(!1).then(function(){return r.format()})},e.updateKpiExtraParams=function(t,n){return e.kpiExtraParams[t]=angular.copy(n)},e.drawTrigger=t.defer(),r.format=function(){var t,i,s,o,l,d,c,u,g;return e.isDataFound&&null!=r.selectedAccount?(o=angular.copy(r.selectedAccount),d=o.dates||r.content.dates,g=null,null!=r.metadata&&null!=r.metadata.hist_parameters&&(g=r.metadata.hist_parameters.period),l=_.map(d,function(e){return a("momentDate")(e,g)}),c={title:o.name,labels:l,values:o.balances},i={labels:l,datasets:[{title:o.name,values:o.balances}]},t=!0,angular.forEach(o.balances,function(e){return t&&(t=e>=0)}),u={scaleBeginAtZero:t,showXLabels:!1},s=n.lineChart([c],u),"pnl"===e.getBehaviour()&&(s=n.combinedBarChart(i,u,!1)),e.drawTrigger.notify(s)):void 0},e.widgetDeferred.resolve(i)}]),e.directive("widgetAccountsBalance",function(){return{restrict:"A",controller:"WidgetAccountsBalanceCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-balance-sheet",[]),e.controller("WidgetAccountsBalanceSheetCtrl",["$scope","$q","ImpacWidgetsSvc","ImpacMainSvc","ImpacUtilities","$translate","ImpacTheming",function(e,t,n,a,i,r,s){var o,l,d,c,u,g,p;return p=e.widget,e.orgDeferred=t.defer(),e.datesPickerDeferred=t.defer(),e.tagFilterDeferred=t.defer(),l=[e.orgDeferred.promise,e.datesPickerDeferred.promise,e.tagFilterDeferred.promise],e.datesPickerTemplate='<div class="row text-right">\n  <div class="col-xs-6">\n    <to-date>\n  </div>\n  <div class="col-xs-6">\n    <from-date>\n  </div>\n</div>',e.ascending=!0,e.sortedColumn="account",e.filterTagsEnabled=s.get().widgetSettings.tagging.enabled,e.isReportFiltered=function(){return null!=p.metadata&&null!=p.metadata.filter_query&&Object.keys(p.metadata.filter_query).length>0},o=function(){return e.fromDate=p.metadata.hist_parameters.from,e.toDate=p.metadata.hist_parameters.to,e.keepToday=p.metadata.hist_parameters.keep_today},null==p.metadata||null==p.metadata.hist_parameters?(p.metadata||(p.metadata={}),p.metadata.hist_parameters={to:moment().format("YYYY-MM-DD"),keep_today:!0,period:"RANGE"},a.load().then(function(e){var t;return t=parseInt(e.currentOrganization.financial_year_end_month)||6,p.metadata.hist_parameters.from=moment(i.financialYearDates(t).end,"YYYY-MM-DD").subtract(1,"year").format("YYYY-MM-DD"),o()})):o(),p.initContext=function(){return(e.isDataFound=angular.isDefined(p.content)&&!_.isEmpty(p.content.summary)&&!_.isEmpty(p.content.dates))&&(e.dates=p.content.dates,e.unCollapsed=p.metadata.unCollapsed||[],u(Object.keys(p.content.summary)).then(function(t){return e.categories=t,c()})),o()},e.toggleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),n.updateWidgetSettings(p,!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},u=function(e){var n;return n=_.map(e,function(e){return r("impac.widget.account_balance_sheets."+e.toLowerCase()).then(function(t){return{label:t,key:e}},function(){return{label:e.toLowerCase(),key:e}})}),t.all(n)},d=function(t){return angular.forEach(e.categories,function(n){var a;return a=p.content.summary[n.key],a.accounts?a.accounts.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},c=function(){return _.isEmpty(e.categories)?void 0:"account"===e.sortedColumn?d(function(e){return e.name}):"total1"===e.sortedColumn?d(function(e){return e.totals[1]}):"total2"===e.sortedColumn?d(function(e){return e.totals[0]}):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),c()},g={},g.initialized=!1,g.initialize=function(){return g.initialized=!0},g.toMetadata=function(){return{unCollapsed:e.unCollapsed}},p.settings.push(g),e.widgetDeferred.resolve(l)}]),e.directive("widgetAccountsBalanceSheet",function(){return{restrict:"A",controller:"WidgetAccountsBalanceSheetCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-cash-balance",[]),e.controller("WidgetAccountsCashBalanceCtrl",["$scope","$q","$timeout","$filter","ImpacTheming","ImpacAssets","ImpacWidgetsSvc","HighchartsFactory",function(e,t,n,a,i,r,s,o){var l,d,c,u,g,p,m,h;return m=e.widget,e.orgDeferred=t.defer(),g=[e.orgDeferred.promise],l=function(){return null!=m.metadata&&null!=m.metadata.hist_parameters&&m.metadata.hist_parameters.period||"MONTHLY"},m.initContext=function(){var t;return e.isDataFound=null!=m.content.chart,e.groupedTable=m.content.grouped_table,u(m.content.chart.series,{positive:"#3FC4FF",negative:"#e50228"}),(t=m.metadata.hist_parameters)?(e.fromDate=t.from,e.toDate=t.to):void 0},e.legendItemOnClick=function(t){var n,a;return(n=null!=e.chart&&null!=e.chart.hc&&d(e.chart.hc.series,t))?(a=n.visible?!1:!0,n.setVisible(a)):void 0},e.getLegendItemCheckBox=function(t){var n;return n=null!=e.chart&&null!=e.chart.hc&&d(e.chart.hc.series,t),n?n.visible?"fa-check-square-o":"fa-square-o":"fa-check-square-o"},e.getLegendItemIcon=function(t){var n;return n=null!=e.chart&&null!=e.chart.hc&&d(e.chart.hc.series,t),"area"===n.type?r.get("areaLegendIcon"):r.get("plotLineLegendIcon")},e.getLegendItemColor=function(t){var n;return n=null!=e.chart&&null!=e.chart.hc&&d(e.chart.hc.series,t),n?n.color:"#000"},d=function(e,t){return _.find(e,function(e){return(e.id||e.options&&e.options.id)===t.id})},u=function(e,t){var n,a,r,s,o,l;a=_.groupBy(e,function(e){return e.bias}),o=[];for(n in a)e=a[n],t[n]&&(s=i.color.generateShadesPalette(t[n],e.length),o.push(function(){var t,n,a;for(a=[],r=t=0,n=e.length;n>t;r=++t)l=e[r],a.push(l.color=s[r]);return a}()));return o},e.chartId=function(){return"cashBalanceChart-"+m.id},p=!1,h={},c=function(e){return h=angular.merge(m.metadata,{xAxis:{max:e.max,min:e.min}}),p?void 0:(p=!0,n(function(){return s.update(m,{metadata:h},!1)["finally"](function(){return p=!1})},1e3))},m.format=function(){return n(function(){var t;return t={chartType:"line",currency:m.metadata.currency,period:l(),showToday:!0,showLegend:!1},e.chart=new o(e.chartId(),m.content.chart.series,t),e.chart.addXAxisOptions({defaults:m.metadata.xAxis,callback:c}),e.chart.removeLegend(),e.chart.render()})},e.widgetDeferred.resolve(g)}]),e.directive("widgetAccountsCashBalance",function(){return{restrict:"A",controller:"WidgetAccountsCashBalanceCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-cash-projection",[]),e.controller("WidgetAccountsCashProjectionCtrl",["$scope","$q","$filter","$timeout","ImpacKpisSvc","ImpacWidgetsSvc","ImpacAssets","HighchartsFactory","BoltResources","ImpacMainSvc",function(e,t,n,a,i,r,s,o,l,d){var c,u,g,p,m,h,f,v,b,w,y,x,C,D,k;return D=e.widget,x=moment().startOf("day").add(moment().utcOffset(),"minutes"),C=!1,k={},D.metadata.ranges=["-60d","-30d"],u=function(e){var t;return t=moment.utc(e),x>=t?"lte "+t.format("YYYY-MM-DD"):t.format("YYYY-MM-DD")},p=function(e){return s.get(_.camelCase(e+"LegendIcon"))},m=function(e,t){return"<img src='"+e+"'><br>"+t},g=function(e,t){var n;return n=_.find(t,function(t){return t.id===e}),n.attributes.name},e.chartId=function(){return"cashProjectionChart-"+D.id},e.orgDeferred=t.defer(),y=[e.orgDeferred.promise],e.trxList={display:!1,updated:!1,transactions:[]},e.contacts=[],e.trxList.show=function(){return e.trxList.display=!0},e.trxList.hide=function(){return e.trxList.display=!1,e.trxList.updated?r.show(D).then(function(){return e.trxList.updated=!1}):void 0},e.trxList.fetch=function(t){var n;return null==t&&(t=1),n=angular.merge(e.trxList.params,{metadata:_.pick(D.metadata,"organization_ids"),page:{number:t},currency:D.metadata.currency}),l.index(D.metadata.bolt_path,e.trxList.resources,n).then(function(t){var n,a,i,r,s;for(_.remove(e.trxList.transactions,function(){return!0}),r=t.data.data,a=0,i=r.length;i>a;a++)s=r[a],s.relationships&&s.relationships.contact&&s.relationships.contact.data&&(n=g(s.relationships.contact.data.id,t.data.included)),e.trxList.transactions.push(angular.merge(s.attributes,{id:s.id,contact_name:n||null}));return e.trxList.totalRecords=t.data.meta.record_count})["finally"](function(){return e.trxList.show()})},e.trxList.updateParams=function(t,n){return e.trxList.resources=t,e.trxList.params={include:"contact",fields:{contacts:"name"},filter:n}},e.trxList.showAll=function(t){var n;return null==t&&(t="invoices"),n={status:["AUTHORISED","APPROVED","SUBMITTED","FORECAST"]},e.trxList.updateParams(t,n),e.trxList.fetch()},e.trxList.updateExpectedDate=function(t,n){return l.update(D.metadata.bolt_path,e.trxList.resources,t,{expected_payment_date:moment(n).format("YYYY-MM-DD")}).then(function(){return e.trxList.updated=!0})},e.trxList.changeResourcesType=function(t){return t!==e.trxList.resources?(e.trxList.resources=t,e.trxList.fetch()):void 0},e.trxList.deleteTransaction=function(t,n){return _.remove(e.trxList.transactions,function(e){return e.id===n}),l.destroy(D.metadata.bolt_path,t,n).then(function(){return e.trxList.updated=!0})},e.trendList={display:!1,updated:!1,trends:[],params:{}},e.trendList.show=function(){return e.trendList.display=!0},e.trendList.hide=function(){return e.trendList.display=!1,e.trendList.updated?r.show(D).then(function(){return e.trendList.updated=!1}):void 0},e.trendList.fetch=function(t){var n;return null==t&&(t=1),n=angular.merge(e.trendList.params,{metadata:_.pick(D.metadata,"organization_ids"),page:{number:t}}),l.index(D.metadata.bolt_path,"trends",n).then(function(t){var n,a,i,r;for(_.remove(e.trendList.trends,function(){return!0}),i=t.data.data,n=0,a=i.length;a>n;n++)r=i[n],r.period||(r.period="once"),e.trendList.trends.push(angular.merge(r.attributes,{id:r.id}));return e.trendList.totalRecords=t.data.meta.record_count})["finally"](function(){return e.trendList.show()})},e.trendList.showAll=function(){return e.trendList.fetch()},e.trendList.updateTrend=function(t){return"once"===t.period&&(t.period=null),l.update(D.metadata.bolt_path,"trends",t.id,_.omit(t,"id")).then(function(){return e.trendList.updated=!0})},e.trendList.deleteTrend=function(t){return _.remove(e.trendList.trends,function(e){return e.id===t}),l.destroy(D.metadata.bolt_path,"trends",t).then(function(){return e.trendList.updated=!0})},e.chartDeferred=t.defer(),e.chartPromise=e.chartDeferred.promise,e.chartThresholdOptions={label:"Get alerted when the cash projection goes below"},e.addForecastPopup={resourcesType:"invoices",display:!1,show:function(){return this.display=!0},hide:function(){return this.display=!1}},e.addForecastPopup.createTransaction=function(t){return l.create(D.metadata.bolt_path,this.resourcesType,{title:t.name,transaction_number:"FOR-"+Math.ceil(1e4*Math.random()),amount:t.amount,balance:t.amount,transaction_date:moment().format("YYYY-MM-DD"),due_date:moment(t.datePicker.date).format("YYYY-MM-DD"),status:"FORECAST",currency:D.metadata.currency},{company:{data:{type:"companies",id:e.firstCompanyId}},contact:{data:{type:"contacts",id:t.contact.id}}}).then(function(){return r.show(D)})},e.addTrendPopup={display:!1,show:function(){return this.display=!0},hide:function(){return this.display=!1}},e.addTrendPopup.lastDate=function(e,t){var n;if(n=null,-1!==e){switch(t){case"once":return null;case"daily":n="days";break;case"weekly":n="weeks";break;case"monthly":n="months";break;case"yearly":n="years"}return moment().add(e,n).format("YYYY-MM-DD")}},e.addTrendPopup.createTrend=function(t){var n;return n=Number.isInteger(t.untilDate)?e.addTrendPopup.lastDate(t.untilDate,t.period):t.untilDate,l.create(D.metadata.bolt_path,"trends",{name:t.name,rate:t.rate,period:"once"===t.period?null:t.period,start_date:t.startDate,last_apply_date:n},{company:{data:{type:"companies",id:e.firstCompanyId}},user:{data:{type:"users",id:e.userId}}}).then(function(){return r.show(D)
})},v=function(t){var n,a,i;return i=this,a=function(){switch(i.userOptions.stack){case"Payables":return"bills";case"Receivables":return"invoices"}}(),null!=a?(n={expected_payment_date:u(t.point.x),status:["AUTHORISED","APPROVED","SUBMITTED","FORECAST"]},e.trxList.updateParams(a,n),e.trxList.fetch()):void 0},h=function(){var e;return e=this.name,"Projected cash"!==e?m(p(e),e):m(p(e),e)+"<br>"+m(p("cashFlow"),"Cash flow")},w=function(e){return k=angular.merge(D.metadata,{xAxis:{max:e.max,min:e.min}}),C?void 0:(C=!0,a(function(){return r.update(D,{metadata:k},!1)["finally"](function(){return C=!1})},1e3))},b=function(){var t,n,a,i,r,s;for(s=this,a=e.chart.hc.series,i=[],t=0,n=a.length;n>t;t++)r=a[t],r.userOptions.linkedTo===s.name&&(s.visible?i.push(r.hide()):i.push(r.show()));return i},f=function(){return l.index(D.metadata.bolt_path,"contacts",{metadata:_.pick(D.metadata,"organization_ids")}).then(function(t){return e.contacts=t.data.data})},c=function(){return e.firstCompanyId?l.create(D.metadata.bolt_path,"users",{first_name:d.config.userData.name,last_name:d.config.userData.surname,email:d.config.userData.email},{companies:{data:[{type:"companies",id:e.firstCompanyId}]}}).then(function(t){return e.userId=t.data.data.id}):void 0},D.initContext=function(){var t;return t=_.find(D.content.chart.series,function(e){return"Cash flow"===e.name}),t.data=[],t.type="area",t.showInLegend=!1,l.index(D.metadata.bolt_path,"companies",{metadata:_.pick(D.metadata,"organization_ids")}).then(function(t){return _.isEmpty(t.data.data)?D.demoData=!0:(D.demoData=!1,e.firstCompanyId=t.data.data[0].id),f()}),l.index(D.metadata.bolt_path,"users",{filter:{email:d.config.userData.email},metadata:_.pick(D.metadata,"organization_ids")}).then(function(t){return t.data.meta.record_count>0?e.userId=t.data.data[0].id:c()})},D.format=function(){var t;return t={chartType:"line",currency:D.metadata.currency,showToday:!0},e.chart=new o(e.chartId(),D.content.chart.series,t),e.chart.addCustomLegend(h),e.chart.addSeriesEvent("click",v),e.chart.addSeriesEvent("legendItemClick",b),e.chart.addXAxisOptions({defaults:D.metadata.xAxis,callback:w}),e.chart.render(),e.chartDeferred.notify(e.chart)},e.widgetDeferred.resolve(y)}]),e.directive("widgetAccountsCashProjection",function(){return{restrict:"A",controller:"WidgetAccountsCashProjectionCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-cash-summary",[]),e.controller("WidgetAccountsCashSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc","$translate",function(e,t,n,a,i,r){var s,o,l,d,c,u,g,p,m;return m=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.chartDeferred=t.defer(),c=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.chartDeferred.promise],e.ascending=!0,e.sortedColumn="account",m.initContext=function(){return(e.isDataFound=angular.isDefined(m.content)&&!_.isEmpty(m.content.summary)&&!_.isEmpty(m.content.dates))?(e.dates=m.content.dates,e.unCollapsed=m.metadata.unCollapsed||[],_.map(m.content.summary,function(e){return null!=e.name?r("impac.widget.account_cash_smry.summary."+e.name.toLowerCase()).then(function(t){return e.label=t}):void 0}),r("impac.widget.account_cash_smry.cash_flow."+e.widget.metadata.hist_parameters.period.toLowerCase()).then(function(t){return e.widget.metadata.hist_parameters.period_translation=t}),m.metadata.selectedElement&&(e.selectedElement=_.find(m.content.summary,function(e){return e.name===m.metadata.selectedElement}),e.selectedElement||(e.selectedElement=s(m.content.summary))),g()):void 0},e.getLastDate=function(){return null!=e.dates?e.dates[e.dates.length-1]:void 0},e.getPrevDate=function(){return null!=e.dates?e.dates[e.dates.length-2]:void 0},e.getLastValue=function(e){return null!=e.cash_flows?_.last(e.cash_flows):void 0},e.formatVariance=function(e){return null!=e?e>0?"+"+e+" %":e+" %":"-"},e.getLastVariance=function(t){return null!=t.variances&&null!=_.last(t.variances)?e.formatVariance(_.last(t.variances)):"-"},e.getVarianceClassColor=function(e){return parseInt(e)>0?"positive":parseInt(e)<0?"negative":null},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace(/_/g," "):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),g()},e.toggleSelectedElement=function(t,n){return null==n&&(n=null),e.isSelected(t,n)?(e.selectedElement=null,m.isExpanded()?m.toggleExpanded():i.updateWidgetSettings(m,!1)):(e.selectedElement=angular.copy(t),e.selectedElement.category=n,m.format(),m.isExpanded()?i.updateWidgetSettings(m,!1):m.toggleExpanded())},e.isSelected=function(t,n){return null==n&&(n=null),null!=t&&null!=e.selectedElement&&l(t,n,e.selectedElement)},e.toggleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),i.updateWidgetSettings(m,!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},e.getSelectLineColor=function(){return n.getColor(0)},s=function(e){var t,n,a,i;for(n=0,a=e.length;a>n;n++)if(i=e[n],null!=i.accounts&&(t=_.find(i.accounts,function(e){return o(e,i.name)===m.metadata.selectedElement}),null!=t))return t=angular.merge(angular.copy(t),{category:i.name})},l=function(e,t,n){return null==t&&(t=null),o(e,t)===o(n)},o=function(e,t){var n;return null==t&&(t=null),n=e.id||e.name,t||(t=e.category),t?t+"-"+n:n},u=function(t){return angular.forEach(m.content.summary,function(n){return n.accounts?n.accounts.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},g=function(){return"account"===e.sortedColumn?u(function(e){return e.name}):"total"===e.sortedColumn?u(function(t){return e.getLastValue(t)}):"variance"===e.sortedColumn?u(function(t){return e.getLastVariance(t)}):void 0},e.drawTrigger=t.defer(),m.format=function(){var t,i,r,s,o,l,d;return e.isDataFound&&null!=e.selectedElement?(r=angular.copy(e.selectedElement),d=null,null!=m.metadata&&null!=m.metadata.hist_parameters&&(d=m.metadata.hist_parameters.period),s=_.map(m.content.dates,function(e){return a("momentDate")(e,d)}),o={labels:s,datasets:[{title:r.label,values:r.cash_flows}]},t=!0,angular.forEach(r.cash_flows,function(e){return t&&(t=e>=0)}),l={scaleBeginAtZero:t,showXLabels:!0},i=n.combinedBarChart(o,l),e.drawTrigger.notify(i)):void 0},p={},p.initialized=!1,p.initialize=function(){return p.initialized=!0},p.toMetadata=function(){return{unCollapsed:e.unCollapsed}},m.settings.push(p),d={},d.initialized=!1,d.initialize=function(){return d.initialized=!0},d.toMetadata=function(){return null==e.selectedElement?{selectedElement:null}:{selectedElement:o(e.selectedElement)}},m.settings.push(d),e.widgetDeferred.resolve(c)}]),e.directive("widgetAccountsCashSummary",function(){return{restrict:"A",controller:"WidgetAccountsCashSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-class-comparison",[]),e.controller("WidgetAccountsClassComparisonCtrl",["$scope","$q","$filter","ChartFormatterSvc","$translate",function(e,t,n,a,i){var r,s,o;return o=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.timePeriodDeferred=t.defer(),r=[e.orgDeferred.promise,e.chartDeferred.promise,e.paramSelectorDeferred.promise,e.timePeriodDeferred.promise],e.timePeriodInfoParams={accountingBehaviour:"pnl",histParams:{}},s=function(e){var t;return e=e.toLowerCase(),t=i.instant("impac.widget.account_class_comp.klass."+e),_.includes(t,"impac.widget.account_class_comp.klass")?_.capitalize(e):t},o.initContext=function(){return e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.summary)&&!_.isEmpty(o.content.companies),e.isDataFound&&(e.timePeriodInfoParams.histParams=o.metadata&&o.metadata.hist_parameters,e.classifications=_.map(o.content.summary,function(e){var t;return t=e.classification,{label:s(t),labelTranslate:null!=e.classification_key?e.classification_key:void 0,value:t}}),!e.selectedClassification)?e.selectedClassification=angular.copy(_.find(e.classifications,{value:o.metadata.classification||e.classifications[0].value})):void 0},e.getTotals=function(){var t;return e.selectedClassification?t=_.find(o.content.summary,function(t){return t.classification===e.selectedClassification.value}).totals:[]},e.getAmount=function(t){var a;return a=e.getTotals()[t],n("mnoCurrency")(a,o.content.currency)},e.getAccountColor=function(e){return a.getColor(_.indexOf(o.content.companies,e))},e.drawTrigger=t.defer(),o.format=function(){var t,n,i;return e.isDataFound?(n={},n.labels=o.content.companies,n.values=e.getTotals(),n.labels.length>15&&(n.labels.length=15),n.values.length>15&&(n.values.length=15),i={showTooltips:!1,showXLabels:!1,barValueSpacing:Math.max(8-o.content.companies.length,1)},t=a.barChart(n,i),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetAccountsClassComparison",function(){return{restrict:"A",controller:"WidgetAccountsClassComparisonCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-comparison",[]),e.controller("WidgetAccountsComparisonCtrl",["$scope","$q","ChartFormatterSvc","$filter","$timeout","$translate",function(e,t,n,a,i,r){var s,o,l,d;return d=e.widget,e.orgDeferred=t.defer(),e.accountsListDeferred=t.defer(),e.chartDeferred=t.defer(),e.paramsCheckboxesDeferred=t.defer(),e.timePeriodDeferred=t.defer(),l=[e.orgDeferred.promise,e.accountsListDeferred.promise,e.chartDeferred.promise,e.paramsCheckboxesDeferred.promise,e.timePeriodDeferred.promise],d.initContext=function(){return e.movedAccount=[],r("impac.widget.account_comp.compare_mode_opt").then(function(t){return e.comparisonModeOptions=[{id:"compare_accounts",label:t,value:!1,onChangeCallback:e.updateSettings}],angular.isDefined(d.metadata.comparison_mode)&&null!=d.metadata.organization_ids&&d.metadata.organization_ids.length>1&&angular.merge(e.comparisonModeOptions,d.metadata.comparison_mode),e.savedAccountsList=s(),e.isDataFound=null!=d.content&&!_.isEmpty(d.content.complete_list)||e.isComparisonMode(),e.noComparableAccounts=e.isComparisonMode()&&null!=d.content&&_.isEmpty(d.content.complete_list),e.canSelectComparisonMode=o()})},o=function(){return null==d.content?!1:_.uniq(_.pluck(d.content.complete_list,"org_name")).length>1},e.isComparisonMode=function(){return _.result(_.find(e.comparisonModeOptions,"id","compare_accounts"),"value")||!1},e.hasAccountsSelected=function(){return d.selectedAccounts&&d.selectedAccounts.length>0},e.getAccountColor=function(t){return e.isComparisonMode()?n.getColor(_.indexOf(d.selectedAccounts[0].accounts,t)):n.getColor(_.indexOf(d.selectedAccounts,t))},e.addAccount=function(t){return t?(d.moveAccountToAnotherList(t,d.remainingAccounts,d.selectedAccounts),e.savedAccountsList.push(t.uid),d.format()):void 0},e.removeAccount=function(t){return t?(d.moveAccountToAnotherList(t,d.selectedAccounts,d.remainingAccounts),e.savedAccountsList.splice(e.savedAccountsList.indexOf(t.uid),1),d.format()):void 0},e.formatAmount=function(e){return a("mnoCurrency")(e.current_balance,e.currency)},s=function(){var t,n,a,i,r,s;if(r=d.metadata.accounts_list,_.isEmpty(r))return[];if(t=r[0].indexOf(":")>=0,!e.isComparisonMode()&&t)return _.flatten(_.map(r,function(e){return e.split(":")}));if(e.isComparisonMode()&&!t){for(a=0,i=r.length;i>a;a++)if(s=r[a],n=_.find(d.content.complete_list,function(e){return e.uid.indexOf(s)>=0}))return[n.uid];return[]}return r},e.drawTrigger=t.defer(),d.format=function(){var t;return t={labels:[],values:[]},i(function(){var a,i,r,s,o,l,c,u,g,p;for(g=d.selectedAccounts,s=0,l=g.length;l>s;s++)if(a=g[s],e.isComparisonMode())for(p=a.accounts,o=0,c=p.length;c>o;o++)r=p[o],t.labels.push(r.name),t.values.push(r.current_balance);else t.labels.push(a.name),t.values.push(a.current_balance);for(;t.values.length<15;)t.labels.push(""),t.values.push(null);return u={showTooltips:!1,showXLabels:!1,barDatasetSpacing:9},i=n.barChart(t,u),e.drawTrigger.notify(i)},500)},e.widgetDeferred.resolve(l)}]),e.directive("widgetAccountsComparison",function(){return{restrict:"A",controller:"WidgetAccountsComparisonCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-custom-calculation",[]),e.controller("WidgetAccountsCustomCalculationCtrl",["$scope","$timeout","$uibModal","$q","$templateCache","$filter","ImpacWidgetsSvc","ChartFormatterSvc",function(e,t,n,a,i,r,s,o){var l,d;return d=e.widget,e.orgDeferred=a.defer(),e.accountsListDeferred=a.defer(),e.formulaDeferred=a.defer(),e.histModeDeferred=a.defer(),e.chartDeferred=a.defer(),l=[e.orgDeferred.promise,e.accountsListDeferred.promise,e.formulaDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],d.initContext=function(){return e.movedAccount={},e.isDataFound=null!=d.content&&!_.isEmpty(d.content.complete_list)},e.drawTrigger=a.defer(),d.format=function(){return t(function(){var t,n,a,i,s,l,c;return t=!0,s=[],c=null,null!=d.metadata&&null!=d.metadata.hist_parameters&&(c=d.metadata.hist_parameters.period),i=_.map(d.content.dates,function(e){return r("momentDate")(e,c)}),a=_.map(d.content.dates,function(e,n){var a;return a=d.evaluatedFormula_History(n),t&&(t=a>=0),a}),s.push({title:"Test Data",labels:i,values:a}),l={scaleBeginAtZero:t,showXLabels:!1,datasetFill:!0,pointDot:!0},n=o.lineChart(s,l),e.drawTrigger.notify(n)},500)},e.addAccountToFormula=function(e){return null!=e?(d.selectedAccounts.length>0?d.formula+=" + {"+(d.selectedAccounts.length+1)+"}":d.formula="{1}",d.moveAccountToAnotherList(e,d.remainingAccounts,d.selectedAccounts,!1)):void 0},e.removeAccountFromFormula=function(e){var t,n,a,i,r,s,o,l;for(o=_.map(d.selectedAccounts,function(e){return e.uid}),s=_.reject(o,function(t){return t===e.uid}),n=_.first(_.difference(o,s)),t=_.indexOf(o,n)+1,l=1===t?"{"+t+"\\}\\s*(-|\\*|\\/|\\+)*\\s*":"\\s*(-|\\*|\\/|\\+)*\\s*\\{"+t+"\\}",r=angular.copy(d.formula).replace(new RegExp(l,"g"),""),a=t+1;a<=o.length;)i="\\{"+a+"\\}",r=r.replace(new RegExp(i,"g"),"{"+(a-1)+"}"),a++;return d.formula=angular.copy(r),d.moveAccountToAnotherList(e,d.selectedAccounts,d.remainingAccounts,!1)},e.formulaModal=e.$new(),e.formulaModal.config={backdrop:"static",template:i.get("widgets/accounts-custom-calculation/formula.modal.html"),size:"lg",scope:e.formulaModal,keyboard:!1},e.formulaModal.open=function(){var t;return t=e.formulaModal,t.modalOrgDeferred=a.defer(),t.timePeriodDeferred=a.defer(),_.remove(d.settings,function(e){return"organizations"===e.key}),t.instance=n.open(t.config),a.all([t.modalOrgDeferred.promise,t.timePeriodDeferred.promise]).then(function(){return e.initSettings()})},e.reloadAccountsLists=function(t){return null!=t&&_.some(_.values(t))?e.updateWidgetSettings():void 0},e.updateWidgetSettings=function(){return s.updateWidgetSettings(d)},e.formulaModal.cancel=function(){return e.initSettings(),e.formulaModal.close()},e.formulaModal.proceed=function(){return s.updateWidgetSettings(d),e.formulaModal.close()},e.formulaModal.close=function(){return e.formulaModal.instance.close()},e.$watch(function(){return d.isEditMode},function(t,n){return t&&!n?e.formulaModal.open():void 0}),e.widgetDeferred.resolve(l)}]),e.directive("widgetAccountsCustomCalculation",function(){return{restrict:"A",controller:"WidgetAccountsCustomCalculationCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-detailed-classifications",[]),e.controller("WidgetAccountsDetailedClassificationsCtrl",["$scope","$q","ImpacWidgetsSvc",function(e,t,n){var a,i,r,s,o;return o=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),a=[e.orgDeferred.promise,e.timePeriodDeferred.promise],e.timePeriodInfoParams={accountingBehaviour:"pnl",histParams:{}},e.ascending=!0,e.sortedColumn="account",o.initContext=function(){return e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.companies),e.isDataFound?(e.timePeriodInfoParams.histParams=o.metadata&&o.metadata.hist_parameters,e.unCollapsed=o.metadata.unCollapsed||[],1===o.content.companies.length?(e.multiEntity=!1,e.dataSource=_.map(o.content.companies[0].classifications,function(e){return{label:e.name,value:e.total,currency:e.currency,entries:_.map(e.accounts,function(e){return{label:e.name,value:e.balance,currency:e.currency}})}})):(e.multiEntity=!0,e.dataSource=_.map(o.content.companies,function(e){return{label:e.name,entries:_.map(e.classifications,function(e){return{label:e.name,value:e.total,currency:e.currency}})}})),r()):void 0},e.toggleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),n.updateWidgetSettings(o,!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},i=function(t){return angular.forEach(e.dataSource,function(n){return n.entries?n.entries.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},r=function(){return"account"===e.sortedColumn?i(function(e){return e.label}):"total"===e.sortedColumn?i(function(e){return e.value}):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),r()},s={},s.initialized=!1,s.initialize=function(){return s.initialized=!0},s.toMetadata=function(){return{unCollapsed:e.unCollapsed}},o.settings.push(s),e.widgetDeferred.resolve(a)}]),e.directive("widgetAccountsDetailedClassifications",function(){return{restrict:"A",controller:"WidgetAccountsDetailedClassificationsCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-expense-weight",[]),e.controller("WidgetAccountsExpenseWeightCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate","$timeout",function(e,t,n,a,i,r){var s,o;return o=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.accountBackDeferred=t.defer(),e.accountFrontDeferred=t.defer(),e.chartDeferred=t.defer(),e.histModeDeferred=t.defer(),s=[e.orgDeferred.promise,e.timePeriodDeferred,e.accountBackDeferred,e.accountFrontDeferred,e.chartDeferred.promise,e.histModeDeferred.promise],e.forwardParams={accountingBehaviour:"pnl"},o.initContext=function(){return e.isDataFound=null!=o.content&&!_.isEmpty(o.content.account_list),e.forwardParams.histParams=o.metadata&&o.metadata.hist_parameters},e.getName=function(){return null!=o.selectedAccount?o.selectedAccount.name:void 0},e.getComparator=function(){switch(o.metadata.comparator){case"turnover":return i.instant("impac.widget.account_expense_weight.comparator.turnover");default:return i.instant("impac.widget.account_expense_weight.comparator.total_exp")}},e.displayAccount=function(){return e.updateSettings(!1).then(function(){return r(function(){return o.format()})})},e.drawTrigger=t.defer(),o.format=function(){var t,i,r,s,l,d,c,u,g,p,m;return e.isDataFound&&null!=o.content.summary?(o.isHistoryMode?(p=null,null!=o.metadata&&null!=o.metadata.hist_parameters&&(p=o.metadata.hist_parameters.period),l=_.map(o.content.dates,function(e){return a("momentDate")(e,p)}),s=_.map(o.content.summary,function(e){return{title:e.company,values:e.ratios}}),t=!0,angular.forEach(o.content.summary,function(e){return angular.forEach(e.ratios,function(e){return t&&(t=e>=0)})}),c={labels:l,datasets:s},u={scaleBeginAtZero:t,showXLabels:!1,currency:"(ratio)"},i=n.combinedBarChart(c,u,!1,!0)):(r=_.map(o.content.summary,function(e){return e.company}),m=_.map(o.content.summary,function(e){return e.ratio}),1===r.length&&(r.push(r[0]),m.push(m[0])),d={labels:r,values:m},g={scales:{yAxes:[{ticks:{suggestedMin:0,suggestedMax:100,maxTicksLimit:5}}]},showXLabels:!1,pointDot:!1,currency:"%"},i=n.lineChart([d],g)),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(s)}]),e.directive("widgetAccountsExpenseWeight",function(){return{restrict:"A",controller:"WidgetAccountsExpenseWeightCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-expenses-revenue",[]),e.controller("WidgetAccountsExpensesRevenueCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),e.paramsCheckboxesDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise,e.paramsCheckboxesDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.values,e.displayOptions=[{id:"show_net_profit",label:i.instant("impac.widget.accounts_expenses_revenue.show_net_profit"),value:!1,onChangeCallback:e.toggleDisplayNetProfit}],angular.isDefined(null!=s.metadata&&null!=s.metadata.display)&&angular.merge(e.displayOptions,s.metadata.display),e.isNetProfitDisplayed=!!e.displayOptions[0].value},e.getCurrentRevenue=function(){return e.isDataFound?_.sum(s.content.values.revenue):void 0},e.getCurrentExpenses=function(){return e.isDataFound?_.sum(s.content.values.expenses):void 0},e.getCurrency=function(){return e.isDataFound?s.content.currency:void 0},e.toggleDisplayNetProfit=function(){return e.isNetProfitDisplayed=!!e.displayOptions[0].value,e.updateSettings(!1),s.format()},e.drawTrigger=t.defer(),s.format=function(){var t,r,o,l,d,c,u,g,p;return e.isDataFound?(s.isHistoryMode?(u=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(u=s.metadata.hist_parameters.period),l=_.map(s.content.dates,function(e){return a("momentDate")(e,u)}),e.isNetProfitDisplayed?(o=[{title:i.instant("impac.widget.accounts_expenses_revenue.net_profit")+(" ("+e.getCurrency()+")"),values:s.content.values.net_profit}],t=!0,angular.forEach(s.content.values.net_profit,function(e){return t&&(t=e>=0)})):(o=[{title:i.instant("impac.widget.accounts_expenses_revenue.expenses")+(" ("+e.getCurrency()+")"),values:s.content.values.expenses},{title:i.instant("impac.widget.accounts_expenses_revenue.revenue")+(" ("+e.getCurrency()+")"),values:s.content.values.revenue}],t=!0,angular.forEach(s.content.values.expenses,function(e){return t&&(t=e>=0)}),angular.forEach(s.content.values.revenue,function(e){return t&&(t=e>=0)})),d={labels:l,datasets:o},c={scaleBeginAtZero:t,showXLabels:!1},r=n.combinedBarChart(d,c,!1,!0)):(g=[{label:i.instant("impac.widget.accounts_expenses_revenue.expenses")+(" ("+e.getCurrency()+")"),value:e.getCurrentExpenses()},{label:i.instant("impac.widget.accounts_expenses_revenue.revenue")+(" ("+e.getCurrency()+")"),value:e.getCurrentRevenue()}],p={tooltipFontSize:12,percentageInnerCutout:0},r=n.pieChart(g,p,!0)),e.drawTrigger.notify(r)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetAccountsExpensesRevenue",function(){return{restrict:"A",controller:"WidgetAccountsExpensesRevenueCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-invoices-list",[]),e.controller("WidgetAccountsInvoicesListCtrl",["$scope","$q","ImpacRoutes","BoltResources",function(e,t,n,a){var i,r,s,o,l;return l=e.widget,r=n.bolts(),i=_.find(r,{name:"finance",provider:"maestrano"}).path,l.sortParamater="-due_date",e.trxList={display:!1,resources:"invoices",transactions:[],params:{include:"contact",fields:{contacts:"name"},sort:l.sortParamater,currency:l.metadata.currency}},s=function(e,t){var n;return n=_.find(t,function(t){return t.id===e}),n.attributes.name},e.orgDeferred=t.defer(),o=[e.orgDeferred.promise],e.trxList.show=function(){return e.trxList.display=!0},e.trxList.hide=function(){return e.trxList.display=!1},e.trxList.fetch=function(t){var n;return null==t&&(t=1),n=angular.merge(e.trxList.params,{metadata:_.pick(l.metadata,"organization_ids"),page:{number:t},currency:l.metadata.currency}),a.index(i,e.trxList.resources,n).then(function(t){var n,a,i,r,o;for(_.remove(e.trxList.transactions,function(){return!0}),r=t.data.data,a=0,i=r.length;i>a;a++)o=r[a],o.relationships&&o.relationships.contact&&o.relationships.contact.data&&(n=s(o.relationships.contact.data.id,t.data.included)),e.trxList.transactions.push(angular.merge(o.attributes,{id:e.trxList.id,contact_name:n||null}));return e.trxList.totalRecords=t.data.meta.record_count})["finally"](function(){return e.trxList.show()})},e.trxList.changeResourcesType=function(t){return t!==e.trxList.resources?(e.trxList.resources=t,e.trxList.fetch()):void 0},l.initContext=function(){return e.trxList.fetch()},e.widgetDeferred.resolve(o)}]),e.directive("widgetAccountsInvoicesList",function(){return{restrict:"A",controller:"WidgetAccountsInvoicesListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-live-balance",[]),e.controller("WidgetAccountsLiveBalanceCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(e,t){var n,a;return a=e.widget,e.isLiveBalance=!0,e.orgDeferred=t.defer(),e.accountBackDeferred=t.defer(),n=[e.orgDeferred.promise,e.accountBackDeferred.promise],e.isDataFound=!0,a.initContext=function(){return e.isDataFound=null!=a.content},e.getCurrency=function(){return null!=a.selectedAccount?a.selectedAccount.currency:void 0},e.getOpeningBalance=function(){return null!=a.content?_.find(a.content.figure.metrics,function(e){return"opening"===e.label}):void 0},e.getClosingBalance=function(){return null!=a.content?_.find(a.content.figure.metrics,function(e){return"closing"===e.label}):void 0},e.getTotal=function(){var e;return null!=a.content&&(e=_.find(a.content.table.tables,function(e){return"Bank Summary"===e.table_title})),null!=a.selectedAccount?_.find(e.table_rows,function(e){var t;return t="All Accounts"===a.selectedAccount.name?"Total":a.selectedAccount.name,e.column_1===t}):void 0},e.getStatementBalance=function(){var e;return null!=a.content&&(e=_.find(a.content.table.tables,function(e){return"Bank Statement"===e.table_title})),e?_.find(e.table_rows,function(e){return"Closing Balance"===e.column_2}):void 0},e.displayAccount=function(){return e.updateSettings(!1).then(function(){return a.format()})},a.format=function(){},e.widgetDeferred.resolve(n)}]),e.directive("widgetAccountsLiveBalance",function(){return{restrict:"A",controller:"WidgetAccountsLiveBalanceCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-payable-receivable",[]),e.controller("WidgetAccountsPayableReceivableCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.values&&null!=s.content.live_values},e.getCurrentPayable=function(){return e.isDataFound?_.last(s.content.values.payables):0},e.getCurrentReceivable=function(){return e.isDataFound?_.last(s.content.values.receivables):0},e.getCurrency=function(){return e.isDataFound?s.content.currency:void 0},e.drawTrigger=t.defer(),s.format=function(){var t,r,o,l,d,c,u,g,p,m,h;if(e.isDataFound){for(g=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(g=s.metadata.hist_parameters.period),r=_.map(s.content.dates,function(e){return a("momentDate")(e,g)}),t=!0,p=s.content.values.payables,o=0,d=p.length;d>o;o++)h=p[o],t&&(t=h>=0);for(m=s.content.values.receivables,l=0,c=m.length;c>l;l++)h=m[l],t&&(t=h>=0);return u={scaleBeginAtZero:t,showXLabels:!1},i(["impac.widget.accounts_payable_receivable.payable","impac.widget.accounts_payable_receivable.receivable"]).then(function(t){var a,i;return i=[{title:t["impac.widget.accounts_payable_receivable.payable"],labels:r,values:s.content.values.payables},{title:t["impac.widget.accounts_payable_receivable.receivable"],labels:r,values:s.content.values.receivables}],a=n.lineChart(i,u,!0),e.drawTrigger.notify(a)})}},e.widgetDeferred.resolve(r)}]),e.directive("widgetAccountsPayableReceivable",function(){return{restrict:"A",controller:"WidgetAccountsPayableReceivableCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-profit-and-loss",[]),e.controller("WidgetAccountsProfitAndLossCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc","ImpacUtilities","$translate","ImpacTheming",function(e,t,n,a,i,r,s,o){var l,d,c,u,g,p,m,h,f,v,b,w,y,x,C;return C=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.chartDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.tagFilterDeferred=t.defer(),b=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.chartDeferred.promise,e.paramSelectorDeferred.promise,e.tagFilterDeferred.promise],e.ascending=!0,e.sortedColumn="account",e.filterTagsEnabled=o.get().widgetSettings.tagging.enabled,v=function(){return e.amountDisplayed=angular.copy(_.find(e.amountDisplayedOptions,function(e){return C.metadata&&e.value===C.metadata.amount_displayed})||e.amountDisplayedOptions[1])},s(["impac.widget.accounts_profit_and_loss.last_period","impac.widget.accounts_profit_and_loss.total_for_period"]).then(function(t){return e.amountDisplayedOptions=[{label:t["impac.widget.accounts_profit_and_loss.last_period"],value:"last"},{label:t["impac.widget.accounts_profit_and_loss.total_for_period"],value:"total"}],v()}),h=(p=e.widget.metadata.hist_parameters)&&p.period?p.period.toLowerCase():"monthly",s("impac.widget.settings.time_period.period."+h).then(function(t){return e.period_translation=_.capitalize(t.toLowerCase())}),e.isReportFiltered=function(){return null!=C.metadata&&null!=C.metadata.filter_query&&Object.keys(C.metadata.filter_query).length>0},C.initContext=function(){var t,n,i,s,o,d,c,g,p;if(e.isDataFound=angular.isDefined(C.content)&&!_.isEmpty(C.content.summary)&&!_.isEmpty(C.content.dates)){if(e.dates=C.content.dates,e.unCollapsed=C.metadata.unCollapsed||[],C.metadata&&(s=C.metadata.hist_parameters)&&(t=r.selectedTimeRange(s),n=a("momentDate")(t.from,u()),d=a("momentDate")(t.to,u()),e.amountDisplayedOptions[1].label=n+" to "+d,e.amountDisplayedOptions[0].label=d),v(),!_.isEmpty(C.metadata.selectedElements))for(e.selectedElements=[],g=C.metadata.selectedElements,o=0,c=g.length;c>o;o++)p=g[o],i=_.find(C.content.summary,function(e){return e.name===p}),i||(i=l(C.content.summary,p)),i&&e.selectedElements.push(i);return _.any(e.selectedElements)||(C.width=6),y()}},e.getElementChartColor=function(e){return n.getColor(e)},u=function(){return null!=C.metadata&&null!=C.metadata.hist_parameters&&null!=C.metadata.hist_parameters.period?C.metadata.hist_parameters.period:"MONTHLY"},c=function(e){return null!=e.totals?_.last(e.totals):void 0},g=function(e){return null!=e.totals?_.sum(e.totals):void 0},e.getAmount=function(t){switch(e.amountDisplayed.value){case"total":return g(t);default:return c(t)}},e.getClassColor=function(e){return parseInt(e)>0?"positive":parseInt(e)<0?"negative":null},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace(/_/g," "):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),y()},e.toggleSelectedElement=function(t,n){var a;return null==n&&(n=null),e.isSelected(t,n)?(e.selectedElements=_.reject(e.selectedElements,function(e){return m(t,n,e)}),C.format(),C.isExpanded()&&0===e.selectedElements.length?C.toggleExpanded():i.updateWidgetSettings(C,!1)):(a=angular.copy(t),a.category=n,e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(a),C.format(),C.isExpanded()?i.updateWidgetSettings(C,!1):C.toggleExpanded())},e.isSelected=function(t,n){return null==n&&(n=null),null!=t&&_.any(e.selectedElements,function(e){return m(t,n,e)})},e.toggleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name
}):e.unCollapsed.push(t.name),i.updateWidgetSettings(C,!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},e.getSelectLineColor=function(t,a){var i;return null==a&&(a=null),i=_.find(e.selectedElements,function(e){return m(t,a,e)}),e.hasElements()?n.getColor(_.indexOf(e.selectedElements,i)):void 0},e.hasElements=function(){return null!=e.selectedElements&&e.selectedElements.length>0},m=function(e,t,n){return null==t&&(t=null),d(e,t)===d(n)},l=function(e,t){var n,a,i,r;for(a=0,i=e.length;i>a;a++)if(r=e[a],null!=r.accounts&&(n=_.find(r.accounts,function(e){return d(e,r.name)===t}),null!=n))return n=angular.merge(angular.copy(n),{category:r.name})},d=function(e,t){var n;return null==t&&(t=null),n=e.id||e.name,t||(t=e.category),t?t+"-"+n:n},w=function(t){return angular.forEach(C.content.summary,function(n){return n.accounts?n.accounts.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},y=function(){return"account"===e.sortedColumn?w(function(e){return e.name}):"total"===e.sortedColumn?w(function(t){return e.getAmount(t)}):void 0},e.drawTrigger=t.defer(),C.format=function(){var t,i,r,s;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,r=[],angular.forEach(e.selectedElements,function(e){var n,i,s;return n=angular.copy(e),s=null,null!=C.metadata&&null!=C.metadata.hist_parameters&&(s=C.metadata.hist_parameters.period),i=_.map(C.content.dates,function(e){return a("momentDate")(e,s)}),r.push({title:n.name,labels:i,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),s={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},i=n.lineChart(r,s),e.drawTrigger.notify(i)):void 0},x={},x.initialized=!1,x.initialize=function(){return x.initialized=!0},x.toMetadata=function(){return{unCollapsed:e.unCollapsed}},C.settings.push(x),f={},f.initialized=!1,f.initialize=function(){return f.initialized=!0},f.toMetadata=function(){var t;return t=_.map(e.selectedElements,function(e){return d(e)}),{selectedElements:t}},C.settings.push(f),e.widgetDeferred.resolve(b)}]),e.directive("widgetAccountsProfitAndLoss",function(){return{restrict:"A",controller:"WidgetAccountsProfitAndLossCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.accounts-ratios",[]),e.controller("WidgetAccountsRatiosCtrl",["$scope","$q","$filter","$translate","ChartFormatterSvc","ImpacTheming",function(e,t,n,a,i,r){var s,o,l;return l=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.numeratorOffsetsDeferred=t.defer(),e.denominatorOffsetsDeferred=t.defer(),o=[e.orgDeferred.promise,e.chartDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.numeratorOffsetsDeferred.promise,e.denominatorOffsetsDeferred.promise],e.totalRatio=0,e.totalNumerator=0,e.totalDenominator=0,e.calculatedNumerator=0,e.calculatedDenominator=0,e.simulationMode=!1,e.intervalsCount=0,e.isPnl=!1,e.periodInfoContext={},s=function(e){var t,n,i,s,o;return n=r.get().widgetSettings.histModeChoser.currentLabels,o=r.get().widgetSettings.histModeChoser.todayPrefixes,i=_.last(l.content.layout.dates)===moment().format("YYYY-MM-DD"),t=n[e],s=o[e],a([t,s]).then(function(e){return i?e[s]+" "+e[t]:e[t]})},l.initContext=function(){var t;return e.isDataFound=!_.isEmpty(l.content),e.isDataFound?(e.intervalsCount=_.size(l.content.layout.dates),e.endDate=_.last(l.content.layout.dates),t=l.content.layout.accounting_behaviour,e.periodInfoContext.histParams=l.metadata.hist_parameters,e.periodInfoContext.accountingBehaviour=t,s(t).then(function(t){return e.periodInfoContext.injectBefore=t}),"pnl"===t?(e.totalRatio=l.content.calculation.ratio.average,e.totalNumerator=_.sum(l.content.calculation.numerator.totals),e.totalDenominator=_.sum(l.content.calculation.denominator.totals),e.calculatedNumerator=_.sum(l.content.calculation.numerator.values),e.calculatedDenominator=_.sum(l.content.calculation.denominator.values),e.isPnl=!0):(e.totalRatio=_.last(l.content.calculation.ratio.totals),e.totalNumerator=_.last(l.content.calculation.numerator.totals),e.totalDenominator=_.last(l.content.calculation.denominator.totals),e.calculatedNumerator=_.last(l.content.calculation.numerator.values),e.calculatedDenominator=_.last(l.content.calculation.denominator.values))):void 0},e.toggleSimulationMode=function(t){return null==t&&(t=!1),t&&e.initSettings(),e.simulationMode=!e.simulationMode},e.saveSimulation=function(){return e.updateSettings(),e.toggleSimulationMode()},e.drawTrigger=t.defer(),l.format=function(){var t,a,r,s,o,d;return e.isDataFound?(a=angular.copy(l.content),d=null,null!=l.metadata&&null!=l.metadata.hist_parameters&&(d=l.metadata.hist_parameters.period),r=_.map(a.layout.dates,function(e){return n("momentDate")(e,d)}),s={labels:r,datasets:[{title:a.layout.ratio,values:a.calculation.ratio.totals}]},o={currency:"hide",showXLabels:!1},t=i.combinedBarChart(s,o,!1),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(o)}]),e.directive("widgetAccountsRatios",function(){return{restrict:"A",controller:"WidgetAccountsRatiosCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-employee-details",[]),e.controller("WidgetHrEmployeeDetailsCtrl",["$scope","$q","$filter","$translate",function(e,t,n,a){var i,r,s;return s=e.widget,e.orgDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred1=t.defer(),e.paramSelectorDeferred2=t.defer(),r=[e.orgDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred1.promise,e.paramSelectorDeferred2.promise],e.salaries=[],s.initContext=function(){var t;return(e.isDataFound=!_.isEmpty(s.content)&&!_.isEmpty(s.content.employees))?(e.periodOptions=[{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.yearly")),value:"yearly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.monthly")),value:"monthly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.weekly")),value:"weekly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.daily")),value:"daily"}],e.period=s.metadata&&s.metadata.period?angular.copy(_.find(e.periodOptions,function(e){return e.value===s.metadata.period.toLowerCase()})||e.periodOptions[0]):angular.copy(e.periodOptions[0]),e.employeesOptions=_.map(s.content.employees,function(e){return{value:e.uid,label:e.lastname+" "+e.firstname}}),t=e.getEmployee(),e.selectedEmployee={value:t.uid,label:t.lastname+" "+t.firstname},i(t,e.salaries)):void 0},i=function(e,t){var n,a,i,r,s,o,l;for(_.remove(t,function(){return!0}),r=e.employee_salaries,s=[],a=0,i=r.length;i>a;a++)o=r[a],l=o.name,o.hours_per_week&&(l=o.name+" ("+o.hours_per_week+"h per week)"),(n=o.annual_salary)?s.push(t.push({amount:n,currency:o.currency,period:"Annual",tooltip:l})):(n=o.hourly_rate)?s.push(t.push({amount:n,currency:o.currency,period:"Hourly",tooltip:l})):s.push(void 0);return s},e.getSingleCompanyName=function(){var t,n;return s.content&&s.content.organizations&&(n=s.content.organizations[0],t=_.find(e.parentDashboard.data_sources,function(e){return e.uid===n}),null!=t)?t.label:void 0},e.getEmployee=function(){var t;return e.isDataFound?(t=s.metadata&&s.metadata.employee_uid?angular.copy(_.find(s.content.employees,function(e){return e.uid===s.metadata.employee_uid})||s.content.employees[0]):angular.copy(s.content.employees[0]),null!=t.salary&&(t.earnings=n("mnoCurrency")(t.salary.amount,t.salary.currency)),t):!1},e.formatAddress=function(e){return angular.isDefined(e)?e.replace(/, /g,",\n"):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetHrEmployeeDetails",function(){return{restrict:"A",controller:"WidgetHrEmployeeDetailsCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-employees-list",[]),e.controller("WidgetHrEmployeesListCtrl",["$scope","$q","$filter","$translate",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),i=[e.orgDeferred.promise,e.paramSelectorDeferred.promise],r.initContext=function(){return(e.isDataFound=!_.isEmpty(r.content)&&!_.isEmpty(r.content.total)&&!_.isEmpty(r.content.employees))?(e.periodOptions=[{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.yearly")),value:"yearly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.monthly")),value:"monthly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.weekly")),value:"weekly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.daily")),value:"daily"}],e.period=angular.copy(_.find(e.periodOptions,function(e){return e.value===r.content.total.period.toLowerCase()})||e.periodOptions[0])):void 0},e.getSingleCompanyName=function(){var t,n;return r.content&&r.content.organizations?(n=r.content.organizations[0],t=_.find(e.parentDashboard.data_sources,function(e){return e.uid===n}),t.label):void 0},e.getEmployeeEarnings=function(e){return null!=e.salary?n("mnoCurrency")(e.salary.amount,r.content.total.currency):"-"},e.widgetDeferred.resolve(i)}]),e.directive("widgetHrEmployeesList",function(){return{restrict:"A",controller:"WidgetHrEmployeesListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-leaves-balance",[]),e.controller("WidgetHrLeavesBalanceCtrl",["$scope","$q","$translate",function(e,t,n){var a,i,r,s;return s=e.widget,e.orgDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),r=[e.orgDeferred.promise,e.paramSelectorDeferred.promise],s.initContext=function(){return(e.isDataFound=!_.isEmpty(s.content)&&!_.isEmpty(s.content.employees))?(e.employeesOptions=_.map(s.content.employees,function(e){return{value:e.uid,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().uid,label:e.getEmployee().lastname+" "+e.getEmployee().firstname}):void 0},e.getEmployee=function(){var t;return e.isDataFound?(t=s.content.employees[0],s.metadata&&s.metadata.employee_id&&(t=_.find(s.content.employees,function(e){return e.uid===s.metadata.employee_id})||s.content.employees[0]),angular.copy(t)):!1},a=e.getEmployee(),i=a&&a.leaves[0].name,i?e.vacationLeaves_translation=i:n("impac.widget.hr_leaves_balance.vacation_leaves").then(function(t){return e.vacationLeaves_translation=t}),i=a&&a.leaves[1].name,i?e.sickLeaves_translation=i:n("impac.widget.hr_leaves_balance.sick_leaves").then(function(t){return e.sickLeaves_translation=t}),e.widgetDeferred.resolve(r)}]),e.directive("widgetHrLeavesBalance",function(){return{restrict:"A",controller:"WidgetHrLeavesBalanceCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-leaves-schedule",[]),e.controller("WidgetHrLeavesScheduleCtrl",["$scope","$q","ChartFormatterSvc",function(e,t){var n,a;return a=e.widget,e.orgDeferred=t.defer(),n=[e.orgDeferred.promise],a.initContext=function(){var t;return(e.isDataFound=angular.isDefined(a.content)&&!_.isEmpty(a.content.summary))?(t=[],angular.forEach(a.content.summary,function(e){return t.push({title:e.employee_name+" - "+e.title,start:e.start_date,end:e.end_date})}),e.eventSources=angular.copy(t)):void 0},e.widgetDeferred.resolve(n)}]),e.directive("widgetHrLeavesSchedule",function(){return{restrict:"A",controller:"WidgetHrLeavesScheduleCtrl"}}),e.directive("widgetComponentCalendar",["$tranlate",function(e){return{scope:{events:"=ngModel"},restrict:"A",link:function(t,n){var a,i;return t.eventSources=[],a={header:{left:e.instant("impac.common.action.calendar.left"),center:e.instant("impac.common.action.calendar.center"),right:e.instant("impac.common.action.calendar.right")},contentHeight:204},i=function(){return t.events},t.$watch(i,function(e){return e.length>0?(n.fullCalendar("destroy"),angular.extend(a,{events:t.events}),n.fullCalendar(a)):void 0},!0)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-payroll-summary",[]),e.controller("WidgetHrPayrollSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc","$translate",function(e,t,n,a,i,r){var s,o,l,d,c,u,g,p,m,h,f;return f=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),g=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],e.ascending=!0,e.sortedColumn="employee",c=(l=e.widget.metadata.hist_parameters)&&l.period?l.period.toLowerCase():"monthly",e.periodTranslation=r.instant("impac.widget.settings.time_period.period."+c),f.initContext=function(){var t,n,a,i,r;if(e.isDataFound=angular.isDefined(f.content)&&!_.isEmpty(f.content.summary)&&!_.isEmpty(f.content.dates)){if(e.unCollapsed=f.metadata.unCollapsed||[],!_.isEmpty(f.metadata.selectedElements))for(e.selectedElements=[],i=f.metadata.selectedElements,n=0,a=i.length;a>n;n++)r=i[n],t=_.find(f.content.summary,function(e){return e.name===r}),t||(t=s(f.content.summary,r)),t&&e.selectedElements.push(t);return null!=e.selectedElements&&e.selectedElements.length>0||(f.width=6),p()}},e.getElementChartColor=function(e){return n.getColor(e)},e.getLastValue=function(e){return e.totals&&e.totals[e.totals.length-1]||0},e.getTotalSum=function(e){return null!=e.totals?_.reduce(e.totals,function(e,t){return e+t},0):void 0},e.getName=function(e){return null!=e&&null!=e.name?"total_leaves"===e.name?r.instant("impac.widget.hr_payroll_summary.total_leaves"):"total_super"===e.name?r.instant("impac.widget.hr_payroll_summary.total_superannuation"):"total_reimbursement"===e.name?r.instant("impac.widget.hr_payroll_summary.total_reimbursements"):"total_tax"===e.name?r.instant("impac.widget.hr_payroll_summary.total_taxes"):"total_timeoff"===e.name?r.instant("impac.widget.hr_payroll_summary.total_time_off"):e.name.replace(/_/g," "):void 0},e.getTrackedField=function(){var t,n;return _.isEmpty(e.selectedElements)||null==e.selectedElements[0].id?void 0:(n=e.selectedElements[0].id.split("-")[0],t=!0,angular.forEach(e.selectedElements,function(e){return t&&(t=e.id&&n===e.id.split("-")[0])}),t?e.getName({name:n}):null)},e.formatDate=function(e){return null!=f.metadata&&null!=f.metadata.hist_parameters?a("momentDate")(e,f.metadata.hist_parameters.period):a("momentDate")(e,"default")},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),p()},e.toggleSelectedElement=function(t,n){var a;return null==n&&(n=null),e.isSelected(t,n)?(e.selectedElements=_.reject(e.selectedElements,function(e){return d(t,n,e)}),f.format(),f.isExpanded()&&0===e.selectedElements.length?f.toggleExpanded():i.updateWidgetSettings(f,!1)):(a=angular.copy(t),a.category=n,e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(a),f.format(),f.isExpanded()?i.updateWidgetSettings(f,!1):f.toggleExpanded())},e.isSelected=function(t,n){return null==n&&(n=null),null!=t&&_.any(e.selectedElements,function(e){return d(t,n,e)})},e.toggleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),i.updateWidgetSettings(f,!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},e.hasElements=function(){return null!=e.selectedElements&&e.selectedElements.length>0},e.getSelectLineColor=function(t,a){var i;return null==a&&(a=null),i=_.find(e.selectedElements,function(e){return d(t,a,e)}),e.hasElements()?n.getColor(_.indexOf(e.selectedElements,i)):void 0},d=function(e,t,n){return null==t&&(t=null),o(e,t)===o(n)},s=function(e,t){var n,a,i,r;for(a=0,i=e.length;i>a;a++)if(r=e[a],null!=r.employees&&(n=_.find(r.employees,function(e){return o(e,r.name)===t}),null!=n))return n=angular.merge(angular.copy(n),{category:r.name})},o=function(e,t){var n;return null==t&&(t=null),n=e.id||e.name,t||(t=e.category),t?t+"-"+n:n},m=function(t){return angular.forEach(f.content.summary,function(n){return n.employees?n.employees.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},p=function(){return"employee"===e.sortedColumn?m(function(e){return e.name}):"total"===e.sortedColumn?m(function(t){return e.getLastValue(t)}):void 0},e.drawTrigger=t.defer(),f.format=function(){var t,i,r,s,o,l,d;return e.isDataFound&&e.hasElements()?(f.isHistoryMode?(t=!0,r=[],s=_.map(f.content.dates,function(e){return f.metadata.hist_parameters&&"YEARLY"===f.metadata.hist_parameters.period?a("momentDate")(e,"YEARLY"):f.metadata.hist_parameters&&"QUARTERLY"===f.metadata.hist_parameters.period?a("momentDate")(e,"QUARTERLY"):f.metadata.hist_parameters&&"MONTHLY"===f.metadata.hist_parameters.period?a("momentDate")(e,"MONTHLY"):f.metadata.hist_parameters&&"WEEKLY"===f.metadata.hist_parameters.period?a("momentDate")(e,"WEEKLY"):f.metadata.hist_parameters&&"DAILY"===f.metadata.hist_parameters.period?a("momentDate")(e,"DAILY"):a("momentDate")(e,"default")}),angular.forEach(e.selectedElements,function(e){var n;return n=angular.copy(e),r.push({title:n.name,labels:s,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length,currency:"hide"},i=n.lineChart(r,o)):(l=_.map(e.selectedElements,function(t){return{label:a("titleize")(e.getName({name:t.name})),value:e.getLastValue(t)}}),d={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12,currency:"hide"},i=n.pieChart(l,d)),e.drawTrigger.notify(i)):void 0},h={},h.initialized=!1,h.initialize=function(){return h.initialized=!0},h.toMetadata=function(){return{unCollapsed:e.unCollapsed}},f.settings.push(h),u={},u.initialized=!1,u.initialize=function(){return u.initialized=!0},u.toMetadata=function(){var t;return t=_.map(e.selectedElements,function(e){return o(e)}),{selectedElements:t}},f.settings.push(u),e.widgetDeferred.resolve(g)}]),e.directive("widgetHrPayrollSummary",function(){return{restrict:"A",controller:"WidgetHrPayrollSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-payroll-taxes",[]),e.controller("WidgetHrPayrollTaxesCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&!_.isEmpty(s.content.total_tax)&&!_.isEmpty(s.content.dates)},e.getCurrentPrice=function(){return e.isDataFound?_.last(s.content.total_tax):void 0},e.getCurrency=function(){return e.isDataFound?s.content.currency||"USD":void 0},e.getPeriod=function(){var t,n;return e.isDataFound&&s.metadata&&s.metadata.hist_parameters?(n=s.metadata.hist_parameters.period||"MONTHLY",t="day","DAILY"!==n&&(t=n.substr(0,n.length-2).toLowerCase()),"(current "+t+")"):void 0},e.drawTrigger=t.defer(),s.format=function(){var t,r,o,l,d,c;return e.isDataFound?(c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(s.content.dates,function(e){return a("momentDate")(e,c)}),l={title:i.instant("impac.widget.hr_payroll_taxes.payroll_taxes"),labels:o,values:s.content.total_tax},t=!0,angular.forEach(s.content.total_tax,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!1},r=n.lineChart([l],d),e.drawTrigger.notify(r)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetHrPayrollTaxes",function(){return{restrict:"A",controller:"WidgetHrPayrollTaxesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-salaries-summary",[]),e.controller("WidgetHrSalariesSummaryCtrl",["$scope","$q","ChartFormatterSvc","$translate",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred1=t.defer(),e.paramSelectorDeferred2=t.defer(),e.chartDeferred=t.defer(),i=[e.orgDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred1.promise,e.paramSelectorDeferred2.promise,e.chartDeferred.promise],r.initContext=function(){return e.isDataFound=!_.isEmpty(r.content)&&null!=r.content.summary&&!_.isEmpty(r.content.summary.data),e.isDataFound?(e.periodOptions=[{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.yearly").toLowerCase()),value:"yearly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.monthly").toLowerCase()),value:"monthly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.weekly").toLowerCase()),value:"weekly"},{label:_.capitalize(a.instant("impac.widget.settings.time_period.period.daily").toLowerCase()),value:"daily"}],e.filterOptions=[{label:a.instant("impac.common.label.gender"),value:"gender"},{label:a.instant("impac.common.label.age_range"),value:"age_range"},{label:a.instant("impac.common.label.job_title"),value:"job_title"}],e.period=angular.copy(_.find(e.periodOptions,function(e){return e.value===r.content.total.period.toLowerCase()})||e.periodOptions[0]),e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===r.content.summary.filter})||e.filterOptions[0])):void 0},e.getColorByIndex=function(e){return n.getColor(e)},e.drawTrigger=t.defer(),r.format=function(){var t,a,i,s,o;if(e.isDataFound){if(t={labels:_.map(r.content.summary.data,function(e){return e.label}),values:_.map(r.content.summary.data,function(e){return e.value})},"gender"===e.filter.value)a={showTooltips:!1},i=n.barChart(t,a);else if("job_title"===e.filter.value)a={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},i=n.barChart(t,a);else{if("age_range"!==e.filter.value)return{error:{message:"wrong filter",code:400}};"unknown"===_.last(t.labels)&&(t.labels.pop(),t.values.pop()),s=[{title:"Average salary",labels:t.labels,values:t.values}],o={scaleBeginAtZero:!0,showXLabels:!1},i=n.lineChart(s,o)}return e.drawTrigger.notify(i)}},e.widgetDeferred.resolve(i)}]),e.directive("widgetHrSalariesSummary",function(){return{restrict:"A",controller:"WidgetHrSalariesSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-superannuation-accruals",[]),e.controller("WidgetHrSuperannuationAccrualsCtrl",["$scope","$q",function(e,t){var n,a;return a=e.widget,e.orgDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),n=[e.orgDeferred.promise,e.paramSelectorDeferred.promise],a.initContext=function(){return(e.isDataFound=!_.isEmpty(a.content)&&!_.isEmpty(a.content.employees))?(e.employeesOptions=_.map(a.content.employees,function(e){return{value:e.uid,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().uid,label:e.getEmployee().lastname+" "+e.getEmployee().firstname}):void 0},e.getEmployee=function(){var t;return e.isDataFound?(t=a.content.employees[0],a.metadata&&a.metadata.employee_id&&(t=_.find(a.content.employees,function(e){return e.uid===a.metadata.employee_id})||a.content.employees[0]),angular.copy(t)):!1},e.widgetDeferred.resolve(n)}]),e.directive("widgetHrSuperannuationAccruals",function(){return{restrict:"A",controller:"WidgetHrSuperannuationAccrualsCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-timesheets",[]),e.controller("WidgetHrTimesheetsCtrl",["$scope","$q","ChartFormatterSvc","ImpacWidgetsSvc",function(e,t,n,a){var i,r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),i=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.paramSelectorDeferred.promise],s.initContext=function(){return(e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.employees)&&!_.isEmpty(s.content.dates))?(e.employeesOptions=_.map(s.content.employees,function(e){return{value:e.id,label:e.lastname+" "+e.firstname}}),e.selectedEmployee={value:e.getEmployee().id,label:e.getEmployee().lastname+" "+e.getEmployee().firstname},e.unCollapsed=s.metadata.unCollapsed||[]):void 0},e.toggleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),a.updateWidgetSettings(s,!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},e.getEmployee=function(){return e.isDataFound?s.metadata&&s.metadata.employee_id?_.find(s.content.employees,function(e){return e.id===s.metadata.employee_id})||s.content.employees[0]:s.content.employees[0]:!1},e.getEmployeeTimeWorked=function(){var t;return(t=e.getEmployee())?_.find(s.content.employees,function(e){return e.id===t.id}).total_time_worked:void 0},e.getEmployeeTimeOff=function(){var t;return(t=e.getEmployee())?_.find(s.content.employees,function(e){return e.id===t.id}).total_time_off:void 0},r={},r.initialized=!1,r.initialize=function(){return r.initialized=!0},r.toMetadata=function(){return{unCollapsed:e.unCollapsed}},s.settings.push(r),e.widgetDeferred.resolve(i)}]),e.directive("widgetHrTimesheets",function(){return{restrict:"A",controller:"WidgetHrTimesheetsCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.hr-workforce-summary",[]),e.controller("WidgetHrWorkforceSummaryCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred1=t.defer(),e.paramSelectorDeferred2=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred1.promise,e.paramSelectorDeferred2.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=!_.isEmpty(s.content)&&null!=s.content.summary&&!_.isEmpty(s.content.summary.data),e.isDataFound?(e.periodOptions=[{label:_.capitalize(i.instant("impac.widget.settings.time_period.period.yearly").toLowerCase()),value:"yearly"},{label:_.capitalize(i.instant("impac.widget.settings.time_period.period.monthly").toLowerCase()),value:"monthly"},{label:_.capitalize(i.instant("impac.widget.settings.time_period.period.weekly").toLowerCase()),value:"weekly"},{label:_.capitalize(i.instant("impac.widget.settings.time_period.period.daily").toLowerCase()),value:"daily"}],e.filterOptions=[{label:i.instant("impac.common.label.gender"),value:"gender"},{label:i.instant("impac.common.label.age_range"),value:"age_range"},{label:i.instant("impac.common.label.salary_range"),value:"salary_range"},{label:i.instant("impac.common.label.job_title"),value:"job_title"}],e.period=angular.copy(_.find(e.periodOptions,function(e){return e.value===s.content.total.period.toLowerCase()})||e.periodOptions[0]),e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===s.content.summary.filter})||e.filterOptions[0])):void 0},e.getTotalWorkforce=function(){return e.isDataFound?s.content.total.amount:void 0},e.getNumberOfEmployees=function(){return e.isDataFound?s.content.total.employees:void 0},e.getCurrency=function(){return e.isDataFound?s.content.total.currency:void 0},e.formatSalaryRange=function(e){var t,n;return t=a("mnoCurrency")(e.label.split("-")[0],e.currency,!1),n=a("mnoCurrency")(e.label.split("-")[1],e.currency,!1),[t,n].join(" - ")},e.getColorByIndex=function(e){return n.getColor(e)},e.drawTrigger=t.defer(),s.format=function(){var t,a,i,r,o;return e.isDataFound?("salary_range"===e.filter.value?(t={labels:_.map(s.content.summary.data,function(t){return e.formatSalaryRange(t)}),values:_.map(s.content.summary.data,function(e){return e.value})},a={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},i=n.barChart(t,a)):(r=_.map(s.content.summary.data,function(e){return{label:e.label,value:e.value}}),o={showTooltips:!0,percentageInnerCutout:50,tooltipFontSize:12},i=n.pieChart(r,o)),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetHrWorkforceSummary",function(){return{restrict:"A",controller:"WidgetHrWorkforceSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.invoices-aged-payables-receivables",[]),e.controller("WidgetInvoicesAgedPayablesReceivablesCtrl",["$scope","$q","$log","$filter","ChartFormatterSvc","ImpacWidgetsSvc","$translate",function(e,t,n,a,i,r,s){var o,l,d,c,u,g,p,m,h,f,v,b,w;return w=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.chartDeferred=t.defer(),m=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.chartDeferred.promise],e.ascending=!0,e.sortedColumn="customer",g=(l=e.widget.content)&&l.hist_parameters&&l.hist_parameters.period?l.hist_parameters.period.toLowerCase():"monthly",s("impac.widget.settings.time_period.period."+g).then(function(t){return e.period_translation=_.capitalize(t.toLowerCase())}),w.initContext=function(){var t,n,a,i,r,s;if(e.isDataFound=!(!angular.isDefined(w.content)||_.isEmpty(w.content.payables)&&_.isEmpty(w.content.receivables)||_.isEmpty(w.content.dates))){if(o(),e.ratesDate=moment.now(),e.payables=w.content.payables,e.receivables=w.content.receivables,e.unCollapsed=w.metadata.unCollapsed||[],!_.isEmpty(w.metadata.selectedElements))for(e.selectedElements=[],i=w.metadata.selectedElements,n=0,a=i.length;a>n;n++)r=i[n],s=[e.payables,e.receivables],t=_.find(s,function(e){return e.name===r}),t||(t=d(s,r)),t&&e.selectedElements.push(t);return null!=e.selectedElements&&e.selectedElements.length>0||(w.width=6),v()}},e.getElementChartColor=function(e){return null!=e?i.getColor(e):void 0},e.getLastValue=function(e){return null!=e&&null!=e.totals?_.last(e.totals):void 0},e.getTotalSum=function(e){return null!=e&&null!=e.totals?_.reduce(e.totals,function(e,t){return e+t},0):void 0},e.getName=function(e){return null!=e&&null!=e.name?e.name.replace(/_/g," "):void 0},e.getPeriod=function(){var t,n;return e.isDataFound&&w.metadata&&w.metadata.hist_parameters?(n=w.metadata.hist_parameters.period||"MONTHLY",t="day","DAILY"!==n&&(t=n.substr(0,n.length-2).toLowerCase()),"current "+t):"current month"},e.getOldestInvoice=function(e){var t;return t=_.findIndex(e.totals,function(e){return 0!==e}),w.content.dates[t]||null},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),v()},e.toggleSelectedElement=function(t,n){return null==n&&(n=null),e.isSelected(t,n)?(e.selectedElements=_.reject(e.selectedElements,function(e){return u(t,n,e)}),w.format(),w.isExpanded()&&0===e.selectedElements.length?w.toggleExpanded():r.updateWidgetSettings(w,!1)):(e.selectedElements||(e.selectedElements=[]),n&&(t.category=n),e.selectedElements.push(t),w.format(),w.isExpanded()?r.updateWidgetSettings(w,!1):w.toggleExpanded())},e.isSelected=function(t,n){return null==n&&(n=null),null!=t&&_.any(e.selectedElements,function(e){return u(t,n,e)})},e.toggleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),r.updateWidgetSettings(w,!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},e.getSelectLineColor=function(t,n){var a;return null==n&&(n=null),a=_.find(e.selectedElements,function(e){return u(t,n,e)}),e.hasElements()?i.getColor(_.indexOf(e.selectedElements,a)):void 0},e.hasElements=function(){return null!=e.selectedElements&&e.selectedElements.length>0},u=function(e,t,n){return null==t&&(t=null),c(e,t)===c(n)},d=function(e,t){var n,a,i,r,s;for(i=0,r=e.length;r>i;i++)if(s=e[i],a=s.suppliers||s.customers,!_.isEmpty(a)&&(n=_.find(a,function(e){return c(e,s.name)===t}),null!=n))return n=angular.merge(angular.copy(n),{category:s.name})},c=function(e,t){var n;return null==t&&(t=null),n=e.id||e.name,t||(t=e.category),t?t+"-"+n:n
},h=function(t,n){return t.sort(function(t,a){var i;return i=n(t)>n(a)?1:n(t)<n(a)?-1:0,e.ascending||(i*=-1),i})},f=function(t){var n;return n=e.getOldestInvoice(t),n&&_.isString(n)&&(n=n.match(/[^_\W]+\s?/g).join("")),new Date(n)},v=function(){return"customer"===e.sortedColumn?(h(w.content.payables.suppliers,function(e){return e.name}),h(w.content.receivables.customers,function(e){return e.name})):"total"===e.sortedColumn?(h(w.content.payables.suppliers,function(t){return e.getTotalSum(t)}),h(w.content.receivables.customers,function(t){return e.getTotalSum(t)})):"invoice"===e.sortedColumn?(h(w.content.payables.suppliers,f),h(w.content.receivables.customers,f)):void 0},o=function(){var e,t,n,a,i,r,s,o,l,d;for(o=_.union(w.content.payables.suppliers,w.content.receivables.customers),d=[],a=0,r=o.length;r>a;a++){for(e=o[a],t=[],l=e.fx_totals,i=0,s=l.length;s>i;i++)n=l[i],_.isEmpty(n)||_.mapKeys(n,function(e,n){return n!==w.metadata.currency?t.push({currency:n,amount:e.amount,rate:e.rate}):void 0});_.isEmpty(t)?d.push(void 0):d.push(e.formattedFxTotals=t)}return d},e.drawTrigger=t.defer(),w.format=function(){var t,n,r,s,o,l;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,s=[],l=null,null!=w.metadata&&null!=w.metadata.hist_parameters&&(l=w.metadata.hist_parameters.period),r=_.map(w.content.dates,function(e){return a("momentDate")(e,l)}),angular.forEach(e.selectedElements,function(e){var n;return n=angular.copy(e),s.push({title:n.name,labels:r,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},n=i.lineChart(s,o),e.drawTrigger.notify(n)):void 0},b={},b.initialized=!1,b.initialize=function(){return b.initialized=!0},b.toMetadata=function(){return{unCollapsed:e.unCollapsed}},w.settings.push(b),p={},p.initialized=!1,p.initialize=function(){return p.initialized=!0},p.toMetadata=function(){var t;return t=_.map(e.selectedElements,function(e){return c(e)}),{selectedElements:t}},w.settings.push(p),e.widgetDeferred.resolve(m)}]),e.directive("widgetInvoicesAgedPayablesReceivables",function(){return{restrict:"A",controller:"WidgetInvoicesAgedPayablesReceivablesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.invoices-list",[]),e.controller("WidgetInvoicesListCtrl",["$scope","$q","$sce","$filter","ImpacUtilities","$translate",function(e,t,n,a,i,r){var s,o,l,d;return d=e.widget,e.orgDeferred=t.defer(),e.limitEntriesDeferred=t.defer(),e.datesPickerDeferred=t.defer(),l=[e.orgDeferred.promise,e.limitEntriesDeferred.promise,e.datesPickerDeferred.promise],d.initContext=function(){var t,n;return e.isDataFound=!_.isEmpty(d.content)&&!_.isEmpty(d.content.entities),e.isDataFound&&"due "===e.orderBy&&(e.limitEntriesLabel="suppliers"===e.entityType?r.instant("impac.widget.invoices_list.limit_entries_label.creditors"):r.instant("impac.widget.invoices_list.limit_entries_label.debtors")),null!=d.metadata&&null!=d.metadata.limit_entries&&(e.limitEntriesSelected=d.metadata.limit_entries),e.isDataFound?(t=_.flatten(_.map(d.content.entities,function(e){return _.map(e.invoices,function(e){return e.invoice_date})})),n=i.getDatesRange(t),e.defaultFrom=a("date")(n[0],"yyyy-MM-dd"),e.defaultTo=a("date")(n[1],"yyyy-MM-dd"),o(d.content.entities),s(),e.ratesDate=moment.now()):void 0},e.entityType=d.metadata.entity,e.entityTypeCap=_.capitalize(d.metadata.entity),e.orderBy=_.isEmpty(d.metadata.order_by)||"name"===d.metadata.order_by||"total_invoiced"===d.metadata.order_by?"":_.last(d.metadata.order_by.split("_")).concat(" "),e.invoiceTooltips={},o=function(t){return _.each(t,function(t){var i,r;return r=["<strong>"+t.name+"</strong>"],i=1,_.each(t.invoices,function(e){var t,n,s,o,l;return l=""!==e.transaction_no?" ("+e.transaction_no+")":"",o=Object.keys(e.fx_totals)[0],n=a("mnoCurrency")(e.fx_totals[o].invoiced,o,!0),"partially paid"===e.tooltip_status?(s=a("mnoCurrency")(e.fx_totals[o].paid,o,!0),t=" ("+s+" on "+n+")"):t=" ("+n+")",r.push("#"+i+l+" - "+e.tooltip_status+t),i++}),e.invoiceTooltips[t.id]=n.trustAsHtml(r.join("<br />"))})},s=function(){var e,t,n,a,i,r;for(i=d.content.entities,r=[],n=0,a=i.length;a>n;n++)e=i[n],t=[],_.mapKeys(e.fx_totals,function(e,n){return n!==d.metadata.currency?t.push({currency:n,amount:e.invoiced,rate:e.rate}):void 0}),_.isEmpty(t)?r.push(void 0):r.push(e.formattedFxTotals=t);return r},e.widgetDeferred.resolve(l)}]),e.directive("widgetInvoicesList",function(){return{restrict:"A",controller:"WidgetInvoicesListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.invoices-summary",[]),e.controller("WidgetInvoicesSummaryCtrl",["$scope","$q","ChartFormatterSvc",function(e,t,n){var a,i;return i=e.widget,e.orgDeferred=t.defer(),e.chartFiltersDeferred=t.defer(),e.chartDeferred=t.defer(),e.datesPickerDeferred=t.defer(),a=[e.orgDeferred.promise,e.chartFiltersDeferred.promise,e.chartDeferred.promise,e.datesPickerDeferred.promise],e.defaultFrom=(new Date).getFullYear()-10+"-01-01",i.initContext=function(){return e.isDataFound=!_.isEmpty(i.content)&&!_.isEmpty(i.content.summary)},e.drawTrigger=t.defer(),i.format=function(){var t,a,r;return e.isDataFound?(a=_.map(i.content.summary,function(e){return{label:e.name,value:e.total}}),r={percentageInnerCutout:50,tooltipFontSize:12},t=n.pieChart(a,r),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(a)}]),e.directive("widgetInvoicesSummary",function(){return{restrict:"A",controller:"WidgetInvoicesSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-aged",[]),e.controller("WidgetSalesAgedCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.paramSelectorDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.aged_sales)&&!_.isEmpty(s.content.dates),e.isDataFound?(e.filterOptions=[{label:i.instant("impac.widget.sales_aged.value_sold_taxes"),value:"gross_value_sold"},{label:i.instant("impac.widget.sales_aged.value_sold_no_taxes"),value:"net_value_sold"},{label:i.instant("impac.widget.sales_aged.quantity_sold"),value:"quantity_sold"}],e.filter=angular.copy(_.find(e.filterOptions,function(e){return s.metadata&&s.metadata.filter===e.value})||e.filterOptions[0])):void 0},e.getTotal=function(t){return e.isDataFound&&t>=0&&t<s.content.aged_sales[e.filter.value].length?s.content.aged_sales[e.filter.value][t]:void 0},e.getLastDate=function(){return e.isDataFound?_.last(s.content.dates):void 0},e.getClassColor=function(e,t){return e>t?"negative":t>e?"positive":null},e.drawTrigger=t.defer(),s.format=function(){var t,i,r,o,l,d;return e.isDataFound?(t=!0,r=[],d=s.content.aged_sales[e.filter.value],l=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(l=s.metadata.hist_parameters.period),e.formattedDates=_.map(s.content.dates,function(e){return a("momentDate")(e,l)}),r.push({title:e.filter.label,labels:e.formattedDates,values:d}),angular.forEach(d,function(e){return t&&(t=e>=0)}),o={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!0,pointDot:!0},e.filter.value.indexOf("quantity")>-1&&angular.merge(o,{currency:"hide"}),i=n.lineChart(r,o),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesAged",function(){return{restrict:"A",controller:"WidgetSalesAgedCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-break-even",[]),e.controller("WidgetSalesBreakEvenCtrl",["$scope","$q","ChartFormatterSvc","$filter",function(e,t,n,a){var i,r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),i=[e.orgDeferred.promise,e.timePeriodDeferred.promise],s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.sales),e.threshold=s.metadata.threshold},s.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getProjectedDate=function(){var t;return e.isDataFound&&s.content.break_even?(""+s.content.break_even.projected_date).match("After")?(t=angular.copy(s.content.break_even.projected_date).replace("After ",""),"> "+a("date")(t,"d-MM-yy")):s.content.break_even.projected_date:void 0},e.getOpportunitiesToClose=function(){var t;return e.isDataFound&&s.content.break_even?(""+s.content.break_even.opportunities_to_close).match(">")?(t=angular.copy(s.content.break_even.opportunities_to_close).replace(">",""),"> "+t):s.content.break_even.opportunities_to_close:void 0},e.isTargetMet=function(){return e.isDataFound&&s.content.break_even?s.content.break_even.variance<0:void 0},e.getVariance=function(){return e.isDataFound&&s.content.break_even?Math.abs(s.content.break_even.variance):void 0},r={},r.initialized=!1,r.initialize=function(){return r.initialized=!0},r.toMetadata=function(){return{threshold:e.threshold}},s.settings.push(r),e.widgetDeferred.resolve(i)}]),e.directive("widgetSalesBreakEven",function(){return{restrict:"A",controller:"WidgetSalesBreakEvenCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-comparison",[]),e.controller("WidgetSalesComparisonCtrl",["$scope","$q","$filter","ChartFormatterSvc","ImpacWidgetsSvc","$translate",function(e,t,n,a,i,r){var s,o,l,d,c,u,g,p,m,h;return h=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred1=t.defer(),e.paramSelectorDeferred2=t.defer(),e.chartDeferred=t.defer(),u=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred1,e.paramSelectorDeferred2,e.chartDeferred.promise],e.ascending=!0,e.sortedColumn="sales",h.initContext=function(){var t,n,a,i,l;if(e.isDataFound=angular.isDefined(h.content)&&!_.isEmpty(h.content.sales_comparison)&&!_.isEmpty(h.content.dates),e.isDataFound){if(e.unCollapsed=h.metadata.unCollapsed||[],e.filterOptions=[{label:r.instant("impac.widget.sales_comparison.value_sold_taxes"),value:"gross_value_sold"},{label:r.instant("impac.widget.sales_comparison.value_sold_no_taxes"),value:"net_value_sold"},{label:r.instant("impac.widget.sales_comparison.quantity_sold"),value:"quantity_sold"}],e.filter=angular.copy(_.find(e.filterOptions,function(e){return h.metadata&&h.metadata.filter===e.value})||e.filterOptions[0]),e.criteriaOptions=[{label:r.instant("impac.widget.sales_comparison.criteria_options.products"),value:"default"},{label:r.instant("impac.widget.sales_comparison.criteria_options.locations"),value:"location"},{label:r.instant("impac.widget.sales_comparison.criteria_options.industries"),value:"industry"},{label:r.instant("impac.widget.sales_comparison.criteria_options.customers"),value:"customer"}],e.criteria=angular.copy(_.find(e.criteriaOptions,function(e){return h.metadata&&h.metadata.criteria===e.value})||e.criteriaOptions[0]),s(),e.ratesDate=moment.now(),!_.isEmpty(h.metadata.selectedElements))for(e.selectedElements=[],i=h.metadata.selectedElements,n=0,a=i.length;a>n;n++)l=i[n],t=_.find(h.content.sales_comparison,function(e){return e.name===l}),t||(t=o(h.content.sales_comparison,l)),t&&e.selectedElements.push(t);return p()}},e.getLastDate=function(){return e.isDataFound?_.last(h.content.dates):void 0},e.getTotalForPeriod=function(t){return null!=t.totals&&e.filter?_.reduce(t.totals[e.filter.value],function(e,t){return e+t},0):void 0},e.getElementChartColor=function(e){return a.getColor(e)},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),p()},e.toggleSelectedElement=function(t,n){var a;return null==n&&(n=null),e.isSelected(t,n)?(e.selectedElements=_.reject(e.selectedElements,function(e){return d(t,n,e)}),h.format(),h.isExpanded()&&0===e.selectedElements.length?h.toggleExpanded():i.updateWidgetSettings(h,!1)):(a=angular.copy(t),a.category=n,e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(a),h.format(),h.isExpanded()?i.updateWidgetSettings(h,!1):h.toggleExpanded())},e.isSelected=function(t,n){return null==n&&(n=null),null!=t&&_.any(e.selectedElements,function(e){return d(t,n,e)})},e.toggleCollapsed=function(t){return null!=t&&null!=t.name?(_.find(e.unCollapsed,function(e){return t.name===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t.name}):e.unCollapsed.push(t.name),i.updateWidgetSettings(h,!1)):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.name?_.find(e.unCollapsed,function(e){return t.name===e})?!1:!0:void 0},e.hasElements=function(){return null!=e.selectedElements&&e.selectedElements.length>0},e.getSelectLineColor=function(t,n){var i;return null==n&&(n=null),i=_.find(e.selectedElements,function(e){return d(t,n,e)}),e.hasElements()?a.getColor(_.indexOf(e.selectedElements,i)):void 0},d=function(e,t,n){return null==t&&(t=null),l(e,t)===l(n)},o=function(e,t){var n,a,i,r;for(a=0,i=e.length;i>a;a++)if(r=e[a],null!=r.sales&&(n=_.find(r.sales,function(e){return l(e,r.name)===t}),null!=n))return n=angular.merge(angular.copy(n),{category:r.name})},l=function(e,t){var n;return null==t&&(t=null),n=e.id||e.name,t||(t=e.category),t?t+"-"+n:n},g=function(t){return angular.forEach(h.content.sales_comparison,function(n){return n.sales?n.sales.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},p=function(){return"sales"===e.sortedColumn?g(function(e){return e.name}):"total"===e.sortedColumn?g(function(t){return e.getTotalForPeriod(t)}):void 0},e.drawTrigger=t.defer(),h.format=function(){var t,i,r,s;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(t=!0,r=[],angular.forEach(e.selectedElements,function(a){var i,s,o;return i=angular.copy(a),o=null,null!=h.metadata&&null!=h.metadata.hist_parameters&&(o=h.metadata.hist_parameters.period),s=_.map(h.content.dates,function(e){return n("momentDate")(e,o)}),r.push({title:i.name,labels:s,values:i.totals[e.filter.value]}),angular.forEach(i.totals,function(e){return t&&(t=e>=0)})}),s={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!1,pointDot:!1},e.filter.value.indexOf("quantity")>-1&&angular.merge(s,{currency:"hide"}),i=a.lineChart(r,s),e.drawTrigger.notify(i)):void 0},s=function(){var e,t,n,a,i,r,s,o;for(r=h.content.sales_comparison,s=[],n=0,a=r.length;a>n;n++)t=r[n],s.push(function(){var n,a,r,s;for(r=t.sales,s=[],n=0,a=r.length;a>n;n++)o=r[n],o.formattedFxTotals={},i=[],e=[],_.isEmpty(o.fx_totals)||_.mapKeys(o.fx_totals,function(t,n){var a,r,s,o,l,d,c,u,g;for(c=t.net_value_sold,r=0,o=c.length;o>r;r++)a=c[r],0!==a&&n!==h.metadata.currency&&i.push({currency:n,amount:a,rate:t.rate});for(u=t.gross_value_sold,g=[],s=0,l=u.length;l>s;s++)d=u[s],0!==d&&n!==h.metadata.currency?g.push(e.push({currency:n,amount:d,rate:t.rate})):g.push(void 0);return g}),_.isEmpty(i)||(o.formattedFxTotals.net_value_sold=i),_.isEmpty(e)?s.push(void 0):s.push(o.formattedFxTotals.gross_value_sold=e);return s}());return s},m={},m.initialized=!1,m.initialize=function(){return m.initialized=!0},m.toMetadata=function(){return{unCollapsed:e.unCollapsed}},h.settings.push(m),c={},c.initialized=!1,c.initialize=function(){return c.initialized=!0},c.toMetadata=function(){var t;return t=_.map(e.selectedElements,function(e){return l(e)}),{selectedElements:t}},h.settings.push(c),e.widgetDeferred.resolve(u)}]),e.directive("widgetSalesComparison",function(){return{restrict:"A",controller:"WidgetSalesComparisonCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-customer-details",[]),e.controller("WidgetSalesCustomerDetailsCtrl",["$scope","$q",function(e,t){var n,a,i,r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.ratesDate=moment.now(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&!_.isEmpty(s.content.customers),e.isDataFound?(a(),e.customersOptions=_.map(s.content.customers,function(e){return{value:e.uid,label:e.name}})):void 0},e.formatAddress=function(e){return angular.isDefined(e)?e.replace(/, /g,",\n"):void 0},e.getFromDate=function(){return e.isDataFound?s.content.from:void 0},e.getToDate=function(){return e.isDataFound?s.content.to:void 0},a=function(){var t;return e.isDataFound?(s.metadata&&s.metadata.customer_uid&&(t=_.find(s.content.customers,function(e){return e.uid===s.metadata.customer_uid})),t||(t=s.content.customers[0]),e.selectedCustomer=angular.copy(t),i(),n()):!1},i=function(){var t;return(t=e.selectedCustomer)?e.selectedCustomerId={value:t.uid,label:t.name}:!1},n=function(){var t,n,a,i;return(t=e.selectedCustomer)?(a=[],n=[],i=[],_.some(t.fx_totals,function(e,t){return t!==s.metadata.currency})&&(_.mapKeys(t.fx_totals,function(e,t){var r;return r={rate:e.rate,currency:t},0!==e.invoiced&&a.push(angular.merge({amount:e.invoiced},r)),0!==e.paid&&i.push(angular.merge({amount:e.paid},r)),0!==e.due?n.push(angular.merge({amount:e.due},r)):void 0}),_.isEmpty(a)||(t.invoicedFxTotals=a),_.isEmpty(i)||(t.paidFxTotals=i),!_.isEmpty(n))?t.dueFxTotals=n:void 0):!1},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesCustomerDetails",function(){return{restrict:"A",controller:"WidgetSalesCustomerDetailsCtrl"}})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-cycle",[]),e.controller("WidgetSalesCycleCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc","ImpacDashboardsSvc",function(e,n,a,i,r,s){var o,l;return l=e.widget,e.orgDeferred=n.defer(),e.paramsPickerDeferred=n.defer(),e.timePeriodDeferred=n.defer(),e.chartDeferred=n.defer(),o=[e.orgDeferred.promise,e.paramsPickerDeferred.promise,e.timePeriodDeferred.promise,e.chartDeferred.promise],l.initContext=function(){var n,a;return n=s.getCurrentDashboard(),a=l.metadata.status_selection||n.metadata.status_selection||{values:[]},(e.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.status_average_durations))?(_.remove(a.values,function(e){return t.call(_.keys(l.content.status_average_durations),e)<0}),e.hasReach=!0,e.statusOptions=[],angular.forEach(l.content.status_average_durations,function(n,i){var r;return r=_.isEmpty(a.values)||t.call(a.values,i)>=0,e.statusOptions.push({label:i,selected:r})})):void 0},l.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.drawTrigger=n.defer(),l.format=function(){var t,n,r;return e.isDataFound?(n=_.compact(_.map(e.statusOptions,function(t){var n;return n=l.content.status_average_durations[t.label],t.selected&&angular.isDefined(n)?{label:i("titleize")(t.label)+": "+n+" "+e.unit,value:n}:void 0})),r={percentageInnerCutout:50,tooltipFontSize:12,currency:l.content.unit},t=a.pieChart(n,r),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(o)}]),e.directive("widgetSalesCycle",function(){return{restrict:"A",controller:"WidgetSalesCycleCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-forecast",[]),e.controller("WidgetSalesForecastCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.totals)},s.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getOpportunityAmount=function(t){return e.isDataFound&&!_.isEmpty(t)?t.amount&&t.amount.amount?t.amount.amount:"-":void 0},e.getOpportunityCurrency=function(t){return e.isDataFound&&!_.isEmpty(t)?t.amount&&t.amount.currency?t.amount.currency:s.content.currency?s.content.currency:"AUD":void 0},e.drawTrigger=t.defer(),s.format=function(){var t,r,o,l,d,c;return e.isDataFound?(t=!0,c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(s.content.dates,function(e){return a("momentDate")(e,c)}),l=[{title:i.instant("impac.widget.sales_forecast.sales_performance"),labels:o,values:s.content.totals}],angular.forEach(s.content.totals,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!0,datasetFill:!0,pointDot:!1},r=n.lineChart(l,d),e.drawTrigger.notify(r)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesForecast",function(){return{restrict:"A",controller:"WidgetSalesForecastCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-growth",[]),e.controller("WidgetSalesGrowthCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s,o,l;return l=e.widget,r=35,s=25,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.paramSelectorDeferred1=t.defer(),e.paramSelectorDeferred2=t.defer(),e.chartDeferred=t.defer(),o=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.paramSelectorDeferred1.promise,e.paramSelectorDeferred2.promise,e.chartDeferred.promise],e.isDataQuantity=!0,l.initContext=function(){return(e.isDataFound=angular.isDefined(l.content)&&!_.isEmpty(l.content.summary)&&!_.isEmpty(l.content.dates))?(e.productOptions=_.flatten(_.map(l.content.summary,function(t){return{label:e.getDisplayName(t,s),value:t.id}})),e.product=angular.copy(_.find(e.productOptions,function(e){return e.value===l.content.product})||{label:i.instant("impac.widget.sales_growth.select_product"),value:-1}),e.filterOptions=[{label:i.instant("impac.widget.sales_growth.value_sold_taxes"),value:"gross_value_sold"},{label:i.instant("impac.widget.sales_growth.value_sold_no_taxes"),value:"net_value_sold"},{label:i.instant("impac.widget.sales_growth.quantity_sold"),value:"quantity_sold"},{label:i.instant("impac.widget.sales_growth.value_purchased_taxes"),value:"gross_value_purchased"},{label:i.instant("impac.widget.sales_growth.value_purchased_no_taxes"),value:"net_value_purchased"},{label:i.instant("impac.widget.sales_growth.quantity_purchased"),value:"quantity_purchased"}],e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===l.content.filter})||e.filterOptions[0]),e.isDataQuantity=e.filter.value.match("quantity")):void 0},e.getSelectedProduct=function(){var t;return e.isDataFound?(t=_.find(l.content.summary,function(t){return t.id===e.product.value})||l.content.summary[0],_.extend(t,{displayName:e.getDisplayName(t,r)})):void 0},e.getCurrentValue=function(){return null!=e.getSelectedProduct()?_.last(e.getSelectedProduct().totals):void 0},e.getCurrentDate=function(){return e.isDataFound?_.last(l.content.dates):void 0},e.getDisplayName=function(e,t){var n,a;return a=1===l.content.organizations.length?e.name:e.company+" - "+e.name,n=1===l.content.organizations.length?e.code:e.company+" - "+e.code,a.length>t?n:a},e.drawTrigger=t.defer(),l.format=function(){var t,i,r,s,o,d,c;return e.isDataFound&&e.product&&(r=e.getSelectedProduct())?(c=null,null!=l.metadata&&null!=l.metadata.hist_parameters&&(c=l.metadata.hist_parameters.period),s=_.map(l.content.dates,function(e){return a("momentDate")(e,c)}),o={title:r.name,labels:s,values:r.totals},t=!0,angular.forEach(r.totals,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!1},e.filter.value.indexOf("quantity")>-1&&angular.merge(d,{currency:"hide"}),i=n.lineChart([o],d),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(o)}]),e.directive("widgetSalesGrowth",function(){return{restrict:"A",controller:"WidgetSalesGrowthCtrl"}})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-leads-funnel",[]),e.controller("WidgetSalesLeadsFunnelCtrl",["$scope","$q","ChartFormatterSvc","$filter","$sce","ImpacWidgetsSvc","ImpacDashboardsSvc","$translate",function(e,n,a,i,r,s,o){var l,d,c,u,g;return g=e.widget,e.orgDeferred=n.defer(),e.timePeriodDeferred=n.defer(),e.paramsPickerDeferred=n.defer(),e.widthDeferred=n.defer(),u=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.paramsPickerDeferred.promise,e.widthDeferred.promise],l=function(e){var t,n,a;return t=_.mapValues(e,function(e){return e.total}),a=_.compact(_.values(t)),n=_.reduce(a,function(e,t){return null==e&&(e=0),e+t}),null!=n&&n>0},g.initContext=function(){var n,a;return n=o.getCurrentDashboard(),a=g.metadata.status_selection||n.metadata.status_selection||{values:[]},(e.isDataFound=angular.isDefined(g.content)&&!_.isEmpty(g.content.leads_per_status)&&l(g.content.leads_per_status))?(_.remove(a.values,function(e){return t.call(_.keys(g.content.leads_per_status),e)<0}),e.hasReach=!0,e.statusOptions=[],angular.forEach(g.content.leads_per_status,function(n,i){var r;return r=_.isEmpty(a.values)||t.call(a.values,i)>=0,e.statusOptions.push({label:i,selected:r})})):void 0},g.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getImpacColor=function(e){return a.getColor(e)},e.toggleSelectStatus=function(t){return e.selectedStatus&&e.selectedStatus===t?e.selectedStatus=null:(e.selectedStatus=t,e.setLeadTooltipsIsLocked=!1),!g.isExpanded()&&e.selectedStatus?g.toggleExpanded():s.updateWidgetSettings(g,!1,!0)},e.isSelected=function(t){return e.selectedStatus&&t===e.selectedStatus},e.getSelectedLeads=function(){var t;return e.isDataFound&&e.selectedStatus?(t=g.content.leads_per_status[e.selectedStatus].leads,e.setLeadTooltipsIsLocked||c(t),t):void 0},e.leadDescriptionTooltips={},c=function(t){return e.leadDescriptionTooltips={},e.setLeadTooltipsIsLocked=!0,_.each(t,function(t,n){var a,s;return s=[],a=["<strong>"],t.first_name&&a.push(i("titleize")(t.first_name)),t.last_name&&a.push(i("titleize")(t.last_name)),a.push("</strong>"),s.push(a.join(" ")),s.push("Status: "+i("titleize")(t.lead_status)),t.organization&&s.push("Organization: "+i("titleize")(t.organization)),t.opportunities&&(s.push("<strong>Opportunities:</strong>"),_.each(t.opportunities,function(e){var t;return t=[],e.code&&t.push("#"+e.code),e.name&&t.push(""+e.name),e.amount&&t.push(i("mnoCurrency")(e.amount.total_amount,"USD",!1)),e.probability&&t.push(e.probability+"%"),e.sales_stage&&t.push(""+e.sales_stage),s.push(t.join(" - "))})),e.leadDescriptionTooltips[n]=r.trustAsHtml(s.join("<br />"))})},d={},d.initialized=!1,d.initialize=function(){return!_.isEmpty(g.content)&&angular.isDefined(g.content.leads_per_status[g.metadata.selected_status])&&(e.selectedStatus=g.metadata.selected_status),d.initialized=!0},d.toMetadata=function(){return{selected_status:e.selectedStatus}},g.settings.push(d),g.format=function(){var t;return e.isDataFound&&(t=0,angular.forEach(e.statusOptions,function(e){var n;return n=g.content.leads_per_status[e.label].total,e.selected&&angular.isDefined(n)&&n>t?t=n:void 0}),t>0)?e.funnel=_.compact(_.map(e.statusOptions,function(e){var n,a,i;return i=g.content.leads_per_status[e.label].total,n=(100*(i/t)-10).toFixed(),a=8>n?92:100-n,e.selected&&angular.isDefined(i)?{status:e.label,number:i,coloredWidth:{width:n+"%"},statusWidth:{width:a+"%"}}:void 0})):void 0},e.widgetDeferred.resolve(u)}]),e.directive("widgetSalesLeadsFunnel",function(){return{restrict:"A",controller:"WidgetSalesLeadsFunnelCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-leads-list",[]),e.controller("WidgetSalesLeadsListCtrl",["$scope","$q","ChartFormatterSvc","$filter","$sce","$translate",function(e,t,n,a,i){var r,s,o;return o=e.widget,e.orgDeferred=t.defer(),s=[e.orgDeferred.promise],e.ordering="last_name",o.initContext=function(){return e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.leads),e.isDataFound?r(o.content.leads):void 0},o.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.leadDescriptionTooltips={},r=function(t){return _.each(t,function(t,n){var r,s;return s=[],r=["<strong>"],t.first_name&&r.push(a("titleize")(t.first_name)),t.last_name&&r.push(a("titleize")(t.last_name)),r.push("</strong>"),s.push(r.join(" ")),s.push("Status: "+a("titleize")(t.lead_status)),t.organization&&s.push("Organization: "+a("titleize")(t.organization)),t.opportunities&&(s.push("<strong>Opportunities:</strong>"),_.each(t.opportunities,function(e){var t;return t=[],e.code&&t.push("#"+e.code),e.name&&t.push(""+e.name),e.amount&&t.push(a("mnoCurrency")(e.amount.total_amount,"USD",!1)),e.probability&&t.push(e.probability+"%"),e.sales_stage&&t.push(""+e.sales_stage),s.push(t.join(" - "))})),e.leadDescriptionTooltips[n]=i.trustAsHtml(s.join("<br />"))})},e.widgetDeferred.resolve(s)}]),e.directive("widgetSalesLeadsList",function(){return{restrict:"A",controller:"WidgetSalesLeadsListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-list",[]),e.controller("WidgetSalesListCtrl",["$scope","$q","ChartFormatterSvc","ImpacWidgetsSvc","$translate",function(e,t,n,a,i){var r,s,o,l,d,c;return c=e.widget,e.orgDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.datesPickerDeferred=t.defer(),s=[e.orgDeferred.promise,e.paramSelectorDeferred.promise,e.datesPickerDeferred.promise],e.ascending=!0,e.sortedColumn="account",e.datesPickerTemplate="<span>"+i.instant("impac.widget.sales_list.from")+"<from-date> "+i.instant("impac.widget.sales_list.to")+" <to-date> <apply></span>",c.initContext=function(){return(e.isDataFound=angular.isDefined(c.content)&&!_.isEmpty(c.content.summary))?(r(),e.ratesDate=moment.now(),e.filterOptions=[{label:i.instant("impac.widget.sales_list.value_sold_taxes"),value:"gross_value_sold"},{label:i.instant("impac.widget.sales_list.value_sold_no_taxes"),value:"net_value_sold"},{label:i.instant("impac.widget.sales_list.quantity_sold"),value:"quantity_sold"},{label:i.instant("impac.widget.sales_list.value_purchased_taxes"),value:"gross_value_purchased"},{label:i.instant("impac.widget.sales_list.value_purchased_no_taxes"),value:"net_value_purchased"},{label:i.instant("impac.widget.sales_list.quantity_purchased"),value:"quantity_purchased"}],e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===c.metadata.filter})||e.filterOptions[0]),e.unCollapsed=c.metadata.unCollapsed||[],l()):void 0},e.toggleCollapsed=function(t){return null!=t?(_.find(e.unCollapsed,function(e){return t===e})?e.unCollapsed=_.reject(e.unCollapsed,function(e){return e===t}):e.unCollapsed.push(t),a.updateWidgetSettings(c,!1)):void 0},e.isCollapsed=function(t){return null!=t?_.find(e.unCollapsed,function(e){return t===e})?!1:!0:void 0},o=function(t){return angular.forEach(c.content.summary,function(n){return n.products?n.products.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},l=function(){return"account"===e.sortedColumn?o(function(e){return e.name}):"total"===e.sortedColumn?o(function(e){return e.total}):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),l()},r=function(){var e,t,n,a,i,r,s;for(a=c.content.summary,i=[],t=0,n=a.length;n>t;t++)e=a[t],i.push(function(){var t,n,a,i;for(a=e.products,i=[],t=0,n=a.length;n>t;t++)r=a[t],s=[],_.isEmpty(r.fx_totals)||_.mapKeys(r.fx_totals,function(e,t){var n;return n=e.amount,0!==n&&t!==c.metadata.currency?s.push({currency:t,amount:n,rate:e.rate}):void 0}),_.isEmpty(s)?i.push(void 0):i.push(r.formattedFxTotals=s);return i}());return i},d={},d.initialized=!1,d.initialize=function(){return d.initialized=!0},d.toMetadata=function(){return{unCollapsed:e.unCollapsed}},c.settings.push(d),e.widgetDeferred.resolve(s)}]),e.directive("widgetSalesList",function(){return{restrict:"A",controller:"WidgetSalesListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-margin",[]),e.controller("WidgetSalesMarginCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;
return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.histModeDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.histModeDeferred.promise,e.paramSelectorDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.margins&&null!=s.content.dates,e.isDataFound?(e.filterOptions=[{label:i.instant("impac.widget.sales_margin.including_taxes"),value:"gross_margin"},{label:i.instant("impac.widget.sales_margin.excluding_taxes"),value:"net_margin"}],e.filter=null!=s.metadata&&"net_margin"===s.metadata.filter?angular.copy(e.filterOptions[1]):angular.copy(e.filterOptions[0])):void 0},e.getTotalMargin=function(){return e.isDataFound?null!=s.metadata&&"net_margin"===s.metadata.filter?_.reduce(s.content.margins.net,function(e,t){return e+t},0):_.reduce(s.content.margins.gross,function(e,t){return e+t},0):void 0},e.getCurrency=function(){return e.isDataFound?s.content.currency||"USD":void 0},e.drawTrigger=t.defer(),s.format=function(){var t,r,o,l,d,c,u;return e.isDataFound?(u=null!=s.metadata&&"net_margin"===s.metadata.filter?s.content.margins.net:s.content.margins.gross,c=null,null!=s.metadata&&null!=s.metadata.hist_parameters&&(c=s.metadata.hist_parameters.period),o=_.map(s.content.dates,function(e){return a("momentDate")(e,c)}),l={title:i.instant("impac.widget.sales_margin.gross_margin"),labels:o,values:u},t=!0,angular.forEach(u,function(e){return t&&(t=e>=0)}),d={scaleBeginAtZero:t,showXLabels:!1},r=n.lineChart([l],d),e.drawTrigger.notify(r)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesMargin",function(){return{restrict:"A",controller:"WidgetSalesMarginCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-net-sales",[]),e.controller("WidgetSalesNetSalesCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.paramSelector1Deferred=t.defer(),e.paramSelector2Deferred=t.defer(),r=[e.orgDeferred.promise,e.paramSelector1Deferred.promise,e.paramSelector2Deferred.promise],i(["impac.widget.sales_net_sales.total_amount","impac.widget.sales_net_sales.average_amount","impac.widget.sales_net_sales.volume"]).then(function(t){return e.displayOptions=[{label:t["impac.widget.sales_net_sales.total_amount"],value:"total"},{label:t["impac.widget.sales_net_sales.average_amount"],value:"average"},{label:t["impac.widget.sales_net_sales.volume"],value:"trans_count"}],e.displayType=angular.copy(_.find(e.displayOptions,function(e){return s.metadata&&e.value===s.metadata.display_type})||e.displayOptions[0])}),i(["impac.widget.sales_net_sales.tmpl.last_hours","impac.widget.sales_net_sales.tmpl.last_days"]).then(function(t){var n,a;return a=t["impac.widget.sales_net_sales.tmpl.last_hours"],n=t["impac.widget.sales_net_sales.tmpl.last_days"],e.timeRangeOptions=[{label:a.replace(":hours:",24),value:"-1d"},{label:n.replace(":days:",5),value:"-5d"},{label:n.replace(":days:",7),value:"-7d"},{label:n.replace(":days:",30),value:"-30d"},{label:n.replace(":days:",45),value:"-45d"},{label:n.replace(":days:",60),value:"-60d"},{label:n.replace(":days:",90),value:"-90d"}],e.timeRange=angular.copy(_.find(e.timeRangeOptions,function(e){return s.metadata&&e.value===s.metadata.time_range})||e.timeRangeOptions[6])}),s.initContext=function(){return e.isDataFound=null!=s.content&&null!=s.content.sales&&s.content.sales.length>0&&null!=s.content.sales[0].total},e.getCurrency=function(){return e.isDataFound?s.content.currency:void 0},e.getValue=function(t){if(null==s.content||!s.content[t])return 0;switch(e.displayType.value){case"total":return a("mnoCurrency")(s.content[t][0].total,e.getCurrency(),!1);case"average":return a("mnoCurrency")(s.content[t][0].avg,e.getCurrency(),!1);case"trans_count":return s.content[t][0].trans_count}},e.sign=function(t){return"average"===e.displayType.value?{minus:"~",equal:"=>"}[t]:"trans_count"===e.displayType.value?{minus:"+",equal:"="}[t]:{minus:"-",equal:"="}[t]},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesNetSales",function(){return{restrict:"A",controller:"WidgetSalesNetSalesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-new-vs-existing-customers",[]),e.controller("WidgetSalesNewVsExistingCustomersCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s,o,l;return l=e.widget,e.orgDeferred=t.defer(),e.timeRangeParamSelectorDeferred=t.defer(),e.displayTypeParamSelectorDeferred=t.defer(),e.chartDeferred=t.defer(),o=[e.orgDeferred.promise,e.timeRangeParamSelectorDeferred.promise,e.displayTypeParamSelectorDeferred.promise,e.chartDeferred.promise],e.displayOptions=[{label:i.instant("impac.widget.sales_new_vs_existing.customers"),value:"customers_count"},{label:i.instant("impac.widget.sales_new_vs_existing.total_sales"),value:"total_sales"},{label:i.instant("impac.widget.sales_new_vs_existing.transactions"),value:"transactions_count"}],e.displayType=angular.copy(_.find(e.displayOptions,function(e){return l.metadata&&e.value===l.metadata.display_type})||e.displayOptions[0]),s=i.instant("impac.widget.sales_new_vs_existing.tmpl.last_hours"),r=i.instant("impac.widget.sales_new_vs_existing.tmpl.last_days"),e.timeRangeOptions=[{label:s.replace(":hours:",24),value:"-1d"},{label:r.replace(":days:",5),value:"-5d"},{label:r.replace(":days:",7),value:"-7d"},{label:r.replace(":days:",30),value:"-30d"},{label:r.replace(":days:",45),value:"-45d"},{label:r.replace(":days:",60),value:"-60d"},{label:r.replace(":days:",90),value:"-90d"}],e.timeRange=angular.copy(_.find(e.timeRangeOptions,function(e){return l.metadata&&e.value===l.metadata.time_range})||e.timeRangeOptions[6]),l.initContext=function(){return e.isDataFound=null!=l.content&&null!=l.content.summary&&null!=l.content.summary.customers_count&&null!=l.content.summary.customers_count.total&&l.content.summary.customers_count.total>0},e.displayTypeOnClick=function(){return e.updateSettings(!1),l.format()},e.getValue=function(t){var n,i;if(e.isDataFound)switch(i=e.displayType.value,n=l.content.summary[i][t],i){case"total_sales":return a("mnoCurrency")(n,l.metadata.currency);default:return n}},e.shouldDisplayCurrency=function(){return e.isDataFound&&e.displayType.value.indexOf("count")<0},e.calculatePercentage=function(t){var n;return n={"new":Math.abs(l.content.summary[e.displayType.value]["new"]),existing:Math.abs(l.content.summary[e.displayType.value].existing)},n.totals=n["new"]+n.existing,Math.round(n[t]/n.totals*100)},e.drawTrigger=t.defer(),l.format=function(){var t,a,i;return e.isDataFound?(a=[{label:"EXISTING "+e.calculatePercentage("existing")+"%",value:l.content.summary[e.displayType.value].existing},{label:"NEW "+e.calculatePercentage("new")+"%",value:l.content.summary[e.displayType.value]["new"]}],i={percentageInnerCutout:50,tooltipFontSize:12},e.shouldDisplayCurrency()||angular.merge(i,{currency:"hide"}),t=n.pieChart(a,i,!0),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(o)}]),e.directive("widgetSalesNewVsExistingCustomers",function(){return{restrict:"A",controller:"WidgetSalesNewVsExistingCustomersCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-number-of-leads",[]),e.controller("WidgetSalesNumberOfLeadsCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s,o;return o=e.widget,e.orgDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),s=[e.orgDeferred.promise,e.paramSelectorDeferred.promise],o.initContext=function(){return(e.isDataFound=angular.isDefined(o.content)&&!_.isEmpty(o.content.number_of_leads))?i(["impac.widget.settings.time_period.period.year","impac.widget.settings.time_period.period.quarter","impac.widget.settings.time_period.period.month","impac.widget.settings.time_period.period.week","impac.widget.settings.time_period.period.day"]).then(function(t){return e.periodOptions=[{label:t["impac.widget.settings.time_period.period.year"],value:"YEARLY"},{label:t["impac.widget.settings.time_period.period.quarter"],value:"QUARTERLY"},{label:t["impac.widget.settings.time_period.period.month"],value:"monthly"},{label:t["impac.widget.settings.time_period.period.week"],value:"WEEKLY"},{label:t["impac.widget.settings.time_period.period.day"],value:"DAILY"}],e.period=angular.copy(_.find(e.periodOptions,function(e){return e.value===o.metadata.period})||e.periodOptions[3])}):void 0},o.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.formatNumberOfLeads=function(t){var n,a,i,s,l,d;if(a=0,i="- %",!e.isDataFound)return{nominal:a,variation:i,color:""};if(s=angular.copy(o.content.number_of_leads),l=0,n="","new"===t&&s.total&&2===s.total.length)l=s.total[1]-s.total[0],d=r(s.total),d>0?n="green":0>d&&(n="red");else if("converted"===t&&s.converted&&2===s.converted.length)l=s.converted[1],d=r(s.converted),d>0?n="green":0>d&&(n="red");else{if("lost"!==t||!s.lost||2!==s.lost.length)return{nominal:a,variation:i,color:n};l=s.lost[1],d=r(s.lost),0>d?n="green":d>0&&(n="red")}return l>0?a="+"+l:0>l&&(a=l),d&&d>0?i="+"+d.toFixed(0)+"%":d&&0>d&&(i=d.toFixed(0)+"%"),{nominal:a,variation:i,color:n}},r=function(e){var t;return t=0!==e[0]?100*(e[1]/e[0]-1):"- "},e.widgetDeferred.resolve(s)}]),e.directive("widgetSalesNumberOfLeads",function(){return{restrict:"A",controller:"WidgetSalesNumberOfLeadsCtrl"}})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-opportunities-funnel",[]),e.controller("WidgetSalesOpportunitiesFunnelCtrl",["$scope","$q","ChartFormatterSvc","$filter","ImpacWidgetsSvc","ImpacDashboardsSvc",function(e,n,a,i,r,s){var o,l,d,c,u,g,p,m;return m=e.widget,e.selectedOpportunities=[],e.collapsed=[],e.orgDeferred=n.defer(),e.paramsPickerDeferred1=n.defer(),e.paramsPickerDeferred2=n.defer(),e.widthDeferred=n.defer(),u=[e.orgDeferred.promise,e.paramsPickerDeferred1.promise,e.paramsPickerDeferred2.promise,e.widthDeferred.promise],e.ascending=!0,e.sortedColumn="group",d=function(e){var t,n,a;return t=_.mapValues(e,function(e){return e.total}),a=_.compact(_.values(t)),n=_.reduce(a,function(e,t){return null==e&&(e=0),e+t}),null!=n&&n>0},o=function(e,n){return _.reduce(e,function(e,a){var i;return null==e&&(e=0),i=a.assignee_id,t.call(n,i)>=0?e+1:e},0)},l=function(e){return _.map(_.filter(e,function(e){return e.selected}),"value")},m.initContext=function(){var n,a,i;return a=s.getCurrentDashboard(),i=m.metadata.sales_stage_selection||a.metadata.sales_stage_selection||{values:[]},n=m.metadata.assignees_selection||a.metadata.assignees_selection||{values:[]},(e.isDataFound=angular.isDefined(m.content)&&!_.isEmpty(m.content.opps_per_sales_stage)&&d(m.content.opps_per_sales_stage))&&(_.remove(i.values,function(e){return t.call(_.keys(m.content.opps_per_sales_stage),e)<0}),e.hasReach=!0,e.statusOptions=[],angular.forEach(m.content.opps_per_sales_stage,function(n,a){var r;return r=_.isEmpty(i.values)||t.call(i.values,a)>=0,e.statusOptions.push({label:a,selected:r})}),!e.statusOptions[0]||_.any(e.statusOptions,"selected")||_.isEmpty(m.content.opps_per_sales_stage)||(e.statusOptions[0].selected=!0),e.assigneesOptions=[],angular.forEach(m.content.assignees,function(a){var i,r;return i=_.isEmpty(n.values)||(r=a.id,t.call(n.values,r)>=0),e.assigneesOptions.push({label:a.name,selected:i,value:a.id})}),e.assigneesOptions[0]&&!_.any(e.assigneesOptions,"selected")&&!_.isEmpty(m.content.assignees))?e.assigneesOptions[0].selected=!0:void 0},m.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getImpacColor=function(e){return a.getColor(e)},e.toggleSelectStatus=function(t){return e.selectedStatus=e.selectedStatus&&e.selectedStatus===t?null:t,e.updateRightView(),!m.isExpanded()&&e.selectedStatus?m.toggleExpanded():r.updateWidgetSettings(m,!1,!0)},e.isSelected=function(t){return e.selectedStatus&&t===e.selectedStatus},e.toggleCollapsed=function(t){return null!=t&&null!=t.assigneeName?_.find(e.collapsed,function(e){return t.assigneeName===e})?e.collapsed=_.reject(e.collapsed,function(e){return e===t.assigneeName}):e.collapsed.push(t.assigneeName):void 0},e.isCollapsed=function(t){return null!=t&&null!=t.assigneeName?_.find(e.collapsed,function(e){return t.assigneeName===e})?!0:!1:void 0},e.getSelectedOpportunities=function(){var n,a,i,r;return e.isDataFound&&e.selectedStatus&&m.content.opps_per_sales_stage[e.selectedStatus]?(n=l(e.assigneesOptions),a=_.filter(m.content.opps_per_sales_stage[e.selectedStatus].opps,function(e){var a;return a=e.assignee_id,t.call(n,a)>=0}),i=_.groupBy(a,"assignee_id"),r=[],angular.forEach(e.assigneesOptions,function(e){var t;return t=e.value,i[t]?r.push({assigneeName:e.label,opps:i[t]}):void 0}),r):[]},e.getOppDetails=function(e){var t;return t=[],e.amount&&t.push(i("mnoCurrency")(e.amount.amount,e.amount.currency||"AUD")),e.probability&&t.push("prob. "+e.probability+"%"),t.join(" / ")},e.getTotal=function(e){var t,n;return e.length>0?(n=_.sum(e,function(e){var t,n;return t=e.amount.amount||0,n=e.probability||0,t*(n/100)}),t=e[0].amount.currency||"AUD",i("mnoCurrency")(n,t)):""},p=function(t){return angular.forEach(e.selectedOpportunities,function(n){return n.opps?n.opps.sort(function(n,a){var i;return i=t(n)>t(a)?1:t(n)<t(a)?-1:0,e.ascending||(i*=-1),i}):void 0})},g=function(){return"group"===e.sortedColumn?p(function(e){return e.name}):"total"===e.sortedColumn?p(function(e){return e.amount.amount}):void 0},e.sort=function(t){return e.sortedColumn===t?e.ascending=!e.ascending:(e.ascending=!0,e.sortedColumn=t),g()},e.updateRightView=function(){return e.selectedOpportunities=e.getSelectedOpportunities(),e.collapsed=[],g()},c={},c.initialized=!1,c.initialize=function(){return!_.isEmpty(m.content)&&angular.isDefined(m.content.opps_per_sales_stage[m.metadata.selected_status])&&(e.selectedStatus=m.metadata.selected_status),c.initialized=!0,e.updateRightView()},c.toMetadata=function(){return{selected_status:e.selectedStatus}},m.settings.push(c),m.format=function(){var t,n;return e.isDataFound?(n=0,t=l(e.assigneesOptions),angular.forEach(e.statusOptions,function(e){var a;return a=o(m.content.opps_per_sales_stage[e.label].opps,t),e.selected&&angular.isDefined(a)&&a>n?n=a:void 0}),n>0?e.funnel=_.compact(_.map(e.statusOptions,function(e){var a,i,r;return r=o(m.content.opps_per_sales_stage[e.label].opps,t),a=(100*(r/n)-10).toFixed(),i=8>a?92:100-a,e.selected&&angular.isDefined(r)&&r>0?{status:e.label,number:r,coloredWidth:{width:a+"%"},statusWidth:{width:i+"%"}}:void 0})):e.isDataFound=!1):void 0},e.widgetDeferred.resolve(u)}]),e.directive("widgetSalesOpportunitiesFunnel",function(){return{restrict:"A",controller:"WidgetSalesOpportunitiesFunnelCtrl"}})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets.sales-performance",[]),e.controller("WidgetSalesPerformanceCtrl",["$scope","$q","$filter","ChartFormatterSvc","ImpacWidgetsSvc",function(e,n,a,i,r){var s,o,l,d,c,u;return u=e.widget,e.orgDeferred=n.defer(),e.paramsWinsPickerDeferred=n.defer(),e.paramsLostsPickerDeferred=n.defer(),e.timePeriodDeferred=n.defer(),e.widthDeferred=n.defer(),e.chartDeferred=n.defer(),c=[e.orgDeferred.promise,e.paramsWinsPickerDeferred,e.paramsLostsPickerDeferred,e.timePeriodDeferred,e.widthDeferred.promise,e.chartDeferred.promise],u.initContext=function(){var n,a,i,r,s;if(e.isDataFound=angular.isDefined(u.content)&&!_.isEmpty(u.content.assignees),e.isDataFound){if(!_.isEmpty(u.metadata.selectedElements))for(e.selectedElements=[],r=u.metadata.selectedElements,a=0,i=r.length;i>a;a++)s=r[a],n=_.find(u.content.assignees,function(e){return o(e)===s}),n&&e.selectedElements.push(n);return e.hasReach=!0,e.closedWonOptions=_.compact(_.map(u.content.sales_stages.won,function(e){return{label:e,selected:!0}})),angular.forEach(u.content.sales_stages.all,function(n){return t.call(u.content.sales_stages.won,n)>=0?void 0:e.closedWonOptions.push({label:n,selected:!1})}),e.closedLostOptions=_.compact(_.map(u.content.sales_stages.lost,function(e){return{label:e,selected:!0}})),angular.forEach(u.content.sales_stages.all,function(n){return t.call(u.content.sales_stages.lost,n)>=0?void 0:e.closedLostOptions.push({label:n,selected:!1})})}},u.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getChartTitle=function(){return e.selectedElements?e.selectedElements.map(function(e){return e.name}).join(", "):void 0},e.getTotalWon=function(){return e.selectedElements?e.selectedElements.reduce(function(e,t){return e+t.total_won},0):0},s=function(e){var t;return t=null!=u.metadata&&null!=u.metadata.hist_parameters?u.metadata.hist_parameters.period:null,a("momentDate")(e,t)},e.getCloseDate=function(e){var t;return null!=e&&null!=e.sales_stage_changes&&e.sales_stage_changes.length>0&&(t=e.sales_stage_changes[e.sales_stage_changes.length-1].updated_at,t.split(" ").length>0)?(t=t.split(" ")[0],s(t)):void 0},e.getForecastCloseDate=function(e){var t;return null!=e&&e.expected_close_date&&(t=e.expected_close_date,t.split(" ").length>0)?(t=t.split(" ")[0],s(t)):void 0},e.getElementChartColor=function(e){return i.getColor(e)},e.no_sales_stages_selected=function(){return u.content&&u.content.sales_stages&&0===u.content.sales_stages.won.length&&0===u.content.sales_stages.lost.length},e.toggleSelectedElement=function(t){var n;return e.isSelected(t)?(e.selectedElements=_.reject(e.selectedElements,function(e){return l(t,e)}),u.format(),u.isExpanded()&&0===e.selectedElements.length?u.toggleExpanded():r.updateWidgetSettings(u,!1,!0)):(n=angular.copy(t),e.selectedElements||(e.selectedElements=[]),e.selectedElements.push(n),u.format(),u.isExpanded()?r.updateWidgetSettings(u,!1,!0):u.toggleExpanded())},e.isSelected=function(t){return null!=t&&_.any(e.selectedElements,function(e){return l(t,e)})},e.hasElements=function(){return null!=e.selectedElements&&e.selectedElements.length>0},e.getSelectLineColor=function(t){var n;return n=_.find(e.selectedElements,function(e){return l(t,e)}),e.hasElements()?i.getColor(_.indexOf(e.selectedElements,n)):void 0},l=function(e,t){return o(e)===o(t)},o=function(e){return e.id||e.name},e.drawTrigger=n.defer(),u.format=function(){var t,n,r,s;return e.isDataFound&&null!=e.selectedElements&&e.selectedElements.length>0?(r=[],t=!0,angular.forEach(e.selectedElements,function(e){var n,i,s;return n=angular.copy(e),s=null,null!=u.metadata&&null!=u.metadata.hist_parameters&&(s=u.metadata.hist_parameters.period),i=_.map(u.content.dates,function(e){return a("momentDate")(e,s)}),r.push({title:n.name,labels:i,values:n.totals}),angular.forEach(n.totals,function(e){return t&&(t=e>=0)})}),s={scaleBeginAtZero:t,showXLabels:!0,datasetFill:1===e.selectedElements.length,pointDot:1===e.selectedElements.length},n=i.lineChart(r,s),e.drawTrigger.notify(n)):void 0},d={initialized:!1},d.initialize=function(){return d.initialized=!0},d.toMetadata=function(){var t;return t=_.map(e.selectedElements,function(e){return o(e)}),{selectedElements:t}},u.settings.push(d),e.widgetDeferred.resolve(c)}]),e.directive("widgetSalesPerformance",function(){return{restrict:"A",controller:"WidgetSalesPerformanceCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-segmented-turnover",[]),e.controller("WidgetSalesSegmentedTurnoverCtrl",["$scope","$q","$filter","ChartFormatterSvc","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),e.timePeriodDeferred=t.defer(),e.widthDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.chartDeferred=t.defer(),r=[e.orgDeferred.promise,e.timePeriodDeferred.promise,e.widthDeferred.promise,e.paramSelectorDeferred.promise,e.chartDeferred.promise],s.initContext=function(){return(e.isDataFound=!_.isEmpty(s.content)&&!_.isEmpty(s.content.dates)&&!_.isEmpty(s.content.ranges))?(e.filterOptions=[{label:i.instant("impac.widget.sales_turnover.gross_revenue"),value:"gross"},{label:i.instant("impac.widget.sales_turnover.net_revenue"),value:"net"}],e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===s.content.filter})||e.filterOptions[0]),e.analysisTranslate=s.content.ranges[0].percentage+s.content.ranges[1].percentage>50?i.instant("impac.widget.sales_turnover.analysis.least"):s.content.ranges[3].percentage+s.content.ranges[4].percentage>50?i.instant("impac.widget.sales_turnover.analysis.most"):i.instant("impac.widget.sales_turnover.analysis.balanced")):void 0},e.getColorByIndex=function(e){return a.getColor(e)},e.getRangeLabel=function(e,t){var a;return null==t&&(t=!1),a=e.split("-"),_.map(a,function(e){return n("mnoCurrency")(e,s.content.currency,t)}).join(" - ")},e.getMaxRange=function(){var t,n;return e.isDataFound?(t=0,n=s.content.ranges[0],angular.forEach(s.content.ranges,function(e){return e.percentage>t&&(n=angular.copy(e)),t=Math.max(t,e.percentage)}),n):void 0},e.drawTrigger=t.defer(),s.format=function(){var t,n,i;return e.isDataFound?(t={labels:_.map(s.content.ranges,function(t){return e.getRangeLabel(t.label,!0)}),values:_.map(s.content.ranges,function(e){return e.value})},n={showTooltips:!1,showXLabels:!1,barDatasetSpacing:15},i=a.barChart(t,n),e.drawTrigger.notify(i)):void 0},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesSegmentedTurnover",function(){return{restrict:"A",controller:"WidgetSalesSegmentedTurnoverCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-summary",[]),e.controller("WidgetSalesSummaryCtrl",["$scope","$q","ChartFormatterSvc","$translate",function(e,t,n,a){var i,r;return r=e.widget,e.orgDeferred=t.defer(),e.chartFiltersDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),e.datesPickerDeferred=t.defer(),e.chartDeferred=t.defer(),i=[e.orgDeferred.promise,e.chartFiltersDeferred.promise,e.paramSelectorDeferred.promise,e.datesPickerDeferred.promise,e.chartDeferred.promise],e.datesPickerTemplate="<span><from-date>"+a.instant("impac.widget.sales_summary.to")+" <to-date> <apply></span>",r.initContext=function(){return e.isDataFound=!_.isEmpty(r.content)&&!_.isEmpty(r.content.summary)&&_.sum(_.map(r.content.summary,function(e){return e.total}))>0,e.isDataFound?(e.filterOptions=[{label:a.instant("impac.widget.sales_summary.value_sold_taxes"),value:"gross_value_sold"},{label:a.instant("impac.widget.sales_summary.value_sold_no_taxes"),value:"net_value_sold"},{label:a.instant("impac.widget.sales_summary.quantity_sold"),value:"quantity_sold"},{label:a.instant("impac.widget.sales_summary.value_purchased_taxes"),value:"gross_value_purchased"},{label:a.instant("impac.widget.sales_summary.value_purchased_no_taxes"),value:"net_value_purchased"},{label:a.instant("impac.widget.sales_summary.quantity_purchased"),value:"quantity_purchased"}],"customer"===r.metadata.criteria&&(e.filterOptions=[e.filterOptions[0],e.filterOptions[1],e.filterOptions[2]]),e.filter=angular.copy(_.find(e.filterOptions,function(e){return e.value===r.metadata.filter})||e.filterOptions[0])):void 0},e.drawTrigger=t.defer(),r.format=function(){var t,a,i;return e.isDataFound?(a=_.map(r.content.summary,function(e){var t;return t=e.company?(e.code||e.name||e.location||e.industry||e.customer)+" ("+e.company+")":e.code||e.name||e.location||e.industry||e.customer,{label:t,value:e.total}}),i={percentageInnerCutout:50,tooltipFontSize:12},e.filter.value.indexOf("quantity")>-1&&angular.merge(i,{currency:"hide"}),t=n.pieChart(a,i),e.drawTrigger.notify(t)):void 0},e.widgetDeferred.resolve(i)}]),e.directive("widgetSalesSummary",function(){return{restrict:"A",controller:"WidgetSalesSummaryCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-top-customers",[]),e.controller("WidgetSalesTopCustomersCtrl",["$scope","$q","$filter","ImpacUtilities","$translate",function(e,t,n,a,i){var r,s,o,l,d;return d=e.widget,e.orgDeferred=t.defer(),e.datesPickerDeferred=t.defer(),e.paramSelectorDeferred=t.defer(),o=[e.orgDeferred.promise,e.datesPickerDeferred.promise,e.paramSelectorDeferred.promise],l=i.instant("impac.widget.sales_top_customers.top"),e.limitEntriesOptions=[{label:l.replace(":number:",5),value:5},{label:l.replace(":number:",10),value:10},{label:l.replace(":number:",25),value:25},{label:l.replace(":number:",50),value:50},{label:l.replace(":number:",100),value:100}],e.limitEntriesSelected=angular.copy(_.find(e.limitEntriesOptions,function(e){return null!=d.metadata&&e.value===d.metadata.limit_entries})||e.limitEntriesOptions[3]),e.headerOptions=[{label:i.instant("impac.widget.sales_top_customers.total_sales"),value:"total_sales",minified:"total"},{label:i.instant("impac.widget.sales_top_customers.transactions"),value:"transactions",minified:"# tr"},{label:i.instant("impac.widget.sales_top_customers.avg_sales"),value:"avg_sales",minified:"avg"},{label:i.instant("impac.widget.sales_top_customers.last_sale"),value:"last_sale",minified:"last"}],e.headerSelected=angular.copy(_.find(e.headerOptions,function(e){return null!=d.metadata&&d.metadata.header===e.value})||e.headerOptions[0]),d.initContext=function(){var t,i;return(e.isDataFound=!_.isEmpty(d.content)&&!_.isEmpty(d.content.entities))?(t=_.flatten(_.map(d.content.entities,function(e){return _.map(e.invoices,function(e){return e.invoice_date})})),i=a.getDatesRange(t),e.defaultFrom=n("date")(i[0],"yyyy-MM-dd"),e.defaultTo=n("date")(i[1],"yyyy-MM-dd"),r(),e.ratesDate=moment.now()):void 0},s=[{label:"total",showCurrency:!0,getValue:function(e){return e.total_invoiced},getFormattedFxTotals:function(e){return e.formattedFxTotals}},{label:"# tr",showCurrency:!1,getValue:function(e){return e.invoices.length}},{label:"avg",showCurrency:!0,getValue:function(e){var t;return t=e.invoices.length,t>0?e.total_invoiced/e.invoices.length:0}},{label:"last",showCurrency:!0,getValue:function(e){var t;return t=e.invoices.length,t>0?e.invoices[e.invoices.length-1].invoiced:0}}],e.getHeaderField=function(){return _.find(s,function(t){return t.label===e.headerSelected.minified})},e.getRemainingFields=function(){return _.reject(s,function(t){return t.label===e.headerSelected.minified})},e.getEntities=function(){return e.isDataFound?n("orderBy")(d.content.entities,function(t){return e.getHeaderField().getValue(t)},!0):[]},r=function(){var e,t,n,a,i,r;for(i=d.content.entities,r=[],n=0,a=i.length;a>n;n++)e=i[n],t=[],_.mapKeys(e.fx_totals,function(e,n){return n!==d.metadata.currency?t.push({currency:n,amount:e.invoiced,rate:e.rate}):void 0}),_.isEmpty(t)?r.push(void 0):r.push(e.formattedFxTotals=t);return r},e.widgetDeferred.resolve(o)}]),e.directive("widgetSalesTopCustomers",function(){return{restrict:"A",controller:"WidgetSalesTopCustomersCtrl",link:function(e){return e.transactionsCollapsed=!1,e.toggleTransactions=function(){return e.transactionsCollapsed=!e.transactionsCollapsed}}}})}.call(this),function(){var e;e=angular.module("impac.components.widgets.sales-top-opportunities",[]),e.controller("WidgetSalesTopOpportunitiesCtrl",["$scope","$q","ChartFormatterSvc","$filter","$translate",function(e,t,n,a,i){var r,s;return s=e.widget,e.orgDeferred=t.defer(),r=[e.orgDeferred.promise],s.initContext=function(){return e.isDataFound=angular.isDefined(s.content)&&!_.isEmpty(s.content.opportunities)},s.processError=function(t){return 404===t.code?e.isDataFound=!1:void 0},e.getOppDetails=function(e){var t;return t=[],e.amount&&t.push(a("mnoCurrency")(e.amount.amount,e.amount.currency||"AUD")),e.probability&&t.push(i.instant("impac.widget.sales_opportunities.proba")+(" "+e.probability+"%")),e.sales_stage&&t.push(e.sales_stage),t.join(" / ")},e.getOppClass=function(e){switch(e){case 0:return"first";case 1:return"second";case 2:return"second";default:return""}},e.widgetDeferred.resolve(r)}]),e.directive("widgetSalesTopOpportunities",function(){return{restrict:"A",controller:"WidgetSalesTopOpportunitiesCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.account",[]),e.controller("SettingAccountCtrl",["$scope","$filter",function(e,t){var n,a,i;return i=e.parentWidget,a={},a.key="account",a.isInitialized=!1,a.initialize=function(){return i.selectedAccount=i.selectedAccount||null,null!=i.content&&null!=i.content.account_list&&null!=i.metadata&&null!=i.metadata.account_uid?(i.selectedAccount=_.find(i.content.account_list,function(e){return e.uid===i.metadata.account_uid}),a.isInitialized=!0):void 0},a.toMetadata=function(){return null!=i.selectedAccount?{account_uid:i.selectedAccount.uid}:void 0},n=function(e){var n;return n=e.current_balance||e.balance||0,t("mnoCurrency")(n,e.currency)},e.formatLabel=function(e){return null!=e.company?e.company+" - "+e.name+" ("+n(e)+")":e.name+" ("+n(e)+")"},i.settings.push(a),e.deferred.resolve(e.parentWidget)}]),e.directive("settingAccount",["$templateCache","$translate",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",label:"@",showLabel:"=?",onAccountSelected:"&"},link:function(e){return e.label?void 0:e.label=t.instant("impac.widget.settings.account.label")},template:e.get("widgets-settings/account.tmpl.html"),controller:"SettingAccountCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.accounting-behaviour",[]),e.directive("settingAccountingBehaviour",["$templateCache","$timeout",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",defaultBehaviour:"=?"},template:e.get("widgets-settings/accounting-behaviour.tmpl.html"),link:function(e){var n,a;return a=e.parentWidget,n={},n.key="accounting-behaviour",n.initialize=function(){return t(function(){return e.selectedBehaviour=null!=e.defaultBehaviour&&"pnl"===e.defaultBehaviour?"pnl":"bls"})},n.toMetadata=function(){return{accounting_behaviour:e.selectedBehaviour}},a.settings.push(n),e.deferred.resolve(n)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.accounts-list",[]),e.controller("SettingAccountsListCtrl",["$scope","$timeout","ImpacWidgetsSvc",function(e,t,n){var a,i,r;return r=e.parentWidget,r.moveAccountToAnotherList=function(e,t,a,i){return null==i&&(i=!0),_.isEmpty(t)||_.isEmpty(e)?void 0:(a||(a=[]),_.remove(t,function(t){return e.uid===t.uid}),a.push(e),i&&n.updateWidgetSettings(r,!1),null)},i={},i.key="accounts-list",i.initialize=function(){return i.isInitialized=!1,r.remainingAccounts=[],r.selectedAccounts=[],null==r.content||_.isEmpty(r.content.complete_list)?void 0:(r.remainingAccounts=angular.copy(r.content.complete_list),t(function(){return a(),i.isInitialized=!0}))},i.toMetadata=function(){return i.isInitialized?{accounts_list:_.map(r.selectedAccounts,function(e){return e.uid})}:void 0},a=function(){var t,n,a,i,s,o;if(!_.isEmpty(r.metadata.accounts_list)||!_.isEmpty(e.accountsList)){for(a=_.isEmpty(e.accountsList)?r.metadata.accounts_list:e.accountsList,o=[],i=0,s=a.length;s>i;i++)n=a[i],t=_.find(r.content.complete_list,function(e){return e.uid===n}),o.push(r.moveAccountToAnotherList(t,r.remainingAccounts,r.selectedAccounts,!1));return o}},r.settings.push(i),e.deferred.resolve(e.parentWidget)}]),e.directive("settingAccountsList",function(){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",accountsList:"=?"},controller:"SettingAccountsListCtrl"}})}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.attach-kpis",[]),e.directive("settingAttachKpis",["$templateCache","ImpacWidgetsSvc","ImpacKpisSvc","$translate",function(e,t,n,a){return{restrict:"A",scope:{parentWidget:"=",attachedKpis:"=?",widgetEngine:"=",widgetId:"=",extraParams:"=?",deferred:"=",showExtraParam:"=?"},template:e.get("widgets-settings/attach-kpis.tmpl.html"),controller:["$scope",function(e){var t,i,r;return r=e.parentWidget,i={},i.initialize=function(){return t()},i.toMetadata=function(){},r.settings.push(i),e.formatKpiName=function(e){return n.formatKpiName(e)},e.hasValidTarget=function(){return n.validateKpiTarget(e.kpi)
},e.attachKpi=function(){var t,a,i,r,s;if(i={},e.hasValidTarget()){s={},s[e.kpi.limit.mode]=e.kpi.limit.value,i.targets={},i.targets[e.kpi.watchables[0]]=[s],i.widget_id=e.widgetId,r=e.extraParams;for(t in r)a=r[t],i.extra_params||(i.extra_params={}),i.extra_params[t]=a.uid;return console.log("attachKpis: ",e.kpi.endpoint,e.elementWatched,i),n.create("impac",e.kpi.endpoint,e.elementWatched,i).then(function(t){return console.log("attached KPI: ",t),e.attachedKpis.push(t)})}},e.deleteKpi=function(t){return n["delete"](t,{widget_id:e.widgetId}).then(function(){return _.remove(e.attachedKpis,function(e){return e.id===t.id})})},e.formatAttachedKpiTitle=function(t){return t.data&&t.targets&&e.elementWatched?n.formatKpiTarget(t.targets[e.elementWatched][0],t.data[e.elementWatched].unit,e.possibleTargets):""},e.attachedKpis||(e.attachedKpis=[]),e.possibleTargets=[{label:a.instant("impac.widget.settings.attach_kpis.over"),mode:"min"},{label:a.instant("impac.widget.settings.attach_kpis.below"),mode:"max"}],e.kpi={limit:{mode:e.possibleTargets[0].mode}},n.getAttachableKpis(e.widgetEngine).then(function(t){return e.availableKpis=angular.copy(t),angular.extend(e.kpi,e.availableKpis[0]),e.selectedParam=_.keys(e.extraParams)[0],e.elementWatched=null!=e.kpi.watchables&&e.kpi.watchables[0]}),t=function(){},t(),e.deferred.resolve(e.parentWidget)}]}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.bolt-account",[]),e.controller("SettingBoltAccountCtrl",["$scope","$filter",function(e,t){var n,a,i,r,s;return s=e.parentWidget,r={},r.key="bolt-account",r.isInitialized=!1,r.initialize=function(){return 0!==s.content.settings.selectors.length&&(s.accountList=a()),s.selectedAccount=i(),null!=s.content&&null!=s.accountList&&null!=s.metadata&&null!=s.metadata.account_uid?(s.selectedAccount=i(s.metadata.account_uid),r.isInitialized=!0):void 0},r.toMetadata=function(){return null!=s.selectedAccount?{account_uid:s.selectedAccount.account_id}:void 0},a=function(e){return null==e&&(e="account"),_.find(s.content.settings.selectors,function(t){return t.name===e}).options},i=function(e){return null==e&&(e="total_uid"),_.find(s.accountList,function(t){return t.account_id===e})},n=function(e){var n;return n=null,t("mnoCurrency")(n,e.currency)},e.formatLabel=function(e){return null!=e.currency?e.name+" ("+e.currency+")":""+e.name},s.settings.push(r),e.deferred.resolve(e.parentWidget)}]),e.directive("settingBoltAccount",["$templateCache","$translate",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",label:"@",showLabel:"=?",onAccountSelected:"&"},link:function(e){return e.label?void 0:e.label=t.instant("impac.widget.settings.bolt-account.label")},template:e.get("widgets-settings/bolt-account.tmpl.html"),controller:"SettingBoltAccountCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.chart-filters",[]),e.controller("SettingChartFiltersCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,t={},t.key="chart-filters",t.isInitialized=!1,t.initialize=function(){return null!=n.content&&null!=n.content.chart_filter&&(e.filterCriteria=n.content.chart_filter.criteria)?(e.maxEntities=n.content.chart_filter.max,e.entityType=n.content.chart_filter.entity_type,e.filterLabel=n.content.chart_filter.filter_label.replace(/_/g," "),"number"===e.filterCriteria?(e.filterValuePercentage=80,e.filterValueNumber=n.content.chart_filter.value):(e.filterValuePercentage=n.content.chart_filter.value,e.filterValueNumber=Math.round(e.maxEntities/2)),t.isInitialized=!0):void 0},t.toMetadata=function(){var t;return null!=n.content&&null!=n.content.chart_filter?(t="percentage"===e.filterCriteria?e.filterValuePercentage:e.filterValueNumber,{chart_filter:{criteria:e.filterCriteria,value:t}}):{}},n.settings.push(t),e.deferred.resolve(e.parentWidget)}]),e.directive("settingChartFilters",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},template:e.get("widgets-settings/chart-filters.tmpl.html"),controller:"SettingChartFiltersCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.dates-picker",[]),e.directive("settingDatesPicker",["$templateCache","$filter","ImpacWidgetsSvc","$timeout","$compile",function(e,t,n,a,i){return{restrict:"A",scope:{parentWidget:"=?",deferred:"=",fromDate:"=from",toDate:"=to",keepToday:"=",onUse:"&?",onChangeCb:"&?onChange",minDate:"=?",updateOnPick:"=?",template:"=?",period:"=?"},template:e.get("widgets-settings/dates-picker.tmpl.html"),link:function(e,r){var s,o,l,d,c,u,g,p;return p=e.parentWidget,c={},c.key="dates-picker",e.setting=c,e.calendarFrom={opened:!1,value:new Date((new Date).getFullYear(),0,1),toggle:function(){return e.calendarFrom.opened=!e.calendarFrom.opened,e.calendarTo.opened=!1}},e.calendarTo={opened:!1,value:new Date,toggle:function(){return e.calendarFrom.opened=!1,e.calendarTo.opened=!e.calendarTo.opened}},e.template||(e.template='<div style="display: flex; flex-wrap: wrap;">\n  <div style="display: flex; flex-grow: 1; justify-content: space-around; margin: 2px 0px;">\n    <span class="sdp-from-label" style="padding-top: 3px; min-width: 32px; flex-grow: 1; text-align: center;" translate>impac.widget.settings.dates_picker.from</span> <from-date style="flex-grow: 2;">\n  </div>\n  <div style="display: flex; flex-grow: 1; justify-content: space-around; margin: 2px 0px;">\n    <span class="sdp-to-label" style="padding-top: 3px; min-width: 32px; flex-grow: 1; text-align: center;" translate>impac.widget.settings.dates_picker.to</span> <to-date style="flex-grow: 2;">\n  </div>\n</div>'),l='<div style="display: inline-block;">\n  <button class="btn btn-sm btn-default date-button" ng-click="calendarFrom.toggle()" uib-datepicker-popup ng-model="calendarFrom.value" is-open="calendarFrom.opened" ng-change="onChange()" min-date="minDate" max-date="calendarFrom.value" ng-focus="onUse()" ATTRS>\n    {{ calendarFrom.value | momentDate : setting.key }}\n  </button>\n</div>',g='<div style="display: inline-block;">\n  <button class="btn btn-sm btn-default date-button" ng-click="calendarTo.toggle()" uib-datepicker-popup ng-model="calendarTo.value" is-open="calendarTo.opened" ng-change="onChange()" min-date="calendarTo.value" ng-focus="onUse()" ATTRS>\n    {{ calendarTo.value | momentDate : setting.key }}\n  </button>\n</div>',s='<button class="btn btn-sm btn-success" uib-tooltip="{{\'impac.widget.settings.dates_picker.tooltip.apply_changes\' | translate}}" ng-show="changed && !parentWidget.isEditMode" ng-click="applyChanges()" ng-focus="onUse()" >\n  <i class="fa fa-check"/>\n</button>',e.template=e.template.replace(/>/," ng-click='onUse()'>"),e.template=e.template.replace(/<from-date([^>]*)>/g,""+l.replace("ATTRS","$1")),e.template=e.template.replace(/<to-date([^>]*)>/g,""+g.replace("ATTRS","$1")),e.template=e.template.replace(/<apply([^>]*)>/g,""+s.replace("ATTRS","$1")),u=r.find("#template-container"),u.html(e.template).show(),i(u.contents())(e),c.initialize=function(){return a(function(){var t,n,a,i,r;return e.changed=!1,Date.parse(e.fromDate)?(a=e.fromDate.split("-"),r=a[0],n=a[1]-1,t=a[2],e.calendarFrom.value=new Date(r,n,t)):e.calendarFrom.value=new Date((new Date).getFullYear(),0,1),Date.parse(e.toDate)&&!e.keepToday?(i=e.toDate.split("-"),r=i[0],n=i[1]-1,t=i[2],e.calendarTo.value=new Date(r,n,t)):e.calendarTo.value=new Date})},d=function(){return e.calendarTo.value.getFullYear()===(new Date).getFullYear()&&e.calendarTo.value.getMonth()===(new Date).getMonth()&&e.calendarTo.value.getDate()===(new Date).getDate()},c.toMetadata=function(){return{hist_parameters:{from:t("date")(e.calendarFrom.value,"yyyy-MM-dd"),to:t("date")(e.calendarTo.value,"yyyy-MM-dd"),period:e.period||"RANGE",keep_today:d()}}},e.onChange=function(){return e.showApplyButton(),_.isUndefined(e.onChangeCb)?void 0:e.onChangeCb()(o())},o=function(){return{from:t("date")(e.calendarFrom.value,"yyyy-MM-dd"),to:t("date")(e.calendarTo.value,"yyyy-MM-dd"),keepToday:d()}},e.showApplyButton=function(){return e.updateOnPick?e.applyChanges():e.changed=!0},e.applyChanges=function(){return n.updateWidgetSettings(p,!0),e.changed=!1},e.showTitle=function(){return r.hasClass("part")},p&&p.settings.push(c),e.deferred.resolve(c)}}}])}.call(this),function(){var module;module=angular.module("impac.components.widgets-settings.formula",[]),module.controller("SettingFormulaCtrl",["$scope","$filter","$timeout","$translate",function($scope,$filter,$timeout,$translate){var AUTHORIZED_REGEXP,evaluateFormula,formatFormula,getFormula,interpolateInFormula,isRatio,prepareFormula,setting,translateEvaluatedFormula,w;return w=$scope.parentWidget,w.formula="",AUTHORIZED_REGEXP=new RegExp("^(\\{|\\d|\\}|\\/|\\+|-|\\*|\\(|\\)|\\s|\\.)*$"),setting={},setting.key="formula",setting.isInitialized=!1,setting.initialize=function(){return null!=w.metadata&&null!=w.metadata.formula?(w.formula=w.metadata.formula,$timeout(function(){return prepareFormula(),setting.isInitialized=!0})):w.formula=""},setting.toMetadata=function(){return prepareFormula(),w.isFormulaCorrect?{formula:w.formula}:{formula:""}},getFormula=function(){return w.formula},w.formatAmount=function(e){return $filter("mnoCurrency")(e.current_balance,e.currency)},$scope.$watch(getFormula,function(){return prepareFormula()}),prepareFormula=function(){var e,t;return t=interpolateInFormula(w.formula,w.selectedAccounts,"current_balance"),(e=evaluateFormula(t))?(w.evaluatedFormula=formatFormula(e,w.formula,w.selectedAccounts),w.legend=interpolateInFormula(w.formula,w.selectedAccounts,"name"),w.isFormulaCorrect=!0):(w.evaluatedFormula="invalid expression",w.legend="...",w.isFormulaCorrect=!1),w.evaluatedFormulaTranslate=translateEvaluatedFormula(w.evaluatedFormula)},w.evaluatedFormula_History=function(e){var t,n,a,i,r,s,o;for(a=w.formula,o=w.selectedAccounts,n=i=0,r=o.length;r>i;n=++i)t=o[n],s=new RegExp("\\{"+(n+1)+"\\}","g"),a=a.replace(s," "+t.balances[e]+" ");return evaluateFormula(a)},translateEvaluatedFormula=function(e){switch(e){case"invalid expression":return $translate.instant("impac.widget.formula.invalid_expression");case"Infinity":return $translate.instant("impac.widget.formula.infinity");case"-Infinity":return $translate.instant("impac.widget.formula.minus_infinity");default:return e}},interpolateInFormula=function(e,t,n){var a,i,r,s,o,l;if(r=e,_.isEmpty(t))return r;for(i=s=0,o=t.length;o>s;i=++s)a=t[i],l=new RegExp("\\{"+(i+1)+"\\}","g"),r=r.replace(l," "+a[n]+" ");return r},evaluateFormula=function(interpolatedFormula){var e,evaluation;if(!interpolatedFormula.match(AUTHORIZED_REGEXP))return!1;try{return evaluation=eval(interpolatedFormula).toFixed(2),isFinite(evaluation)?evaluation:!1}catch(error){return e=error,!1}},isRatio=function(e){return e.match(/\//g)},formatFormula=function(e,t,n){var a,i;return isRatio(t)||_.isEmpty(n)?e:(i=n[0],(a=i.currency)?$filter("mnoCurrency")(e,a):e)},w.settings.push(setting),$scope.deferred.resolve($scope.parentWidget)}]),module.directive("settingFormula",function(){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},controller:"SettingFormulaCtrl"}})}.call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("impac.components.widgets-settings.hist-mode",[]),e.controller("SettingHistModeCtrl",["$scope","$translate","$timeout","ImpacWidgetsSvc","ImpacTheming","ImpacUtilities",function(e,n,a,i,r){var s,o,l;return l=e.parentWidget,l.isHistoryMode=l.metadata&&l.metadata.hist_parameters&&"history"===l.metadata.hist_parameters.mode,e.forwardParams={accountingBehaviour:function(){return e.accountingBehaviour}},e.toggleHistMode=function(n){var a;if(!(l.isHistoryMode&&"history"===n||!l.isHistoryMode&&"current"===n))return l.isHistoryMode=!l.isHistoryMode,i.updateWidgetSettings(l,!1),a=e.onToggle(),t.call(angular.isDefined(e.onToggle),a)>=0},s=function(){var t,a,i,s;return a=r.get().widgetSettings.histModeChoser.currentLabels,null!=e.accountingBehaviour&&a[e.accountingBehaviour]?(i=!e.endDate||e.endDate===moment().format("YYYY-MM-DD"),t=a[e.accountingBehaviour],s=a[e.accountingBehaviour]+".prefix",n([s,t]).then(function(n){return e.currentLabel=i?n[s]+" "+n[t]:n[t]})):n(a["default"]).then(function(t){return e.currentLabel=t})},o={},o.key="hist-mode",o.isInitialized=!1,o.initialize=function(){return a(function(){var t;return null!=l.metadata&&null!=l.metadata.hist_parameters&&(t=l.metadata.hist_parameters.mode)&&(l.isHistoryMode="history"===t?!0:!1),s(),e.forwardParams.histParams=l.metadata&&l.metadata.hist_parameters,o.isInitialized=!0,e})},o.toMetadata=function(){var e;return e=l.isHistoryMode?"history":"current",{hist_parameters:{mode:e}}},l.settings.push(o),e.deferred.resolve(e.parentWidget)}]),e.directive("settingHistMode",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",onToggle:"&",accountingBehaviour:"@?",endDate:"=?"},template:e.get("widgets-settings/hist-mode.tmpl.html"),controller:"SettingHistModeCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.limit-entries",[]),e.controller("SettingLimitEntriesCtrl",["$scope",function(e){var t;return t={},t.key="limit-entries",t.initialize=function(){return!0},t.toMetadata=function(){return{limit_entries:e.selected}},e.parentWidget.settings.push(t),e.deferred.resolve(t)}]),e.directive("settingLimitEntries",["$templateCache","ImpacWidgetsSvc",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",selected:"=",max:"=?",options:"=?",entriesLabel:"=?"},link:function(e){return null!=e.options&&e.options.length>0||(e.options=[5,15,50]),e.selectOption=function(n){return e.selected=n,t.updateWidgetSettings(e.parentWidget,!1)},e.isOptionValid=function(t){return null==e.max||t<e.max}},controller:"SettingLimitEntriesCtrl",template:e.get("widgets-settings/limit-entries.tmpl.html")}}])}.call(this),function(){var module;module=angular.module("impac.components.widgets-settings.offsets",[]),module.directive("settingOffsets",["$templateCache","ImpacUtilities",function($templateCache,ImpacUtilities){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",offsetsKey:"@",initialOffsets:"=",currency:"=",intervalsCount:"=",period:"=",showIntervalsMult:"=",textPlaceholder:"@?"},template:$templateCache.get("widgets-settings/offsets.tmpl.html"),link:function(scope){var authorized_regex,computedFormula,placeholder,setting,w;return w=scope.parentWidget,authorized_regex=new RegExp("^(\\{|\\d|\\}|\\/|\\+|-|\\*|\\(|\\)|\\s|\\.)*$"),setting={key:"offsets-"+scope.offsetsKey},setting.initialize=function(){var e,t,n,a;for(scope.offsets=[],a=scope.initialOffsets||[],e=0,t=a.length;t>e;e++)n=a[e],scope.offsets.push(n);return scope.offsetFormula="",scope.periodWord=ImpacUtilities.getPeriodWord(scope.period),scope.placeholder=placeholder(scope.period||"MONTHLY")},setting.toMetadata=function(){var e;return e={offset:{}},e.offset[scope.offsetsKey]=scope.offsets,e},scope.addOffset=function(){var e;return e=computedFormula(),e&&scope.offsets.push(e),scope.offsetFormula=""},scope.removeOffset=function(e){return scope.offsets.splice(e,1)},scope.addOffsetOnEnter=function(e){return 13===e.keyCode?scope.addOffset():void 0},placeholder=function(e){var t;return null!=scope.textPlaceholder?scope.textPlaceholder:(t=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase(),t+" adjustment")},computedFormula=function(){return scope.offsetFormula.match(authorized_regex)?eval(scope.offsetFormula):void 0},w&&w.settings.push(setting),scope.deferred.resolve(setting)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.organizations",[]),e.controller("SettingOrganizationsCtrl",["$scope","$log","ImpacDashboardsSvc","ImpacMainSvc","ImpacWidgetsSvc",function(e,t,n,a,i){var r,s,o;return o=e.parentWidget,o.selectedOrganizations={},e.mode||(e.mode="multiple"),e.multiOrgMode=function(){return"multiple"===e.mode},e.singleOrgMode=function(){return"single"===e.mode},r=function(){return o.selectedOrganizations=_.mapValues(o.selectedOrganizations,function(){return!1})},e.isOrganizationSelected=function(e){return!!o.selectedOrganizations[e]},e.toggleSelectOrganization=function(t){if(e.multiOrgMode()){if(o.selectedOrganizations[t]=!o.selectedOrganizations[t],angular.isDefined(e.onSelect))return e.onSelect({orgs:o.selectedOrganizations})}else if(e.singleOrgMode())return r(),o.selectedOrganizations[t]=!0},s={},s.key="organizations",s.isInitialized=!1,s.initialize=function(){return n.load().then(function(t){var n,l,d,c,u,g,p,m;if(n=t.currentDashboard,e.dashboardOrganizations=_.sortBy(n.data_sources,function(e){return e.label.toLowerCase()}),null!=o.metadata&&null!=o.metadata.organization_ids){if(m=o.metadata.organization_ids,e.singleOrgMode())r(),m.length>1?(l=a.config.currentOrganization,o.selectedOrganizations[l.uid]=!0,d=!0):o.selectedOrganizations[m[0]]=!0;else if(e.multiOrgMode())for(p=e.dashboardOrganizations,c=0,u=p.length;u>c;c++)g=p[c],o.selectedOrganizations[g.uid]=_.contains(m,g.uid);return s.isInitialized=!0,d?i.updateWidgetSettings(o,!0):void 0}})},s.toMetadata=function(){var t;return t=_.compact(_.map(o.selectedOrganizations,function(e,t){return e?t:void 0})),_.isEmpty(t)&&(t=[_.first(e.dashboardOrganizations).uid]),{organization_ids:t}},o.settings.push(s),e.deferred.resolve(e.parentWidget)}]),e.directive("settingOrganizations",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",mode:"@?",deferred:"=",onSelect:"&?"},template:e.get("widgets-settings/organizations.tmpl.html"),controller:"SettingOrganizationsCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.param-selector",[]),e.controller("SettingParamSelectorCtrl",["$scope","ImpacWidgetsSvc",function(e,t){var n,a;return e.showOptions=!1,e.toggleShowOptions=function(){return e.showOptions=!e.showOptions},e.onInit=function(){return e.selectedOption={},angular.extend(e.selectedOption,e.selected)},e.selectOption=function(n){return n.value!==e.selected.value&&(angular.extend(e.selected,n),t.updateWidgetSettings(e.parentWidget,!e.noReload),angular.isDefined(e.onSelect)&&e.onSelect()),e.toggleShowOptions()},e.getTruncateValue=function(){return parseInt(e.truncateNo)||20},a=e.parentWidget,n={},n.key="param-selector",n.isInitialized=!1,n.initialize=function(){return null!=a.content?n.isInitialized=!0:void 0},n.toMetadata=function(){var t;return t={},_.isEmpty(e.selected)||(t[e.param]=e.selected.value),t},a.settings.push(n),e.deferred.resolve(e.parentWidget)}]),e.directive("settingParamSelector",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"=",selected:"=",truncateNo:"@",onSelect:"&"},link:function(e,t,n){return e.noReload="undefined"!=typeof n.noReload,e.truncateNo=n.truncateNo||20},template:function(t,n){return e.get(n.classic?"widgets-settings/param-selector-classic.tmpl.html":"widgets-settings/param-selector.tmpl.html")},controller:"SettingParamSelectorCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.params-checkboxes",[]),e.controller("SettingParamsCheckboxesCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,t={},t.key="params-checkboxes",t.initialize=function(){},t.toMetadata=function(){var t;return t={},t[e.param]=_.map(e.options,function(e){return{id:e.id,value:e.value}}),t},n.settings.push(t),e.deferred.resolve(e.parentWidget)}]),e.directive("settingParamsCheckboxes",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"="},template:e.get("widgets-settings/params-checkboxes.tmpl.html"),controller:"SettingParamsCheckboxesCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.params-picker",[]),e.controller("SettingParamsPickerCtrl",["$scope",function(e){var t,n;return n=e.parentWidget,t={},t.key="params-picker",t.isInitialized=!1,t.initialize=function(){return e.sortableOptions={"ui-floating":!0,tolerance:"pointer"},e.applyToDashboard=n.metadata[e.param]&&"dashboard"===n.metadata[e.param].reach,e.toggleReach=function(){return t.reach=e.applyToDashboard?"dashboard":"widget"},e.toggleReach(),_.isEmpty(e.options)?t.isInitialized=!0:void 0},t.toMetadata=function(){var n;return n={},n[e.param]={values:_.compact(_.map(e.options,function(e){return e.selected?e.value||e.label:void 0})),reach:t.reach},n},n.settings.push(t),e.deferred.resolve(e.parentWidget)}]),e.directive("settingParamsPicker",["$templateCache","$translate",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",param:"@",options:"=",hasReach:"=",description:"@"},link:function(e){var n;return n=t.instant("impac.widget.settings.params-picker."+e.param),e.formattedParam=_.includes(n,"impac.widget.settings.params-picker")?e.param.replace(/_/g," "):n,null==e.description?e.description=t.instant("impac.widget.settings.params-picker.description"):void 0},template:e.get("widgets-settings/params-picker.tmpl.html"),controller:"SettingParamsPickerCtrl"}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.tag-filter",["ngTagsInput"]),e.directive("settingTagFilter",["$templateCache","$timeout",function(e,t){return{restrict:"A",scope:{parentWidget:"=",deferred:"="},template:e.get("widgets-settings/tag-filter.tmpl.html"),link:function(e){var n,a,i,r,s,o;return o=e.parentWidget,s={},s.key="tag-filter",e.settingsTags=[],s.initialize=function(){return t(function(){return r(),i(),!0})},s.toMetadata=function(){var t,a;return a=[],t={condition:"OR",rules:a},angular.forEach(e.settingsTags,function(e){var t;return t={condition:"AND",rules:[]},angular.forEach(e.tags,function(e){var a;return a=n(e,!0),t.rules.push(a)}),0!==e.tags.length?a.push(t):void 0}),0===t.rules.length&&(t={}),{filter_query:t}},a=function(e){var t;if(!_.isEmpty(e))return t=[],angular.forEach(e.rules,function(e){var a;return a={operator:"OR",tags:[]},angular.forEach(e.rules,function(e){var t,i;return e=n(e),i=_.compact([e.name,e.value]).join(":"),t={value:e.value,text:i},null!=e.name&&(t.name=e.name),a.tags.push(t)}),t.push(a)}),t},r=function(){return _.isEmpty(o.metadata.filter_query)?void 0:e.settingsTags=a(o.metadata.filter_query)},i=function(){var t,a,i,r;r=o.content.available_tags||[],t=[];for(a in r)i=r[a],angular.forEach(i.tag_references,function(e){return e=n(e),angular.forEach(e.tag_reference_values,function(a){var i,r;return a=n(a),r=_.compact([e.name,a.value]).join(":"),i={text:r,value:a.value},null!=e.name&&(i.name=e.name),t.push(i)})});return e.loadTagList=function(e){return _.filter(t,function(t){return t.text.toLowerCase().indexOf(e.toLowerCase())>-1})}},n=function(e,t){var n;return null==t&&(t=!1),n=t?encodeURIComponent:decodeURIComponent,_.inject(e,function(e,t,a){return _.isString(t)?(e[a]=n(t))&&e:(e[a]=t)&&e},{})},e.addRule=function(){return e.settingsTags.push({operator:"OR",tags:[]})},e.delRule=function(t){return e.settingsTags.splice(t,1)},o.settings.push(s),e.deferred.resolve(s)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.time-period",[]),e.directive("settingTimePeriod",["$templateCache","$q","$log","$timeout","$filter","ImpacTheming","$translate",function(e,t,n,a,i,r,s){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",histParams:"=?",hideChartInterval:"=?",applyChangesCallback:"&?"},template:e.get("widgets-settings/time-period.tmpl.html"),link:function(e){var n,o,l,d,c,u,g,p,m;return m=e.parentWidget,e.timePeriodSetting={key:"time-period",settings:[],isEditMode:!0},e.timeSliderDeferred=t.defer(),e.datesPickerDeferred=t.defer(),e.timePresetsDeferred=t.defer(),u=[e.timeSliderDeferred.promise,e.datesPickerDeferred.promise,e.timePresetsDeferred.promise],e.resetPreset=t.defer(),s(["impac.widget.settings.time_period.period.daily","impac.widget.settings.time_period.period.weekly","impac.widget.settings.time_period.period.monthly","impac.widget.settings.time_period.period.quarterly","impac.widget.settings.time_period.period.yearly","impac.widget.settings.time_period.period.days","impac.widget.settings.time_period.period.weeks","impac.widget.settings.time_period.period.months","impac.widget.settings.time_period.period.quarters","impac.widget.settings.time_period.period.years"]).then(function(t){return e.periods=[{label:t["impac.widget.settings.time_period.period.daily"],plural:"days",value:"DAILY"},{label:t["impac.widget.settings.time_period.period.weekly"],plural:"weeks",value:"WEEKLY"},{label:t["impac.widget.settings.time_period.period.monthly"],plural:"months",value:"MONTHLY"},{label:t["impac.widget.settings.time_period.period.quarterly"],plural:"quarters",value:"QUARTERLY"},{label:t["impac.widget.settings.time_period.period.yearly"],plural:"years",value:"YEARLY"}]}),e.maxNumberOfPeriods=20,null==r.get().widgetSettings||null==r.get().widgetSettings.timePeriod||_.isEmpty(r.get().widgetSettings.timePeriod.presets)||(e.presets=angular.copy(r.get().widgetSettings.timePeriod.presets)),e.applyPreset=function(e){return d(e),c(e)},e.timePeriodSetting.initialize=function(){return a(function(){return d(),o("time-presets").initialize(),e.showApplyButton=angular.isDefined(e.applyChangesCallback)})},e.timePeriodSetting.toMetadata=function(){var t,a,i;return i=o(l()),null!=i&&(t=i.toMetadata().hist_parameters),t.period=n(),null!=e.histParams&&null!=e.histParams.mode&&(t.mode=e.histParams.mode),a={hist_parameters:t}},e.titleize=function(e){return"FYEARLY"!==e?""+e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase():"Yearly (financial)"},n=function(){return null!=e.timePeriodSetting.period?e.timePeriodSetting.period:d()},e.isTimeSliderUsed=function(){return"time-slider"===l()},e.isDatesPickerUsed=function(){return"dates-picker"===l()},l=function(){return null!=e.usedSetting?e.usedSetting:c()},o=function(t){return _.find(e.timePeriodSetting.settings,function(e){return e.key===t})},d=function(t){return null==t&&(t=null),null==t&&(t=e.histParams),e.timePeriodSetting.period=null!=t&&null!=t.period&&_.find(e.periods,function(e){return e.value===t.period})?angular.copy(t.period):"MONTHLY",e.timePeriodSetting.period},c=function(t){var n,a,i,r;return null==t&&(t=null),null==t&&(t=e.histParams),null!=t&&null!=t.from?(e.usedSetting="dates-picker",e.toDate=t.to,n=e.getMinDate(e.toDate),e.fromDate=moment(t.from,"YYYY-MM-DD").isBefore(n)?n:t.from,e.keepToday=t.keep_today,o("dates-picker").initialize()):(e.usedSetting="time-slider",null!=t&&null!=t.time_range&&(r=t.time_range,i=/([a-z])/,a=i.exec(r)[1],e.timePeriodSetting.period=angular.copy(_.find(e.periods,function(e){return e.value.slice(0,1).toLowerCase()===a}).value),e.timePeriodSetting.timeRange=r),o("time-slider").initialize()),e.usedSetting},e.updateSettings=function(){return"time-slider"===e.usedSetting?e.resetPreset.notify("choose-period"):"dates-picker"===e.usedSetting&&e.resetPreset.notify("choose-dates"),p(),g()},p=function(){var t,a,i;return e.isTimeSliderUsed()&&(a=o("time-slider"),i=a.toMetadata().hist_parameters.time_range,t=n().slice(0,1).toLowerCase(),e.timePeriodSetting.timeRange=i.replace(/[a-z]/,t),a.initialize()),e.timePeriodSetting.timeRange},g=function(){var t,n,a,i;return e.isDatesPickerUsed()&&(a=o("dates-picker"),t=a.toMetadata().hist_parameters.from,i=a.toMetadata().hist_parameters.to,n=e.getMinDate(),moment(t,"YYYY-MM-DD").isBefore(n)&&(e.toDate=i,e.fromDate=n,a.initialize())),e.fromDate},e.useTimeSlider=function(){return e.usedSetting="time-slider",e.updateSettings()},e.useDatesPicker=function(){return e.usedSetting="dates-picker",e.updateSettings()},e.getMinDate=function(t){var a,i,r,s;return null==t&&(t=void 0),s=moment(),null!=t?s=moment(t,"YYYY-MM-DD"):null!=e.usedSetting&&e.isDatesPickerUsed()&&(r=o("dates-picker"),s=moment(r.toMetadata().hist_parameters.to,"YYYY-MM-DD")),a=n(),i=_.find(e.periods,function(e){return a===e.value}).plural,s.subtract(e.maxNumberOfPeriods,i)},e.formattedMinDate=function(t){return null==t&&(t=void 0),i("momentDate")(e.getMinDate(t),"time-period")},m.settings.push(e.timePeriodSetting),t.all(u).then(function(){return e.deferred.resolve(e.timePeriodSetting)})}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.time-presets",[]),e.directive("settingTimePresets",["$templateCache","ImpacMainSvc","$timeout","ImpacUtilities","ImpacTheming","$translate",function(e,t,n,a,i,r){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",presets:"=?",onSelect:"&?",onChooseDates:"&?",onChoosePeriod:"&?",histParams:"=?",resetPromise:"=?"},template:e.get("widgets-settings/time-presets.tmpl.html"),link:function(e){var n,s,o,l;return l=e.parentWidget,e.setting={},e.setting.key="time-presets",e.financialYearEndMonth=6,n=e.financialYearEndMonth,t.load().then(function(){return n=t.getFinancialYearEndMonth()})["finally"](function(){var t,i,s,l;return t=a.financialYearDates(n).start,s=moment(a.financialYearDates(n).start,"YYYY-MM-DD").subtract(1,"year").format("YYYY-MM-DD"),i=moment(a.financialYearDates(n).end,"YYYY-MM-DD").subtract(1,"year").format("YYYY-MM-DD"),l=moment().format("YYYY-MM-DD"),r(["impac.common.period.preset_in_words.calendar_year_to_date","impac.common.period.preset_in_words.financial_year_to_date","impac.common.period.preset_in_words.previous_financial_year","impac.common.period.preset_in_words.last_6_months","impac.common.period.preset_in_words.last_4_quarters","impac.common.period.preset_in_words.last_4_weeks","impac.common.period.preset_in_words.choose_period","impac.common.period.preset_in_words.choose_dates"]).then(function(n){return e.presets||(e.presets=[{label:n["impac.common.period.preset_in_words.calendar_year_to_date"],value:{from:moment().startOf("year").format("YYYY-MM-DD"),to:l,period:"MONTHLY"}},{label:n["impac.common.period.preset_in_words.financial_year_to_date"],value:{from:t,to:l,period:"MONTHLY"}},{label:n["impac.common.period.preset_in_words.previous_financial_year"],value:{from:s,to:i,period:"MONTHLY"}},{label:n["impac.common.period.preset_in_words.last_6_months"],value:{time_range:"-6m",to:l}},{label:n["impac.common.period.preset_in_words.last_4_quarters"],value:{time_range:"-4q",to:l}},{label:n["impac.common.period.preset_in_words.last_4_weeks"],value:{time_range:"-4w",to:l}}]),angular.isDefined(e.onChooseDates)&&o()&&e.presets.unshift({label:n["impac.common.period.preset_in_words.choose_period"],value:"choose-period"}),angular.isDefined(e.onChooseDates)?e.presets.unshift({label:n["impac.common.period.preset_in_words.choose_dates"],value:"choose-dates"}):void 0})}),null!=e.resetPromise&&e.resetPromise.then(null,null,function(t){return e.selectedPreset=_.find(e.presets,function(e){return e.value===t})}),o=function(){return null!=i.get().widgetSettings&&null!=i.get().widgetSettings.timePeriod&&i.get().widgetSettings.timePeriod.showSlider},s=function(){return null!=e.histParams&&(e.selectedPreset=_.find(e.presets,function(t){return _.every(t.value,function(t,a){return e.histParams[a]===(angular.isFunction(t)?t(n):t)})}),null==e.selectedPreset&&null!=e.histParams.time_range&&o()&&(e.selectedPreset=e.presets[1])),null==e.selectedPreset?e.selectedPreset=e.presets[0]:void 0},e.presetSelected=function(){return null!=e.selectedPreset&&"choose-dates"===e.selectedPreset.value?e.onChooseDates():null!=e.selectedPreset&&"choose-period"===e.selectedPreset.value?e.onChoosePeriod():e.onSelect({histParams:e.setting.toMetadata().hist_parameters})},e.setting.initialize=function(){return s(),e.presetSelected(),!0},e.setting.toMetadata=function(){var t;return t={},_.isEmpty(e.selectedPreset.value)||_.forEach(e.selectedPreset.value,function(e,a){return t[a]=angular.isFunction(e)?e(n):e}),{hist_parameters:t}},l.settings.push(e.setting),e.deferred.resolve(e.setting)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.time-slider",[]),e.directive("settingTimeSlider",["$templateCache","$timeout","ImpacMainSvc","ImpacUtilities","ImpacTheming",function(e,t,n,a){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",timeRange:"=?",onUse:"&?"},template:e.get("widgets-settings/time-slider.tmpl.html"),link:function(e){var i,r,s,o,l,d,c,u,g,p;
return p=e.parentWidget,g={},g.key="time-slider",i=["d","w","m","q","y","f"],g.initialize=function(){return t(function(){return c(),u(),d(),!0})},g.toMetadata=function(){var t;return t={to:e.toDate().format("YYYY-MM-DD"),time_range:l()},"f"===s()&&(t.from=e.fromDate().format("YYYY-MM-DD")),{hist_parameters:t}},c=function(){var t,n,a;return a=e.timeRange,e.numberOfPeriods=moment().month(),null==a?e.numberOfPeriods:(n=/^-?([0-9]{1,2})[a-z]?$/,t=n.exec(a),null!=t&&t[1]&&parseInt(t[1])&&(e.numberOfPeriods=parseInt(t[1])),e.numberOfPeriods)},u=function(){var t,n,a,r;return r=e.timeRange,e.period="m",null==r?"m":(n=/^-?[0-9]{0,2}([a-z])$/,t=n.exec(r),a=_.find(i,function(e){return null!=t&&t[1]===e}),null!=a&&(e.period=a),e.period)},d=function(){return e.financialYearEndMonth=6,n.load().then(function(t){return null!=t&&null!=t.currentOrganization&&parseInt(t.currentOrganization.financial_year_end_month)?e.financialYearEndMonth=parseInt(t.currentOrganization.financial_year_end_month):void 0})},s=function(){return null!=e.period?e.period:u()},o=function(){return a.getPeriodWord(s())},r=function(){return null!=e.numberOfPeriods?e.numberOfPeriods:c()},l=function(){var e,t;return e=r(),t=s(),"-"+e+t},e.formatPeriod=function(){return a.formatPeriod(r(),s())},e.fromDate=function(){var t,n,a;return n=r(),a=o(),"f"===a.slice(0,1)?(t=moment().year()-1,moment().month()>=6&&(t=moment().year()),t-=n,moment(t+"-"+(e.financialYearEndMonth+1)+"-01","YYYY-M-DD")):"w"===a.slice(0,1)?moment().subtract(n,a).startOf("isoweek"):moment().subtract(n,a).startOf(a)},e.toDate=function(){return moment()},p.settings.push(g),e.deferred.resolve(g)}}}])}.call(this),function(){var e;e=angular.module("impac.components.widgets-settings.width",[]),e.controller("SettingWidthCtrl",["$scope","$element","$timeout","$log","ImpacWidgetsSvc","ImpacDashboardsSvc",function(e,t,n,a,i,r){var s,o,l,d,c,u,g;for(g=e.parentWidget,u={},u.key="width",u.isInitialized=!1,c=t.parents(),l=0,d=c.length;d>l;l++)if(s=c[l],angular.element(s).hasClass("content")){e.contentElements=angular.element(s).children();break}return o=function(e){var t,a;if(e&&e.length>0){for(t=0,a=e.length;a>t;t++)s=e[t],angular.element(s).animate({opacity:0},0);return n(function(){var t,n,a;for(a=[],t=0,n=e.length;n>t;t++)s=e[t],a.push(angular.element(s).animate({opacity:1},200));return a},300)}},g.toggleExpanded=function(t){return null==t&&(t=!0),e.expanded=!e.expanded,t&&i.updateWidgetSettings(g,!1,!0),o(e.contentElements),g.width=e.expanded?parseInt(e.max):parseInt(e.min)},g.isExpanded=function(){return e.expanded},u.initialize=function(){return null!=g.width?(e.expanded=g.width===parseInt(e.max),u.isInitialized=!0):void 0},u.toMetadata=function(){var t;return t=e.expanded?e.max:e.min,{width:parseInt(t)}},r.pdfModeEnabled().then(null,null,function(){return e.pdfMode=!0,e.initiallyExpanded=!!e.expanded,e.initiallyExpanded?void 0:g.toggleExpanded(!1)}),r.pdfModeCanceled().then(null,null,function(){return e.pdfMode=!1,e.initiallyExpanded?void 0:g.toggleExpanded(!1)}),g.settings.push(u),e.deferred.resolve(e.parentWidget)}]),e.directive("settingWidth",["$templateCache",function(e){return{restrict:"A",scope:{parentWidget:"=",deferred:"=",min:"@",max:"@"},template:e.get("widgets-settings/width.tmpl.html"),controller:"SettingWidthCtrl"}}])}.call(this)}).call(this),!function e(t,n,a){function i(s,o){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return i(n?n:e)},c,c.exports,e,t,n,a)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(){},{}],2:[function(e,t){function n(e){if(e){var t=/^#([a-fA-F0-9]{3})$/,n=/^#([a-fA-F0-9]{6})$/,a=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,r=/(\w+)/,s=[0,0,0],o=1,l=e.match(t);if(l){l=l[1];for(var d=0;d<s.length;d++)s[d]=parseInt(l[d]+l[d],16)}else if(l=e.match(n)){l=l[1];for(var d=0;d<s.length;d++)s[d]=parseInt(l.slice(2*d,2*d+2),16)}else if(l=e.match(a)){for(var d=0;d<s.length;d++)s[d]=parseInt(l[d+1]);o=parseFloat(l[4])}else if(l=e.match(i)){for(var d=0;d<s.length;d++)s[d]=Math.round(2.55*parseFloat(l[d+1]));o=parseFloat(l[4])}else if(l=e.match(r)){if("transparent"==l[1])return[0,0,0,0];if(s=w[l[1]],!s)return}for(var d=0;d<s.length;d++)s[d]=v(s[d],0,255);return o=o||0==o?v(o,0,1):1,s[3]=o,s}}function a(e){if(e){var t=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var a=parseFloat(n[4]),i=v(parseInt(n[1]),0,360),r=v(parseFloat(n[2]),0,100),s=v(parseFloat(n[3]),0,100),o=v(isNaN(a)?1:a,0,1);return[i,r,s,o]}}}function i(e){if(e){var t=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var a=parseFloat(n[4]),i=v(parseInt(n[1]),0,360),r=v(parseFloat(n[2]),0,100),s=v(parseFloat(n[3]),0,100),o=v(isNaN(a)?1:a,0,1);return[i,r,s,o]}}}function r(e){var t=n(e);return t&&t.slice(0,3)}function s(e){var t=a(e);return t&&t.slice(0,3)}function o(e){var t=n(e);return t?t[3]:(t=a(e))?t[3]:(t=i(e))?t[3]:void 0}function l(e){return"#"+b(e[0])+b(e[1])+b(e[2])}function d(e,t){return 1>t||e[3]&&e[3]<1?c(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"}function c(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function u(e,t){if(1>t||e[3]&&e[3]<1)return g(e,t);var n=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgb("+n+"%, "+a+"%, "+i+"%)"}function g(e,t){var n=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return"rgba("+n+"%, "+a+"%, "+i+"%, "+(t||e[3]||1)+")"}function p(e,t){return 1>t||e[3]&&e[3]<1?m(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"}function m(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function h(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"}function f(e){return y[e.slice(0,3)]}function v(e,t,n){return Math.min(Math.max(t,e),n)}function b(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var w=e("color-name");t.exports={getRgba:n,getHsla:a,getRgb:r,getHsl:s,getHwb:i,getAlpha:o,hexString:l,rgbString:d,rgbaString:c,percentString:u,percentaString:g,hslString:p,hslaString:m,hwbString:h,keyword:f};var y={};for(var _ in w)y[w[_]]=_},{"color-name":6}],3:[function(e,t){var n=e("color-convert"),a=e("chartjs-color-string"),i=function(e){if(e instanceof i)return e;if(!(this instanceof i))return new i(e);this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1};var t;if("string"==typeof e)if(t=a.getRgba(e))this.setValues("rgb",t);else if(t=a.getHsla(e))this.setValues("hsl",t);else{if(!(t=a.getHwb(e)))throw new Error('Unable to parse color from string "'+e+'"');this.setValues("hwb",t)}else if("object"==typeof e)if(t=e,void 0!==t.r||void 0!==t.red)this.setValues("rgb",t);else if(void 0!==t.l||void 0!==t.lightness)this.setValues("hsl",t);else if(void 0!==t.v||void 0!==t.value)this.setValues("hsv",t);else if(void 0!==t.w||void 0!==t.whiteness)this.setValues("hwb",t);else{if(void 0===t.c&&void 0===t.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(e));this.setValues("cmyk",t)}};i.prototype={rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;return 1!==e.alpha?e.hwb.concat([e.alpha]):e.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return e&&(e%=360,e=0>e?360+e:e),this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return a.hexString(this.values.rgb)},rgbString:function(){return a.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return a.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return a.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return a.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return a.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return a.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return a.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){for(var e=this.values.rgb,t=[],n=0;n<e.length;n++){var a=e[n]/255;t[n]=.03928>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb,t=(299*e[0]+587*e[1]+114*e[2])/1e3;return 128>t},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;3>t;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){var t=this.values.hsl;return t[2]+=t[2]*e,this.setValues("hsl",t),this},darken:function(e){var t=this.values.hsl;return t[2]-=t[2]*e,this.setValues("hsl",t),this},saturate:function(e){var t=this.values.hsl;return t[1]+=t[1]*e,this.setValues("hsl",t),this},desaturate:function(e){var t=this.values.hsl;return t[1]-=t[1]*e,this.setValues("hsl",t),this},whiten:function(e){var t=this.values.hwb;return t[1]+=t[1]*e,this.setValues("hwb",t),this},blacken:function(e){var t=this.values.hwb;return t[2]+=t[2]*e,this.setValues("hwb",t),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){var t=this.values.alpha;return this.setValues("alpha",t-t*e),this},opaquer:function(e){var t=this.values.alpha;return this.setValues("alpha",t+t*e),this},rotate:function(e){var t=this.values.hsl,n=(t[0]+e)%360;return t[0]=0>n?360+n:n,this.setValues("hsl",t),this},mix:function(e,t){var n=this,a=e,i=void 0===t?.5:t,r=2*i-1,s=n.alpha()-a.alpha(),o=((r*s===-1?r:(r+s)/(1+r*s))+1)/2,l=1-o;return this.rgb(o*n.red()+l*a.red(),o*n.green()+l*a.green(),o*n.blue()+l*a.blue()).alpha(n.alpha()*i+a.alpha()*(1-i))},toJSON:function(){return this.rgb()},clone:function(){var e,t,n=new i,a=this.values,r=n.values;for(var s in a)a.hasOwnProperty(s)&&(e=a[s],t={}.toString.call(e),"[object Array]"===t?r[s]=e.slice(0):"[object Number]"===t?r[s]=e:console.error("unexpected color value:",e));return n}},i.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},i.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},i.prototype.getValues=function(e){for(var t=this.values,n={},a=0;a<e.length;a++)n[e.charAt(a)]=t[e][a];return 1!==t.alpha&&(n.a=t.alpha),n},i.prototype.setValues=function(e,t){var a,i=this.values,r=this.spaces,s=this.maxes,o=1;if("alpha"===e)o=t;else if(t.length)i[e]=t.slice(0,e.length),o=t[e.length];else if(void 0!==t[e.charAt(0)]){for(a=0;a<e.length;a++)i[e][a]=t[e.charAt(a)];o=t.a}else if(void 0!==t[r[e][0]]){var l=r[e];for(a=0;a<e.length;a++)i[e][a]=t[l[a]];o=t.alpha}if(i.alpha=Math.max(0,Math.min(1,void 0===o?i.alpha:o)),"alpha"===e)return!1;var d;for(a=0;a<e.length;a++)d=Math.max(0,Math.min(s[e][a],i[e][a])),i[e][a]=Math.round(d);for(var c in r)c!==e&&(i[c]=n[e][c](i[e]));return!0},i.prototype.setSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},i.prototype.setChannel=function(e,t,n){var a=this.values[e];return void 0===n?a[t]:n===a[t]?this:(a[t]=n,this.setValues(e,a),this)},"undefined"!=typeof window&&(window.Color=i),t.exports=i},{"chartjs-color-string":2,"color-convert":5}],4:[function(e,t){function n(e){var t,n,a,i=e[0]/255,r=e[1]/255,s=e[2]/255,o=Math.min(i,r,s),l=Math.max(i,r,s),d=l-o;return l==o?t=0:i==l?t=(r-s)/d:r==l?t=2+(s-i)/d:s==l&&(t=4+(i-r)/d),t=Math.min(60*t,360),0>t&&(t+=360),a=(o+l)/2,n=l==o?0:.5>=a?d/(l+o):d/(2-l-o),[t,100*n,100*a]}function a(e){var t,n,a,i=e[0],r=e[1],s=e[2],o=Math.min(i,r,s),l=Math.max(i,r,s),d=l-o;return n=0==l?0:d/l*1e3/10,l==o?t=0:i==l?t=(r-s)/d:r==l?t=2+(s-i)/d:s==l&&(t=4+(i-r)/d),t=Math.min(60*t,360),0>t&&(t+=360),a=l/255*1e3/10,[t,n,a]}function i(e){var t=e[0],a=e[1],i=e[2],r=n(e)[0],s=1/255*Math.min(t,Math.min(a,i)),i=1-1/255*Math.max(t,Math.max(a,i));return[r,100*s,100*i]}function s(e){var t,n,a,i,r=e[0]/255,s=e[1]/255,o=e[2]/255;return i=Math.min(1-r,1-s,1-o),t=(1-r-i)/(1-i)||0,n=(1-s-i)/(1-i)||0,a=(1-o-i)/(1-i)||0,[100*t,100*n,100*a,100*i]}function o(e){return G[JSON.stringify(e)]}function l(e){var t=e[0]/255,n=e[1]/255,a=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92;var i=.4124*t+.3576*n+.1805*a,r=.2126*t+.7152*n+.0722*a,s=.0193*t+.1192*n+.9505*a;return[100*i,100*r,100*s]}function d(e){var t,n,a,i=l(e),r=i[0],s=i[1],o=i[2];return r/=95.047,s/=100,o/=108.883,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,t=116*s-16,n=500*(r-s),a=200*(s-o),[t,n,a]}function c(e){return W(d(e))}function u(e){var t,n,a,i,r,s=e[0]/360,o=e[1]/100,l=e[2]/100;if(0==o)return r=255*l,[r,r,r];n=.5>l?l*(1+o):l+o-l*o,t=2*l-n,i=[0,0,0];for(var d=0;3>d;d++)a=s+1/3*-(d-1),0>a&&a++,a>1&&a--,r=1>6*a?t+6*(n-t)*a:1>2*a?n:2>3*a?t+(n-t)*(2/3-a)*6:t,i[d]=255*r;return i}function p(e){var t,n,a=e[0],i=e[1]/100,r=e[2]/100;return 0===r?[0,0,0]:(r*=2,i*=1>=r?r:2-r,n=(r+i)/2,t=2*i/(r+i),[a,100*t,100*n])}function m(e){return i(u(e))}function h(e){return s(u(e))}function f(e){return o(u(e))}function v(e){var t=e[0]/60,n=e[1]/100,a=e[2]/100,i=Math.floor(t)%6,r=t-Math.floor(t),s=255*a*(1-n),o=255*a*(1-n*r),l=255*a*(1-n*(1-r)),a=255*a;switch(i){case 0:return[a,l,s];case 1:return[o,a,s];case 2:return[s,a,l];case 3:return[s,o,a];case 4:return[l,s,a];case 5:return[a,s,o]}}function w(e){var t,n,a=e[0],i=e[1]/100,r=e[2]/100;return n=(2-i)*r,t=i*r,t/=1>=n?n:2-n,t=t||0,n/=2,[a,100*t,100*n]}function y(e){return i(v(e))}function _(e){return s(v(e))}function x(e){return o(v(e))}function C(e){var t,n,a,i,s=e[0]/360,o=e[1]/100,l=e[2]/100,d=o+l;switch(d>1&&(o/=d,l/=d),t=Math.floor(6*s),n=1-l,a=6*s-t,0!=(1&t)&&(a=1-a),i=o+a*(n-o),t){default:case 6:case 0:r=n,g=i,b=o;break;case 1:r=i,g=n,b=o;break;case 2:r=o,g=n,b=i;break;case 3:r=o,g=i,b=n;break;case 4:r=i,g=o,b=n;break;case 5:r=n,g=o,b=i}return[255*r,255*g,255*b]}function D(e){return n(C(e))}function k(e){return a(C(e))}function S(e){return s(C(e))}function M(e){return o(C(e))}function E(e){var t,n,a,i=e[0]/100,r=e[1]/100,s=e[2]/100,o=e[3]/100;return t=1-Math.min(1,i*(1-o)+o),n=1-Math.min(1,r*(1-o)+o),a=1-Math.min(1,s*(1-o)+o),[255*t,255*n,255*a]}function T(e){return n(E(e))}function A(e){return a(E(e))}function P(e){return i(E(e))}function I(e){return o(E(e))}function F(e){var t,n,a,i=e[0]/100,r=e[1]/100,s=e[2]/100;return t=3.2406*i+-1.5372*r+s*-.4986,n=i*-.9689+1.8758*r+.0415*s,a=.0557*i+r*-.204+1.057*s,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:t=12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n=12.92*n,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=12.92*a,t=Math.min(Math.max(0,t),1),n=Math.min(Math.max(0,n),1),a=Math.min(Math.max(0,a),1),[255*t,255*n,255*a]}function L(e){var t,n,a,i=e[0],r=e[1],s=e[2];return i/=95.047,r/=100,s/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,t=116*r-16,n=500*(i-r),a=200*(r-s),[t,n,a]}function O(e){return W(L(e))}function $(e){var t,n,a,i,r=e[0],s=e[1],o=e[2];return 8>=r?(n=100*r/903.3,i=7.787*(n/100)+16/116):(n=100*Math.pow((r+16)/116,3),i=Math.pow(n/100,1/3)),t=.008856>=t/95.047?t=95.047*(s/500+i-16/116)/7.787:95.047*Math.pow(s/500+i,3),a=.008859>=a/108.883?a=108.883*(i-o/200-16/116)/7.787:108.883*Math.pow(i-o/200,3),[t,n,a]}function W(e){var t,n,a,i=e[0],r=e[1],s=e[2];return t=Math.atan2(s,r),n=360*t/2/Math.PI,0>n&&(n+=360),a=Math.sqrt(r*r+s*s),[i,a,n]}function z(e){return F($(e))}function R(e){var t,n,a,i=e[0],r=e[1],s=e[2];return a=s/360*2*Math.PI,t=r*Math.cos(a),n=r*Math.sin(a),[i,t,n]}function B(e){return $(R(e))}function V(e){return z(R(e))}function N(e){return X[e]}function H(e){return n(N(e))}function Y(e){return a(N(e))}function j(e){return i(N(e))}function U(e){return s(N(e))}function q(e){return d(N(e))}function K(e){return l(N(e))}t.exports={rgb2hsl:n,rgb2hsv:a,rgb2hwb:i,rgb2cmyk:s,rgb2keyword:o,rgb2xyz:l,rgb2lab:d,rgb2lch:c,hsl2rgb:u,hsl2hsv:p,hsl2hwb:m,hsl2cmyk:h,hsl2keyword:f,hsv2rgb:v,hsv2hsl:w,hsv2hwb:y,hsv2cmyk:_,hsv2keyword:x,hwb2rgb:C,hwb2hsl:D,hwb2hsv:k,hwb2cmyk:S,hwb2keyword:M,cmyk2rgb:E,cmyk2hsl:T,cmyk2hsv:A,cmyk2hwb:P,cmyk2keyword:I,keyword2rgb:N,keyword2hsl:H,keyword2hsv:Y,keyword2hwb:j,keyword2cmyk:U,keyword2lab:q,keyword2xyz:K,xyz2rgb:F,xyz2lab:L,xyz2lch:O,lab2xyz:$,lab2rgb:z,lab2lch:W,lch2lab:R,lch2xyz:B,lch2rgb:V};var X={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},G={};for(var Z in X)G[JSON.stringify(X[Z])]=Z},{}],5:[function(e,t){var n=e("./conversions"),a=function(){return new l};for(var i in n){a[i+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),n[e](t)}}(i);var r=/(\w+)2(\w+)/.exec(i),s=r[1],o=r[2];a[s]=a[s]||{},a[s][o]=a[i]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var a=n[e](t);if("string"==typeof a||void 0===a)return a;for(var i=0;i<a.length;i++)a[i]=Math.round(a[i]);return a}}(i)}var l=function(){this.convs={}};l.prototype.routeSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},l.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},l.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space,i=this.convs[n];t=a[n][e](i),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){l.prototype[e]=function(){return this.routeSpace(e,arguments)}}),t.exports=a},{"./conversions":4}],6:[function(e,t){t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],7:[function(e,t){var n=e("./core/core.js")();e("./core/core.helpers")(n),e("./core/core.element")(n),e("./core/core.animation")(n),e("./core/core.controller")(n),e("./core/core.datasetController")(n),e("./core/core.layoutService")(n),e("./core/core.legend")(n),e("./core/core.plugin.js")(n),e("./core/core.scale")(n),e("./core/core.scaleService")(n),e("./core/core.title")(n),e("./core/core.tooltip")(n),e("./elements/element.arc")(n),e("./elements/element.line")(n),e("./elements/element.point")(n),e("./elements/element.rectangle")(n),e("./scales/scale.category")(n),e("./scales/scale.linear")(n),e("./scales/scale.logarithmic")(n),e("./scales/scale.radialLinear")(n),e("./scales/scale.time")(n),e("./controllers/controller.bar")(n),e("./controllers/controller.bubble")(n),e("./controllers/controller.doughnut")(n),e("./controllers/controller.line")(n),e("./controllers/controller.polarArea")(n),e("./controllers/controller.radar")(n),e("./charts/Chart.Bar")(n),e("./charts/Chart.Bubble")(n),e("./charts/Chart.Doughnut")(n),e("./charts/Chart.Line")(n),e("./charts/Chart.PolarArea")(n),e("./charts/Chart.Radar")(n),e("./charts/Chart.Scatter")(n),window.Chart=t.exports=n},{"./charts/Chart.Bar":8,"./charts/Chart.Bubble":9,"./charts/Chart.Doughnut":10,"./charts/Chart.Line":11,"./charts/Chart.PolarArea":12,"./charts/Chart.Radar":13,"./charts/Chart.Scatter":14,"./controllers/controller.bar":15,"./controllers/controller.bubble":16,"./controllers/controller.doughnut":17,"./controllers/controller.line":18,"./controllers/controller.polarArea":19,"./controllers/controller.radar":20,"./core/core.animation":21,"./core/core.controller":22,"./core/core.datasetController":23,"./core/core.element":24,"./core/core.helpers":25,"./core/core.js":26,"./core/core.layoutService":27,"./core/core.legend":28,"./core/core.plugin.js":29,"./core/core.scale":30,"./core/core.scaleService":31,"./core/core.title":32,"./core/core.tooltip":33,"./elements/element.arc":34,"./elements/element.line":35,"./elements/element.point":36,"./elements/element.rectangle":37,"./scales/scale.category":38,"./scales/scale.linear":39,"./scales/scale.logarithmic":40,"./scales/scale.radialLinear":41,"./scales/scale.time":42}],8:[function(e,t){"use strict";t.exports=function(e){e.Bar=function(t,n){return n.type="bar",new e(t,n)}}},{}],9:[function(e,t){"use strict";t.exports=function(e){e.Bubble=function(t,n){return n.type="bubble",new e(t,n)}}},{}],10:[function(e,t){"use strict";t.exports=function(e){e.Doughnut=function(t,n){return n.type="doughnut",new e(t,n)}}},{}],11:[function(e,t){"use strict";t.exports=function(e){e.Line=function(t,n){return n.type="line",new e(t,n)}}},{}],12:[function(e,t){"use strict";t.exports=function(e){e.PolarArea=function(t,n){return n.type="polarArea",new e(t,n)}}},{}],13:[function(e,t){"use strict";t.exports=function(e){e.Radar=function(t,n){return n.options=e.helpers.configMerge({aspectRatio:1},n.options),n.type="radar",new e(t,n)}}},{}],14:[function(e,t){"use strict";t.exports=function(e){var t={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-1"}],yAxes:[{type:"linear",position:"left",id:"y-axis-1"}]},tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}};e.defaults.scatter=t,e.controllers.scatter=e.controllers.line,e.Scatter=function(t,n){return n.type="scatter",new e(t,n)}}},{}],15:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.bar={hover:{mode:"label"},scales:{xAxes:[{type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}},e.controllers.bar=e.DatasetController.extend({dataElementType:e.elements.Rectangle,initialize:function(t,n){e.DatasetController.prototype.initialize.call(this,t,n),this.getMeta().bar=!0},getBarCount:function(){var e=0;return t.each(this.chart.data.datasets,function(t,n){var a=this.chart.getDatasetMeta(n);a.bar&&this.chart.isDatasetVisible(n)&&++e},this),e},update:function(e){t.each(this.getMeta().data,function(t,n){this.updateElement(t,n,e)},this)},updateElement:function(e,n,a){var i=this.getMeta(),r=this.getScaleForId(i.xAxisID),s=this.getScaleForId(i.yAxisID),o=s.getBasePixel(),l=this.chart.options.elements.rectangle,d=e.custom||{},c=this.getDataset();t.extend(e,{_xScale:r,_yScale:s,_datasetIndex:this.index,_index:n,_model:{x:this.calculateBarX(n,this.index),y:a?o:this.calculateBarY(n,this.index),label:this.chart.data.labels[n],datasetLabel:c.label,base:a?o:this.calculateBarBase(this.index,n),width:this.calculateBarWidth(n),backgroundColor:d.backgroundColor?d.backgroundColor:t.getValueAtIndexOrDefault(c.backgroundColor,n,l.backgroundColor),borderSkipped:d.borderSkipped?d.borderSkipped:l.borderSkipped,borderColor:d.borderColor?d.borderColor:t.getValueAtIndexOrDefault(c.borderColor,n,l.borderColor),borderWidth:d.borderWidth?d.borderWidth:t.getValueAtIndexOrDefault(c.borderWidth,n,l.borderWidth)}}),e.pivot()},calculateBarBase:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.yAxisID),i=0;if(a.options.stacked){var r=this.chart,s=r.data.datasets,o=s[e].data[t];if(0>o)for(var l=0;e>l;l++){var d=s[l],c=r.getDatasetMeta(l);c.bar&&c.yAxisID===a.id&&r.isDatasetVisible(l)&&(i+=d.data[t]<0?d.data[t]:0)}else for(var u=0;e>u;u++){var g=s[u],p=r.getDatasetMeta(u);p.bar&&p.yAxisID===a.id&&r.isDatasetVisible(u)&&(i+=g.data[t]>0?g.data[t]:0)}return a.getPixelForValue(i)}return a.getBasePixel()},getRuler:function(e){var t,n=this.getMeta(),a=this.getScaleForId(n.xAxisID),i=this.getBarCount();
t="category"===a.options.type?a.getPixelForTick(e+1)-a.getPixelForTick(e):a.width/a.ticks.length;var r=t*a.options.categoryPercentage,s=(t-t*a.options.categoryPercentage)/2,o=r/i;if(a.ticks.length!==this.chart.data.labels.length){var l=a.ticks.length/this.chart.data.labels.length;o*=l}var d=o*a.options.barPercentage,c=o-o*a.options.barPercentage;return{datasetCount:i,tickWidth:t,categoryWidth:r,categorySpacing:s,fullBarWidth:o,barWidth:d,barSpacing:c}},calculateBarWidth:function(e){var t=this.getScaleForId(this.getMeta().xAxisID),n=this.getRuler(e);return t.options.stacked?n.categoryWidth:n.barWidth},getBarIndex:function(e){var t,n,a=0;for(n=0;e>n;++n)t=this.chart.getDatasetMeta(n),t.bar&&this.chart.isDatasetVisible(n)&&++a;return a},calculateBarX:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.xAxisID),i=this.getBarIndex(t),r=this.getRuler(e),s=a.getPixelForValue(null,e,t,this.chart.isCombo);return s-=this.chart.isCombo?r.tickWidth/2:0,a.options.stacked?s+r.categoryWidth/2+r.categorySpacing:s+r.barWidth/2+r.categorySpacing+r.barWidth*i+r.barSpacing/2+r.barSpacing*i},calculateBarY:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.yAxisID),i=this.getDataset().data[e];if(a.options.stacked){for(var r=0,s=0,o=0;t>o;o++){var l=this.chart.data.datasets[o],d=this.chart.getDatasetMeta(o);d.bar&&d.yAxisID===a.id&&this.chart.isDatasetVisible(o)&&(l.data[e]<0?s+=l.data[e]||0:r+=l.data[e]||0)}return 0>i?a.getPixelForValue(s+i):a.getPixelForValue(r+i)}return a.getPixelForValue(i)},draw:function(e){var n=e||1;t.each(this.getMeta().data,function(e,t){var a=this.getDataset().data[t];null===a||void 0===a||isNaN(a)||e.transition(n).draw()},this)},setHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=e._model;r.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:t.getValueAtIndexOrDefault(n.hoverBackgroundColor,a,t.getHoverColor(r.backgroundColor)),r.borderColor=i.hoverBorderColor?i.hoverBorderColor:t.getValueAtIndexOrDefault(n.hoverBorderColor,a,t.getHoverColor(r.borderColor)),r.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:t.getValueAtIndexOrDefault(n.hoverBorderWidth,a,r.borderWidth)},removeHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=e._model,s=this.chart.options.elements.rectangle;r.backgroundColor=i.backgroundColor?i.backgroundColor:t.getValueAtIndexOrDefault(n.backgroundColor,a,s.backgroundColor),r.borderColor=i.borderColor?i.borderColor:t.getValueAtIndexOrDefault(n.borderColor,a,s.borderColor),r.borderWidth=i.borderWidth?i.borderWidth:t.getValueAtIndexOrDefault(n.borderWidth,a,s.borderWidth)}}),e.defaults.horizontalBar={hover:{mode:"label"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{position:"left",type:"category",categoryPercentage:.8,barPercentage:.9,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{callbacks:{title:function(e,t){var n="";return e.length>0&&(e[0].yLabel?n=e[0].yLabel:t.labels.length>0&&e[0].index<t.labels.length&&(n=t.labels[e[0].index])),n},label:function(e,t){var n=t.datasets[e.datasetIndex].label||"";return n+": "+e.xLabel}}}},e.controllers.horizontalBar=e.controllers.bar.extend({updateElement:function(e,n,a){var i=this.getMeta(),r=this.getScaleForId(i.xAxisID),s=this.getScaleForId(i.yAxisID),o=r.getBasePixel(),l=e.custom||{},d=this.getDataset(),c=this.chart.options.elements.rectangle;t.extend(e,{_xScale:r,_yScale:s,_datasetIndex:this.index,_index:n,_model:{x:a?o:this.calculateBarX(n,this.index),y:this.calculateBarY(n,this.index),label:this.chart.data.labels[n],datasetLabel:d.label,base:a?o:this.calculateBarBase(this.index,n),height:this.calculateBarHeight(n),backgroundColor:l.backgroundColor?l.backgroundColor:t.getValueAtIndexOrDefault(d.backgroundColor,n,c.backgroundColor),borderSkipped:l.borderSkipped?l.borderSkipped:c.borderSkipped,borderColor:l.borderColor?l.borderColor:t.getValueAtIndexOrDefault(d.borderColor,n,c.borderColor),borderWidth:l.borderWidth?l.borderWidth:t.getValueAtIndexOrDefault(d.borderWidth,n,c.borderWidth)},draw:function(){function e(e){return l[(c+e)%4]}var t=this._chart.ctx,n=this._view,a=n.height/2,i=n.y-a,r=n.y+a,s=n.base-(n.base-n.x),o=n.borderWidth/2;n.borderWidth&&(i+=o,r-=o,s+=o),t.beginPath(),t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth;var l=[[n.base,r],[n.base,i],[s,i],[s,r]],d=["bottom","left","top","right"],c=d.indexOf(n.borderSkipped,0);-1===c&&(c=0),t.moveTo.apply(t,e(0));for(var u=1;4>u;u++)t.lineTo.apply(t,e(u));t.fill(),n.borderWidth&&t.stroke()},inRange:function(e,t){var n=this._view,a=!1;return n&&(a=n.x<n.base?t>=n.y-n.height/2&&t<=n.y+n.height/2&&e>=n.x&&e<=n.base:t>=n.y-n.height/2&&t<=n.y+n.height/2&&e>=n.base&&e<=n.x),a}}),e.pivot()},calculateBarBase:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.xAxisID),i=0;if(a.options.stacked){var r=this.chart.data.datasets[e].data[t];if(0>r)for(var s=0;e>s;s++){var o=this.chart.data.datasets[s],l=this.chart.getDatasetMeta(s);l.bar&&l.xAxisID===a.id&&this.chart.isDatasetVisible(s)&&(i+=o.data[t]<0?o.data[t]:0)}else for(var d=0;e>d;d++){var c=this.chart.data.datasets[d],u=this.chart.getDatasetMeta(d);u.bar&&u.xAxisID===a.id&&this.chart.isDatasetVisible(d)&&(i+=c.data[t]>0?c.data[t]:0)}return a.getPixelForValue(i)}return a.getBasePixel()},getRuler:function(e){var t,n=this.getMeta(),a=this.getScaleForId(n.yAxisID),i=this.getBarCount();t="category"===a.options.type?a.getPixelForTick(e+1)-a.getPixelForTick(e):a.width/a.ticks.length;var r=t*a.options.categoryPercentage,s=(t-t*a.options.categoryPercentage)/2,o=r/i;if(a.ticks.length!==this.chart.data.labels.length){var l=a.ticks.length/this.chart.data.labels.length;o*=l}var d=o*a.options.barPercentage,c=o-o*a.options.barPercentage;return{datasetCount:i,tickHeight:t,categoryHeight:r,categorySpacing:s,fullBarHeight:o,barHeight:d,barSpacing:c}},calculateBarHeight:function(e){var t=this.getScaleForId(this.getMeta().yAxisID),n=this.getRuler(e);return t.options.stacked?n.categoryHeight:n.barHeight},calculateBarX:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.xAxisID),i=this.getDataset().data[e];if(a.options.stacked){for(var r=0,s=0,o=0;t>o;o++){var l=this.chart.data.datasets[o],d=this.chart.getDatasetMeta(o);d.bar&&d.xAxisID===a.id&&this.chart.isDatasetVisible(o)&&(l.data[e]<0?s+=l.data[e]||0:r+=l.data[e]||0)}return 0>i?a.getPixelForValue(s+i):a.getPixelForValue(r+i)}return a.getPixelForValue(i)},calculateBarY:function(e,t){var n=this.getMeta(),a=this.getScaleForId(n.yAxisID),i=this.getBarIndex(t),r=this.getRuler(e),s=a.getPixelForValue(null,e,t,this.chart.isCombo);return s-=this.chart.isCombo?r.tickHeight/2:0,a.options.stacked?s+r.categoryHeight/2+r.categorySpacing:s+r.barHeight/2+r.categorySpacing+r.barHeight*i+r.barSpacing/2+r.barSpacing*i}})}},{}],16:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.bubble={hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.datasets[e.datasetIndex].label||"",a=t.datasets[e.datasetIndex].data[e.index];return n+": ("+a.x+", "+a.y+", "+a.r+")"}}}},e.controllers.bubble=e.DatasetController.extend({dataElementType:e.elements.Point,update:function(e){var n=this.getMeta(),a=n.data;t.each(a,function(t,n){this.updateElement(t,n,e)},this)},updateElement:function(e,n,a){var i=this.getMeta(),r=this.getScaleForId(i.xAxisID),s=this.getScaleForId(i.yAxisID),o=e.custom||{},l=this.getDataset(),d=l.data[n],c=this.chart.options.elements.point;t.extend(e,{_xScale:r,_yScale:s,_datasetIndex:this.index,_index:n,_model:{x:a?r.getPixelForDecimal(.5):r.getPixelForValue(d,n,this.index,this.chart.isCombo),y:a?s.getBasePixel():s.getPixelForValue(d,n,this.index),radius:a?0:o.radius?o.radius:this.getRadius(d),backgroundColor:o.backgroundColor?o.backgroundColor:t.getValueAtIndexOrDefault(l.backgroundColor,n,c.backgroundColor),borderColor:o.borderColor?o.borderColor:t.getValueAtIndexOrDefault(l.borderColor,n,c.borderColor),borderWidth:o.borderWidth?o.borderWidth:t.getValueAtIndexOrDefault(l.borderWidth,n,c.borderWidth),hitRadius:o.hitRadius?o.hitRadius:t.getValueAtIndexOrDefault(l.hitRadius,n,c.hitRadius)}});var u=e._model;u.skip=o.skip?o.skip:isNaN(u.x)||isNaN(u.y),e.pivot()},getRadius:function(e){return e.r||this.chart.options.elements.point.radius},setHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=e._model;r.radius=i.hoverRadius?i.hoverRadius:t.getValueAtIndexOrDefault(n.hoverRadius,a,this.chart.options.elements.point.hoverRadius)+this.getRadius(this.getDataset().data[e._index]),r.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:t.getValueAtIndexOrDefault(n.hoverBackgroundColor,a,t.getHoverColor(r.backgroundColor)),r.borderColor=i.hoverBorderColor?i.hoverBorderColor:t.getValueAtIndexOrDefault(n.hoverBorderColor,a,t.getHoverColor(r.borderColor)),r.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:t.getValueAtIndexOrDefault(n.hoverBorderWidth,a,r.borderWidth)},removeHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=e._model,s=this.chart.options.elements.point;r.radius=i.radius?i.radius:this.getRadius(n.data[e._index]),r.backgroundColor=i.backgroundColor?i.backgroundColor:t.getValueAtIndexOrDefault(n.backgroundColor,a,s.backgroundColor),r.borderColor=i.borderColor?i.borderColor:t.getValueAtIndexOrDefault(n.borderColor,a,s.borderColor),r.borderWidth=i.borderWidth?i.borderWidth:t.getValueAtIndexOrDefault(n.borderWidth,a,s.borderWidth)}})}},{}],17:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=e.defaults;n.doughnut={animation:{animateRotate:!0,animateScale:!1},aspectRatio:1,hover:{mode:"single"},legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');var n=e.data,a=n.datasets,i=n.labels;if(a.length)for(var r=0;r<a[0].data.length;++r)t.push('<li><span style="background-color:'+a[0].backgroundColor[r]+'"></span>'),i[r]&&t.push(i[r]),t.push("</li>");return t.push("</ul>"),t.join("")},legend:{labels:{generateLabels:function(e){var n=e.data;return n.labels.length&&n.datasets.length?n.labels.map(function(a,i){var r=e.getDatasetMeta(0),s=n.datasets[0],o=r.data[i],l=o.custom||{},d=t.getValueAtIndexOrDefault,c=e.options.elements.arc,u=l.backgroundColor?l.backgroundColor:d(s.backgroundColor,i,c.backgroundColor),g=l.borderColor?l.borderColor:d(s.borderColor,i,c.borderColor),p=l.borderWidth?l.borderWidth:d(s.borderWidth,i,c.borderWidth);return{text:a,fillStyle:u,strokeStyle:g,lineWidth:p,hidden:isNaN(s.data[i])||r.data[i].hidden,index:i}}):[]}},onClick:function(e,t){var n,a,i,r=t.index,s=this.chart;for(n=0,a=(s.data.datasets||[]).length;a>n;++n)i=s.getDatasetMeta(n),i.data[r].hidden=!i.data[r].hidden;s.update()}},cutoutPercentage:50,rotation:Math.PI*-.5,circumference:2*Math.PI,tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+t.datasets[e.datasetIndex].data[e.index]}}}},n.pie=t.clone(n.doughnut),t.extend(n.pie,{cutoutPercentage:0}),e.controllers.doughnut=e.controllers.pie=e.DatasetController.extend({dataElementType:e.elements.Arc,linkScales:t.noop,getRingIndex:function(e){for(var t=0,n=0;e>n;++n)this.chart.isDatasetVisible(n)&&++t;return t},update:function(e){var n=this,a=n.chart,i=a.chartArea,r=a.options,s=r.elements.arc,o=i.right-i.left-s.borderWidth,l=i.bottom-i.top-s.borderWidth,d=Math.min(o,l),c={x:0,y:0},u=n.getMeta(),g=r.cutoutPercentage,p=r.circumference;if(p<2*Math.PI){var m=r.rotation%(2*Math.PI);m+=2*Math.PI*(m>=Math.PI?-1:m<-Math.PI?1:0);var h=m+p,f={x:Math.cos(m),y:Math.sin(m)},v={x:Math.cos(h),y:Math.sin(h)},b=0>=m&&h>=0||m<=2*Math.PI&&2*Math.PI<=h,w=m<=.5*Math.PI&&.5*Math.PI<=h||m<=2.5*Math.PI&&2.5*Math.PI<=h,y=m<=-Math.PI&&-Math.PI<=h||m<=Math.PI&&Math.PI<=h,_=m<=.5*-Math.PI&&.5*-Math.PI<=h||m<=1.5*Math.PI&&1.5*Math.PI<=h,x=g/100,C={x:y?-1:Math.min(f.x*(f.x<0?1:x),v.x*(v.x<0?1:x)),y:_?-1:Math.min(f.y*(f.y<0?1:x),v.y*(v.y<0?1:x))},D={x:b?1:Math.max(f.x*(f.x>0?1:x),v.x*(v.x>0?1:x)),y:w?1:Math.max(f.y*(f.y>0?1:x),v.y*(v.y>0?1:x))},k={width:.5*(D.x-C.x),height:.5*(D.y-C.y)};d=Math.min(o/k.width,l/k.height),c={x:(D.x+C.x)*-.5,y:(D.y+C.y)*-.5}}a.outerRadius=Math.max(d/2,0),a.innerRadius=Math.max(g?a.outerRadius/100*g:1,0),a.radiusLength=(a.outerRadius-a.innerRadius)/a.getVisibleDatasetCount(),a.offsetX=c.x*a.outerRadius,a.offsetY=c.y*a.outerRadius,u.total=n.calculateTotal(),n.outerRadius=a.outerRadius-a.radiusLength*n.getRingIndex(n.index),n.innerRadius=n.outerRadius-a.radiusLength,t.each(u.data,function(t,a){n.updateElement(t,a,e)})},updateElement:function(e,n,a){var i=this,r=i.chart,s=r.chartArea,o=r.options,l=o.animation,d=o.elements.arc,c=(s.left+s.right)/2,u=(s.top+s.bottom)/2,g=o.rotation,p=o.rotation,m=i.getDataset(),h=a&&l.animateRotate?0:e.hidden?0:i.calculateCircumference(m.data[n])*(o.circumference/(2*Math.PI)),f=a&&l.animateScale?0:i.innerRadius,v=a&&l.animateScale?0:i.outerRadius,b=e.custom||{},w=t.getValueAtIndexOrDefault;t.extend(e,{_datasetIndex:i.index,_index:n,_model:{x:c+r.offsetX,y:u+r.offsetY,startAngle:g,endAngle:p,circumference:h,outerRadius:v,innerRadius:f,label:w(m.label,n,r.data.labels[n])}});var y=e._model;y.backgroundColor=b.backgroundColor?b.backgroundColor:w(m.backgroundColor,n,d.backgroundColor),y.hoverBackgroundColor=b.hoverBackgroundColor?b.hoverBackgroundColor:w(m.hoverBackgroundColor,n,d.hoverBackgroundColor),y.borderWidth=b.borderWidth?b.borderWidth:w(m.borderWidth,n,d.borderWidth),y.borderColor=b.borderColor?b.borderColor:w(m.borderColor,n,d.borderColor),a&&l.animateRotate||(y.startAngle=0===n?o.rotation:i.getMeta().data[n-1]._model.endAngle,y.endAngle=y.startAngle+y.circumference),e.pivot()},removeHoverStyle:function(t){e.DatasetController.prototype.removeHoverStyle.call(this,t,this.chart.options.elements.arc)},calculateTotal:function(){var e,n=this.getDataset(),a=this.getMeta(),i=0;return t.each(a.data,function(t,a){e=n.data[a],isNaN(e)||t.hidden||(i+=Math.abs(e))}),i},calculateCircumference:function(e){var t=this.getMeta().total;return t>0&&!isNaN(e)?2*Math.PI*(e/t):0}})}},{}],18:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.line={showLines:!0,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}},e.controllers.line=e.DatasetController.extend({datasetElementType:e.elements.Line,dataElementType:e.elements.Point,addElementAndReset:function(t){var n=this,a=n.chart.options;e.DatasetController.prototype.addElementAndReset.call(n,t),a.showLines&&0!==a.elements.line.tension&&n.updateBezierControlPoints()},update:function(e){var n,a,i,r,s=this,o=s.getMeta(),l=o.dataset,d=o.data||[],c=s.chart.options,u=c.elements.line,g=s.getScaleForId(o.yAxisID);for(c.showLines&&(i=s.getDataset(),r=l.custom||{},void 0!==i.tension&&void 0===i.lineTension&&(i.lineTension=i.tension),l._scale=g,l._datasetIndex=s.index,l._children=d,l._model={tension:r.tension?r.tension:t.getValueOrDefault(i.lineTension,u.tension),backgroundColor:r.backgroundColor?r.backgroundColor:i.backgroundColor||u.backgroundColor,borderWidth:r.borderWidth?r.borderWidth:i.borderWidth||u.borderWidth,borderColor:r.borderColor?r.borderColor:i.borderColor||u.borderColor,borderCapStyle:r.borderCapStyle?r.borderCapStyle:i.borderCapStyle||u.borderCapStyle,borderDash:r.borderDash?r.borderDash:i.borderDash||u.borderDash,borderDashOffset:r.borderDashOffset?r.borderDashOffset:i.borderDashOffset||u.borderDashOffset,borderJoinStyle:r.borderJoinStyle?r.borderJoinStyle:i.borderJoinStyle||u.borderJoinStyle,fill:r.fill?r.fill:void 0!==i.fill?i.fill:u.fill,scaleTop:g.top,scaleBottom:g.bottom,scaleZero:g.getBasePixel()},l.pivot()),n=0,a=d.length;a>n;++n)s.updateElement(d[n],n,e);c.showLines&&0!==u.tension&&s.updateBezierControlPoints()},getPointBackgroundColor:function(e,n){var a=this.chart.options.elements.point.backgroundColor,i=this.getDataset(),r=e.custom||{};return r.backgroundColor?a=r.backgroundColor:i.pointBackgroundColor?a=t.getValueAtIndexOrDefault(i.pointBackgroundColor,n,a):i.backgroundColor&&(a=i.backgroundColor),a},getPointBorderColor:function(e,n){var a=this.chart.options.elements.point.borderColor,i=this.getDataset(),r=e.custom||{};return r.borderColor?a=r.borderColor:i.pointBorderColor?a=t.getValueAtIndexOrDefault(i.pointBorderColor,n,a):i.borderColor&&(a=i.borderColor),a},getPointBorderWidth:function(e,n){var a=this.chart.options.elements.point.borderWidth,i=this.getDataset(),r=e.custom||{};return r.borderWidth?a=r.borderWidth:i.pointBorderWidth?a=t.getValueAtIndexOrDefault(i.pointBorderWidth,n,a):i.borderWidth&&(a=i.borderWidth),a},updateElement:function(e,n,a){var i,r,s=this,o=s.getMeta(),l=e.custom||{},d=s.getDataset(),c=s.index,u=d.data[n],g=s.getScaleForId(o.yAxisID),p=s.getScaleForId(o.xAxisID),m=s.chart.options.elements.point;void 0!==d.radius&&void 0===d.pointRadius&&(d.pointRadius=d.radius),void 0!==d.hitRadius&&void 0===d.pointHitRadius&&(d.pointHitRadius=d.hitRadius),i=p.getPixelForValue(u,n,c,s.chart.isCombo),r=a?g.getBasePixel():s.calculatePointY(u,n,c,s.chart.isCombo),e._xScale=p,e._yScale=g,e._datasetIndex=c,e._index=n,e._model={x:i,y:r,skip:l.skip||isNaN(i)||isNaN(r),radius:l.radius||t.getValueAtIndexOrDefault(d.pointRadius,n,m.radius),pointStyle:l.pointStyle||t.getValueAtIndexOrDefault(d.pointStyle,n,m.pointStyle),backgroundColor:s.getPointBackgroundColor(e,n),borderColor:s.getPointBorderColor(e,n),borderWidth:s.getPointBorderWidth(e,n),tension:o.dataset._model?o.dataset._model.tension:0,hitRadius:l.hitRadius||t.getValueAtIndexOrDefault(d.pointHitRadius,n,m.hitRadius)}},calculatePointY:function(e,t,n){var a,i,r,s=this,o=s.chart,l=s.getMeta(),d=s.getScaleForId(l.yAxisID),c=0,u=0;if(d.options.stacked){for(a=0;n>a;a++)i=o.data.datasets[a],r=o.getDatasetMeta(a),"line"===r.type&&o.isDatasetVisible(a)&&(i.data[t]<0?u+=i.data[t]||0:c+=i.data[t]||0);return 0>e?d.getPixelForValue(u+e):d.getPixelForValue(c+e)}return d.getPixelForValue(e)},updateBezierControlPoints:function(){var e,n,a,i,r,s=this.getMeta(),o=this.chart.chartArea,l=s.data||[];for(e=0,n=l.length;n>e;++e)a=l[e],i=a._model,r=t.splineCurve(t.previousItem(l,e)._model,i,t.nextItem(l,e)._model,s.dataset._model.tension),i.controlPointPreviousX=Math.max(Math.min(r.previous.x,o.right),o.left),i.controlPointPreviousY=Math.max(Math.min(r.previous.y,o.bottom),o.top),i.controlPointNextX=Math.max(Math.min(r.next.x,o.right),o.left),i.controlPointNextY=Math.max(Math.min(r.next.y,o.bottom),o.top),a.pivot()},draw:function(e){var t,n,a=this.getMeta(),i=a.data||[],r=e||1;for(t=0,n=i.length;n>t;++t)i[t].transition(r);for(this.chart.options.showLines&&a.dataset.transition(r).draw(),t=0,n=i.length;n>t;++t)i[t].draw()},setHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=e._model;r.radius=i.hoverRadius||t.getValueAtIndexOrDefault(n.pointHoverRadius,a,this.chart.options.elements.point.hoverRadius),r.backgroundColor=i.hoverBackgroundColor||t.getValueAtIndexOrDefault(n.pointHoverBackgroundColor,a,t.getHoverColor(r.backgroundColor)),r.borderColor=i.hoverBorderColor||t.getValueAtIndexOrDefault(n.pointHoverBorderColor,a,t.getHoverColor(r.borderColor)),r.borderWidth=i.hoverBorderWidth||t.getValueAtIndexOrDefault(n.pointHoverBorderWidth,a,r.borderWidth)},removeHoverStyle:function(e){var n=this,a=n.chart.data.datasets[e._datasetIndex],i=e._index,r=e.custom||{},s=e._model;void 0!==a.radius&&void 0===a.pointRadius&&(a.pointRadius=a.radius),s.radius=r.radius||t.getValueAtIndexOrDefault(a.pointRadius,i,n.chart.options.elements.point.radius),s.backgroundColor=n.getPointBackgroundColor(e,i),s.borderColor=n.getPointBorderColor(e,i),s.borderWidth=n.getPointBorderWidth(e,i)}})}},{}],19:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.polarArea={scale:{type:"radialLinear",lineArc:!0},animation:{animateRotate:!0,animateScale:!0},aspectRatio:1,legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');var n=e.data,a=n.datasets,i=n.labels;if(a.length)for(var r=0;r<a[0].data.length;++r)t.push('<li><span style="background-color:'+a[0].backgroundColor[r]+'">'),i[r]&&t.push(i[r]),t.push("</span></li>");return t.push("</ul>"),t.join("")},legend:{labels:{generateLabels:function(e){var n=e.data;return n.labels.length&&n.datasets.length?n.labels.map(function(a,i){var r=e.getDatasetMeta(0),s=n.datasets[0],o=r.data[i],l=o.custom||{},d=t.getValueAtIndexOrDefault,c=e.options.elements.arc,u=l.backgroundColor?l.backgroundColor:d(s.backgroundColor,i,c.backgroundColor),g=l.borderColor?l.borderColor:d(s.borderColor,i,c.borderColor),p=l.borderWidth?l.borderWidth:d(s.borderWidth,i,c.borderWidth);return{text:a,fillStyle:u,strokeStyle:g,lineWidth:p,hidden:isNaN(s.data[i])||r.data[i].hidden,index:i}}):[]}},onClick:function(e,t){var n,a,i,r=t.index,s=this.chart;for(n=0,a=(s.data.datasets||[]).length;a>n;++n)i=s.getDatasetMeta(n),i.data[r].hidden=!i.data[r].hidden;s.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}},e.controllers.polarArea=e.DatasetController.extend({dataElementType:e.elements.Arc,linkScales:t.noop,update:function(e){var n=this,a=n.chart,i=a.chartArea,r=this.getMeta(),s=a.options,o=s.elements.arc,l=Math.min(i.right-i.left,i.bottom-i.top);a.outerRadius=Math.max((l-o.borderWidth/2)/2,0),a.innerRadius=Math.max(s.cutoutPercentage?a.outerRadius/100*s.cutoutPercentage:1,0),a.radiusLength=(a.outerRadius-a.innerRadius)/a.getVisibleDatasetCount(),n.outerRadius=a.outerRadius-a.radiusLength*n.index,n.innerRadius=n.outerRadius-a.radiusLength,r.count=n.countVisibleElements(),t.each(r.data,function(t,a){n.updateElement(t,a,e)})},updateElement:function(e,n,a){for(var i=this,r=i.chart,s=r.chartArea,o=i.getDataset(),l=r.options,d=l.animation,c=l.elements.arc,u=e.custom||{},g=r.scale,p=t.getValueAtIndexOrDefault,m=r.data.labels,h=i.calculateCircumference(o.data[n]),f=(s.left+s.right)/2,v=(s.top+s.bottom)/2,b=0,w=i.getMeta(),y=0;n>y;++y)isNaN(o.data[y])||w.data[y].hidden||++b;var _=e.hidden?0:g.getDistanceFromCenterForValue(o.data[n]),x=-.5*Math.PI+h*b,C=x+(e.hidden?0:h),D={x:f,y:v,innerRadius:0,outerRadius:d.animateScale?0:g.getDistanceFromCenterForValue(o.data[n]),startAngle:d.animateRotate?Math.PI*-.5:x,endAngle:d.animateRotate?Math.PI*-.5:C,backgroundColor:u.backgroundColor?u.backgroundColor:p(o.backgroundColor,n,c.backgroundColor),borderWidth:u.borderWidth?u.borderWidth:p(o.borderWidth,n,c.borderWidth),borderColor:u.borderColor?u.borderColor:p(o.borderColor,n,c.borderColor),label:p(m,n,m[n])};t.extend(e,{_datasetIndex:i.index,_index:n,_scale:g,_model:a?D:{x:f,y:v,innerRadius:0,outerRadius:_,startAngle:x,endAngle:C,backgroundColor:u.backgroundColor?u.backgroundColor:p(o.backgroundColor,n,c.backgroundColor),borderWidth:u.borderWidth?u.borderWidth:p(o.borderWidth,n,c.borderWidth),borderColor:u.borderColor?u.borderColor:p(o.borderColor,n,c.borderColor),label:p(m,n,m[n])}}),e.pivot()},removeHoverStyle:function(t){e.DatasetController.prototype.removeHoverStyle.call(this,t,this.chart.options.elements.arc)},countVisibleElements:function(){var e=this.getDataset(),n=this.getMeta(),a=0;return t.each(n.data,function(t,n){isNaN(e.data[n])||t.hidden||a++}),a},calculateCircumference:function(e){var t=this.getMeta().count;return t>0&&!isNaN(e)?2*Math.PI/t:0}})}},{}],20:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.radar={scale:{type:"radialLinear"},elements:{line:{tension:0}}},e.controllers.radar=e.DatasetController.extend({datasetElementType:e.elements.Line,dataElementType:e.elements.Point,linkScales:t.noop,addElementAndReset:function(t){e.DatasetController.prototype.addElementAndReset.call(this,t),this.updateBezierControlPoints()},update:function(e){var n=this.getMeta(),a=n.dataset,i=n.data,r=a.custom||{},s=this.getDataset(),o=this.chart.options.elements.line,l=this.chart.scale;void 0!==s.tension&&void 0===s.lineTension&&(s.lineTension=s.tension),t.extend(n.dataset,{_datasetIndex:this.index,_children:i,_loop:!0,_model:{tension:r.tension?r.tension:t.getValueOrDefault(s.lineTension,o.tension),backgroundColor:r.backgroundColor?r.backgroundColor:s.backgroundColor||o.backgroundColor,borderWidth:r.borderWidth?r.borderWidth:s.borderWidth||o.borderWidth,borderColor:r.borderColor?r.borderColor:s.borderColor||o.borderColor,fill:r.fill?r.fill:void 0!==s.fill?s.fill:o.fill,borderCapStyle:r.borderCapStyle?r.borderCapStyle:s.borderCapStyle||o.borderCapStyle,borderDash:r.borderDash?r.borderDash:s.borderDash||o.borderDash,borderDashOffset:r.borderDashOffset?r.borderDashOffset:s.borderDashOffset||o.borderDashOffset,borderJoinStyle:r.borderJoinStyle?r.borderJoinStyle:s.borderJoinStyle||o.borderJoinStyle,scaleTop:l.top,scaleBottom:l.bottom,scaleZero:l.getBasePosition()}}),n.dataset.pivot(),t.each(i,function(t,n){this.updateElement(t,n,e)},this),this.updateBezierControlPoints()},updateElement:function(e,n,a){var i=e.custom||{},r=this.getDataset(),s=this.chart.scale,o=this.chart.options.elements.point,l=s.getPointPositionForValue(n,r.data[n]);t.extend(e,{_datasetIndex:this.index,_index:n,_scale:s,_model:{x:a?s.xCenter:l.x,y:a?s.yCenter:l.y,tension:i.tension?i.tension:t.getValueOrDefault(r.tension,this.chart.options.elements.line.tension),radius:i.radius?i.radius:t.getValueAtIndexOrDefault(r.pointRadius,n,o.radius),backgroundColor:i.backgroundColor?i.backgroundColor:t.getValueAtIndexOrDefault(r.pointBackgroundColor,n,o.backgroundColor),borderColor:i.borderColor?i.borderColor:t.getValueAtIndexOrDefault(r.pointBorderColor,n,o.borderColor),borderWidth:i.borderWidth?i.borderWidth:t.getValueAtIndexOrDefault(r.pointBorderWidth,n,o.borderWidth),pointStyle:i.pointStyle?i.pointStyle:t.getValueAtIndexOrDefault(r.pointStyle,n,o.pointStyle),hitRadius:i.hitRadius?i.hitRadius:t.getValueAtIndexOrDefault(r.hitRadius,n,o.hitRadius)}}),e._model.skip=i.skip?i.skip:isNaN(e._model.x)||isNaN(e._model.y)},updateBezierControlPoints:function(){var e=this.chart.chartArea,n=this.getMeta();t.each(n.data,function(a,i){var r=a._model,s=t.splineCurve(t.previousItem(n.data,i,!0)._model,r,t.nextItem(n.data,i,!0)._model,r.tension);r.controlPointPreviousX=Math.max(Math.min(s.previous.x,e.right),e.left),r.controlPointPreviousY=Math.max(Math.min(s.previous.y,e.bottom),e.top),r.controlPointNextX=Math.max(Math.min(s.next.x,e.right),e.left),r.controlPointNextY=Math.max(Math.min(s.next.y,e.bottom),e.top),a.pivot()},this)},draw:function(e){var n=this.getMeta(),a=e||1;t.each(n.data,function(e){e.transition(a)}),n.dataset.transition(a).draw(),t.each(n.data,function(e){e.draw()})},setHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e.custom||{},i=e._index,r=e._model;r.radius=a.hoverRadius?a.hoverRadius:t.getValueAtIndexOrDefault(n.pointHoverRadius,i,this.chart.options.elements.point.hoverRadius),r.backgroundColor=a.hoverBackgroundColor?a.hoverBackgroundColor:t.getValueAtIndexOrDefault(n.pointHoverBackgroundColor,i,t.getHoverColor(r.backgroundColor)),r.borderColor=a.hoverBorderColor?a.hoverBorderColor:t.getValueAtIndexOrDefault(n.pointHoverBorderColor,i,t.getHoverColor(r.borderColor)),r.borderWidth=a.hoverBorderWidth?a.hoverBorderWidth:t.getValueAtIndexOrDefault(n.pointHoverBorderWidth,i,r.borderWidth)},removeHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e.custom||{},i=e._index,r=e._model,s=this.chart.options.elements.point;r.radius=a.radius?a.radius:t.getValueAtIndexOrDefault(n.radius,i,s.radius),r.backgroundColor=a.backgroundColor?a.backgroundColor:t.getValueAtIndexOrDefault(n.pointBackgroundColor,i,s.backgroundColor),r.borderColor=a.borderColor?a.borderColor:t.getValueAtIndexOrDefault(n.pointBorderColor,i,s.borderColor),r.borderWidth=a.borderWidth?a.borderWidth:t.getValueAtIndexOrDefault(n.pointBorderWidth,i,s.borderWidth)}})}},{}],21:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.global.animation={duration:1e3,easing:"easeOutQuart",onProgress:t.noop,onComplete:t.noop},e.Animation=e.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),e.animationService={frameDuration:17,animations:[],dropFrames:0,request:null,addAnimation:function(e,t,n,a){a||(e.animating=!0);for(var i=0;i<this.animations.length;++i)if(this.animations[i].chartInstance===e)return void(this.animations[i].animationObject=t);this.animations.push({chartInstance:e,animationObject:t}),1===this.animations.length&&this.requestAnimationFrame()},cancelAnimation:function(e){var n=t.findIndex(this.animations,function(t){return t.chartInstance===e});-1!==n&&(this.animations.splice(n,1),e.animating=!1)},requestAnimationFrame:function(){var e=this;null===e.request&&(e.request=t.requestAnimFrame.call(window,function(){e.request=null,e.startDigest()}))},startDigest:function(){var e=Date.now(),t=0;this.dropFrames>1&&(t=Math.floor(this.dropFrames),this.dropFrames=this.dropFrames%1);for(var n=0;n<this.animations.length;)null===this.animations[n].animationObject.currentStep&&(this.animations[n].animationObject.currentStep=0),this.animations[n].animationObject.currentStep+=1+t,this.animations[n].animationObject.currentStep>this.animations[n].animationObject.numSteps&&(this.animations[n].animationObject.currentStep=this.animations[n].animationObject.numSteps),this.animations[n].animationObject.render(this.animations[n].chartInstance,this.animations[n].animationObject),this.animations[n].animationObject.onAnimationProgress&&this.animations[n].animationObject.onAnimationProgress.call&&this.animations[n].animationObject.onAnimationProgress.call(this.animations[n].chartInstance,this.animations[n]),this.animations[n].animationObject.currentStep===this.animations[n].animationObject.numSteps?(this.animations[n].animationObject.onAnimationComplete&&this.animations[n].animationObject.onAnimationComplete.call&&this.animations[n].animationObject.onAnimationComplete.call(this.animations[n].chartInstance,this.animations[n]),this.animations[n].chartInstance.animating=!1,this.animations.splice(n,1)):++n;var a=Date.now(),i=(a-e)/this.frameDuration;this.dropFrames+=i,this.animations.length>0&&this.requestAnimationFrame()}}}},{}],22:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.types={},e.instances={},e.controllers={},e.Controller=function(n){return this.chart=n,this.config=n.config,this.options=this.config.options=t.configMerge(e.defaults.global,e.defaults[this.config.type],this.config.options||{}),this.id=t.uid(),Object.defineProperty(this,"data",{get:function(){return this.config.data}}),e.instances[this.id]=this,this.options.responsive&&this.resize(!0),this.initialize(),this},t.extend(e.Controller.prototype,{initialize:function(){return e.pluginService.notifyPlugins("beforeInit",[this]),this.bindEvents(),this.ensureScalesHaveIDs(),this.buildOrUpdateControllers(),this.buildScales(),this.buildSurroundingItems(),this.updateLayout(),this.resetElements(),this.initToolTip(),this.update(),e.pluginService.notifyPlugins("afterInit",[this]),this},clear:function(){return t.clear(this.chart),this},stop:function(){return e.animationService.cancelAnimation(this),this},resize:function(e){var n=this.chart.canvas,a=t.getMaximumWidth(this.chart.canvas),i=this.options.maintainAspectRatio&&isNaN(this.chart.aspectRatio)===!1&&isFinite(this.chart.aspectRatio)&&0!==this.chart.aspectRatio?a/this.chart.aspectRatio:t.getMaximumHeight(this.chart.canvas),r=this.chart.width!==a||this.chart.height!==i;return r?(n.width=this.chart.width=a,n.height=this.chart.height=i,t.retinaScale(this.chart),e||(this.stop(),this.update(this.options.responsiveAnimationDuration)),this):this},ensureScalesHaveIDs:function(){var e=this.options,n=e.scales||{},a=e.scale;t.each(n.xAxes,function(e,t){e.id=e.id||"x-axis-"+t}),t.each(n.yAxes,function(e,t){e.id=e.id||"y-axis-"+t}),a&&(a.id=a.id||"scale")
},buildScales:function(){var n=this,a=n.options,i=n.scales={},r=[];a.scales&&(r=r.concat((a.scales.xAxes||[]).map(function(e){return{options:e,dtype:"category"}}),(a.scales.yAxes||[]).map(function(e){return{options:e,dtype:"linear"}}))),a.scale&&r.push({options:a.scale,dtype:"radialLinear",isDefault:!0}),t.each(r,function(a){var r=a.options,s=t.getValueOrDefault(r.type,a.dtype),o=e.scaleService.getScaleConstructor(s);if(o){var l=new o({id:r.id,options:r,ctx:n.chart.ctx,chart:n});i[l.id]=l,a.isDefault&&(n.scale=l)}}),e.scaleService.addScalesToLayout(this)},buildSurroundingItems:function(){this.options.title&&(this.titleBlock=new e.Title({ctx:this.chart.ctx,options:this.options.title,chart:this}),e.layoutService.addBox(this,this.titleBlock)),this.options.legend&&(this.legend=new e.Legend({ctx:this.chart.ctx,options:this.options.legend,chart:this}),e.layoutService.addBox(this,this.legend))},updateLayout:function(){e.layoutService.update(this,this.chart.width,this.chart.height)},buildOrUpdateControllers:function(){var n=[],a=[];if(t.each(this.data.datasets,function(t,i){var r=this.getDatasetMeta(i);r.type||(r.type=t.type||this.config.type),n.push(r.type),r.controller?r.controller.updateIndex(i):(r.controller=new e.controllers[r.type](this,i),a.push(r.controller))},this),n.length>1)for(var i=1;i<n.length;i++)if(n[i]!==n[i-1]){this.isCombo=!0;break}return a},resetElements:function(){t.each(this.data.datasets,function(e,t){this.getDatasetMeta(t).controller.reset()},this)},update:function(n,a){e.pluginService.notifyPlugins("beforeUpdate",[this]),this.tooltip._data=this.data;var i=this.buildOrUpdateControllers();t.each(this.data.datasets,function(e,t){this.getDatasetMeta(t).controller.buildOrUpdateElements()},this),e.layoutService.update(this,this.chart.width,this.chart.height),e.pluginService.notifyPlugins("afterScaleUpdate",[this]),t.each(i,function(e){e.reset()}),t.each(this.data.datasets,function(e,t){this.getDatasetMeta(t).controller.update()},this),e.pluginService.notifyPlugins("afterUpdate",[this]),this.render(n,a)},render:function(n,a){e.pluginService.notifyPlugins("beforeRender",[this]);var i=this.options.animation;if(i&&("undefined"!=typeof n&&0!==n||"undefined"==typeof n&&0!==i.duration)){var r=new e.Animation;r.numSteps=(n||i.duration)/16.66,r.easing=i.easing,r.render=function(e,n){var a=t.easingEffects[n.easing],i=n.currentStep/n.numSteps,r=a(i);e.draw(r,i,n.currentStep)},r.onAnimationProgress=i.onProgress,r.onAnimationComplete=i.onComplete,e.animationService.addAnimation(this,r,n,a)}else this.draw(),i&&i.onComplete&&i.onComplete.call&&i.onComplete.call(this);return this},draw:function(n){var a=n||1;this.clear(),e.pluginService.notifyPlugins("beforeDraw",[this,a]),t.each(this.boxes,function(e){e.draw(this.chartArea)},this),this.scale&&this.scale.draw();var i=this.chart.ctx;i.save(),i.beginPath(),i.rect(this.chartArea.left,this.chartArea.top,this.chartArea.right-this.chartArea.left,this.chartArea.bottom-this.chartArea.top),i.clip(),t.each(this.data.datasets,function(e,t){this.isDatasetVisible(t)&&this.getDatasetMeta(t).controller.draw(n)},this,!0),i.restore(),this.tooltip.transition(a).draw(),e.pluginService.notifyPlugins("afterDraw",[this,a])},getElementAtEvent:function(e){var n=t.getRelativePosition(e,this.chart),a=[];return t.each(this.data.datasets,function(e,i){if(this.isDatasetVisible(i)){var r=this.getDatasetMeta(i);t.each(r.data,function(e){return e.inRange(n.x,n.y)?(a.push(e),a):void 0})}},this),a},getElementsAtEvent:function(e){var n=t.getRelativePosition(e,this.chart),a=[],i=function(){if(this.data.datasets)for(var e=0;e<this.data.datasets.length;e++){var t=this.getDatasetMeta(e);if(this.isDatasetVisible(e))for(var a=0;a<t.data.length;a++)if(t.data[a].inRange(n.x,n.y))return t.data[a]}}.call(this);return i?(t.each(this.data.datasets,function(e,t){if(this.isDatasetVisible(t)){var n=this.getDatasetMeta(t);a.push(n.data[i._index])}},this),a):a},getElementsAtEventForMode:function(e,t){var n=this;switch(t){case"single":return n.getElementAtEvent(e);case"label":return n.getElementsAtEvent(e);case"dataset":return n.getDatasetAtEvent(e);default:return e}},getDatasetAtEvent:function(e){var t=this.getElementAtEvent(e);return t.length>0&&(t=this.getDatasetMeta(t[0]._datasetIndex).data),t},getDatasetMeta:function(e){var t=this.data.datasets[e];t._meta||(t._meta={});var n=t._meta[this.id];return n||(n=t._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null}),n},getVisibleDatasetCount:function(){for(var e=0,t=0,n=this.data.datasets.length;n>t;++t)this.isDatasetVisible(t)&&e++;return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return"boolean"==typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroy:function(){this.clear(),t.unbindEvents(this,this.events),t.removeResizeListener(this.chart.canvas.parentNode);var n=this.chart.canvas;n.width=this.chart.width,n.height=this.chart.height,void 0!==this.chart.originalDevicePixelRatio&&this.chart.ctx.scale(1/this.chart.originalDevicePixelRatio,1/this.chart.originalDevicePixelRatio),n.style.width=this.chart.originalCanvasStyleWidth,n.style.height=this.chart.originalCanvasStyleHeight,e.pluginService.notifyPlugins("destroy",[this]),delete e.instances[this.id]},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)},initToolTip:function(){this.tooltip=new e.Tooltip({_chart:this.chart,_chartInstance:this,_data:this.data,_options:this.options},this)},bindEvents:function(){t.bindEvents(this,this.options.events,function(e){this.eventHandler(e)})},updateHoverStyle:function(e,t,n){var a,i,r,s=n?"setHoverStyle":"removeHoverStyle";switch(t){case"single":e=[e[0]];break;case"label":case"dataset":break;default:return}for(i=0,r=e.length;r>i;++i)a=e[i],a&&this.getDatasetMeta(a._datasetIndex).controller[s](a)},eventHandler:function(e){var n=this,a=n.tooltip,i=n.options||{},r=i.hover,s=i.tooltips;return n.lastActive=n.lastActive||[],n.lastTooltipActive=n.lastTooltipActive||[],"mouseout"===e.type?(n.active=[],n.tooltipActive=[]):(n.active=n.getElementsAtEventForMode(e,r.mode),n.tooltipActive=n.getElementsAtEventForMode(e,s.mode)),r.onHover&&r.onHover.call(n,n.active),("mouseup"===e.type||"click"===e.type)&&(i.onClick&&i.onClick.call(n,e,n.active),n.legend&&n.legend.handleEvent&&n.legend.handleEvent(e)),n.lastActive.length&&n.updateHoverStyle(n.lastActive,r.mode,!1),n.active.length&&r.mode&&n.updateHoverStyle(n.active,r.mode,!0),(s.enabled||s.custom)&&(a.initialize(),a._active=n.tooltipActive,a.update(!0)),a.pivot(),n.animating||t.arrayEquals(n.active,n.lastActive)&&t.arrayEquals(n.tooltipActive,n.lastTooltipActive)||(n.stop(),(s.enabled||s.custom)&&a.update(!0),n.render(r.animationDuration,!0)),n.lastActive=n.active,n.lastTooltipActive=n.tooltipActive,n}})}},{}],23:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=t.noop;e.DatasetController=function(e,t){this.initialize.call(this,e,t)},t.extend(e.DatasetController.prototype,{datasetElementType:null,dataElementType:null,initialize:function(e,t){this.chart=e,this.index=t,this.linkScales(),this.addElements()},updateIndex:function(e){this.index=e},linkScales:function(){var e=this.getMeta(),t=this.getDataset();null===e.xAxisID&&(e.xAxisID=t.xAxisID||this.chart.options.scales.xAxes[0].id),null===e.yAxisID&&(e.yAxisID=t.yAxisID||this.chart.options.scales.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},reset:function(){this.update(!0)},createMetaDataset:function(){var e=this,t=e.datasetElementType;return t&&new t({_chart:e.chart.chart,_datasetIndex:e.index})},createMetaData:function(e){var t=this,n=t.dataElementType;return n&&new n({_chart:t.chart.chart,_datasetIndex:t.index,_index:e})},addElements:function(){var e,t,n=this,a=n.getMeta(),i=n.getDataset().data||[],r=a.data;for(e=0,t=i.length;t>e;++e)r[e]=r[e]||n.createMetaData(a,e);a.dataset=a.dataset||n.createMetaDataset()},addElementAndReset:function(e){var t=this,n=t.createMetaData(e);t.getMeta().data.splice(e,0,n),t.updateElement(n,e,!0)},buildOrUpdateElements:function(){var e=this.getMeta(),t=e.data,n=this.getDataset().data.length,a=t.length;if(a>n)t.splice(n,a-n);else if(n>a)for(var i=a;n>i;++i)this.addElementAndReset(i)},update:n,draw:function(e){var n=e||1;t.each(this.getMeta().data,function(e){e.transition(n).draw()})},removeHoverStyle:function(e,n){var a=this.chart.data.datasets[e._datasetIndex],i=e._index,r=e.custom||{},s=t.getValueAtIndexOrDefault,o=(t.color,e._model);o.backgroundColor=r.backgroundColor?r.backgroundColor:s(a.backgroundColor,i,n.backgroundColor),o.borderColor=r.borderColor?r.borderColor:s(a.borderColor,i,n.borderColor),o.borderWidth=r.borderWidth?r.borderWidth:s(a.borderWidth,i,n.borderWidth)},setHoverStyle:function(e){var n=this.chart.data.datasets[e._datasetIndex],a=e._index,i=e.custom||{},r=t.getValueAtIndexOrDefault,s=(t.color,t.getHoverColor),o=e._model;o.backgroundColor=i.hoverBackgroundColor?i.hoverBackgroundColor:r(n.hoverBackgroundColor,a,s(o.backgroundColor)),o.borderColor=i.hoverBorderColor?i.hoverBorderColor:r(n.hoverBorderColor,a,s(o.borderColor)),o.borderWidth=i.hoverBorderWidth?i.hoverBorderWidth:r(n.hoverBorderWidth,a,o.borderWidth)}}),e.DatasetController.extend=t.inherits}},{}],24:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.elements={},e.Element=function(e){t.extend(this,e),this.initialize.apply(this,arguments)},t.extend(e.Element.prototype,{initialize:function(){this.hidden=!1},pivot:function(){return this._view||(this._view=t.clone(this._model)),this._start=t.clone(this._view),this},transition:function(e){return this._view||(this._view=t.clone(this._model)),1===e?(this._view=this._model,this._start=null,this):(this._start||this.pivot(),t.each(this._model,function(n,a){if("_"===a[0]);else if(this._view.hasOwnProperty(a))if(n===this._view[a]);else if("string"==typeof n)try{var i=t.color(this._model[a]).mix(t.color(this._start[a]),e);this._view[a]=i.rgbString()}catch(r){this._view[a]=n}else if("number"==typeof n){var s=void 0!==this._start[a]&&isNaN(this._start[a])===!1?this._start[a]:0;this._view[a]=(this._model[a]-s)*e+s}else this._view[a]=n;else this._view[a]="number"!=typeof n||isNaN(this._view[a])?n:n*e},this),this)},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return t.isNumber(this._model.x)&&t.isNumber(this._model.y)}}),e.Element.extend=t.inherits}},{}],25:[function(e,t){"use strict";var n=e("chartjs-color");t.exports=function(e){function t(e,t,n){var a;return"string"==typeof e?(a=parseInt(e,10),-1!=e.indexOf("%")&&(a=a/100*t.parentNode[n])):a=e,a}function a(e){return void 0!==e&&null!==e&&"none"!==e}function i(e,n,i){var r=document.defaultView,s=e.parentNode,o=r.getComputedStyle(e)[n],l=r.getComputedStyle(s)[n],d=a(o),c=a(l),u=Number.POSITIVE_INFINITY;return d||c?Math.min(d?t(o,e,i):u,c?t(l,s,i):u):"none"}var r=e.helpers={};r.each=function(e,t,n,a){var i,s;if(r.isArray(e))if(s=e.length,a)for(i=s-1;i>=0;i--)t.call(n,e[i],i);else for(i=0;s>i;i++)t.call(n,e[i],i);else if("object"==typeof e){var o=Object.keys(e);for(s=o.length,i=0;s>i;i++)t.call(n,e[o[i]],o[i])}},r.clone=function(e){var t={};return r.each(e,function(e,n){t[n]=r.isArray(e)?e.slice(0):"object"==typeof e&&null!==e?r.clone(e):e}),t},r.extend=function(e){for(var t=arguments.length,n=[],a=1;t>a;a++)n.push(arguments[a]);return r.each(n,function(t){r.each(t,function(t,n){e[n]=t})}),e},r.configMerge=function(t){var n=r.clone(t);return r.each(Array.prototype.slice.call(arguments,1),function(t){r.each(t,function(t,a){if("scales"===a)n[a]=r.scaleMerge(n.hasOwnProperty(a)?n[a]:{},t);else if("scale"===a)n[a]=r.configMerge(n.hasOwnProperty(a)?n[a]:{},e.scaleService.getScaleDefaults(t.type),t);else if(n.hasOwnProperty(a)&&r.isArray(n[a])&&r.isArray(t)){var i=n[a];r.each(t,function(e,t){t<i.length?i[t]="object"==typeof i[t]&&null!==i[t]&&"object"==typeof e&&null!==e?r.configMerge(i[t],e):e:i.push(e)})}else n[a]=n.hasOwnProperty(a)&&"object"==typeof n[a]&&null!==n[a]&&"object"==typeof t?r.configMerge(n[a],t):t})}),n},r.extendDeep=function(){function e(t){return r.each(arguments,function(n){n!==t&&r.each(n,function(n,a){t[a]&&t[a].constructor&&t[a].constructor===Object?e(t[a],n):t[a]=n})}),t}return e.apply(this,arguments)},r.scaleMerge=function(t,n){var a=r.clone(t);return r.each(n,function(t,n){"xAxes"===n||"yAxes"===n?a.hasOwnProperty(n)?r.each(t,function(t,i){var s=r.getValueOrDefault(t.type,"xAxes"===n?"category":"linear"),o=e.scaleService.getScaleDefaults(s);i>=a[n].length||!a[n][i].type?a[n].push(r.configMerge(o,t)):a[n][i]=t.type&&t.type!==a[n][i].type?r.configMerge(a[n][i],o,t):r.configMerge(a[n][i],t)}):(a[n]=[],r.each(t,function(t){var i=r.getValueOrDefault(t.type,"xAxes"===n?"category":"linear");a[n].push(r.configMerge(e.scaleService.getScaleDefaults(i),t))})):a[n]=a.hasOwnProperty(n)&&"object"==typeof a[n]&&null!==a[n]&&"object"==typeof t?r.configMerge(a[n],t):t}),a},r.getValueAtIndexOrDefault=function(e,t,n){return void 0===e||null===e?n:r.isArray(e)?t<e.length?e[t]:n:e},r.getValueOrDefault=function(e,t){return void 0===e?t:e},r.indexOf=function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},r.where=function(e,t){if(r.isArray(e)&&Array.prototype.filter)return e.filter(t);var n=[];return r.each(e,function(e){t(e)&&n.push(e)}),n},r.findIndex=function(e,t,n){var a=-1;if(Array.prototype.findIndex)a=e.findIndex(t,n);else for(var i=0;i<e.length;++i)if(n=void 0!==n?n:e,t.call(n,e[i],i,e)){a=i;break}return a},r.findNextWhere=function(e,t,n){(void 0===n||null===n)&&(n=-1);for(var a=n+1;a<e.length;a++){var i=e[a];if(t(i))return i}},r.findPreviousWhere=function(e,t,n){(void 0===n||null===n)&&(n=e.length);for(var a=n-1;a>=0;a--){var i=e[a];if(t(i))return i}},r.inherits=function(e){var t=this,n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},a=function(){this.constructor=n};return a.prototype=t.prototype,n.prototype=new a,n.extend=r.inherits,e&&r.extend(n.prototype,e),n.__super__=t.prototype,n},r.noop=function(){},r.uid=function(){var e=0;return function(){return e++}}(),r.warn=function(e){console&&"function"==typeof console.warn&&console.warn(e)},r.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r.almostEquals=function(e,t,n){return Math.abs(e-t)<n},r.max=function(e){return e.reduce(function(e,t){return isNaN(t)?e:Math.max(e,t)},Number.NEGATIVE_INFINITY)},r.min=function(e){return e.reduce(function(e,t){return isNaN(t)?e:Math.min(e,t)},Number.POSITIVE_INFINITY)},r.sign=function(e){return Math.sign?Math.sign(e):(e=+e,0===e||isNaN(e)?e:e>0?1:-1)},r.log10=function(e){return Math.log10?Math.log10(e):Math.log(e)/Math.LN10},r.toRadians=function(e){return e*(Math.PI/180)},r.toDegrees=function(e){return e*(180/Math.PI)},r.getAngleFromPoint=function(e,t){var n=t.x-e.x,a=t.y-e.y,i=Math.sqrt(n*n+a*a),r=Math.atan2(a,n);return r<-.5*Math.PI&&(r+=2*Math.PI),{angle:r,distance:i}},r.aliasPixel=function(e){return e%2===0?0:.5},r.splineCurve=function(e,t,n,a){var i=e.skip?t:e,r=t,s=n.skip?t:n,o=Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)),l=Math.sqrt(Math.pow(s.x-r.x,2)+Math.pow(s.y-r.y,2)),d=o/(o+l),c=l/(o+l);d=isNaN(d)?0:d,c=isNaN(c)?0:c;var u=a*d,g=a*c;return{previous:{x:r.x-u*(s.x-i.x),y:r.y-u*(s.y-i.y)},next:{x:r.x+g*(s.x-i.x),y:r.y+g*(s.y-i.y)}}},r.nextItem=function(e,t,n){return n?t>=e.length-1?e[0]:e[t+1]:t>=e.length-1?e[e.length-1]:e[t+1]},r.previousItem=function(e,t,n){return n?0>=t?e[e.length-1]:e[t-1]:0>=t?e[0]:e[t-1]},r.niceNum=function(e,t){var n,a=Math.floor(r.log10(e)),i=e/Math.pow(10,a);return n=t?1.5>i?1:3>i?2:7>i?5:10:1>=i?1:2>=i?2:5>=i?5:10,n*Math.pow(10,a)};var s=r.easingEffects={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-1*e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1*((e=e/1-1)*e*e+1)},easeInOutCubic:function(e){return(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-1*((e=e/1-1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return 1*(e/=1)*e*e*e*e},easeOutQuint:function(e){return 1*((e=e/1-1)*e*e*e*e+1)},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return-1*Math.cos(e/1*(Math.PI/2))+1},easeOutSine:function(e){return 1*Math.sin(e/1*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e/1)-1)},easeInExpo:function(e){return 0===e?1:1*Math.pow(2,10*(e/1-1))},easeOutExpo:function(e){return 1===e?1:1*(-Math.pow(2,-10*e/1)+1)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(-Math.pow(2,-10*--e)+2)},easeInCirc:function(e){return e>=1?e:-1*(Math.sqrt(1-(e/=1)*e)-1)},easeOutCirc:function(e){return 1*Math.sqrt(1-(e=e/1-1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeInElastic:function(e){var t=1.70158,n=0,a=1;return 0===e?0:1===(e/=1)?1:(n||(n=.3),a<Math.abs(1)?(a=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/a),-(a*Math.pow(2,10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n)))},easeOutElastic:function(e){var t=1.70158,n=0,a=1;return 0===e?0:1===(e/=1)?1:(n||(n=.3),a<Math.abs(1)?(a=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/a),a*Math.pow(2,-10*e)*Math.sin(2*(1*e-t)*Math.PI/n)+1)},easeInOutElastic:function(e){var t=1.70158,n=0,a=1;return 0===e?0:2===(e/=.5)?1:(n||(n=.3*1.5),a<Math.abs(1)?(a=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/a),1>e?-.5*a*Math.pow(2,10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n):a*Math.pow(2,-10*(e-=1))*Math.sin(2*(1*e-t)*Math.PI/n)*.5+1)},easeInBack:function(e){var t=1.70158;return 1*(e/=1)*e*((t+1)*e-t)},easeOutBack:function(e){var t=1.70158;return 1*((e=e/1-1)*e*((t+1)*e+t)+1)},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?.5*e*e*(((t*=1.525)+1)*e-t):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:function(e){return 1-s.easeOutBounce(1-e)},easeOutBounce:function(e){return(e/=1)<1/2.75?7.5625*e*e:2/2.75>e?1*(7.5625*(e-=1.5/2.75)*e+.75):2.5/2.75>e?1*(7.5625*(e-=2.25/2.75)*e+.9375):1*(7.5625*(e-=2.625/2.75)*e+.984375)},easeInOutBounce:function(e){return.5>e?.5*s.easeInBounce(2*e):.5*s.easeOutBounce(2*e-1)+.5}};r.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}(),r.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(e){return window.clearTimeout(e,1e3/60)}}(),r.getRelativePosition=function(e,t){var n,a,i=e.originalEvent||e,s=e.currentTarget||e.srcElement,o=s.getBoundingClientRect(),l=i.touches;l&&l.length>0?(n=l[0].clientX,a=l[0].clientY):(n=i.clientX,a=i.clientY);var d=parseFloat(r.getStyle(s,"padding-left")),c=parseFloat(r.getStyle(s,"padding-top")),u=parseFloat(r.getStyle(s,"padding-right")),g=parseFloat(r.getStyle(s,"padding-bottom")),p=o.right-o.left-d-u,m=o.bottom-o.top-c-g;return n=Math.round((n-o.left-d)/p*s.width/t.currentDevicePixelRatio),a=Math.round((a-o.top-c)/m*s.height/t.currentDevicePixelRatio),{x:n,y:a}},r.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},r.removeEvent=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=r.noop},r.bindEvents=function(e,t,n){var a=e.events=e.events||{};r.each(t,function(t){a[t]=function(){n.apply(e,arguments)},r.addEvent(e.chart.canvas,t,a[t])})},r.unbindEvents=function(e,t){var n=e.chart.canvas;r.each(t,function(e,t){r.removeEvent(n,t,e)})},r.getConstraintWidth=function(e){return i(e,"max-width","clientWidth")},r.getConstraintHeight=function(e){return i(e,"max-height","clientHeight")},r.getMaximumWidth=function(e){var t=e.parentNode,n=parseInt(r.getStyle(t,"padding-left"))+parseInt(r.getStyle(t,"padding-right")),a=t.clientWidth-n,i=r.getConstraintWidth(e);return isNaN(i)?a:Math.min(a,i)},r.getMaximumHeight=function(e){var t=e.parentNode,n=parseInt(r.getStyle(t,"padding-top"))+parseInt(r.getStyle(t,"padding-bottom")),a=t.clientHeight-n,i=r.getConstraintHeight(e);return isNaN(i)?a:Math.min(a,i)},r.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},r.retinaScale=function(e){var t=e.ctx,n=e.canvas,a=n.width,i=n.height,r=e.currentDevicePixelRatio=window.devicePixelRatio||1;1!==r&&(n.height=i*r,n.width=a*r,t.scale(r,r),e.originalDevicePixelRatio=e.originalDevicePixelRatio||r),n.style.width=a+"px",n.style.height=i+"px"},r.clear=function(e){e.ctx.clearRect(0,0,e.width,e.height)},r.fontString=function(e,t,n){return t+" "+e+"px "+n},r.longestText=function(e,t,n,a){a=a||{};var i=a.data=a.data||{},s=a.garbageCollect=a.garbageCollect||[];a.font!==t&&(i=a.data={},s=a.garbageCollect=[],a.font=t),e.font=t;var o=0;r.each(n,function(t){if(void 0!==t&&null!==t){var n=i[t];n||(n=i[t]=e.measureText(t).width,s.push(t)),n>o&&(o=n)}});var l=s.length/2;if(l>n.length){for(var d=0;l>d;d++)delete i[s[d]];s.splice(0,l)}return o},r.drawRoundedRectangle=function(e,t,n,a,i,r){e.beginPath(),e.moveTo(t+r,n),e.lineTo(t+a-r,n),e.quadraticCurveTo(t+a,n,t+a,n+r),e.lineTo(t+a,n+i-r),e.quadraticCurveTo(t+a,n+i,t+a-r,n+i),e.lineTo(t+r,n+i),e.quadraticCurveTo(t,n+i,t,n+i-r),e.lineTo(t,n+r),e.quadraticCurveTo(t,n,t+r,n),e.closePath()},r.color=function(t){return n?n(t instanceof CanvasGradient?e.defaults.global.defaultColor:t):(console.log("Color.js not found!"),t)},r.addResizeListener=function(e,t){var n=document.createElement("iframe"),a="chartjs-hidden-iframe";n.classlist?n.classlist.add(a):n.setAttribute("class",a);var i=n.style;i.width="100%",i.display="block",i.border=0,i.height=0,i.margin=0,i.position="absolute",i.left=0,i.right=0,i.top=0,i.bottom=0,e.insertBefore(n,e.firstChild),(n.contentWindow||n).onresize=function(){t&&t()}},r.removeResizeListener=function(e){var t=e.querySelector(".chartjs-hidden-iframe");t&&t.parentNode.removeChild(t)},r.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},r.arrayEquals=function(e,t){var n,a,i,s;if(!e||!t||e.length!=t.length)return!1;for(n=0,a=e.length;a>n;++n)if(i=e[n],s=t[n],i instanceof Array&&s instanceof Array){if(!r.arrayEquals(i,s))return!1}else if(i!=s)return!1;return!0},r.pushAllIfDefined=function(e,t){"undefined"!=typeof e&&(r.isArray(e)?t.push.apply(t,e):t.push(e))},r.callCallback=function(e,t,n){e&&"function"==typeof e.call&&e.apply(n,t)},r.getHoverColor=function(e){return e instanceof CanvasPattern?e:r.color(e).saturate(.5).darken(.1).rgbString()}}},{"chartjs-color":3}],26:[function(e,t){"use strict";t.exports=function(){var e=function(t,n){this.config=n,t.length&&t[0].getContext&&(t=t[0]),t.getContext&&(t=t.getContext("2d")),this.ctx=t,this.canvas=t.canvas,this.width=t.canvas.width||parseInt(e.helpers.getStyle(t.canvas,"width"))||e.helpers.getMaximumWidth(t.canvas),this.height=t.canvas.height||parseInt(e.helpers.getStyle(t.canvas,"height"))||e.helpers.getMaximumHeight(t.canvas),this.aspectRatio=this.width/this.height,(isNaN(this.aspectRatio)||isFinite(this.aspectRatio)===!1)&&(this.aspectRatio=void 0!==n.aspectRatio?n.aspectRatio:2),this.originalCanvasStyleWidth=t.canvas.style.width,this.originalCanvasStyleHeight=t.canvas.style.height,e.helpers.retinaScale(this),n&&(this.controller=new e.Controller(this));var a=this;return e.helpers.addResizeListener(t.canvas.parentNode,function(){a.controller&&a.controller.config.options.responsive&&a.controller.resize()}),this.controller?this.controller:this};return e.defaults={global:{responsive:!0,responsiveAnimationDuration:0,maintainAspectRatio:!0,events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"single",animationDuration:400},onClick:null,defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",showLines:!0,elements:{},legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');for(var n=0;n<e.data.datasets.length;n++)t.push('<li><span style="background-color:'+e.data.datasets[n].backgroundColor+'"></span>'),e.data.datasets[n].label&&t.push(e.data.datasets[n].label),t.push("</li>");return t.push("</ul>"),t.join("")}}},e}},{}],27:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.layoutService={defaults:{},addBox:function(e,t){e.boxes||(e.boxes=[]),e.boxes.push(t)},removeBox:function(e,t){e.boxes&&e.boxes.splice(e.boxes.indexOf(t),1)},update:function(e,n,a){function i(e){var t,n=e.isHorizontal();n?(t=e.update(e.options.fullWidth?h:_,y),x-=t.height):(t=e.update(w,b),_-=t.width),C.push({horizontal:n,minSize:t,box:e})}function r(e){var n=t.findNextWhere(C,function(t){return t.box===e});if(n)if(e.isHorizontal()){var a={left:D,right:k,top:0,bottom:0};e.update(e.options.fullWidth?h:_,f/2,a)}else e.update(n.minSize.width,x)}function s(e){var n=t.findNextWhere(C,function(t){return t.box===e}),a={left:0,right:0,top:S,bottom:M};n&&e.update(n.minSize.width,x,a)}function o(e){e.isHorizontal()?(e.left=e.options.fullWidth?l:D,e.right=e.options.fullWidth?n-l:D+_,e.top=P,e.bottom=P+e.height,P=e.bottom):(e.left=A,e.right=A+e.width,e.top=S,e.bottom=S+x,A=e.right)}if(e){var l=0,d=0,c=t.where(e.boxes,function(e){return"left"===e.options.position}),u=t.where(e.boxes,function(e){return"right"===e.options.position}),g=t.where(e.boxes,function(e){return"top"===e.options.position}),p=t.where(e.boxes,function(e){return"bottom"===e.options.position}),m=t.where(e.boxes,function(e){return"chartArea"===e.options.position});g.sort(function(e,t){return(t.options.fullWidth?1:0)-(e.options.fullWidth?1:0)}),p.sort(function(e,t){return(e.options.fullWidth?1:0)-(t.options.fullWidth?1:0)});var h=n-2*l,f=a-2*d,v=h/2,b=f/2,w=(n-v)/(c.length+u.length),y=(a-b)/(g.length+p.length),_=h,x=f,C=[];t.each(c.concat(u,g,p),i);var D=l,k=l,S=d,M=d;t.each(c.concat(u),r),t.each(c,function(e){D+=e.width}),t.each(u,function(e){k+=e.width}),t.each(g.concat(p),r),t.each(g,function(e){S+=e.height}),t.each(p,function(e){M+=e.height}),t.each(c.concat(u),s),D=l,k=l,S=d,M=d,t.each(c,function(e){D+=e.width}),t.each(u,function(e){k+=e.width}),t.each(g,function(e){S+=e.height}),t.each(p,function(e){M+=e.height});var E=a-S-M,T=n-D-k;(T!==_||E!==x)&&(t.each(c,function(e){e.height=E}),t.each(u,function(e){e.height=E}),t.each(g,function(e){e.options.fullWidth||(e.width=T)}),t.each(p,function(e){e.options.fullWidth||(e.width=T)}),x=E,_=T);var A=l,P=d;t.each(c.concat(g),o),A+=_,P+=x,t.each(u,o),t.each(p,o),e.chartArea={left:D,top:S,right:D+_,bottom:S+x},t.each(m,function(t){t.left=e.chartArea.left,t.top=e.chartArea.top,t.right=e.chartArea.right,t.bottom=e.chartArea.bottom,t.update(_,x)})}}}}},{}],28:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=t.noop;e.defaults.global.legend={display:!0,position:"top",fullWidth:!0,reverse:!1,onClick:function(e,t){var n=t.datasetIndex,a=this.chart,i=a.getDatasetMeta(n);i.hidden=null===i.hidden?!a.data.datasets[n].hidden:null,a.update()},labels:{boxWidth:40,padding:10,generateLabels:function(e){var n=e.data;return t.isArray(n.datasets)?n.datasets.map(function(t,n){return{text:t.label,fillStyle:t.backgroundColor,hidden:!e.isDatasetVisible(n),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,datasetIndex:n}},this):[]}}},e.Legend=e.Element.extend({initialize:function(e){t.extend(this,e),this.legendHitBoxes=[],this.doughnutMode=!1},beforeUpdate:n,update:function(e,t,n){return this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this.margins=n,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeBuildLabels(),this.buildLabels(),this.afterBuildLabels(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:n,beforeSetDimensions:n,setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.minSize={width:0,height:0}},afterSetDimensions:n,beforeBuildLabels:n,buildLabels:function(){this.legendItems=this.options.labels.generateLabels.call(this,this.chart),this.options.reverse&&this.legendItems.reverse()},afterBuildLabels:n,beforeFit:n,fit:function(){var n=this.options,a=n.labels,i=n.display,r=this.ctx,s=e.defaults.global,o=t.getValueOrDefault,l=o(a.fontSize,s.defaultFontSize),d=o(a.fontStyle,s.defaultFontStyle),c=o(a.fontFamily,s.defaultFontFamily),u=t.fontString(l,d,c),g=this.legendHitBoxes=[],p=this.minSize,m=this.isHorizontal();if(m?(p.width=this.maxWidth,p.height=i?10:0):(p.width=i?10:0,p.height=this.maxHeight),i&&m){var h=this.lineWidths=[0],f=this.legendItems.length?l+a.padding:0;r.textAlign="left",r.textBaseline="top",r.font=u,t.each(this.legendItems,function(e,t){var n=a.boxWidth+l/2+r.measureText(e.text).width;h[h.length-1]+n+a.padding>=this.width&&(f+=l+a.padding,h[h.length]=this.left),g[t]={left:0,top:0,width:n,height:l},h[h.length-1]+=n+a.padding},this),p.height+=f}this.width=p.width,this.height=p.height},afterFit:n,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var n=this.options,a=n.labels,i=e.defaults.global,r=i.elements.line,s=this.width,o=this.lineWidths;if(n.display){var l=this.ctx,d={x:this.left+(s-o[0])/2,y:this.top+a.padding,line:0},c=t.getValueOrDefault,u=c(a.fontColor,i.defaultFontColor),g=c(a.fontSize,i.defaultFontSize),p=c(a.fontStyle,i.defaultFontStyle),m=c(a.fontFamily,i.defaultFontFamily),h=t.fontString(g,p,m);if(this.isHorizontal()){l.textAlign="left",l.textBaseline="top",l.lineWidth=.5,l.strokeStyle=u,l.fillStyle=u,l.font=h;var f=a.boxWidth,v=this.legendHitBoxes;t.each(this.legendItems,function(e,t){var n=l.measureText(e.text).width,u=f+g/2+n,p=d.x,m=d.y;p+u>=s&&(m=d.y+=g+a.padding,d.line++,p=d.x=this.left+(s-o[d.line])/2),l.save(),l.fillStyle=c(e.fillStyle,i.defaultColor),l.lineCap=c(e.lineCap,r.borderCapStyle),l.lineDashOffset=c(e.lineDashOffset,r.borderDashOffset),l.lineJoin=c(e.lineJoin,r.borderJoinStyle),l.lineWidth=c(e.lineWidth,r.borderWidth),l.strokeStyle=c(e.strokeStyle,i.defaultColor),l.setLineDash&&l.setLineDash(c(e.lineDash,r.borderDash)),l.strokeRect(p,m,f,g),l.fillRect(p,m,f,g),l.restore(),v[t].left=p,v[t].top=m,l.fillText(e.text,f+g/2+p,m),e.hidden&&(l.beginPath(),l.lineWidth=2,l.moveTo(f+g/2+p,m+g/2),l.lineTo(f+g/2+p+n,m+g/2),l.stroke()),d.x+=u+a.padding},this)}}},handleEvent:function(e){var n=t.getRelativePosition(e,this.chart.chart),a=n.x,i=n.y,r=this.options;if(a>=this.left&&a<=this.right&&i>=this.top&&i<=this.bottom)for(var s=this.legendHitBoxes,o=0;o<s.length;++o){var l=s[o];if(a>=l.left&&a<=l.left+l.width&&i>=l.top&&i<=l.top+l.height){r.onClick&&r.onClick.call(this,e,this.legendItems[o]);break}}}})}},{}],29:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.plugins=[],e.pluginService={register:function(t){var n=e.plugins;-1===n.indexOf(t)&&n.push(t)},remove:function(t){var n=e.plugins,a=n.indexOf(t);-1!==a&&n.splice(a,1)},notifyPlugins:function(n,a,i){t.each(e.plugins,function(e){e[n]&&"function"==typeof e[n]&&e[n].apply(i,a)},i)}};var n=t.noop;e.PluginBase=e.Element.extend({beforeInit:n,afterInit:n,beforeUpdate:n,afterUpdate:n,beforeDraw:n,afterDraw:n,destroy:n})
}},{}],30:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.scale={display:!0,position:"left",gridLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",offsetGridLines:!1},scaleLabel:{labelString:"",display:!1},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:10,reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:function(e){return""+e}}},e.Scale=e.Element.extend({beforeUpdate:function(){t.callCallback(this.options.beforeUpdate,[this])},update:function(e,n,a){return this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this.margins=t.extend({left:0,right:0,top:0,bottom:0},a),this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this.beforeBuildTicks(),this.buildTicks(),this.afterBuildTicks(),this.beforeTickToLabelConversion(),this.convertTicksToLabels(),this.afterTickToLabelConversion(),this.beforeCalculateTickRotation(),this.calculateTickRotation(),this.afterCalculateTickRotation(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:function(){t.callCallback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){t.callCallback(this.options.beforeSetDimensions,[this])},setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0},afterSetDimensions:function(){t.callCallback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){t.callCallback(this.options.beforeDataLimits,[this])},determineDataLimits:t.noop,afterDataLimits:function(){t.callCallback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){t.callCallback(this.options.beforeBuildTicks,[this])},buildTicks:t.noop,afterBuildTicks:function(){t.callCallback(this.options.afterBuildTicks,[this])},beforeTickToLabelConversion:function(){t.callCallback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){this.ticks=this.ticks.map(function(e,t,n){return this.options.ticks.userCallback?this.options.ticks.userCallback(e,t,n):this.options.ticks.callback(e,t,n)},this)},afterTickToLabelConversion:function(){t.callCallback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){t.callCallback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var n=this.ctx,a=e.defaults.global,i=this.options.ticks,r=t.getValueOrDefault(i.fontSize,a.defaultFontSize),s=t.getValueOrDefault(i.fontStyle,a.defaultFontStyle),o=t.getValueOrDefault(i.fontFamily,a.defaultFontFamily),l=t.fontString(r,s,o);n.font=l;var d,c=n.measureText(this.ticks[0]).width,u=n.measureText(this.ticks[this.ticks.length-1]).width;if(this.labelRotation=i.minRotation||0,this.paddingRight=0,this.paddingLeft=0,this.options.display&&this.isHorizontal()){this.paddingRight=u/2+3,this.paddingLeft=c/2+3,this.longestTextCache||(this.longestTextCache={});for(var g,p,m=t.longestText(n,l,this.ticks,this.longestTextCache),h=m,f=this.getPixelForTick(1)-this.getPixelForTick(0)-6;h>f&&this.labelRotation<i.maxRotation;){if(g=Math.cos(t.toRadians(this.labelRotation)),p=Math.sin(t.toRadians(this.labelRotation)),d=g*c,d+r/2>this.yLabelWidth&&(this.paddingLeft=d+r/2),this.paddingRight=r/2,p*m>this.maxHeight){this.labelRotation--;break}this.labelRotation++,h=g*m}}this.margins&&(this.paddingLeft=Math.max(this.paddingLeft-this.margins.left,0),this.paddingRight=Math.max(this.paddingRight-this.margins.right,0))},afterCalculateTickRotation:function(){t.callCallback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){t.callCallback(this.options.beforeFit,[this])},fit:function(){var n=this.minSize={width:0,height:0},a=this.options,i=e.defaults.global,r=a.ticks,s=a.scaleLabel,o=a.display,l=this.isHorizontal(),d=t.getValueOrDefault(r.fontSize,i.defaultFontSize),c=t.getValueOrDefault(r.fontStyle,i.defaultFontStyle),u=t.getValueOrDefault(r.fontFamily,i.defaultFontFamily),g=t.fontString(d,c,u),p=t.getValueOrDefault(s.fontSize,i.defaultFontSize),m=t.getValueOrDefault(s.fontStyle,i.defaultFontStyle),h=t.getValueOrDefault(s.fontFamily,i.defaultFontFamily),f=(t.fontString(p,m,h),a.gridLines.tickMarkLength);if(n.width=l?this.isFullWidth()?this.maxWidth-this.margins.left-this.margins.right:this.maxWidth:o?f:0,n.height=l?o?f:0:this.maxHeight,s.display&&o&&(l?n.height+=1.5*p:n.width+=1.5*p),r.display&&o){this.longestTextCache||(this.longestTextCache={});var v=t.longestText(this.ctx,g,this.ticks,this.longestTextCache);if(l){this.longestLabelWidth=v;var b=Math.sin(t.toRadians(this.labelRotation))*this.longestLabelWidth+1.5*d;n.height=Math.min(this.maxHeight,n.height+b),this.ctx.font=g;var w=this.ctx.measureText(this.ticks[0]).width,y=this.ctx.measureText(this.ticks[this.ticks.length-1]).width,_=Math.cos(t.toRadians(this.labelRotation)),x=Math.sin(t.toRadians(this.labelRotation));this.paddingLeft=0!==this.labelRotation?_*w+3:w/2+3,this.paddingRight=0!==this.labelRotation?x*(d/2)+3:y/2+3}else{var C=this.maxWidth-n.width,D=r.mirror;D?v=0:v+=this.options.ticks.padding,C>v?n.width+=v:n.width=this.maxWidth,this.paddingTop=d/2,this.paddingBottom=d/2}}this.margins&&(this.paddingLeft=Math.max(this.paddingLeft-this.margins.left,0),this.paddingTop=Math.max(this.paddingTop-this.margins.top,0),this.paddingRight=Math.max(this.paddingRight-this.margins.right,0),this.paddingBottom=Math.max(this.paddingBottom-this.margins.bottom,0)),this.width=n.width,this.height=n.height},afterFit:function(){t.callCallback(this.options.afterFit,[this])},isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},isFullWidth:function(){return this.options.fullWidth},getRightValue:function n(e){return null===e||"undefined"==typeof e?0/0:"number"==typeof e&&isNaN(e)?0/0:"object"==typeof e?e instanceof Date||e.isValid?e:n(this.isHorizontal()?e.x:e.y):e},getLabelForIndex:t.noop,getPixelForValue:t.noop,getValueForPixel:t.noop,getPixelForTick:function(e,t){if(this.isHorizontal()){var n=this.width-(this.paddingLeft+this.paddingRight),a=n/Math.max(this.ticks.length-(this.options.gridLines.offsetGridLines?0:1),1),i=a*e+this.paddingLeft;t&&(i+=a/2);var r=this.left+Math.round(i);return r+=this.isFullWidth()?this.margins.left:0}var s=this.height-(this.paddingTop+this.paddingBottom);return this.top+e*(s/(this.ticks.length-1))},getPixelForDecimal:function(e){if(this.isHorizontal()){var t=this.width-(this.paddingLeft+this.paddingRight),n=t*e+this.paddingLeft,a=this.left+Math.round(n);return a+=this.isFullWidth()?this.margins.left:0}return this.top+e*this.height},getBasePixel:function(){var e=this,t=e.min,n=e.max;return e.getPixelForValue(e.beginAtZero?0:0>t&&0>n?n:t>0&&n>0?t:0)},draw:function(n){var a=this.options;if(a.display){var i,r,s,o,l,d=this.ctx,c=e.defaults.global,u=a.ticks,g=a.gridLines,p=a.scaleLabel,m=0!==this.labelRotation,h=u.autoSkip;u.maxTicksLimit&&(l=u.maxTicksLimit);var f=t.getValueOrDefault(u.fontColor,c.defaultFontColor),v=t.getValueOrDefault(u.fontSize,c.defaultFontSize),b=t.getValueOrDefault(u.fontStyle,c.defaultFontStyle),w=t.getValueOrDefault(u.fontFamily,c.defaultFontFamily),y=t.fontString(v,b,w),_=g.tickMarkLength,x=t.getValueOrDefault(p.fontColor,c.defaultFontColor),C=t.getValueOrDefault(p.fontSize,c.defaultFontSize),D=t.getValueOrDefault(p.fontStyle,c.defaultFontStyle),k=t.getValueOrDefault(p.fontFamily,c.defaultFontFamily),S=t.fontString(C,D,k),M=t.toRadians(this.labelRotation),E=Math.cos(M),T=(Math.sin(M),this.longestLabelWidth*E);if(d.fillStyle=f,this.isHorizontal()){i=!0;var A="bottom"===a.position?this.top:this.bottom-_,P="bottom"===a.position?this.top+_:this.bottom;if(r=!1,m&&(T/=2),(T+u.autoSkipPadding)*this.ticks.length>this.width-(this.paddingLeft+this.paddingRight)&&(r=1+Math.floor((T+u.autoSkipPadding)*this.ticks.length/(this.width-(this.paddingLeft+this.paddingRight)))),l&&this.ticks.length>l)for(;!r||this.ticks.length/(r||1)>l;)r||(r=1),r+=1;h||(r=!1),t.each(this.ticks,function(e,s){var o=this.ticks.length===s+1,l=r>1&&s%r>0||s%r===0&&s+r>=this.ticks.length;if((!l||o)&&void 0!==e&&null!==e){var c=this.getPixelForTick(s),p=this.getPixelForTick(s,g.offsetGridLines);g.display&&(s===("undefined"!=typeof this.zeroLineIndex?this.zeroLineIndex:0)?(d.lineWidth=g.zeroLineWidth,d.strokeStyle=g.zeroLineColor,i=!0):i&&(d.lineWidth=g.lineWidth,d.strokeStyle=g.color,i=!1),c+=t.aliasPixel(d.lineWidth),d.beginPath(),g.drawTicks&&(d.moveTo(c,A),d.lineTo(c,P)),g.drawOnChartArea&&(d.moveTo(c,n.top),d.lineTo(c,n.bottom)),d.stroke()),u.display&&(d.save(),d.translate(p+u.labelOffset,m?this.top+12:"top"===a.position?this.bottom-_:this.top+_),d.rotate(-1*M),d.font=y,d.textAlign=m?"right":"center",d.textBaseline=m?"middle":"top"===a.position?"bottom":"top",d.fillText(e,0,0),d.restore())}},this),p.display&&(d.textAlign="center",d.textBaseline="middle",d.fillStyle=x,d.font=S,s=this.left+(this.right-this.left)/2,o="bottom"===a.position?this.bottom-C/2:this.top+C/2,d.fillText(p.labelString,s,o))}else{i=!0;var I="right"===a.position?this.left:this.right-5,F="right"===a.position?this.left+5:this.right;if(t.each(this.ticks,function(e,r){if(void 0!==e&&null!==e){var s=this.getPixelForTick(r);if(g.display&&(r===("undefined"!=typeof this.zeroLineIndex?this.zeroLineIndex:0)?(d.lineWidth=g.zeroLineWidth,d.strokeStyle=g.zeroLineColor,i=!0):i&&(d.lineWidth=g.lineWidth,d.strokeStyle=g.color,i=!1),s+=t.aliasPixel(d.lineWidth),d.beginPath(),g.drawTicks&&(d.moveTo(I,s),d.lineTo(F,s)),g.drawOnChartArea&&(d.moveTo(n.left,s),d.lineTo(n.right,s)),d.stroke()),u.display){var o,l=this.getPixelForTick(r,g.offsetGridLines);d.save(),"left"===a.position?u.mirror?(o=this.right+u.padding,d.textAlign="left"):(o=this.right-u.padding,d.textAlign="right"):u.mirror?(o=this.left-u.padding,d.textAlign="right"):(o=this.left+u.padding,d.textAlign="left"),d.translate(o,l+u.labelOffset),d.rotate(-1*M),d.font=y,d.textBaseline="middle",d.fillText(e,0,0),d.restore()}}},this),p.display){s="left"===a.position?this.left+C/2:this.right-C/2,o=this.top+(this.bottom-this.top)/2;var L="left"===a.position?-.5*Math.PI:.5*Math.PI;d.save(),d.translate(s,o),d.rotate(L),d.textAlign="center",d.fillStyle=x,d.font=S,d.textBaseline="middle",d.fillText(p.labelString,0,0),d.restore()}}if(g.drawBorder){d.lineWidth=g.lineWidth,d.strokeStyle=g.color;var O=this.left,$=this.right,W=this.top,z=this.bottom,R=t.aliasPixel(d.lineWidth);this.isHorizontal()?(W=z="top"===a.position?this.bottom:this.top,W+=R,z+=R):(O=$="left"===a.position?this.right:this.left,O+=R,$+=R),d.beginPath(),d.moveTo(O,W),d.lineTo($,z),d.stroke()}}}})}},{}],31:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.scaleService={constructors:{},defaults:{},registerScaleType:function(e,n,a){this.constructors[e]=n,this.defaults[e]=t.clone(a)},getScaleConstructor:function(e){return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function(n){return this.defaults.hasOwnProperty(n)?t.scaleMerge(e.defaults.scale,this.defaults[n]):{}},updateScaleDefaults:function(e,n){var a=this.defaults;a.hasOwnProperty(e)&&(a[e]=t.extend(a[e],n))},addScalesToLayout:function(n){t.each(n.scales,function(t){e.layoutService.addBox(n,t)})}}}},{}],32:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers;e.defaults.global.title={display:!1,position:"top",fullWidth:!0,fontStyle:"bold",padding:10,text:""};var n=t.noop;e.Title=e.Element.extend({initialize:function(n){t.extend(this,n),this.options=t.configMerge(e.defaults.global.title,n.options),this.legendHitBoxes=[]},beforeUpdate:n,update:function(e,t,n){return this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this.margins=n,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this.beforeBuildLabels(),this.buildLabels(),this.afterBuildLabels(),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate(),this.minSize},afterUpdate:n,beforeSetDimensions:n,setDimensions:function(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0,this.minSize={width:0,height:0}},afterSetDimensions:n,beforeBuildLabels:n,buildLabels:n,afterBuildLabels:n,beforeFit:n,fit:function(){var n=this,a=(n.ctx,t.getValueOrDefault),i=n.options,r=e.defaults.global,s=i.display,o=a(i.fontSize,r.defaultFontSize),l=n.minSize;n.isHorizontal()?(l.width=n.maxWidth,l.height=s?o+2*i.padding:0):(l.width=s?o+2*i.padding:0,l.height=n.maxHeight),n.width=l.width,n.height=l.height},afterFit:n,isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function(){var n=this,a=n.ctx,i=t.getValueOrDefault,r=n.options,s=e.defaults.global;if(r.display){var o,l,d=i(r.fontSize,s.defaultFontSize),c=i(r.fontStyle,s.defaultFontStyle),u=i(r.fontFamily,s.defaultFontFamily),g=t.fontString(d,c,u),p=0,m=n.top,h=n.left,f=n.bottom,v=n.right;a.fillStyle=i(r.fontColor,s.defaultFontColor),a.font=g,n.isHorizontal()?(o=h+(v-h)/2,l=m+(f-m)/2):(o="left"===r.position?h+d/2:v-d/2,l=m+(f-m)/2,p=Math.PI*("left"===r.position?-.5:.5)),a.save(),a.translate(o,l),a.rotate(p),a.textAlign="center",a.textBaseline="middle",a.fillText(r.text,0,0),a.restore()}}})}},{}],33:[function(e,t){"use strict";t.exports=function(e){function t(e,t){return t&&(n.isArray(t)?e=e.concat(t):e.push(t)),e}var n=e.helpers;e.defaults.global.tooltips={enabled:!0,custom:null,mode:"single",backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleColor:"#fff",titleAlign:"left",bodySpacing:2,bodyColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,yAlign:"center",xAlign:"center",caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",callbacks:{beforeTitle:n.noop,title:function(e,t){var n="";return e.length>0&&(e[0].xLabel?n=e[0].xLabel:t.labels.length>0&&e[0].index<t.labels.length&&(n=t.labels[e[0].index])),n},afterTitle:n.noop,beforeBody:n.noop,beforeLabel:n.noop,label:function(e,t){var n=t.datasets[e.datasetIndex].label||"";return n+": "+e.yLabel},afterLabel:n.noop,afterBody:n.noop,beforeFooter:n.noop,footer:n.noop,afterFooter:n.noop}},e.Tooltip=e.Element.extend({initialize:function(){var t=e.defaults.global,a=this._options,i=a.tooltips;n.extend(this,{_model:{xPadding:i.xPadding,yPadding:i.yPadding,xAlign:i.yAlign,yAlign:i.xAlign,bodyColor:i.bodyColor,_bodyFontFamily:n.getValueOrDefault(i.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:n.getValueOrDefault(i.bodyFontStyle,t.defaultFontStyle),_bodyAlign:i.bodyAlign,bodyFontSize:n.getValueOrDefault(i.bodyFontSize,t.defaultFontSize),bodySpacing:i.bodySpacing,titleColor:i.titleColor,_titleFontFamily:n.getValueOrDefault(i.titleFontFamily,t.defaultFontFamily),_titleFontStyle:n.getValueOrDefault(i.titleFontStyle,t.defaultFontStyle),titleFontSize:n.getValueOrDefault(i.titleFontSize,t.defaultFontSize),_titleAlign:i.titleAlign,titleSpacing:i.titleSpacing,titleMarginBottom:i.titleMarginBottom,footerColor:i.footerColor,_footerFontFamily:n.getValueOrDefault(i.footerFontFamily,t.defaultFontFamily),_footerFontStyle:n.getValueOrDefault(i.footerFontStyle,t.defaultFontStyle),footerFontSize:n.getValueOrDefault(i.footerFontSize,t.defaultFontSize),_footerAlign:i.footerAlign,footerSpacing:i.footerSpacing,footerMarginTop:i.footerMarginTop,caretSize:i.caretSize,cornerRadius:i.cornerRadius,backgroundColor:i.backgroundColor,opacity:0,legendColorBackground:i.multiKeyBackground}})},getTitle:function(){var e=this._options.tooltips.callbacks.beforeTitle.apply(this,arguments),n=this._options.tooltips.callbacks.title.apply(this,arguments),a=this._options.tooltips.callbacks.afterTitle.apply(this,arguments),i=[];return i=t(i,e),i=t(i,n),i=t(i,a)},getBeforeBody:function(){var e=this._options.tooltips.callbacks.beforeBody.apply(this,arguments);return n.isArray(e)?e:void 0!==e?[e]:[]},getBody:function(e,t){var a=[];return n.each(e,function(e){n.pushAllIfDefined(this._options.tooltips.callbacks.beforeLabel.call(this,e,t),a),n.pushAllIfDefined(this._options.tooltips.callbacks.label.call(this,e,t),a),n.pushAllIfDefined(this._options.tooltips.callbacks.afterLabel.call(this,e,t),a)},this),a},getAfterBody:function(){var e=this._options.tooltips.callbacks.afterBody.apply(this,arguments);return n.isArray(e)?e:void 0!==e?[e]:[]},getFooter:function(){var e=this._options.tooltips.callbacks.beforeFooter.apply(this,arguments),n=this._options.tooltips.callbacks.footer.apply(this,arguments),a=this._options.tooltips.callbacks.afterFooter.apply(this,arguments),i=[];return i=t(i,e),i=t(i,n),i=t(i,a)},getAveragePosition:function(e){if(!e.length)return!1;var t=[],a=[];n.each(e,function(e){if(e&&e.hasValue()){var n=e.tooltipPosition();t.push(n.x),a.push(n.y)}});for(var i=0,r=0,s=0;s<t.length;s++)i+=t[s],r+=a[s];return{x:Math.round(i/t.length),y:Math.round(r/t.length)}},update:function(e){if(this._active.length){this._model.opacity=1;var t,a=this._active[0],i=[],r=[];if("single"===this._options.tooltips.mode){var s=a._yScale||a._scale;r.push({xLabel:a._xScale?a._xScale.getLabelForIndex(a._index,a._datasetIndex):"",yLabel:s?s.getLabelForIndex(a._index,a._datasetIndex):"",index:a._index,datasetIndex:a._datasetIndex}),t=this.getAveragePosition(this._active)}else n.each(this._data.datasets,function(e,t){if(this._chartInstance.isDatasetVisible(t)){var n=this._chartInstance.getDatasetMeta(t),i=n.data[a._index];if(i){var s=a._yScale||a._scale;r.push({xLabel:i._xScale?i._xScale.getLabelForIndex(i._index,i._datasetIndex):"",yLabel:s?s.getLabelForIndex(i._index,i._datasetIndex):"",index:a._index,datasetIndex:t})}}},this),n.each(this._active,function(e){e&&i.push({borderColor:e._view.borderColor,backgroundColor:e._view.backgroundColor})},null),t=this.getAveragePosition(this._active);n.extend(this._model,{title:this.getTitle(r,this._data),beforeBody:this.getBeforeBody(r,this._data),body:this.getBody(r,this._data),afterBody:this.getAfterBody(r,this._data),footer:this.getFooter(r,this._data)}),n.extend(this._model,{x:Math.round(t.x),y:Math.round(t.y),caretPadding:n.getValueOrDefault(t.padding,2),labelColors:i});var o=this.getTooltipSize(this._model);this.determineAlignment(o),n.extend(this._model,this.getBackgroundPoint(this._model,o))}else this._model.opacity=0;return e&&this._options.tooltips.custom&&this._options.tooltips.custom.call(this,this._model),this},getTooltipSize:function(e){var t=this._chart.ctx,a={height:2*e.yPadding,width:0},i=e.body.length+e.beforeBody.length+e.afterBody.length;return a.height+=e.title.length*e.titleFontSize,a.height+=(e.title.length-1)*e.titleSpacing,a.height+=e.title.length?e.titleMarginBottom:0,a.height+=i*e.bodyFontSize,a.height+=i?(i-1)*e.bodySpacing:0,a.height+=e.footer.length?e.footerMarginTop:0,a.height+=e.footer.length*e.footerFontSize,a.height+=e.footer.length?(e.footer.length-1)*e.footerSpacing:0,t.font=n.fontString(e.titleFontSize,e._titleFontStyle,e._titleFontFamily),n.each(e.title,function(e){a.width=Math.max(a.width,t.measureText(e).width)}),t.font=n.fontString(e.bodyFontSize,e._bodyFontStyle,e._bodyFontFamily),n.each(e.beforeBody.concat(e.afterBody),function(e){a.width=Math.max(a.width,t.measureText(e).width)}),n.each(e.body,function(n){a.width=Math.max(a.width,t.measureText(n).width+("single"!==this._options.tooltips.mode?e.bodyFontSize+2:0))},this),t.font=n.fontString(e.footerFontSize,e._footerFontStyle,e._footerFontFamily),n.each(e.footer,function(e){a.width=Math.max(a.width,t.measureText(e).width)}),a.width+=2*e.xPadding,a},determineAlignment:function(e){this._model.y<e.height?this._model.yAlign="top":this._model.y>this._chart.height-e.height&&(this._model.yAlign="bottom");var t,n,a,i,r,s=this,o=(this._chartInstance.chartArea.left+this._chartInstance.chartArea.right)/2,l=(this._chartInstance.chartArea.top+this._chartInstance.chartArea.bottom)/2;"center"===this._model.yAlign?(t=function(e){return o>=e},n=function(e){return e>o}):(t=function(t){return t<=e.width/2},n=function(t){return t>=s._chart.width-e.width/2}),a=function(t){return t+e.width>s._chart.width},i=function(t){return t-e.width<0},r=function(e){return l>=e?"top":"bottom"},t(this._model.x)?(this._model.xAlign="left",a(this._model.x)&&(this._model.xAlign="center",this._model.yAlign=r(this._model.y))):n(this._model.x)&&(this._model.xAlign="right",i(this._model.x)&&(this._model.xAlign="center",this._model.yAlign=r(this._model.y)))},getBackgroundPoint:function(e,t){var n={x:e.x,y:e.y};return"right"===e.xAlign?n.x-=t.width:"center"===e.xAlign&&(n.x-=t.width/2),"top"===e.yAlign?n.y+=e.caretPadding+e.caretSize:n.y-="bottom"===e.yAlign?t.height+e.caretPadding+e.caretSize:t.height/2,"center"===e.yAlign?"left"===e.xAlign?n.x+=e.caretPadding+e.caretSize:"right"===e.xAlign&&(n.x-=e.caretPadding+e.caretSize):"left"===e.xAlign?n.x-=e.cornerRadius+e.caretPadding:"right"===e.xAlign&&(n.x+=e.cornerRadius+e.caretPadding),n},drawCaret:function(e,t,a){var i,r,s,o,l,d,c=this._view,u=this._chart.ctx;"center"===c.yAlign?("left"===c.xAlign?(i=e.x,r=i-c.caretSize,s=i):(i=e.x+t.width,r=i+c.caretSize,s=i),l=e.y+t.height/2,o=l-c.caretSize,d=l+c.caretSize):("left"===c.xAlign?(i=e.x+c.cornerRadius,r=i+c.caretSize,s=r+c.caretSize):"right"===c.xAlign?(i=e.x+t.width-c.cornerRadius,r=i-c.caretSize,s=r-c.caretSize):(r=e.x+t.width/2,i=r-c.caretSize,s=r+c.caretSize),"top"===c.yAlign?(o=e.y,l=o-c.caretSize,d=o):(o=e.y+t.height,l=o+c.caretSize,d=o));var g=n.color(c.backgroundColor);u.fillStyle=g.alpha(a*g.alpha()).rgbString(),u.beginPath(),u.moveTo(i,o),u.lineTo(r,l),u.lineTo(s,d),u.closePath(),u.fill()},drawTitle:function(e,t,a,i){if(t.title.length){a.textAlign=t._titleAlign,a.textBaseline="top";var r=n.color(t.titleColor);a.fillStyle=r.alpha(i*r.alpha()).rgbString(),a.font=n.fontString(t.titleFontSize,t._titleFontStyle,t._titleFontFamily),n.each(t.title,function(n,i){a.fillText(n,e.x,e.y),e.y+=t.titleFontSize+t.titleSpacing,i+1===t.title.length&&(e.y+=t.titleMarginBottom-t.titleSpacing)})}},drawBody:function(e,t,a,i){a.textAlign=t._bodyAlign,a.textBaseline="top";var r=n.color(t.bodyColor);a.fillStyle=r.alpha(i*r.alpha()).rgbString(),a.font=n.fontString(t.bodyFontSize,t._bodyFontStyle,t._bodyFontFamily),n.each(t.beforeBody,function(n){a.fillText(n,e.x,e.y),e.y+=t.bodyFontSize+t.bodySpacing}),n.each(t.body,function(r,s){"single"!==this._options.tooltips.mode&&(a.fillStyle=n.color(t.legendColorBackground).alpha(i).rgbaString(),a.fillRect(e.x,e.y,t.bodyFontSize,t.bodyFontSize),a.strokeStyle=n.color(t.labelColors[s].borderColor).alpha(i).rgbaString(),a.strokeRect(e.x,e.y,t.bodyFontSize,t.bodyFontSize),a.fillStyle=n.color(t.labelColors[s].backgroundColor).alpha(i).rgbaString(),a.fillRect(e.x+1,e.y+1,t.bodyFontSize-2,t.bodyFontSize-2),a.fillStyle=n.color(t.bodyColor).alpha(i).rgbaString()),a.fillText(r,e.x+("single"!==this._options.tooltips.mode?t.bodyFontSize+2:0),e.y),e.y+=t.bodyFontSize+t.bodySpacing},this),n.each(t.afterBody,function(n){a.fillText(n,e.x,e.y),e.y+=t.bodyFontSize}),e.y-=t.bodySpacing},drawFooter:function(e,t,a,i){if(t.footer.length){e.y+=t.footerMarginTop,a.textAlign=t._footerAlign,a.textBaseline="top";var r=n.color(t.footerColor);a.fillStyle=r.alpha(i*r.alpha()).rgbString(),a.font=n.fontString(t.footerFontSize,t._footerFontStyle,t._footerFontFamily),n.each(t.footer,function(n){a.fillText(n,e.x,e.y),e.y+=t.footerFontSize+t.footerSpacing})}},draw:function(){var e=this._chart.ctx,t=this._view;if(0!==t.opacity){var a=t.caretPadding,i=this.getTooltipSize(t),r={x:t.x,y:t.y},s=Math.abs(t.opacity<.001)?0:t.opacity;if(this._options.tooltips.enabled){var o=n.color(t.backgroundColor);e.fillStyle=o.alpha(s*o.alpha()).rgbString(),n.drawRoundedRectangle(e,r.x,r.y,i.width,i.height,t.cornerRadius),e.fill(),this.drawCaret(r,i,s,a),r.x+=t.xPadding,r.y+=t.yPadding,this.drawTitle(r,t,e,s),this.drawBody(r,t,e,s),this.drawFooter(r,t,e,s)}}}})}},{}],34:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=e.defaults.global;n.elements.arc={backgroundColor:n.defaultColor,borderColor:"#fff",borderWidth:2},e.elements.Arc=e.Element.extend({inLabelRange:function(e){var t=this._view;return t?Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2):!1},inRange:function(e,n){var a=this._view;if(a){for(var i=t.getAngleFromPoint(a,{x:e,y:n}),r=i.angle,s=i.distance,o=a.startAngle,l=a.endAngle;o>l;)l+=2*Math.PI;for(;r>l;)r-=2*Math.PI;for(;o>r;)r+=2*Math.PI;var d=r>=o&&l>=r,c=s>=a.innerRadius&&s<=a.outerRadius;return d&&c}return!1},tooltipPosition:function(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,n=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},draw:function(){var e=this._chart.ctx,t=this._view,n=t.startAngle,a=t.endAngle;e.beginPath(),e.arc(t.x,t.y,t.outerRadius,n,a),e.arc(t.x,t.y,t.innerRadius,a,n,!0),e.closePath(),e.strokeStyle=t.borderColor,e.lineWidth=t.borderWidth,e.fillStyle=t.backgroundColor,e.fill(),e.lineJoin="bevel",t.borderWidth&&e.stroke()}})}},{}],35:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=e.defaults.global;e.defaults.global.elements.line={tension:.4,backgroundColor:n.defaultColor,borderWidth:3,borderColor:n.defaultColor,borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",fill:!0},e.elements.Line=e.Element.extend({lineToNextPoint:function(e,t,n,a,i){var r=this._chart.ctx;t._view.skip?a.call(this,e,t,n):e._view.skip?i.call(this,e,t,n):0===t._view.tension?r.lineTo(t._view.x,t._view.y):r.bezierCurveTo(e._view.controlPointNextX,e._view.controlPointNextY,t._view.controlPointPreviousX,t._view.controlPointPreviousY,t._view.x,t._view.y)},draw:function(){function e(e){s._view.skip||o._view.skip?e&&r.lineTo(a._view.scaleZero.x,a._view.scaleZero.y):r.bezierCurveTo(o._view.controlPointNextX,o._view.controlPointNextY,s._view.controlPointPreviousX,s._view.controlPointPreviousY,s._view.x,s._view.y)}var a=this,i=this._view,r=this._chart.ctx,s=this._children[0],o=this._children[this._children.length-1];r.save(),this._children.length>0&&i.fill&&(r.beginPath(),t.each(this._children,function(e,n){var a=t.previousItem(this._children,n),s=t.nextItem(this._children,n);0===n?(this._loop?r.moveTo(i.scaleZero.x,i.scaleZero.y):r.moveTo(e._view.x,i.scaleZero),e._view.skip?this._loop||r.moveTo(s._view.x,this._view.scaleZero):r.lineTo(e._view.x,e._view.y)):this.lineToNextPoint(a,e,s,function(e,t,n){this._loop?r.lineTo(this._view.scaleZero.x,this._view.scaleZero.y):(r.lineTo(e._view.x,this._view.scaleZero),r.moveTo(n._view.x,this._view.scaleZero))},function(e,t){r.lineTo(t._view.x,t._view.y)})},this),this._loop?e(!0):(r.lineTo(this._children[this._children.length-1]._view.x,i.scaleZero),r.lineTo(this._children[0]._view.x,i.scaleZero)),r.fillStyle=i.backgroundColor||n.defaultColor,r.closePath(),r.fill());var l=n.elements.line;r.lineCap=i.borderCapStyle||l.borderCapStyle,r.setLineDash&&r.setLineDash(i.borderDash||l.borderDash),r.lineDashOffset=i.borderDashOffset||l.borderDashOffset,r.lineJoin=i.borderJoinStyle||l.borderJoinStyle,r.lineWidth=i.borderWidth||l.borderWidth,r.strokeStyle=i.borderColor||n.defaultColor,r.beginPath(),t.each(this._children,function(e,n){var a=t.previousItem(this._children,n),i=t.nextItem(this._children,n);0===n?r.moveTo(e._view.x,e._view.y):this.lineToNextPoint(a,e,i,function(e,t,n){r.moveTo(n._view.x,n._view.y)},function(e,t){r.moveTo(t._view.x,t._view.y)})},this),this._loop&&this._children.length>0&&e(),r.stroke(),r.restore()}})}},{}],36:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=e.defaults.global,a=n.defaultColor;n.elements.point={radius:3,pointStyle:"circle",backgroundColor:a,borderWidth:1,borderColor:a,hitRadius:1,hoverRadius:4,hoverBorderWidth:1},e.elements.Point=e.Element.extend({inRange:function(e,t){var n=this._view;return n?Math.pow(e-n.x,2)+Math.pow(t-n.y,2)<Math.pow(n.hitRadius+n.radius,2):!1},inLabelRange:function(e){var t=this._view;return t?Math.pow(e-t.x,2)<Math.pow(t.radius+t.hitRadius,2):!1},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(){var e,i,r,s,o,l,d=this._view,c=this._chart.ctx,u=d.pointStyle,g=d.radius,p=d.x,m=d.y;if(!d.skip){if("object"==typeof u&&(e=u.toString(),"[object HTMLImageElement]"===e||"[object HTMLCanvasElement]"===e))return void c.drawImage(u,p-u.width/2,m-u.height/2);if(!(isNaN(g)||0>=g)){switch(c.strokeStyle=d.borderColor||a,c.lineWidth=t.getValueOrDefault(d.borderWidth,n.elements.point.borderWidth),c.fillStyle=d.backgroundColor||a,u){default:c.beginPath(),c.arc(p,m,g,0,2*Math.PI),c.closePath(),c.fill();break;case"triangle":c.beginPath(),i=3*g/Math.sqrt(3),o=i*Math.sqrt(3)/2,c.moveTo(p-i/2,m+o/3),c.lineTo(p+i/2,m+o/3),c.lineTo(p,m-2*o/3),c.closePath(),c.fill();break;case"rect":l=1/Math.SQRT2*g,c.fillRect(p-l,m-l,2*l,2*l),c.strokeRect(p-l,m-l,2*l,2*l);break;case"rectRot":c.translate(p,m),c.rotate(Math.PI/4),l=1/Math.SQRT2*g,c.fillRect(-l,-l,2*l,2*l),c.strokeRect(-l,-l,2*l,2*l),c.setTransform(1,0,0,1,0,0);break;case"cross":c.beginPath(),c.moveTo(p,m+g),c.lineTo(p,m-g),c.moveTo(p-g,m),c.lineTo(p+g,m),c.closePath();break;case"crossRot":c.beginPath(),r=Math.cos(Math.PI/4)*g,s=Math.sin(Math.PI/4)*g,c.moveTo(p-r,m-s),c.lineTo(p+r,m+s),c.moveTo(p-r,m+s),c.lineTo(p+r,m-s),c.closePath();break;case"star":c.beginPath(),c.moveTo(p,m+g),c.lineTo(p,m-g),c.moveTo(p-g,m),c.lineTo(p+g,m),r=Math.cos(Math.PI/4)*g,s=Math.sin(Math.PI/4)*g,c.moveTo(p-r,m-s),c.lineTo(p+r,m+s),c.moveTo(p-r,m+s),c.lineTo(p+r,m-s),c.closePath();break;case"line":c.beginPath(),c.moveTo(p-g,m),c.lineTo(p+g,m),c.closePath();break;case"dash":c.beginPath(),c.moveTo(p,m),c.lineTo(p+g,m),c.closePath()}c.stroke()}}}})}},{}],37:[function(e,t){"use strict";t.exports=function(e){var t=(e.helpers,e.defaults.global);t.elements.rectangle={backgroundColor:t.defaultColor,borderWidth:0,borderColor:t.defaultColor,borderSkipped:"bottom"},e.elements.Rectangle=e.Element.extend({draw:function(){function e(e){return l[(c+e)%4]}var t=this._chart.ctx,n=this._view,a=n.width/2,i=n.x-a,r=n.x+a,s=n.base-(n.base-n.y),o=n.borderWidth/2;n.borderWidth&&(i+=o,r-=o,s+=o),t.beginPath(),t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth;var l=[[i,n.base],[i,s],[r,s],[r,n.base]],d=["bottom","left","top","right"],c=d.indexOf(n.borderSkipped,0);-1===c&&(c=0),t.moveTo.apply(t,e(0));for(var u=1;4>u;u++)t.lineTo.apply(t,e(u));t.fill(),n.borderWidth&&t.stroke()},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){var n=this._view;return n?n.y<n.base?e>=n.x-n.width/2&&e<=n.x+n.width/2&&t>=n.y&&t<=n.base:e>=n.x-n.width/2&&e<=n.x+n.width/2&&t>=n.base&&t<=n.y:!1},inLabelRange:function(e){var t=this._view;return t?e>=t.x-t.width/2&&e<=t.x+t.width/2:!1},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}})}},{}],38:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n={position:"bottom"},a=e.Scale.extend({determineDataLimits:function(){this.minIndex=0,this.maxIndex=this.chart.data.labels.length-1;var e;void 0!==this.options.ticks.min&&(e=t.indexOf(this.chart.data.labels,this.options.ticks.min),this.minIndex=-1!==e?e:this.minIndex),void 0!==this.options.ticks.max&&(e=t.indexOf(this.chart.data.labels,this.options.ticks.max),this.maxIndex=-1!==e?e:this.maxIndex),this.min=this.chart.data.labels[this.minIndex],this.max=this.chart.data.labels[this.maxIndex]},buildTicks:function(){this.ticks=0===this.minIndex&&this.maxIndex===this.chart.data.labels.length-1?this.chart.data.labels:this.chart.data.labels.slice(this.minIndex,this.maxIndex+1)},getLabelForIndex:function(e){return this.ticks[e]},getPixelForValue:function(e,t,n,a){var i=Math.max(this.maxIndex+1-this.minIndex-(this.options.gridLines.offsetGridLines?0:1),1);
if(this.isHorizontal()){var r=this.width-(this.paddingLeft+this.paddingRight),s=r/i,o=s*(t-this.minIndex)+this.paddingLeft;return this.options.gridLines.offsetGridLines&&a&&(o+=s/2),this.left+Math.round(o)}var l=this.height-(this.paddingTop+this.paddingBottom),d=l/i,c=d*(t-this.minIndex)+this.paddingTop;return this.options.gridLines.offsetGridLines&&a&&(c+=d/2),this.top+Math.round(c)},getPixelForTick:function(e,t){return this.getPixelForValue(this.ticks[e],e+this.minIndex,null,t)},getValueForPixel:function(e){var t,n=Math.max(this.ticks.length-(this.options.gridLines.offsetGridLines?0:1),1),a=this.isHorizontal(),i=a?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),r=i/n;return this.options.gridLines.offsetGridLines&&(e-=r/2),e-=a?this.paddingLeft:this.paddingTop,t=0>=e?0:Math.round(e/r)}});e.scaleService.registerScaleType("category",a,n)}},{}],39:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n={position:"left",ticks:{callback:function(e,n,a){var i=a.length>3?a[2]-a[1]:a[1]-a[0];Math.abs(i)>1&&e!==Math.floor(e)&&(i=e-Math.floor(e));var r=t.log10(Math.abs(i)),s="";if(0!==e){var o=-1*Math.floor(r);o=Math.max(Math.min(o,20),0),s=e.toFixed(o)}else s="0";return s}}},a=e.Scale.extend({determineDataLimits:function(){function e(e){return l?e.xAxisID===n.id:e.yAxisID===n.id}var n=this,a=n.options,i=a.ticks,r=n.chart,s=r.data,o=s.datasets,l=n.isHorizontal();if(n.min=null,n.max=null,a.stacked){var d={},c=!1,u=!1;t.each(o,function(i,s){var o=r.getDatasetMeta(s);void 0===d[o.type]&&(d[o.type]={positiveValues:[],negativeValues:[]});var l=d[o.type].positiveValues,g=d[o.type].negativeValues;r.isDatasetVisible(s)&&e(o)&&t.each(i.data,function(e,t){var i=+n.getRightValue(e);isNaN(i)||o.data[t].hidden||(l[t]=l[t]||0,g[t]=g[t]||0,a.relativePoints?l[t]=100:0>i?(u=!0,g[t]+=i):(c=!0,l[t]+=i))})}),t.each(d,function(e){var a=e.positiveValues.concat(e.negativeValues),i=t.min(a),r=t.max(a);n.min=null===n.min?i:Math.min(n.min,i),n.max=null===n.max?r:Math.max(n.max,r)})}else t.each(o,function(a,i){var s=r.getDatasetMeta(i);r.isDatasetVisible(i)&&e(s)&&t.each(a.data,function(e,t){var a=+n.getRightValue(e);isNaN(a)||s.data[t].hidden||(null===n.min?n.min=a:a<n.min&&(n.min=a),null===n.max?n.max=a:a>n.max&&(n.max=a))})});if(i.beginAtZero){var g=t.sign(n.min),p=t.sign(n.max);0>g&&0>p?n.max=0:g>0&&p>0&&(n.min=0)}void 0!==i.min?n.min=i.min:void 0!==i.suggestedMin&&(n.min=Math.min(n.min,i.suggestedMin)),void 0!==i.max?n.max=i.max:void 0!==i.suggestedMax&&(n.max=Math.max(n.max,i.suggestedMax)),n.min===n.max&&(n.max++,i.beginAtZero||n.min--)},buildTicks:function(){var n,a=this,i=a.options,r=i.ticks,s=t.getValueOrDefault,o=a.isHorizontal(),l=a.ticks=[];if(o)n=Math.min(r.maxTicksLimit?r.maxTicksLimit:11,Math.ceil(a.width/50));else{var d=s(r.fontSize,e.defaults.global.defaultFontSize);n=Math.min(r.maxTicksLimit?r.maxTicksLimit:11,Math.ceil(a.height/(2*d)))}n=Math.max(2,n);var c,u=r.fixedStepSize&&r.fixedStepSize>0||r.stepSize&&r.stepSize>0;if(u)c=s(r.fixedStepSize,r.stepSize);else{var g=t.niceNum(a.max-a.min,!1);c=t.niceNum(g/(n-1),!0)}var p=Math.floor(a.min/c)*c,m=Math.ceil(a.max/c)*c,h=(m-p)/c;h=t.almostEquals(h,Math.round(h),c/1e3)?Math.round(h):Math.ceil(h),l.push(void 0!==r.min?r.min:p);for(var f=1;h>f;++f)l.push(p+f*c);l.push(void 0!==r.max?r.max:m),o||l.reverse(),a.max=t.max(l),a.min=t.min(l),r.reverse?(l.reverse(),a.start=a.max,a.end=a.min):(a.start=a.min,a.end=a.max)},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},convertTicksToLabels:function(){var t=this;t.ticksAsNumbers=t.ticks.slice(),t.zeroLineIndex=t.ticks.indexOf(0),e.Scale.prototype.convertTicksToLabels.call(t)},getPixelForValue:function(e){var t,n,a=this,i=a.paddingLeft,r=a.paddingBottom,s=a.start,o=+a.getRightValue(e),l=a.end-s;return a.isHorizontal()?(n=a.width-(i+a.paddingRight),t=a.left+n/l*(o-s),Math.round(t+i)):(n=a.height-(a.paddingTop+r),t=a.bottom-r-n/l*(o-s),Math.round(t))},getValueForPixel:function(e){var t=this,n=t.isHorizontal(),a=t.paddingLeft,i=t.paddingBottom,r=n?t.width-(a+t.paddingRight):t.height-(t.paddingTop+i),s=(n?e-t.left-a:t.bottom-i-e)/r;return t.start+(t.end-t.start)*s},getPixelForTick:function(e,t){return this.getPixelForValue(this.ticksAsNumbers[e],null,null,t)}});e.scaleService.registerScaleType("linear",a,n)}},{}],40:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n={position:"left",ticks:{callback:function(e,n,a){var i=e/Math.pow(10,Math.floor(t.log10(e)));return 1===i||2===i||5===i||0===n||n===a.length-1?e.toExponential():""}}},a=e.Scale.extend({determineDataLimits:function(){function e(e){return d?e.xAxisID===n.id:e.yAxisID===n.id}var n=this,a=n.options,i=a.ticks,r=n.chart,s=r.data,o=s.datasets,l=t.getValueOrDefault,d=n.isHorizontal();if(n.min=null,n.max=null,a.stacked){var c={};t.each(o,function(i,s){var o=r.getDatasetMeta(s);r.isDatasetVisible(s)&&e(o)&&(void 0===c[o.type]&&(c[o.type]=[]),t.each(i.data,function(e,t){var i=c[o.type],r=+n.getRightValue(e);isNaN(r)||o.data[t].hidden||(i[t]=i[t]||0,a.relativePoints?i[t]=100:i[t]+=r)}))}),t.each(c,function(e){var a=t.min(e),i=t.max(e);n.min=null===n.min?a:Math.min(n.min,a),n.max=null===n.max?i:Math.max(n.max,i)})}else t.each(o,function(a,i){var s=r.getDatasetMeta(i);r.isDatasetVisible(i)&&e(s)&&t.each(a.data,function(e,t){var a=+n.getRightValue(e);isNaN(a)||s.data[t].hidden||(null===n.min?n.min=a:a<n.min&&(n.min=a),null===n.max?n.max=a:a>n.max&&(n.max=a))})});n.min=l(i.min,n.min),n.max=l(i.max,n.max),n.min===n.max&&(0!==n.min&&null!==n.min?(n.min=Math.pow(10,Math.floor(t.log10(n.min))-1),n.max=Math.pow(10,Math.floor(t.log10(n.max))+1)):(n.min=1,n.max=10))},buildTicks:function(){for(var e=this,n=e.options,a=n.ticks,i=t.getValueOrDefault,r=e.ticks=[],s=i(a.min,Math.pow(10,Math.floor(t.log10(e.min))));s<e.max;){r.push(s);var o=Math.floor(t.log10(s)),l=Math.floor(s/Math.pow(10,o))+1;10===l&&(l=1,++o),s=l*Math.pow(10,o)}var d=i(a.max,s);r.push(d),e.isHorizontal()||r.reverse(),e.max=t.max(r),e.min=t.min(r),a.reverse?(r.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),e.Scale.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e,t){return this.getPixelForValue(this.tickValues[e],null,null,t)},getPixelForValue:function(e){var n,a,i=this,r=i.start,s=+i.getRightValue(e),o=t.log10(i.end)-t.log10(r),l=i.paddingTop,d=i.paddingBottom,c=i.paddingLeft;return i.isHorizontal()?0===s?a=i.left+c:(n=i.width-(c+i.paddingRight),a=i.left+n/o*(t.log10(s)-t.log10(r)),a+=c):0===s?a=i.top+l:(n=i.height-(l+d),a=i.bottom-d-n/o*(t.log10(s)-t.log10(r))),a},getValueForPixel:function(e){var n,a,i=this,r=t.log10(i.end)-t.log10(i.start);return i.isHorizontal()?(a=i.width-(i.paddingLeft+i.paddingRight),n=i.start*Math.pow(10,(e-i.left-i.paddingLeft)*r/a)):(a=i.height-(i.paddingTop+i.paddingBottom),n=Math.pow(10,(i.bottom-i.paddingBottom-e)*r/a)/i.start),n}});e.scaleService.registerScaleType("logarithmic",a,n)}},{}],41:[function(e,t){"use strict";t.exports=function(e){var t=e.helpers,n=e.defaults.global,a={display:!0,animate:!0,lineArc:!1,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2},pointLabels:{fontSize:10,callback:function(e){return e}}},i=e.Scale.extend({getValueCount:function(){return this.chart.data.labels.length},setDimensions:function(){var e=this.options;this.width=this.maxWidth,this.height=this.maxHeight,this.xCenter=Math.round(this.width/2),this.yCenter=Math.round(this.height/2);var a=t.min([this.height,this.width]),i=t.getValueOrDefault(e.ticks.fontSize,n.defaultFontSize);this.drawingArea=e.display?a/2-(i/2+e.ticks.backdropPaddingY):a/2},determineDataLimits:function(){if(this.min=null,this.max=null,t.each(this.chart.data.datasets,function(e,n){if(this.chart.isDatasetVisible(n)){var a=this.chart.getDatasetMeta(n);t.each(e.data,function(e,t){var n=+this.getRightValue(e);isNaN(n)||a.data[t].hidden||(null===this.min?this.min=n:n<this.min&&(this.min=n),null===this.max?this.max=n:n>this.max&&(this.max=n))},this)}},this),this.options.ticks.beginAtZero){var e=t.sign(this.min),n=t.sign(this.max);0>e&&0>n?this.max=0:e>0&&n>0&&(this.min=0)}void 0!==this.options.ticks.min?this.min=this.options.ticks.min:void 0!==this.options.ticks.suggestedMin&&(this.min=Math.min(this.min,this.options.ticks.suggestedMin)),void 0!==this.options.ticks.max?this.max=this.options.ticks.max:void 0!==this.options.ticks.suggestedMax&&(this.max=Math.max(this.max,this.options.ticks.suggestedMax)),this.min===this.max&&(this.min--,this.max++)},buildTicks:function(){this.ticks=[];var e=t.getValueOrDefault(this.options.ticks.fontSize,n.defaultFontSize),a=Math.min(this.options.ticks.maxTicksLimit?this.options.ticks.maxTicksLimit:11,Math.ceil(this.drawingArea/(1.5*e)));a=Math.max(2,a);var i=t.niceNum(this.max-this.min,!1),r=t.niceNum(i/(a-1),!0),s=Math.floor(this.min/r)*r,o=Math.ceil(this.max/r)*r,l=Math.ceil((o-s)/r);this.ticks.push(void 0!==this.options.ticks.min?this.options.ticks.min:s);for(var d=1;l>d;++d)this.ticks.push(s+d*r);this.ticks.push(void 0!==this.options.ticks.max?this.options.ticks.max:o),this.max=t.max(this.ticks),this.min=t.min(this.ticks),this.options.ticks.reverse?(this.ticks.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),this.zeroLineIndex=this.ticks.indexOf(0)},convertTicksToLabels:function(){e.Scale.prototype.convertTicksToLabels.call(this),this.pointLabels=this.chart.data.labels.map(this.options.pointLabels.callback,this)},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){var e,a,i,r,s,o,l,d,c,u,g,p,m=this.options.pointLabels,h=t.getValueOrDefault(m.fontSize,n.defaultFontSize),f=t.getValueOrDefault(m.fontStyle,n.defaultFontStyle),v=t.getValueOrDefault(m.fontFamily,n.defaultFontFamily),b=t.fontString(h,f,v),w=t.min([this.height/2-h-5,this.width/2]),y=this.width,_=0;for(this.ctx.font=b,a=0;a<this.getValueCount();a++)e=this.getPointPosition(a,w),i=this.ctx.measureText(this.pointLabels[a]?this.pointLabels[a]:"").width+5,0===a||a===this.getValueCount()/2?(r=i/2,e.x+r>y&&(y=e.x+r,s=a),e.x-r<_&&(_=e.x-r,l=a)):a<this.getValueCount()/2?e.x+i>y&&(y=e.x+i,s=a):a>this.getValueCount()/2&&e.x-i<_&&(_=e.x-i,l=a);c=_,u=Math.ceil(y-this.width),o=this.getIndexAngle(s),d=this.getIndexAngle(l),g=u/Math.sin(o+Math.PI/2),p=c/Math.sin(d+Math.PI/2),g=t.isNumber(g)?g:0,p=t.isNumber(p)?p:0,this.drawingArea=Math.round(w-(p+g)/2),this.setCenterPoint(p,g)},setCenterPoint:function(e,t){var n=this.width-t-this.drawingArea,a=e+this.drawingArea;this.xCenter=Math.round((a+n)/2+this.left),this.yCenter=Math.round(this.height/2+this.top)},getIndexAngle:function(e){var t=2*Math.PI/this.getValueCount();return e*t-Math.PI/2},getDistanceFromCenterForValue:function(e){if(null===e)return 0;var t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t},getPointPosition:function(e,t){var n=this.getIndexAngle(e);return{x:Math.round(Math.cos(n)*t)+this.xCenter,y:Math.round(Math.sin(n)*t)+this.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(){var e=this,t=e.min,n=e.max;return e.getPointPositionForValue(0,e.beginAtZero?0:0>t&&0>n?n:t>0&&n>0?t:0)},draw:function(){if(this.options.display){var e=this.ctx;if(t.each(this.ticks,function(a,i){if(i>0||this.options.reverse){var r=this.getDistanceFromCenterForValue(this.ticks[i]),s=this.yCenter-r;if(this.options.gridLines.display)if(e.strokeStyle=this.options.gridLines.color,e.lineWidth=this.options.gridLines.lineWidth,this.options.lineArc)e.beginPath(),e.arc(this.xCenter,this.yCenter,r,0,2*Math.PI),e.closePath(),e.stroke();else{e.beginPath();for(var o=0;o<this.getValueCount();o++){var l=this.getPointPosition(o,this.getDistanceFromCenterForValue(this.ticks[i]));0===o?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y)}e.closePath(),e.stroke()}if(this.options.ticks.display){var d=t.getValueOrDefault(this.options.ticks.fontColor,n.defaultFontColor),c=t.getValueOrDefault(this.options.ticks.fontSize,n.defaultFontSize),u=t.getValueOrDefault(this.options.ticks.fontStyle,n.defaultFontStyle),g=t.getValueOrDefault(this.options.ticks.fontFamily,n.defaultFontFamily),p=t.fontString(c,u,g);if(e.font=p,this.options.ticks.showLabelBackdrop){var m=e.measureText(a).width;e.fillStyle=this.options.ticks.backdropColor,e.fillRect(this.xCenter-m/2-this.options.ticks.backdropPaddingX,s-c/2-this.options.ticks.backdropPaddingY,m+2*this.options.ticks.backdropPaddingX,c+2*this.options.ticks.backdropPaddingY)}e.textAlign="center",e.textBaseline="middle",e.fillStyle=d,e.fillText(a,this.xCenter,s)}}},this),!this.options.lineArc){e.lineWidth=this.options.angleLines.lineWidth,e.strokeStyle=this.options.angleLines.color;for(var a=this.getValueCount()-1;a>=0;a--){if(this.options.angleLines.display){var i=this.getPointPosition(a,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max));e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(i.x,i.y),e.stroke(),e.closePath()}var r=this.getPointPosition(a,this.getDistanceFromCenterForValue(this.options.reverse?this.min:this.max)+5),s=t.getValueOrDefault(this.options.pointLabels.fontColor,n.defaultFontColor),o=t.getValueOrDefault(this.options.pointLabels.fontSize,n.defaultFontSize),l=t.getValueOrDefault(this.options.pointLabels.fontStyle,n.defaultFontStyle),d=t.getValueOrDefault(this.options.pointLabels.fontFamily,n.defaultFontFamily),c=t.fontString(o,l,d);e.font=c,e.fillStyle=s;var u=this.pointLabels.length,g=this.pointLabels.length/2,p=g/2,m=p>a||a>u-p,h=a===p||a===u-p;e.textAlign=0===a?"center":a===g?"center":g>a?"left":"right",e.textBaseline=h?"middle":m?"bottom":"top",e.fillText(this.pointLabels[a]?this.pointLabels[a]:"",r.x,r.y)}}}}});e.scaleService.registerScaleType("radialLinear",i,a)}},{}],42:[function(e,t){"use strict";var n=e("moment");n="function"==typeof n?n:window.moment,t.exports=function(e){var t=e.helpers,a={units:[{name:"millisecond",steps:[1,2,5,10,20,50,100,250,500]},{name:"second",steps:[1,2,5,10,30]},{name:"minute",steps:[1,2,5,10,30]},{name:"hour",steps:[1,2,3,6,12]},{name:"day",steps:[1,2,5]},{name:"week",maxStep:4},{name:"month",maxStep:3},{name:"quarter",maxStep:4},{name:"year",maxStep:!1}]},i={position:"bottom",time:{parser:!1,format:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,displayFormats:{millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm:ss a",hour:"MMM D, hA",day:"ll",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"}},ticks:{autoSkip:!1}},r=e.Scale.extend({initialize:function(){if(!n)throw new Error("Chart.js - Moment.js could not be found! You must include it before Chart.js to use the time scale. Download at https://momentjs.com");e.Scale.prototype.initialize.call(this)},getLabelMoment:function(e,t){return this.labelMoments[e][t]},getMomentStartOf:function(e){return"week"===this.options.time.unit&&this.options.time.isoWeekday!==!1?e.clone().startOf("isoWeek").isoWeekday(this.options.time.isoWeekday):e.clone().startOf(this.tickUnit)},determineDataLimits:function(){this.labelMoments=[];var e=[];this.chart.data.labels&&this.chart.data.labels.length>0?(t.each(this.chart.data.labels,function(t){var n=this.parseTime(t);n.isValid()&&(this.options.time.round&&n.startOf(this.options.time.round),e.push(n))},this),this.firstTick=n.min.call(this,e),this.lastTick=n.max.call(this,e)):(this.firstTick=null,this.lastTick=null),t.each(this.chart.data.datasets,function(a,i){var r=[],s=this.chart.isDatasetVisible(i);"object"==typeof a.data[0]&&null!==a.data[0]?t.each(a.data,function(e){var t=this.parseTime(this.getRightValue(e));t.isValid()&&(this.options.time.round&&t.startOf(this.options.time.round),r.push(t),s&&(this.firstTick=null!==this.firstTick?n.min(this.firstTick,t):t,this.lastTick=null!==this.lastTick?n.max(this.lastTick,t):t))},this):r=e,this.labelMoments.push(r)},this),this.options.time.min&&(this.firstTick=this.parseTime(this.options.time.min)),this.options.time.max&&(this.lastTick=this.parseTime(this.options.time.max)),this.firstTick=(this.firstTick||n()).clone(),this.lastTick=(this.lastTick||n()).clone()},buildTicks:function(){this.ctx.save();var n=t.getValueOrDefault(this.options.ticks.fontSize,e.defaults.global.defaultFontSize),i=t.getValueOrDefault(this.options.ticks.fontStyle,e.defaults.global.defaultFontStyle),r=t.getValueOrDefault(this.options.ticks.fontFamily,e.defaults.global.defaultFontFamily),s=t.fontString(n,i,r);if(this.ctx.font=s,this.ticks=[],this.unitScale=1,this.scaleSizeInUnits=0,this.options.time.unit)this.tickUnit=this.options.time.unit||"day",this.displayFormat=this.options.time.displayFormats[this.tickUnit],this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0),this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,1);else{var o=this.isHorizontal()?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),l=this.tickFormatFunction(this.firstTick,0,[]),d=this.ctx.measureText(l).width,c=Math.cos(t.toRadians(this.options.ticks.maxRotation)),u=Math.sin(t.toRadians(this.options.ticks.maxRotation));d=d*c+n*u;var g=o/d;this.tickUnit="millisecond",this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0),this.displayFormat=this.options.time.displayFormats[this.tickUnit];for(var p=0,m=a.units[p];p<a.units.length;){if(this.unitScale=1,t.isArray(m.steps)&&Math.ceil(this.scaleSizeInUnits/g)<t.max(m.steps)){for(var h=0;h<m.steps.length;++h)if(m.steps[h]>=Math.ceil(this.scaleSizeInUnits/g)){this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,m.steps[h]);break}break}if(m.maxStep===!1||Math.ceil(this.scaleSizeInUnits/g)<m.maxStep){this.unitScale=t.getValueOrDefault(this.options.time.unitStepSize,Math.ceil(this.scaleSizeInUnits/g));break}++p,m=a.units[p],this.tickUnit=m.name;var f=this.firstTick.diff(this.getMomentStartOf(this.firstTick),this.tickUnit,!0),v=this.getMomentStartOf(this.lastTick.clone().add(1,this.tickUnit)).diff(this.lastTick,this.tickUnit,!0);this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0)+f+v,this.displayFormat=this.options.time.displayFormats[m.name]}}var b;if(this.options.time.min?b=this.getMomentStartOf(this.firstTick):(this.firstTick=this.getMomentStartOf(this.firstTick),b=this.firstTick),!this.options.time.max){var w=this.getMomentStartOf(this.lastTick);0!==w.diff(this.lastTick,this.tickUnit,!0)&&(this.lastTick=this.getMomentStartOf(this.lastTick.add(1,this.tickUnit)))}this.smallestLabelSeparation=this.width,t.each(this.chart.data.datasets,function(e,t){for(var n=1;n<this.labelMoments[t].length;n++)this.smallestLabelSeparation=Math.min(this.smallestLabelSeparation,this.labelMoments[t][n].diff(this.labelMoments[t][n-1],this.tickUnit,!0))},this),this.options.time.displayFormat&&(this.displayFormat=this.options.time.displayFormat),this.ticks.push(this.firstTick.clone());for(var y=1;y<=this.scaleSizeInUnits;++y){var _=b.clone().add(y,this.tickUnit);if(this.options.time.max&&_.diff(this.lastTick,this.tickUnit,!0)>=0)break;y%this.unitScale===0&&this.ticks.push(_)}var x=this.ticks[this.ticks.length-1].diff(this.lastTick,this.tickUnit);(0!==x||0===this.scaleSizeInUnits)&&(this.options.time.max?(this.ticks.push(this.lastTick.clone()),this.scaleSizeInUnits=this.lastTick.diff(this.ticks[0],this.tickUnit,!0)):(this.ticks.push(this.lastTick.clone()),this.scaleSizeInUnits=this.lastTick.diff(this.firstTick,this.tickUnit,!0))),this.ctx.restore()},getLabelForIndex:function(e,t){var n=this.chart.data.labels&&e<this.chart.data.labels.length?this.chart.data.labels[e]:"";return"object"==typeof this.chart.data.datasets[t].data[0]&&(n=this.getRightValue(this.chart.data.datasets[t].data[e])),this.options.time.tooltipFormat&&(n=this.parseTime(n).format(this.options.time.tooltipFormat)),n},tickFormatFunction:function(e,n,a){var i=e.format(this.displayFormat),r=this.options.ticks,s=t.getValueOrDefault(r.callback,r.userCallback);return s?s(i,n,a):i},convertTicksToLabels:function(){this.tickMoments=this.ticks,this.ticks=this.ticks.map(this.tickFormatFunction,this)},getPixelForValue:function(e,t,n){var a=e&&e.isValid&&e.isValid()?e:this.getLabelMoment(n,t);if(a){var i=a.diff(this.firstTick,this.tickUnit,!0),r=i/this.scaleSizeInUnits;if(this.isHorizontal()){var s=this.width-(this.paddingLeft+this.paddingRight),o=(s/Math.max(this.ticks.length-1,1),s*r+this.paddingLeft);return this.left+Math.round(o)}var l=this.height-(this.paddingTop+this.paddingBottom),d=(l/Math.max(this.ticks.length-1,1),l*r+this.paddingTop);return this.top+Math.round(d)}},getPixelForTick:function(e,t){return this.getPixelForValue(this.tickMoments[e],null,null,t)},getValueForPixel:function(e){var t=this.isHorizontal()?this.width-(this.paddingLeft+this.paddingRight):this.height-(this.paddingTop+this.paddingBottom),a=(e-(this.isHorizontal()?this.left+this.paddingLeft:this.top+this.paddingTop))/t;return a*=this.scaleSizeInUnits,this.firstTick.clone().add(n.duration(a,this.tickUnit).asSeconds(),"seconds")},parseTime:function(e){return"string"==typeof this.options.time.parser?n(e,this.options.time.parser):"function"==typeof this.options.time.parser?this.options.time.parser(e):"function"==typeof e.getMonth||"number"==typeof e?n(e):e.isValid&&e.isValid()?e:"string"!=typeof this.options.time.format&&this.options.time.format.call?(console.warn("options.time.format is deprecated and replaced by options.time.parser. See http://nnnick.github.io/Chart.js/docs-v2/#scales-time-scale"),this.options.time.format(e)):n(e,this.options.time.format)}});e.scaleService.registerScaleType("time",r,i)}},{moment:1}]},{},[7]);